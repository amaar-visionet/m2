require.config({
    config: {
        'jsbuild':{"legacy-build.min.js":"var Prototype={Version:\"1.7\",Browser:(function(){var d=navigator.userAgent;var b=Object.prototype.toString.call(window.opera)==\"[object Opera]\";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:d.indexOf(\"AppleWebKit/\")>-1,Gecko:d.indexOf(\"Gecko\")>-1&&d.indexOf(\"KHTML\")===-1,MobileSafari:/Apple.*Mobile/.test(d)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var b=window.Element||window.HTMLElement;return !!(b&&b.prototype)})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!==\"undefined\"){return true}var e=document.createElement(\"div\"),d=document.createElement(\"form\"),b=false;if(e.__proto__&&(e.__proto__!==d.__proto__)){b=true}e=d=null;return b})()},ScriptFragment:\"<script[^>]*>([\\\\S\\\\s]*?)<\\/script>\",JSONFilter:/^\\/\\*-secure-([\\s\\S]*)\\*\\/\\s*$/,emptyFunction:function(){},K:function(b){return b}};if(Prototype.Browser.MobileSafari){Prototype.BrowserFeatures.SpecificElementExtensions=false}var Abstract={};var Try={these:function(){var f;for(var d=0,g=arguments.length;d<g;d++){var b=arguments[d];try{f=b();break}catch(h){}}return f}};var Class=(function(){var f=(function(){for(var g in {toString:1}){if(g===\"toString\"){return false}}return true})();function b(){}function d(){var n=null,l=$A(arguments);if(Object.isFunction(l[0])){n=l.shift()}function g(){this.initialize.apply(this,arguments)}Object.extend(g,Class.Methods);g.superclass=n;g.subclasses=[];if(n){b.prototype=n.prototype;g.prototype=new b;n.subclasses.push(g)}for(var h=0,o=l.length;h<o;h++){g.addMethods(l[h])}if(!g.prototype.initialize){g.prototype.initialize=Prototype.emptyFunction}g.prototype.constructor=g;return g}function e(q){var l=this.superclass&&this.superclass.prototype,h=Object.keys(q);if(f){if(q.toString!=Object.prototype.toString){h.push(\"toString\")}if(q.valueOf!=Object.prototype.valueOf){h.push(\"valueOf\")}}for(var g=0,n=h.length;g<n;g++){var p=h[g],o=q[p];if(l&&Object.isFunction(o)&&o.argumentNames()[0]==\"$super\"){var r=o;o=(function(s){return function(){return l[s].apply(this,arguments)}})(p).wrap(r);o.valueOf=r.valueOf.bind(r);o.toString=r.toString.bind(r)}this.prototype[p]=o}return this}return{create:d,Methods:{addMethods:e}}})();(function(){var J=Object.prototype.toString,I=\"Null\",u=\"Undefined\",C=\"Boolean\",h=\"Number\",z=\"String\",O=\"Object\",A=\"[object Function]\",F=\"[object Boolean]\",l=\"[object Number]\",r=\"[object String]\",n=\"[object Array]\",E=\"[object Date]\",o=window.JSON&&typeof JSON.stringify===\"function\"&&JSON.stringify(0)===\"0\"&&typeof JSON.stringify(Prototype.K)===\"undefined\";function q(Q){switch(Q){case null:return I;case (void 0):return u}var P=typeof Q;switch(P){case\"boolean\":return C;case\"number\":return h;case\"string\":return z}return O}function G(P,R){for(var Q in R){P[Q]=R[Q]}return P}function N(P){try{if(e(P)){return\"undefined\"}if(P===null){return\"null\"}return P.inspect?P.inspect():String(P)}catch(Q){if(Q instanceof RangeError){return\"...\"}throw Q}}function K(P){return M(\"\",{\"\":P},[])}function M(Y,V,W){var X=V[Y],U=typeof X;if(q(X)===O&&typeof X.toJSON===\"function\"){X=X.toJSON(Y)}var R=J.call(X);switch(R){case l:case F:case r:X=X.valueOf()}switch(X){case null:return\"null\";case true:return\"true\";case false:return\"false\"}U=typeof X;switch(U){case\"string\":return X.inspect(true);case\"number\":return isFinite(X)?String(X):\"null\";case\"object\":for(var Q=0,P=W.length;Q<P;Q++){if(W[Q]===X){throw new TypeError()}}W.push(X);var T=[];if(R===n){for(var Q=0,P=X.length;Q<P;Q++){var S=M(Q,X,W);T.push(typeof S===\"undefined\"?\"null\":S)}T=\"[\"+T.join(\",\")+\"]\"}else{var Z=Object.keys(X);for(var Q=0,P=Z.length;Q<P;Q++){var Y=Z[Q],S=M(Y,X,W);if(typeof S!==\"undefined\"){T.push(Y.inspect(true)+\":\"+S)}}T=\"{\"+T.join(\",\")+\"}\"}W.pop();return T}}function D(P){return JSON.stringify(P)}function p(P){return $H(P).toQueryString()}function v(P){return P&&P.toHTML?P.toHTML():String.interpret(P)}function y(P){if(q(P)!==O){throw new TypeError()}var Q=[];for(var R in P){if(P.hasOwnProperty(R)){Q.push(R)}}return Q}function f(P){var Q=[];for(var R in P){Q.push(P[R])}return Q}function H(P){return G({},P)}function B(P){return !!(P&&P.nodeType==1)}function s(P){return J.call(P)===n}var d=(typeof Array.isArray==\"function\")&&Array.isArray([])&&!Array.isArray({});if(d){s=Array.isArray}function g(P){return P instanceof Hash}function b(P){return J.call(P)===A}function t(P){return J.call(P)===r}function w(P){return J.call(P)===l}function L(P){return J.call(P)===E}function e(P){return typeof P===\"undefined\"}G(Object,{extend:G,inspect:N,toJSON:o?D:K,toQueryString:p,toHTML:v,keys:Object.keys||y,values:f,clone:H,isElement:B,isArray:s,isHash:g,isFunction:b,isString:t,isNumber:w,isDate:L,isUndefined:e})})();Object.extend(Function.prototype,(function(){var p=Array.prototype.slice;function f(t,q){var s=t.length,r=q.length;while(r--){t[s+r]=q[r]}return t}function n(r,q){r=p.call(r,0);return f(r,q)}function l(){var q=this.toString().match(/^[\\s\\(]*function[^(]*\\(([^)]*)\\)/)[1].replace(/\\/\\/.*?[\\r\\n]|\\/\\*(?:.|[\\r\\n])*?\\*\\//g,\"\").replace(/\\s+/g,\"\").split(\",\");return q.length==1&&!q[0]?[]:q}function h(s){var q=this,r=p.call(arguments,1);return function(u){var t=f([u||window.event],r);return q.apply(s,t)}}function o(){if(!arguments.length){return this}var q=this,r=p.call(arguments,0);return function(){var s=n(r,arguments);return q.apply(this,s)}}function g(s){var q=this,r=p.call(arguments,1);s=s*1000;return window.setTimeout(function(){return q.apply(q,r)},s)}function b(){var q=f([0.01],arguments);return this.delay.apply(this,q)}function e(r){var q=this;return function(){var s=f([q.bind(this)],arguments);return r.apply(this,s)}}function d(){if(this._methodized){return this._methodized}var q=this;return this._methodized=function(){var r=f([this],arguments);return q.apply(null,r)}}return{argumentNames:l,bindAsEventListener:h,curry:o,delay:g,defer:b,wrap:e,methodize:d}})());(function(e){function d(){return this.getUTCFullYear()+\"-\"+(this.getUTCMonth()+1).toPaddedString(2)+\"-\"+this.getUTCDate().toPaddedString(2)+\"T\"+this.getUTCHours().toPaddedString(2)+\":\"+this.getUTCMinutes().toPaddedString(2)+\":\"+this.getUTCSeconds().toPaddedString(2)+\"Z\"}function b(){return this.toISOString()}if(!e.toISOString){e.toISOString=d}if(!e.toJSON){e.toJSON=b}})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(b){return String(b).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\")};var PeriodicalExecuter=Class.create({initialize:function(d,b){this.callback=d;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},execute:function(){this.callback(this)},stop:function(){if(!this.timer){return}clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(b){this.currentlyExecuting=false;throw b}}}});Object.extend(String,{interpret:function(b){return b==null?\"\":String(b)},specialChar:{\"\\b\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\f\":\"\\\\f\",\"\\r\":\"\\\\r\",\"\\\\\":\"\\\\\\\\\"}});Object.extend(String.prototype,(function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&typeof JSON.parse===\"function\"&&JSON.parse('{\"test\": true}').test;function prepareReplacement(replacement){if(Object.isFunction(replacement)){return replacement}var template=new Template(replacement);return function(match){return template.evaluate(match)}}function gsub(pattern,replacement){var result=\"\",source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern)){pattern=RegExp.escape(pattern)}if(!(pattern.length||pattern.source)){replacement=replacement(\"\");return replacement+source.split(\"\").join(replacement)+replacement}while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=\"\"}}return result}function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0){return match[0]}return replacement(match)})}function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this)}function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?\"...\":truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this)}function strip(){return this.replace(/^\\s+/,\"\").replace(/\\s+$/,\"\")}function stripTags(){return this.replace(/<\\w+(\\s+(\"[^\"]*\"|'[^']*'|[^>])+)?>|<\\/\\w+>/gi,\"\")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,\"img\"),\"\")}function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,\"img\"),matchOne=new RegExp(Prototype.ScriptFragment,\"im\");return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||[\"\",\"\"])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,\"<\").replace(/&gt;/g,\">\").replace(/&amp;/g,\"&\")}function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match){return{}}return match[1].split(separator||\"&\").inject({},function(hash,pair){if((pair=pair.split(\"=\"))[0]){var key=decodeURIComponent(pair.shift()),value=pair.length>1?pair.join(\"=\"):pair[0];if(value!=undefined){value=decodeURIComponent(value)}if(key in hash){if(!Object.isArray(hash[key])){hash[key]=[hash[key]]}hash[key].push(value)}else{hash[key]=value}}return hash})}function toArray(){return this.split(\"\")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(count){return count<1?\"\":new Array(count+1).join(this)}function camelize(){return this.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():\"\"})}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,\"/\").replace(/([A-Z]+)([A-Z][a-z])/g,\"$1_$2\").replace(/([a-z\\d])([A-Z])/g,\"$1_$2\").replace(/-/g,\"_\").toLowerCase()}function dasherize(){return this.replace(/_/g,\"-\")}function inspect(useDoubleQuotes){var escapedString=this.replace(/[\\x00-\\x1f\\\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character]}return\"\\\\u00\"+character.charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes){return'\"'+escapedString.replace(/\"/g,'\\\\\"')+'\"'}return\"'\"+escapedString.replace(/'/g,\"\\\\'\")+\"'\"}function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,\"$1\")}function isJSON(){var str=this;if(str.blank()){return false}str=str.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,\"@\");str=str.replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,\"]\");str=str.replace(/(?:^|:|,)(?:\\s*\\[)+/g,\"\");return(/^[\\],:{}\\s]*$/).test(str)}function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;if(cx.test(json)){json=json.replace(cx,function(a){return\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)})}try{if(!sanitize||json.isJSON()){return eval(\"(\"+json+\")\")}}catch(e){}throw new SyntaxError(\"Badly formed JSON string: \"+this.inspect())}function parseJSON(){var json=this.unfilterJSON();return JSON.parse(json)}function include(pattern){return this.indexOf(pattern)>-1}function startsWith(pattern){return this.lastIndexOf(pattern,0)===0}function endsWith(pattern){var d=this.length-pattern.length;return d>=0&&this.indexOf(pattern,d)===d}function empty(){return this==\"\"}function blank(){return/^\\s*$/.test(this)}function interpolate(object,pattern){return new Template(this,pattern).evaluate(object)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate}})());var Template=Class.create({initialize:function(b,d){this.template=b.toString();this.pattern=d||Template.Pattern},evaluate:function(b){if(b&&Object.isFunction(b.toTemplateReplacements)){b=b.toTemplateReplacements()}return this.template.gsub(this.pattern,function(f){if(b==null){return(f[1]+\"\")}var h=f[1]||\"\";if(h==\"\\\\\"){return f[2]}var d=b,l=f[3],g=/^([^.[]+|\\[((?:.*?[^\\\\])?)\\])(\\.|\\[|$)/;f=g.exec(l);if(f==null){return h}while(f!=null){var e=f[1].startsWith(\"[\")?f[2].replace(/\\\\\\\\]/g,\"]\"):f[1];d=d[e];if(null==d||\"\"==f[3]){break}l=l.substring(\"[\"==f[3]?f[1].length:f[0].length);f=g.exec(l)}return h+String.interpret(d)})}});Template.Pattern=/(^|.|\\r|\\n)(#\\{(.*?)\\})/;var $break={};var Enumerable=(function(){function e(F,E){var D=0;try{this._each(function(H){F.call(E,H,D++)})}catch(G){if(G!=$break){throw G}}return this}function y(G,F,E){var D=-G,H=[],I=this.toArray();if(G<1){return I}while((D+=G)<I.length){H.push(I.slice(D,D+G))}return H.collect(F,E)}function d(F,E){F=F||Prototype.K;var D=true;this.each(function(H,G){D=D&&!!F.call(E,H,G);if(!D){throw $break}});return D}function o(F,E){F=F||Prototype.K;var D=false;this.each(function(H,G){if(D=!!F.call(E,H,G)){throw $break}});return D}function p(F,E){F=F||Prototype.K;var D=[];this.each(function(H,G){D.push(F.call(E,H,G))});return D}function A(F,E){var D;this.each(function(H,G){if(F.call(E,H,G)){D=H;throw $break}});return D}function n(F,E){var D=[];this.each(function(H,G){if(F.call(E,H,G)){D.push(H)}});return D}function l(G,F,E){F=F||Prototype.K;var D=[];if(Object.isString(G)){G=new RegExp(RegExp.escape(G))}this.each(function(I,H){if(G.match(I)){D.push(F.call(E,I,H))}});return D}function b(D){if(Object.isFunction(this.indexOf)){if(this.indexOf(D)!=-1){return true}}var E=false;this.each(function(F){if(F==D){E=true;throw $break}});return E}function w(E,D){D=Object.isUndefined(D)?null:D;return this.eachSlice(E,function(F){while(F.length<E){F.push(D)}return F})}function r(D,F,E){this.each(function(H,G){D=F.call(E,D,H,G)});return D}function C(E){var D=$A(arguments).slice(1);return this.map(function(F){return F[E].apply(F,D)})}function v(F,E){F=F||Prototype.K;var D;this.each(function(H,G){H=F.call(E,H,G);if(D==null||H>=D){D=H}});return D}function t(F,E){F=F||Prototype.K;var D;this.each(function(H,G){H=F.call(E,H,G);if(D==null||H<D){D=H}});return D}function g(G,E){G=G||Prototype.K;var F=[],D=[];this.each(function(I,H){(G.call(E,I,H)?F:D).push(I)});return[F,D]}function h(E){var D=[];this.each(function(F){D.push(F[E])});return D}function f(F,E){var D=[];this.each(function(H,G){if(!F.call(E,H,G)){D.push(H)}});return D}function s(E,D){return this.map(function(G,F){return{value:G,criteria:E.call(D,G,F)}}).sort(function(I,H){var G=I.criteria,F=H.criteria;return G<F?-1:G>F?1:0}).pluck(\"value\")}function u(){return this.map(Prototype.K)}function z(){var E=Prototype.K,D=$A(arguments);if(Object.isFunction(D.last())){E=D.pop()}var F=[this].concat(D).map($A);return this.map(function(H,G){return E(F.pluck(G))})}function q(){return this.toArray().length}function B(){return\"#<Enumerable:\"+this.toArray().inspect()+\">\"}return{each:e,eachSlice:y,all:d,any:o,collect:p,detect:A,findAll:n,select:n,grep:l,include:b,member:b,inGroupsOf:w,inject:r,invoke:C,partition:g,pluck:h,reject:f,sortBy:s,toArray:u,entries:u,zip:z,size:q,inspect:B,find:A,map:Array.prototype.map}})();function $A(e){if(!e){return[]}if(\"toArray\" in Object(e)){return e.toArray()}var d=e.length||0,b=new Array(d);while(d--){b[d]=e[d]}return b}function $w(b){if(!Object.isString(b)){return[]}b=b.strip();return b?b.split(/\\s+/):[]}Array.from=$A;(function(){var y=Array.prototype,s=y.slice,u=y.forEach;function d(D,C){for(var B=0,E=this.length>>>0;B<E;B++){if(B in this){D.call(C,this[B],B,this)}}}if(!u){u=d}function r(){this.length=0;return this}function f(){return this[0]}function l(){return this[this.length-1]}function o(){return this.select(function(B){return B!=null})}function A(){return this.inject([],function(C,B){if(Object.isArray(B)){return C.concat(B.flatten())}C.push(B);return C})}function n(){var B=s.call(arguments,0);return this.select(function(C){return !B.include(C)})}function h(B){return(B===false?this.toArray():this)._reverse()}function q(B){return this.inject([],function(E,D,C){if(0==C||(B?E.last()!=D:!E.include(D))){E.push(D)}return E})}function v(B){return this.uniq().findAll(function(C){return B.detect(function(D){return C===D})})}function w(){return s.call(this,0)}function p(){return this.length}function z(){return\"[\"+this.map(Object.inspect).join(\", \")+\"]\"}function b(D,B){B||(B=0);var C=this.length;if(B<0){B=C+B}for(;B<C;B++){if(this[B]===D){return B}}return -1}function t(C,B){B=isNaN(B)?this.length:(B<0?this.length+B:B)+1;var D=this.slice(0,B).reverse().indexOf(C);return(D<0)?D:B-D-1}function e(){var G=s.call(this,0),E;for(var C=0,D=arguments.length;C<D;C++){E=arguments[C];if(Object.isArray(E)&&!(\"callee\" in E)){for(var B=0,F=E.length;B<F;B++){G.push(E[B])}}else{G.push(E)}}return G}Object.extend(y,Enumerable);if(!y._reverse){y._reverse=y.reverse}Object.extend(y,{_each:u,clear:r,first:f,last:l,compact:o,flatten:A,without:n,reverse:h,uniq:q,intersect:v,clone:w,toArray:w,size:p,inspect:z});var g=(function(){return[].concat(arguments)[0][0]!==1})(1,2);if(g){y.concat=e}if(!y.indexOf){y.indexOf=b}if(!y.lastIndexOf){y.lastIndexOf=t}})();function $H(b){return new Hash(b)}var Hash=Class.create(Enumerable,(function(){function g(v){this._object=Object.isHash(v)?v.toObject():Object.clone(v)}function h(w){for(var v in this._object){var y=this._object[v],z=[v,y];z.key=v;z.value=y;w(z)}}function p(v,w){return this._object[v]=w}function e(v){if(this._object[v]!==Object.prototype[v]){return this._object[v]}}function s(v){var w=this._object[v];delete this._object[v];return w}function u(){return Object.clone(this._object)}function t(){return this.pluck(\"key\")}function r(){return this.pluck(\"value\")}function l(w){var v=this.detect(function(y){return y.value===w});return v&&v.key}function o(v){return this.clone().update(v)}function f(v){return new Hash(v).inject(this,function(w,y){w.set(y.key,y.value);return w})}function d(v,w){if(Object.isUndefined(w)){return v}return v+\"=\"+encodeURIComponent(String.interpret(w))}function b(){return this.inject([],function(A,D){var z=encodeURIComponent(D.key),w=D.value;if(w&&typeof w==\"object\"){if(Object.isArray(w)){var C=[];for(var y=0,v=w.length,B;y<v;y++){B=w[y];C.push(d(z,B))}return A.concat(C)}}else{A.push(d(z,w))}return A}).join(\"&\")}function q(){return\"#<Hash:{\"+this.map(function(v){return v.map(Object.inspect).join(\": \")}).join(\", \")+\"}>\"}function n(){return new Hash(this)}return{initialize:g,_each:h,set:p,get:e,unset:s,toObject:u,toTemplateReplacements:u,keys:t,values:r,index:l,merge:o,update:f,toQueryString:b,inspect:q,toJSON:u,clone:n}})());Hash.from=$H;Object.extend(Number.prototype,(function(){function f(){return this.toPaddedString(2,16)}function d(){return this+1}function n(p,o){$R(0,this,true).each(p,o);return this}function l(q,p){var o=this.toString(p||10);return\"0\".times(q-o.length)+o}function b(){return Math.abs(this)}function e(){return Math.round(this)}function g(){return Math.ceil(this)}function h(){return Math.floor(this)}return{toColorPart:f,succ:d,times:n,toPaddedString:l,abs:b,round:e,ceil:g,floor:h}})());function $R(e,b,d){return new ObjectRange(e,b,d)}var ObjectRange=Class.create(Enumerable,(function(){function d(h,f,g){this.start=h;this.end=f;this.exclusive=g}function e(f){var g=this.start;while(this.include(g)){f(g);g=g.succ()}}function b(f){if(f<this.start){return false}if(this.exclusive){return f<this.end}return f<=this.end}return{initialize:d,_each:e,include:b}})());var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject(\"Msxml2.XMLHTTP\")},function(){return new ActiveXObject(\"Microsoft.XMLHTTP\")})||false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(b){this.responders._each(b)},register:function(b){if(!this.include(b)){this.responders.push(b)}},unregister:function(b){this.responders=this.responders.without(b)},dispatch:function(f,d,e,b){this.each(function(g){if(Object.isFunction(g[f])){try{g[f].apply(g,[d,e,b])}catch(h){}}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(b){this.options={method:\"post\",asynchronous:true,contentType:\"application/x-www-form-urlencoded\",encoding:\"UTF-8\",parameters:\"\",evalJSON:true,evalJS:true};Object.extend(this.options,b||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters)){this.options.parameters=this.options.parameters.toObject()}}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,d,b){$super(b);this.transport=Ajax.getTransport();this.request(d)},request:function(d){this.url=d;this.method=this.options.method;var g=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(![\"get\",\"post\"].include(this.method)){g+=(g?\"&\":\"\")+\"_method=\"+this.method;this.method=\"post\"}if(g&&this.method===\"get\"){this.url+=(this.url.include(\"?\")?\"&\":\"?\")+g}this.parameters=g.toQueryParams();try{var b=new Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(b)}Ajax.Responders.dispatch(\"onCreate\",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){this.respondToReadyState.bind(this).defer(1)}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method==\"post\"?(this.options.postBody||g):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(f){this.dispatchException(f)}},onStateChange:function(){var b=this.transport.readyState;if(b>1&&!((b==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var g={\"X-Requested-With\":\"XMLHttpRequest\",\"X-Prototype-Version\":Prototype.Version,Accept:\"text/javascript, text/html, application/xml, text/xml, */*\"};if(this.method==\"post\"){g[\"Content-type\"]=this.options.contentType+(this.options.encoding?\"; charset=\"+this.options.encoding:\"\");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\\/(\\d{4})/)||[0,2005])[1]<2005){g.Connection=\"close\"}}if(typeof this.options.requestHeaders==\"object\"){var e=this.options.requestHeaders;if(Object.isFunction(e.push)){for(var d=0,f=e.length;d<f;d+=2){g[e[d]]=e[d+1]}}else{$H(e).each(function(h){g[h.key]=h.value})}}for(var b in g){this.transport.setRequestHeader(b,g[b])}},success:function(){var b=this.getStatus();return !b||(b>=200&&b<300)||b==304},getStatus:function(){try{if(this.transport.status===1223){return 204}return this.transport.status||0}catch(b){return 0}},respondToReadyState:function(b){var f=Ajax.Request.Events[b],d=new Ajax.Response(this);if(f==\"Complete\"){try{this._complete=true;(this.options[\"on\"+d.status]||this.options[\"on\"+(this.success()?\"Success\":\"Failure\")]||Prototype.emptyFunction)(d,d.headerJSON)}catch(g){this.dispatchException(g)}var h=d.getHeader(\"Content-type\");if(this.options.evalJS==\"force\"||(this.options.evalJS&&this.isSameOrigin()&&h&&h.match(/^\\s*(text|application)\\/(x-)?(java|ecma)script(;.*)?\\s*$/i))){this.evalResponse()}}try{(this.options[\"on\"+f]||Prototype.emptyFunction)(d,d.headerJSON);Ajax.Responders.dispatch(\"on\"+f,this,d,d.headerJSON)}catch(g){this.dispatchException(g)}if(f==\"Complete\"){this.transport.onreadystatechange=Prototype.emptyFunction}},isSameOrigin:function(){var b=this.url.match(/^\\s*https?:\\/\\/[^\\/]*/);return !b||(b[0]==\"#{protocol}//#{domain}#{port}\".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?\":\"+location.port:\"\"}))},getHeader:function(b){try{return this.transport.getResponseHeader(b)||null}catch(d){return null}},evalResponse:function(){try{return eval((this.transport.responseText||\"\").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(b){(this.options.onException||Prototype.emptyFunction)(this,b);Ajax.Responders.dispatch(\"onException\",this,b)}});Ajax.Request.Events=[\"Uninitialized\",\"Loading\",\"Loaded\",\"Interactive\",\"Complete\"];Ajax.Response=Class.create({initialize:function(e){this.request=e;var f=this.transport=e.transport,b=this.readyState=f.readyState;if((b>2&&!Prototype.Browser.IE)||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(f.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){var d=f.responseXML;this.responseXML=Object.isUndefined(d)?null:d;this.responseJSON=this._getResponseJSON()}},status:0,statusText:\"\",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||\"\"}catch(b){return\"\"}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(b){return null}},getResponseHeader:function(b){return this.transport.getResponseHeader(b)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var b=this.getHeader(\"X-JSON\");if(!b){return null}b=decodeURIComponent(escape(b));try{return b.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(d){this.request.dispatchException(d)}},_getResponseJSON:function(){var b=this.request.options;if(!b.evalJSON||(b.evalJSON!=\"force\"&&!(this.getHeader(\"Content-type\")||\"\").include(\"application/json\"))||this.responseText.blank()){return null}try{return this.responseText.evalJSON(b.sanitizeJSON||!this.request.isSameOrigin())}catch(d){this.request.dispatchException(d)}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,e,d){this.container={success:(b.success||b),failure:(b.failure||(b.success?null:b))};d=Object.clone(d);var f=d.onComplete;d.onComplete=(function(g,h){this.updateContent(g.responseText);if(Object.isFunction(f)){f(g,h)}}).bind(this);$super(e,d)},updateContent:function(f){var e=this.container[this.success()?\"success\":\"failure\"],b=this.options;if(!b.evalScripts){f=f.stripScripts()}if(e=$(e)){if(b.insertion){if(Object.isString(b.insertion)){var d={};d[b.insertion]=f;e.insert(d)}else{b.insertion(e,f)}}else{e.update(f)}}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,e,d){$super(d);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=b;this.url=e;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(b){if(this.options.decay){this.decay=(b.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=b.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});function $(d){if(arguments.length>1){for(var b=0,f=[],e=arguments.length;b<e;b++){f.push($(arguments[b]))}return f}if(Object.isString(d)){d=document.getElementById(d)}return Element.extend(d)}if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(h,b){var e=[];var g=document.evaluate(h,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var d=0,f=g.snapshotLength;d<f;d++){e.push(Element.extend(g.snapshotItem(d)))}return e}}if(!Node){var Node={}}if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}(function(e){function f(h,g){if(h===\"select\"){return false}if(\"type\" in g){return false}return true}var d=(function(){try{var g=document.createElement('<input name=\"x\">');return g.tagName.toLowerCase()===\"input\"&&g.name===\"x\"}catch(h){return false}})();var b=e.Element;e.Element=function(l,h){h=h||{};l=l.toLowerCase();var g=Element.cache;if(d&&h.name){l=\"<\"+l+' name=\"'+h.name+'\">';delete h.name;return Element.writeAttribute(document.createElement(l),h)}if(!g[l]){g[l]=Element.extend(document.createElement(l))}var n=f(l,h)?g[l].cloneNode(false):document.createElement(l);return Element.writeAttribute(n,h)};Object.extend(e.Element,b||{});if(b){e.Element.prototype=b.prototype}})(this);Element.idCounter=1;Element.cache={};Element._purgeElement=function(d){var b=d._prototypeUID;if(b){Element.stopObserving(d);d._prototypeUID=void 0;delete Element.Storage[b]}};Element.Methods={visible:function(b){return $(b).style.display!=\"none\"},toggle:function(b){b=$(b);Element[Element.visible(b)?\"hide\":\"show\"](b);return b},hide:function(b){b=$(b);b.style.display=\"none\";return b},show:function(b){b=$(b);b.style.display=\"\";return b},remove:function(b){b=$(b);b.parentNode.removeChild(b);return b},update:(function(){var f=(function(){var l=document.createElement(\"select\"),n=true;l.innerHTML='<option value=\"test\">test</option>';if(l.options&&l.options[0]){n=l.options[0].nodeName.toUpperCase()!==\"OPTION\"}l=null;return n})();var d=(function(){try{var l=document.createElement(\"table\");if(l&&l.tBodies){l.innerHTML=\"<tbody><tr><td>test</td></tr></tbody>\";var o=typeof l.tBodies[0]==\"undefined\";l=null;return o}}catch(n){return true}})();var b=(function(){try{var l=document.createElement(\"div\");l.innerHTML=\"<link>\";var o=(l.childNodes.length===0);l=null;return o}catch(n){return true}})();var e=f||d||b;var h=(function(){var l=document.createElement(\"script\"),o=false;try{l.appendChild(document.createTextNode(\"\"));o=!l.firstChild||l.firstChild&&l.firstChild.nodeType!==3}catch(n){o=true}l=null;return o})();function g(q,r){q=$(q);var l=Element._purgeElement;var s=q.getElementsByTagName(\"*\"),p=s.length;while(p--){l(s[p])}if(r&&r.toElement){r=r.toElement()}if(Object.isElement(r)){return q.update().insert(r)}r=Object.toHTML(r);var o=q.tagName.toUpperCase();if(o===\"SCRIPT\"&&h){q.text=r;return q}if(e){if(o in Element._insertionTranslations.tags){while(q.firstChild){q.removeChild(q.firstChild)}Element._getContentFromAnonymousElement(o,r.stripScripts()).each(function(t){q.appendChild(t)})}else{if(b&&Object.isString(r)&&r.indexOf(\"<link\")>-1){while(q.firstChild){q.removeChild(q.firstChild)}var n=Element._getContentFromAnonymousElement(o,r.stripScripts(),true);n.each(function(t){q.appendChild(t)})}else{q.innerHTML=r.stripScripts()}}}else{q.innerHTML=r.stripScripts()}r.evalScripts.bind(r).defer();return q}return g})(),replace:function(d,e){d=$(d);if(e&&e.toElement){e=e.toElement()}else{if(!Object.isElement(e)){e=Object.toHTML(e);var b=d.ownerDocument.createRange();b.selectNode(d);e.evalScripts.bind(e).defer();e=b.createContextualFragment(e.stripScripts())}}d.parentNode.replaceChild(e,d);return d},insert:function(e,g){e=$(e);if(Object.isString(g)||Object.isNumber(g)||Object.isElement(g)||(g&&(g.toElement||g.toHTML))){g={bottom:g}}var f,h,d,l;for(var b in g){f=g[b];b=b.toLowerCase();h=Element._insertionTranslations[b];if(f&&f.toElement){f=f.toElement()}if(Object.isElement(f)){h(e,f);continue}f=Object.toHTML(f);d=((b==\"before\"||b==\"after\")?e.parentNode:e).tagName.toUpperCase();l=Element._getContentFromAnonymousElement(d,f.stripScripts());if(b==\"top\"||b==\"after\"){l.reverse()}l.each(h.curry(e));f.evalScripts.bind(f).defer()}return e},wrap:function(d,e,b){d=$(d);if(Object.isElement(e)){$(e).writeAttribute(b||{})}else{if(Object.isString(e)){e=new Element(e,b)}else{e=new Element(\"div\",e)}}if(d.parentNode){d.parentNode.replaceChild(e,d)}e.appendChild(d);return e},inspect:function(d){d=$(d);var b=\"<\"+d.tagName.toLowerCase();$H({id:\"id\",className:\"class\"}).each(function(h){var g=h.first(),e=h.last(),f=(d[g]||\"\").toString();if(f){b+=\" \"+e+\"=\"+f.inspect(true)}});return b+\">\"},recursivelyCollect:function(b,e,f){b=$(b);f=f||-1;var d=[];while(b=b[e]){if(b.nodeType==1){d.push(Element.extend(b))}if(d.length==f){break}}return d},ancestors:function(b){return Element.recursivelyCollect(b,\"parentNode\")},descendants:function(b){return Element.select(b,\"*\")},firstDescendant:function(b){b=$(b).firstChild;while(b&&b.nodeType!=1){b=b.nextSibling}return $(b)},immediateDescendants:function(d){var b=[],e=$(d).firstChild;while(e){if(e.nodeType===1){b.push(Element.extend(e))}e=e.nextSibling}return b},previousSiblings:function(b,d){return Element.recursivelyCollect(b,\"previousSibling\")},nextSiblings:function(b){return Element.recursivelyCollect(b,\"nextSibling\")},siblings:function(b){b=$(b);return Element.previousSiblings(b).reverse().concat(Element.nextSiblings(b))},match:function(d,b){d=$(d);if(Object.isString(b)){return Prototype.Selector.match(d,b)}return b.match(d)},up:function(d,f,b){d=$(d);if(arguments.length==1){return $(d.parentNode)}var e=Element.ancestors(d);return Object.isNumber(f)?e[f]:Prototype.Selector.find(e,f,b)},down:function(d,e,b){d=$(d);if(arguments.length==1){return Element.firstDescendant(d)}return Object.isNumber(e)?Element.descendants(d)[e]:Element.select(d,e)[b||0]},previous:function(d,e,b){d=$(d);if(Object.isNumber(e)){b=e,e=false}if(!Object.isNumber(b)){b=0}if(e){return Prototype.Selector.find(d.previousSiblings(),e,b)}else{return d.recursivelyCollect(\"previousSibling\",b+1)[b]}},next:function(d,f,b){d=$(d);if(Object.isNumber(f)){b=f,f=false}if(!Object.isNumber(b)){b=0}if(f){return Prototype.Selector.find(d.nextSiblings(),f,b)}else{var e=Object.isNumber(b)?b+1:1;return d.recursivelyCollect(\"nextSibling\",b+1)[b]}},select:function(b){b=$(b);var d=Array.prototype.slice.call(arguments,1).join(\", \");return Prototype.Selector.select(d,b)},adjacent:function(b){b=$(b);var d=Array.prototype.slice.call(arguments,1).join(\", \");return Prototype.Selector.select(d,b.parentNode).without(b)},identify:function(b){b=$(b);var d=Element.readAttribute(b,\"id\");if(d){return d}do{d=\"anonymous_element_\"+Element.idCounter++}while($(d));Element.writeAttribute(b,\"id\",d);return d},readAttribute:function(e,b){e=$(e);if(Prototype.Browser.IE){var d=Element._attributeTranslations.read;if(d.values[b]){return d.values[b](e,b)}if(d.names[b]){b=d.names[b]}if(b.include(\":\")){return(!e.attributes||!e.attributes[b])?null:e.attributes[b].value}}return e.getAttribute(b)},writeAttribute:function(g,e,h){g=$(g);var d={},f=Element._attributeTranslations.write;if(typeof e==\"object\"){d=e}else{d[e]=Object.isUndefined(h)?true:h}for(var b in d){e=f.names[b]||b;h=d[b];if(f.values[b]){e=f.values[b](g,h)}if(h===false||h===null){g.removeAttribute(e)}else{if(h===true){g.setAttribute(e,e)}else{g.setAttribute(e,h)}}}return g},getHeight:function(b){return Element.getDimensions(b).height},getWidth:function(b){return Element.getDimensions(b).width},classNames:function(b){return new Element.ClassNames(b)},hasClassName:function(b,d){if(!(b=$(b))){return}var e=b.className;return(e.length>0&&(e==d||new RegExp(\"(^|\\\\s)\"+d+\"(\\\\s|$)\").test(e)))},addClassName:function(b,d){if(!(b=$(b))){return}if(!Element.hasClassName(b,d)){b.className+=(b.className?\" \":\"\")+d}return b},removeClassName:function(b,d){if(!(b=$(b))){return}b.className=b.className.replace(new RegExp(\"(^|\\\\s+)\"+d+\"(\\\\s+|$)\"),\" \").strip();return b},toggleClassName:function(b,d){if(!(b=$(b))){return}return Element[Element.hasClassName(b,d)?\"removeClassName\":\"addClassName\"](b,d)},cleanWhitespace:function(d){d=$(d);var e=d.firstChild;while(e){var b=e.nextSibling;if(e.nodeType==3&&!/\\S/.test(e.nodeValue)){d.removeChild(e)}e=b}return d},empty:function(b){return $(b).innerHTML.blank()},descendantOf:function(d,b){d=$(d),b=$(b);if(d.compareDocumentPosition){return(d.compareDocumentPosition(b)&8)===8}if(b.contains){return b.contains(d)&&b!==d}while(d=d.parentNode){if(d==b){return true}}return false},scrollTo:function(b){b=$(b);var d=Element.cumulativeOffset(b);window.scrollTo(d[0],d[1]);return b},getStyle:function(d,e){d=$(d);e=e==\"float\"?\"cssFloat\":e.camelize();var f=d.style[e];if(!f||f==\"auto\"){var b=document.defaultView.getComputedStyle(d,null);f=b?b[e]:null}if(e==\"opacity\"){return f?parseFloat(f):1}return f==\"auto\"?null:f},getOpacity:function(b){return $(b).getStyle(\"opacity\")},setStyle:function(d,e){d=$(d);var g=d.style,b;if(Object.isString(e)){d.style.cssText+=\";\"+e;return e.include(\"opacity\")?d.setOpacity(e.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1]):d}for(var f in e){if(f==\"opacity\"){d.setOpacity(e[f])}else{g[(f==\"float\"||f==\"cssFloat\")?(Object.isUndefined(g.styleFloat)?\"cssFloat\":\"styleFloat\"):f]=e[f]}}return d},setOpacity:function(b,d){b=$(b);b.style.opacity=(d==1||d===\"\")?\"\":(d<0.00001)?0:d;return b},makePositioned:function(b){b=$(b);var d=Element.getStyle(b,\"position\");if(d==\"static\"||!d){b._madePositioned=true;b.style.position=\"relative\";if(Prototype.Browser.Opera){b.style.top=0;b.style.left=0}}return b},undoPositioned:function(b){b=$(b);if(b._madePositioned){b._madePositioned=undefined;b.style.position=b.style.top=b.style.left=b.style.bottom=b.style.right=\"\"}return b},makeClipping:function(b){b=$(b);if(b._overflow){return b}b._overflow=Element.getStyle(b,\"overflow\")||\"auto\";if(b._overflow!==\"hidden\"){b.style.overflow=\"hidden\"}return b},undoClipping:function(b){b=$(b);if(!b._overflow){return b}b.style.overflow=b._overflow==\"auto\"?\"\":b._overflow;b._overflow=null;return b},clonePosition:function(d,f){var b=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});f=$(f);var g=Element.viewportOffset(f),h=[0,0],e=null;d=$(d);if(Element.getStyle(d,\"position\")==\"absolute\"){e=Element.getOffsetParent(d);h=Element.viewportOffset(e)}if(e==document.body){h[0]-=document.body.offsetLeft;h[1]-=document.body.offsetTop}if(b.setLeft){d.style.left=(g[0]-h[0]+b.offsetLeft)+\"px\"}if(b.setTop){d.style.top=(g[1]-h[1]+b.offsetTop)+\"px\"}if(b.setWidth){d.style.width=f.offsetWidth+\"px\"}if(b.setHeight){d.style.height=f.offsetHeight+\"px\"}return d}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:\"class\",htmlFor:\"for\"},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(f,d,e){switch(e){case\"height\":case\"width\":if(!Element.visible(d)){return null}var g=parseInt(f(d,e),10);if(g!==d[\"offset\"+e.capitalize()]){return g+\"px\"}var b;if(e===\"height\"){b=[\"border-top-width\",\"padding-top\",\"padding-bottom\",\"border-bottom-width\"]}else{b=[\"border-left-width\",\"padding-left\",\"padding-right\",\"border-right-width\"]}return b.inject(g,function(h,l){var n=f(d,l);return n===null?h:h-parseInt(n,10)})+\"px\";default:return f(d,e)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(e,b,d){if(d===\"title\"){return b.title}return e(b,d)})}else{if(Prototype.Browser.IE){Element.Methods.getStyle=function(b,d){b=$(b);d=(d==\"float\"||d==\"cssFloat\")?\"styleFloat\":d.camelize();var e=b.style[d];if(!e&&b.currentStyle){e=b.currentStyle[d]}if(d==\"opacity\"){if(e=(b.getStyle(\"filter\")||\"\").match(/alpha\\(opacity=(.*)\\)/)){if(e[1]){return parseFloat(e[1])/100}}return 1}if(e==\"auto\"){if((d==\"width\"||d==\"height\")&&(b.getStyle(\"display\")!=\"none\")){return b[\"offset\"+d.capitalize()]+\"px\"}return null}return e};Element.Methods.setOpacity=function(d,g){function h(l){return l.replace(/alpha\\([^\\)]*\\)/gi,\"\")}d=$(d);var b=d.currentStyle;if((b&&!b.hasLayout)||(!b&&d.style.zoom==\"normal\")){d.style.zoom=1}var f=d.getStyle(\"filter\"),e=d.style;if(g==1||g===\"\"){(f=h(f))?e.filter=f:e.removeAttribute(\"filter\");return d}else{if(g<0.00001){g=0}}e.filter=h(f)+\"alpha(opacity=\"+(g*100)+\")\";return d};Element._attributeTranslations=(function(){var d=\"className\",b=\"for\",e=document.createElement(\"div\");e.setAttribute(d,\"x\");if(e.className!==\"x\"){e.setAttribute(\"class\",\"x\");if(e.className===\"x\"){d=\"class\"}}e=null;e=document.createElement(\"label\");e.setAttribute(b,\"x\");if(e.htmlFor!==\"x\"){e.setAttribute(\"htmlFor\",\"x\");if(e.htmlFor===\"x\"){b=\"htmlFor\"}}e=null;return{read:{names:{\"class\":d,className:d,\"for\":b,htmlFor:b},values:{_getAttr:function(f,g){return f.getAttribute(g)},_getAttr2:function(f,g){return f.getAttribute(g,2)},_getAttrNode:function(f,h){var g=f.getAttributeNode(h);return g?g.value:\"\"},_getEv:(function(){var g=document.createElement(\"div\"),l;g.onclick=Prototype.emptyFunction;var h=g.getAttribute(\"onclick\");if(String(h).indexOf(\"{\")>-1){l=function(f,n){n=f.getAttribute(n);if(!n){return null}n=n.toString();n=n.split(\"{\")[1];n=n.split(\"}\")[0];return n.strip()}}else{if(h===\"\"){l=function(f,n){n=f.getAttribute(n);if(!n){return null}return n.strip()}}}g=null;return l})(),_flag:function(f,g){return $(f).hasAttribute(g)?g:null},style:function(f){return f.style.cssText.toLowerCase()},title:function(f){return f.title}}}}})();Element._attributeTranslations.write={names:Object.extend({cellpadding:\"cellPadding\",cellspacing:\"cellSpacing\"},Element._attributeTranslations.read.names),values:{checked:function(b,d){b.checked=!!d},style:function(b,d){b.style.cssText=d?d:\"\"}}};Element._attributeTranslations.has={};$w(\"colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder\").each(function(b){Element._attributeTranslations.write.names[b.toLowerCase()]=b;Element._attributeTranslations.has[b.toLowerCase()]=b});(function(b){Object.extend(b,{href:b._getAttr2,src:b._getAttr2,type:b._getAttr,action:b._getAttrNode,disabled:b._flag,checked:b._flag,readonly:b._flag,multiple:b._flag,onload:b._getEv,onunload:b._getEv,onclick:b._getEv,ondblclick:b._getEv,onmousedown:b._getEv,onmouseup:b._getEv,onmouseover:b._getEv,onmousemove:b._getEv,onmouseout:b._getEv,onfocus:b._getEv,onblur:b._getEv,onkeypress:b._getEv,onkeydown:b._getEv,onkeyup:b._getEv,onsubmit:b._getEv,onreset:b._getEv,onselect:b._getEv,onchange:b._getEv})})(Element._attributeTranslations.read.values);if(Prototype.BrowserFeatures.ElementExtensions){(function(){function b(g){var d=g.getElementsByTagName(\"*\"),f=[];for(var e=0,h;h=d[e];e++){if(h.tagName!==\"!\"){f.push(h)}}return f}Element.Methods.down=function(e,f,d){e=$(e);if(arguments.length==1){return e.firstDescendant()}return Object.isNumber(f)?b(e)[f]:Element.select(e,f)[d||0]}})()}}else{if(Prototype.Browser.Gecko&&/rv:1\\.8\\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(b,d){b=$(b);b.style.opacity=(d==1)?0.999999:(d===\"\")?\"\":(d<0.00001)?0:d;return b}}else{if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(b,d){b=$(b);b.style.opacity=(d==1||d===\"\")?\"\":(d<0.00001)?0:d;if(d==1){if(b.tagName.toUpperCase()==\"IMG\"&&b.width){b.width++;b.width--}else{try{var g=document.createTextNode(\" \");b.appendChild(g);b.removeChild(g)}catch(f){}}}return b}}}}}if(\"outerHTML\" in document.documentElement){Element.Methods.replace=function(e,g){e=$(e);if(g&&g.toElement){g=g.toElement()}if(Object.isElement(g)){e.parentNode.replaceChild(g,e);return e}g=Object.toHTML(g);var f=e.parentNode,d=f.tagName.toUpperCase();if(Element._insertionTranslations.tags[d]){var h=e.next(),b=Element._getContentFromAnonymousElement(d,g.stripScripts());f.removeChild(e);if(h){b.each(function(l){f.insertBefore(l,h)})}else{b.each(function(l){f.appendChild(l)})}}else{e.outerHTML=g.stripScripts()}g.evalScripts.bind(g).defer();return e}}Element._returnOffset=function(d,e){var b=[d,e];b.left=d;b.top=e;return b};Element._getContentFromAnonymousElement=function(g,f,h){var l=new Element(\"div\"),e=Element._insertionTranslations.tags[g];var b=false;if(e){b=true}else{if(h){b=true;e=[\"\",\"\",0]}}if(b){l.innerHTML=\"&nbsp;\"+e[0]+f+e[1];l.removeChild(l.firstChild);for(var d=e[2];d--;){l=l.firstChild}}else{l.innerHTML=f}return $A(l.childNodes)};Element._insertionTranslations={before:function(b,d){b.parentNode.insertBefore(d,b)},top:function(b,d){b.insertBefore(d,b.firstChild)},bottom:function(b,d){b.appendChild(d)},after:function(b,d){b.parentNode.insertBefore(d,b.nextSibling)},tags:{TABLE:[\"<table>\",\"</table>\",1],TBODY:[\"<table><tbody>\",\"</tbody></table>\",2],TR:[\"<table><tbody><tr>\",\"</tr></tbody></table>\",3],TD:[\"<table><tbody><tr><td>\",\"</td></tr></tbody></table>\",4],SELECT:[\"<select>\",\"</select>\",1]}};(function(){var b=Element._insertionTranslations.tags;Object.extend(b,{THEAD:b.TBODY,TFOOT:b.TBODY,TH:b.TD})})();Element.Methods.Simulated={hasAttribute:function(b,e){e=Element._attributeTranslations.has[e]||e;var d=$(b).getAttributeNode(e);return !!(d&&d.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);(function(b){if(!Prototype.BrowserFeatures.ElementExtensions&&b.__proto__){window.HTMLElement={};window.HTMLElement.prototype=b.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}b=null})(document.createElement(\"div\"));Element.extend=(function(){function e(l){if(typeof window.Element!=\"undefined\"){var o=window.Element.prototype;if(o){var q=\"_\"+(Math.random()+\"\").slice(2),n=document.createElement(l);o[q]=\"x\";var p=(n[q]!==\"x\");delete o[q];n=null;return p}}return false}function d(n,l){for(var p in l){var o=l[p];if(Object.isFunction(o)&&!(p in n)){n[p]=o.methodize()}}}var f=e(\"object\");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(f){return function(n){if(n&&typeof n._extendedByPrototype==\"undefined\"){var l=n.tagName;if(l&&(/^(?:object|applet|embed)$/i.test(l))){d(n,Element.Methods);d(n,Element.Methods.Simulated);d(n,Element.Methods.ByTag[l.toUpperCase()])}}return n}}return Prototype.K}var b={},g=Element.Methods.ByTag;var h=Object.extend(function(o){if(!o||typeof o._extendedByPrototype!=\"undefined\"||o.nodeType!=1||o==window){return o}var l=Object.clone(b),n=o.tagName.toUpperCase();if(g[n]){Object.extend(l,g[n])}d(o,l);o._extendedByPrototype=Prototype.emptyFunction;return o},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(b,Element.Methods);Object.extend(b,Element.Methods.Simulated)}}});h.refresh();return h})();if(document.documentElement.hasAttribute){Element.hasAttribute=function(b,d){return b.hasAttribute(d)}}else{Element.hasAttribute=Element.Methods.Simulated.hasAttribute}Element.addMethods=function(e){var o=Prototype.BrowserFeatures,f=Element.Methods.ByTag;if(!e){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var d=e;e=arguments[1]}if(!d){Object.extend(Element.Methods,e||{})}else{if(Object.isArray(d)){d.each(l)}else{l(d)}}function l(q){q=q.toUpperCase();if(!Element.Methods.ByTag[q]){Element.Methods.ByTag[q]={}}Object.extend(Element.Methods.ByTag[q],e)}function b(s,r,q){q=q||false;for(var u in s){var t=s[u];if(!Object.isFunction(t)){continue}if(!q||!(u in r)){r[u]=t.methodize()}}}function g(t){var q;var s={OPTGROUP:\"OptGroup\",TEXTAREA:\"TextArea\",P:\"Paragraph\",FIELDSET:\"FieldSet\",UL:\"UList\",OL:\"OList\",DL:\"DList\",DIR:\"Directory\",H1:\"Heading\",H2:\"Heading\",H3:\"Heading\",H4:\"Heading\",H5:\"Heading\",H6:\"Heading\",Q:\"Quote\",INS:\"Mod\",DEL:\"Mod\",A:\"Anchor\",IMG:\"Image\",CAPTION:\"TableCaption\",COL:\"TableCol\",COLGROUP:\"TableCol\",THEAD:\"TableSection\",TFOOT:\"TableSection\",TBODY:\"TableSection\",TR:\"TableRow\",TH:\"TableCell\",TD:\"TableCell\",FRAMESET:\"FrameSet\",IFRAME:\"IFrame\"};if(s[t]){q=\"HTML\"+s[t]+\"Element\"}if(window[q]){return window[q]}q=\"HTML\"+t+\"Element\";if(window[q]){return window[q]}q=\"HTML\"+t.capitalize()+\"Element\";if(window[q]){return window[q]}var r=document.createElement(t),u=r.__proto__||r.constructor.prototype;r=null;return u}var n=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(o.ElementExtensions){b(Element.Methods,n);b(Element.Methods.Simulated,n,true)}if(o.SpecificElementExtensions){for(var p in Element.Methods.ByTag){var h=g(p);if(Object.isUndefined(h)){continue}b(f[p],h.prototype)}}Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh){Element.extend.refresh()}Element.cache={}};document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};(function(d){var l=Prototype.Browser,g=document,e,f={};function b(){if(l.WebKit&&!g.evaluate){return document}if(l.Opera&&window.parseFloat(window.opera.version())<9.5){return document.body}return document.documentElement}function h(n){if(!e){e=b()}f[n]=\"client\"+n;d[\"get\"+n]=function(){return e[f[n]]};return d[\"get\"+n]()}d.getWidth=h.curry(\"Width\");d.getHeight=h.curry(\"Height\")})(document.viewport);Element.Storage={UID:1};Element.addMethods({getStorage:function(d){if(!(d=$(d))){return}var b;if(d===window){b=0}else{if(typeof d._prototypeUID===\"undefined\"){d._prototypeUID=Element.Storage.UID++}b=d._prototypeUID}if(!Element.Storage[b]){Element.Storage[b]=$H()}return Element.Storage[b]},store:function(d,b,e){if(!(d=$(d))){return}if(arguments.length===2){Element.getStorage(d).update(b)}else{Element.getStorage(d).set(b,e)}return d},retrieve:function(e,d,b){if(!(e=$(e))){return}var g=Element.getStorage(e),f=g.get(d);if(Object.isUndefined(f)){g.set(d,b);f=b}return f},clone:function(e,b){if(!(e=$(e))){return}var g=e.cloneNode(b);g._prototypeUID=void 0;if(b){var f=Element.select(g,\"*\"),d=f.length;while(d--){f[d]._prototypeUID=void 0}}return Element.extend(g)},purge:function(e){if(!(e=$(e))){return}var b=Element._purgeElement;b(e);var f=e.getElementsByTagName(\"*\"),d=f.length;while(d--){b(f[d])}return null}});(function(){function n(C){var B=C.match(/^(\\d+)%?$/i);if(!B){return null}return(Number(B[1])/100)}function u(M,N,C){var F=null;if(Object.isElement(M)){F=M;M=F.getStyle(N)}if(M===null){return null}if((/^(?:-)?\\d+(\\.\\d+)?(px)?$/i).test(M)){return window.parseFloat(M)}var H=M.include(\"%\"),D=(C===document.viewport);if(/\\d/.test(M)&&F&&F.runtimeStyle&&!(H&&D)){var B=F.style.left,L=F.runtimeStyle.left;F.runtimeStyle.left=F.currentStyle.left;F.style.left=M||0;M=F.style.pixelLeft;F.style.left=B;F.runtimeStyle.left=L;return M}if(F&&H){C=C||F.parentNode;var E=n(M);var I=null;var G=F.getStyle(\"position\");var K=N.include(\"left\")||N.include(\"right\")||N.include(\"width\");var J=N.include(\"top\")||N.include(\"bottom\")||N.include(\"height\");if(C===document.viewport){if(K){I=document.viewport.getWidth()}else{if(J){I=document.viewport.getHeight()}}}else{if(K){I=$(C).measure(\"width\")}else{if(J){I=$(C).measure(\"height\")}}}return(I===null)?0:I*E}return 0}function l(B){if(Object.isString(B)&&B.endsWith(\"px\")){return B}return B+\"px\"}function p(C){var B=C;while(C&&C.parentNode){var D=C.getStyle(\"display\");if(D===\"none\"){return false}C=$(C.parentNode)}return true}var f=Prototype.K;if(\"currentStyle\" in document.documentElement){f=function(B){if(!B.currentStyle.hasLayout){B.style.zoom=1}return B}}function h(B){if(B.include(\"border\")){B=B+\"-width\"}return B.camelize()}Element.Layout=Class.create(Hash,{initialize:function($super,C,B){$super();this.element=$(C);Element.Layout.PROPERTIES.each(function(D){this._set(D,null)},this);if(B){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(C,B){return Hash.prototype.set.call(this,C,B)},set:function(C,B){throw\"Properties of Element.Layout are read-only.\"},get:function($super,C){var B=$super(C);return B===null?this._compute(C):B},_begin:function(){if(this._prepared){return}var F=this.element;if(p(F)){this._prepared=true;return}var H={position:F.style.position||\"\",width:F.style.width||\"\",visibility:F.style.visibility||\"\",display:F.style.display||\"\"};F.store(\"prototype_original_styles\",H);var I=F.getStyle(\"position\"),B=F.getStyle(\"width\");if(B===\"0px\"||B===null){F.style.display=\"block\";B=F.getStyle(\"width\")}var C=(I===\"fixed\")?document.viewport:F.parentNode;F.setStyle({position:\"absolute\",visibility:\"hidden\",display:\"block\"});var D=F.getStyle(\"width\");var E;if(B&&(D===B)){E=u(F,\"width\",C)}else{if(I===\"absolute\"||I===\"fixed\"){E=u(F,\"width\",C)}else{var J=F.parentNode,G=$(J).getLayout();E=G.get(\"width\")-this.get(\"margin-left\")-this.get(\"border-left\")-this.get(\"padding-left\")-this.get(\"padding-right\")-this.get(\"border-right\")-this.get(\"margin-right\")}}F.setStyle({width:E+\"px\"});this._prepared=true},_end:function(){var C=this.element;var B=C.retrieve(\"prototype_original_styles\");C.store(\"prototype_original_styles\",null);C.setStyle(B);this._prepared=false},_compute:function(C){var B=Element.Layout.COMPUTATIONS;if(!(C in B)){throw\"Property not found.\"}return this._set(C,B[C].call(this,this.element))},toObject:function(){var B=$A(arguments);var C=(B.length===0)?Element.Layout.PROPERTIES:B.join(\" \").split(\" \");var D={};C.each(function(E){if(!Element.Layout.PROPERTIES.include(E)){return}var F=this.get(E);if(F!=null){D[E]=F}},this);return D},toHash:function(){var B=this.toObject.apply(this,arguments);return new Hash(B)},toCSS:function(){var B=$A(arguments);var D=(B.length===0)?Element.Layout.PROPERTIES:B.join(\" \").split(\" \");var C={};D.each(function(E){if(!Element.Layout.PROPERTIES.include(E)){return}if(Element.Layout.COMPOSITE_PROPERTIES.include(E)){return}var F=this.get(E);if(F!=null){C[h(E)]=F+\"px\"}},this);return C},inspect:function(){return\"#<Element.Layout>\"}});Object.extend(Element.Layout,{PROPERTIES:$w(\"height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height\"),COMPOSITE_PROPERTIES:$w(\"padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height\"),COMPUTATIONS:{height:function(D){if(!this._preComputing){this._begin()}var B=this.get(\"border-box-height\");if(B<=0){if(!this._preComputing){this._end()}return 0}var E=this.get(\"border-top\"),C=this.get(\"border-bottom\");var G=this.get(\"padding-top\"),F=this.get(\"padding-bottom\");if(!this._preComputing){this._end()}return B-E-C-G-F},width:function(D){if(!this._preComputing){this._begin()}var C=this.get(\"border-box-width\");if(C<=0){if(!this._preComputing){this._end()}return 0}var G=this.get(\"border-left\"),B=this.get(\"border-right\");var E=this.get(\"padding-left\"),F=this.get(\"padding-right\");if(!this._preComputing){this._end()}return C-G-B-E-F},\"padding-box-height\":function(C){var B=this.get(\"height\"),E=this.get(\"padding-top\"),D=this.get(\"padding-bottom\");return B+E+D},\"padding-box-width\":function(B){var C=this.get(\"width\"),D=this.get(\"padding-left\"),E=this.get(\"padding-right\");return C+D+E},\"border-box-height\":function(C){if(!this._preComputing){this._begin()}var B=C.offsetHeight;if(!this._preComputing){this._end()}return B},\"border-box-width\":function(B){if(!this._preComputing){this._begin()}var C=B.offsetWidth;if(!this._preComputing){this._end()}return C},\"margin-box-height\":function(C){var B=this.get(\"border-box-height\"),D=this.get(\"margin-top\"),E=this.get(\"margin-bottom\");if(B<=0){return 0}return B+D+E},\"margin-box-width\":function(D){var C=this.get(\"border-box-width\"),E=this.get(\"margin-left\"),B=this.get(\"margin-right\");if(C<=0){return 0}return C+E+B},top:function(B){var C=B.positionedOffset();return C.top},bottom:function(B){var E=B.positionedOffset(),C=B.getOffsetParent(),D=C.measure(\"height\");var F=this.get(\"border-box-height\");return D-F-E.top},left:function(B){var C=B.positionedOffset();return C.left},right:function(D){var F=D.positionedOffset(),E=D.getOffsetParent(),B=E.measure(\"width\");var C=this.get(\"border-box-width\");return B-C-F.left},\"padding-top\":function(B){return u(B,\"paddingTop\")},\"padding-bottom\":function(B){return u(B,\"paddingBottom\")},\"padding-left\":function(B){return u(B,\"paddingLeft\")},\"padding-right\":function(B){return u(B,\"paddingRight\")},\"border-top\":function(B){return u(B,\"borderTopWidth\")},\"border-bottom\":function(B){return u(B,\"borderBottomWidth\")},\"border-left\":function(B){return u(B,\"borderLeftWidth\")},\"border-right\":function(B){return u(B,\"borderRightWidth\")},\"margin-top\":function(B){return u(B,\"marginTop\")},\"margin-bottom\":function(B){return u(B,\"marginBottom\")},\"margin-left\":function(B){return u(B,\"marginLeft\")},\"margin-right\":function(B){return u(B,\"marginRight\")}}});if(\"getBoundingClientRect\" in document.documentElement){Object.extend(Element.Layout.COMPUTATIONS,{right:function(C){var D=f(C.getOffsetParent());var E=C.getBoundingClientRect(),B=D.getBoundingClientRect();return(B.right-E.right).round()},bottom:function(C){var D=f(C.getOffsetParent());var E=C.getBoundingClientRect(),B=D.getBoundingClientRect();return(B.bottom-E.bottom).round()}})}Element.Offset=Class.create({initialize:function(C,B){this.left=C.round();this.top=B.round();this[0]=this.left;this[1]=this.top},relativeTo:function(B){return new Element.Offset(this.left-B.left,this.top-B.top)},inspect:function(){return\"#<Element.Offset left: #{left} top: #{top}>\".interpolate(this)},toString:function(){return\"[#{left}, #{top}]\".interpolate(this)},toArray:function(){return[this.left,this.top]}});function y(C,B){return new Element.Layout(C,B)}function d(B,C){return $(B).getLayout().get(C)}function t(C){C=$(C);var G=Element.getStyle(C,\"display\");if(G&&G!==\"none\"){return{width:C.offsetWidth,height:C.offsetHeight}}var D=C.style;var B={visibility:D.visibility,position:D.position,display:D.display};var F={visibility:\"hidden\",display:\"block\"};if(B.position!==\"fixed\"){F.position=\"absolute\"}Element.setStyle(C,F);var E={width:C.offsetWidth,height:C.offsetHeight};Element.setStyle(C,B);return E}function r(B){B=$(B);if(g(B)||e(B)||s(B)||q(B)){return $(document.body)}var C=(Element.getStyle(B,\"display\")===\"inline\");if(!C&&B.offsetParent){return $(B.offsetParent)}while((B=B.parentNode)&&B!==document.body){if(Element.getStyle(B,\"position\")!==\"static\"){return q(B)?$(document.body):$(B)}}return $(document.body)}function A(C){C=$(C);var B=0,D=0;if(C.parentNode){do{B+=C.offsetTop||0;D+=C.offsetLeft||0;C=C.offsetParent}while(C)}return new Element.Offset(D,B)}function v(C){C=$(C);var D=C.getLayout();var B=0,F=0;do{B+=C.offsetTop||0;F+=C.offsetLeft||0;C=C.offsetParent;if(C){if(s(C)){break}var E=Element.getStyle(C,\"position\");if(E!==\"static\"){break}}}while(C);F-=D.get(\"margin-top\");B-=D.get(\"margin-left\");return new Element.Offset(F,B)}function b(C){var B=0,D=0;do{B+=C.scrollTop||0;D+=C.scrollLeft||0;C=C.parentNode}while(C);return new Element.Offset(D,B)}function z(F){C=$(C);var B=0,E=0,D=document.body;var C=F;do{B+=C.offsetTop||0;E+=C.offsetLeft||0;if(C.offsetParent==D&&Element.getStyle(C,\"position\")==\"absolute\"){break}}while(C=C.offsetParent);C=F;do{if(C!=D){B-=C.scrollTop||0;E-=C.scrollLeft||0}}while(C=C.parentNode);return new Element.Offset(E,B)}function w(B){B=$(B);if(Element.getStyle(B,\"position\")===\"absolute\"){return B}var F=r(B);var E=B.viewportOffset(),C=F.viewportOffset();var G=E.relativeTo(C);var D=B.getLayout();B.store(\"prototype_absolutize_original_styles\",{left:B.getStyle(\"left\"),top:B.getStyle(\"top\"),width:B.getStyle(\"width\"),height:B.getStyle(\"height\")});B.setStyle({position:\"absolute\",top:G.top+\"px\",left:G.left+\"px\",width:D.get(\"width\")+\"px\",height:D.get(\"height\")+\"px\"});return B}function o(C){C=$(C);if(Element.getStyle(C,\"position\")===\"relative\"){return C}var B=C.retrieve(\"prototype_absolutize_original_styles\");if(B){C.setStyle(B)}return C}if(Prototype.Browser.IE){r=r.wrap(function(D,C){C=$(C);if(g(C)||e(C)||s(C)||q(C)){return $(document.body)}var B=C.getStyle(\"position\");if(B!==\"static\"){return D(C)}C.setStyle({position:\"relative\"});var E=D(C);C.setStyle({position:B});return E});v=v.wrap(function(E,C){C=$(C);if(!C.parentNode){return new Element.Offset(0,0)}var B=C.getStyle(\"position\");if(B!==\"static\"){return E(C)}var D=C.getOffsetParent();if(D&&D.getStyle(\"position\")===\"fixed\"){f(D)}C.setStyle({position:\"relative\"});var F=E(C);C.setStyle({position:B});return F})}else{if(Prototype.Browser.Webkit){A=function(C){C=$(C);var B=0,D=0;do{B+=C.offsetTop||0;D+=C.offsetLeft||0;if(C.offsetParent==document.body){if(Element.getStyle(C,\"position\")==\"absolute\"){break}}C=C.offsetParent}while(C);return new Element.Offset(D,B)}}}Element.addMethods({getLayout:y,measure:d,getDimensions:t,getOffsetParent:r,cumulativeOffset:A,positionedOffset:v,cumulativeScrollOffset:b,viewportOffset:z,absolutize:w,relativize:o});function s(B){return B.nodeName.toUpperCase()===\"BODY\"}function q(B){return B.nodeName.toUpperCase()===\"HTML\"}function g(B){return B.nodeType===Node.DOCUMENT_NODE}function e(B){return B!==document.body&&!Element.descendantOf(B,document.body)}if(\"getBoundingClientRect\" in document.documentElement){Element.addMethods({viewportOffset:function(B){B=$(B);if(e(B)){return new Element.Offset(0,0)}var C=B.getBoundingClientRect(),D=document.documentElement;return new Element.Offset(C.left-D.clientLeft,C.top-D.clientTop)}})}})();window.$$=function(){var b=$A(arguments).join(\", \");return Prototype.Selector.select(b,document)};Prototype.Selector=(function(){function b(){throw new Error('Method \"Prototype.Selector.select\" must be defined.')}function e(){throw new Error('Method \"Prototype.Selector.match\" must be defined.')}function f(q,r,n){n=n||0;var l=Prototype.Selector.match,p=q.length,h=0,o;for(o=0;o<p;o++){if(l(q[o],r)&&n==h++){return Element.extend(q[o])}}}function g(n){for(var h=0,l=n.length;h<l;h++){Element.extend(n[h])}return n}var d=Prototype.K;return{select:b,match:e,find:f,extendElements:(Element.extend===d)?d:g,extendElement:Element.extend}})();Prototype._original_property=window.Sizzle;\r\n/*!\r\n * Sizzle CSS Selector Engine - v1.0\r\n *  Copyright 2009, The Dojo Foundation\r\n *  Released under the MIT, BSD, and GPL Licenses.\r\n *  More information: http://sizzlejs.com/\r\n */\r\n(function(){var w=/((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^[\\]]*\\]|['\"][^'\"]*['\"]|[^[\\]'\"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?((?:.|\\r|\\n)*)/g,p=0,g=Object.prototype.toString,u=false,o=true;[0,0].sort(function(){o=false;return 0});var d=function(L,B,I,D){I=I||[];var e=B=B||document;if(B.nodeType!==1&&B.nodeType!==9){return[]}if(!L||typeof L!==\"string\"){return I}var J=[],K,G,P,O,H,A,z=true,E=v(B),N=L;while((w.exec(\"\"),K=w.exec(N))!==null){N=K[3];J.push(K[1]);if(K[2]){A=K[3];break}}if(J.length>1&&q.exec(L)){if(J.length===2&&h.relative[J[0]]){G=l(J[0]+J[1],B)}else{G=h.relative[J[0]]?[B]:d(J.shift(),B);while(J.length){L=J.shift();if(h.relative[L]){L+=J.shift()}G=l(L,G)}}}else{if(!D&&J.length>1&&B.nodeType===9&&!E&&h.match.ID.test(J[0])&&!h.match.ID.test(J[J.length-1])){var Q=d.find(J.shift(),B,E);B=Q.expr?d.filter(Q.expr,Q.set)[0]:Q.set[0]}if(B){var Q=D?{expr:J.pop(),set:b(D)}:d.find(J.pop(),J.length===1&&(J[0]===\"~\"||J[0]===\"+\")&&B.parentNode?B.parentNode:B,E);G=Q.expr?d.filter(Q.expr,Q.set):Q.set;if(J.length>0){P=b(G)}else{z=false}while(J.length){var C=J.pop(),F=C;if(!h.relative[C]){C=\"\"}else{F=J.pop()}if(F==null){F=B}h.relative[C](P,F,E)}}else{P=J=[]}}if(!P){P=G}if(!P){throw\"Syntax error, unrecognized expression: \"+(C||L)}if(g.call(P)===\"[object Array]\"){if(!z){I.push.apply(I,P)}else{if(B&&B.nodeType===1){for(var M=0;P[M]!=null;M++){if(P[M]&&(P[M]===true||P[M].nodeType===1&&n(B,P[M]))){I.push(G[M])}}}else{for(var M=0;P[M]!=null;M++){if(P[M]&&P[M].nodeType===1){I.push(G[M])}}}}}else{b(P,I)}if(A){d(A,e,I,D);d.uniqueSort(I)}return I};d.uniqueSort=function(z){if(f){u=o;z.sort(f);if(u){for(var e=1;e<z.length;e++){if(z[e]===z[e-1]){z.splice(e--,1)}}}}return z};d.matches=function(e,z){return d(e,null,null,z)};d.find=function(F,e,G){var E,C;if(!F){return[]}for(var B=0,A=h.order.length;B<A;B++){var D=h.order[B],C;if((C=h.leftMatch[D].exec(F))){var z=C[1];C.splice(1,1);if(z.substr(z.length-1)!==\"\\\\\"){C[1]=(C[1]||\"\").replace(/\\\\/g,\"\");E=h.find[D](C,e,G);if(E!=null){F=F.replace(h.match[D],\"\");break}}}}if(!E){E=e.getElementsByTagName(\"*\")}return{set:E,expr:F}};d.filter=function(I,H,L,B){var A=I,N=[],F=H,D,e,E=H&&H[0]&&v(H[0]);while(I&&H.length){for(var G in h.filter){if((D=h.match[G].exec(I))!=null){var z=h.filter[G],M,K;e=false;if(F==N){N=[]}if(h.preFilter[G]){D=h.preFilter[G](D,F,L,N,B,E);if(!D){e=M=true}else{if(D===true){continue}}}if(D){for(var C=0;(K=F[C])!=null;C++){if(K){M=z(K,D,C,F);var J=B^!!M;if(L&&M!=null){if(J){e=true}else{F[C]=false}}else{if(J){N.push(K);e=true}}}}}if(M!==undefined){if(!L){F=N}I=I.replace(h.match[G],\"\");if(!e){return[]}break}}}if(I==A){if(e==null){throw\"Syntax error, unrecognized expression: \"+I}else{break}}A=I}return F};var h=d.selectors={order:[\"ID\",\"NAME\",\"TAG\"],match:{ID:/#((?:[\\w\\u00c0-\\uFFFF-]|\\\\.)+)/,CLASS:/\\.((?:[\\w\\u00c0-\\uFFFF-]|\\\\.)+)/,NAME:/\\[name=['\"]*((?:[\\w\\u00c0-\\uFFFF-]|\\\\.)+)['\"]*\\]/,ATTR:/\\[\\s*((?:[\\w\\u00c0-\\uFFFF-]|\\\\.)+)\\s*(?:(\\S?=)\\s*(['\"]*)(.*?)\\3|)\\s*\\]/,TAG:/^((?:[\\w\\u00c0-\\uFFFF\\*-]|\\\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\\((even|odd|[\\dn+-]*)\\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^-]|$)/,PSEUDO:/:((?:[\\w\\u00c0-\\uFFFF-]|\\\\.)+)(?:\\((['\"]*)((?:\\([^\\)]+\\)|[^\\2\\(\\)]*)+)\\2\\))?/},leftMatch:{},attrMap:{\"class\":\"className\",\"for\":\"htmlFor\"},attrHandle:{href:function(e){return e.getAttribute(\"href\")}},relative:{\"+\":function(F,e,E){var C=typeof e===\"string\",G=C&&!/\\W/.test(e),D=C&&!G;if(G&&!E){e=e.toUpperCase()}for(var B=0,A=F.length,z;B<A;B++){if((z=F[B])){while((z=z.previousSibling)&&z.nodeType!==1){}F[B]=D||z&&z.nodeName===e?z||false:z===e}}if(D){d.filter(e,F,true)}},\">\":function(E,z,F){var C=typeof z===\"string\";if(C&&!/\\W/.test(z)){z=F?z:z.toUpperCase();for(var A=0,e=E.length;A<e;A++){var D=E[A];if(D){var B=D.parentNode;E[A]=B.nodeName===z?B:false}}}else{for(var A=0,e=E.length;A<e;A++){var D=E[A];if(D){E[A]=C?D.parentNode:D.parentNode===z}}if(C){d.filter(z,E,true)}}},\"\":function(B,z,D){var A=p++,e=y;if(!/\\W/.test(z)){var C=z=D?z:z.toUpperCase();e=t}e(\"parentNode\",z,A,B,C,D)},\"~\":function(B,z,D){var A=p++,e=y;if(typeof z===\"string\"&&!/\\W/.test(z)){var C=z=D?z:z.toUpperCase();e=t}e(\"previousSibling\",z,A,B,C,D)}},find:{ID:function(z,A,B){if(typeof A.getElementById!==\"undefined\"&&!B){var e=A.getElementById(z[1]);return e?[e]:[]}},NAME:function(A,D,E){if(typeof D.getElementsByName!==\"undefined\"){var z=[],C=D.getElementsByName(A[1]);for(var B=0,e=C.length;B<e;B++){if(C[B].getAttribute(\"name\")===A[1]){z.push(C[B])}}return z.length===0?null:z}},TAG:function(e,z){return z.getElementsByTagName(e[1])}},preFilter:{CLASS:function(B,z,A,e,E,F){B=\" \"+B[1].replace(/\\\\/g,\"\")+\" \";if(F){return B}for(var C=0,D;(D=z[C])!=null;C++){if(D){if(E^(D.className&&(\" \"+D.className+\" \").indexOf(B)>=0)){if(!A){e.push(D)}}else{if(A){z[C]=false}}}}return false},ID:function(e){return e[1].replace(/\\\\/g,\"\")},TAG:function(z,e){for(var A=0;e[A]===false;A++){}return e[A]&&v(e[A])?z[1]:z[1].toUpperCase()},CHILD:function(e){if(e[1]==\"nth\"){var z=/(-?)(\\d*)n((?:\\+|-)?\\d*)/.exec(e[2]==\"even\"&&\"2n\"||e[2]==\"odd\"&&\"2n+1\"||!/\\D/.test(e[2])&&\"0n+\"+e[2]||e[2]);e[2]=(z[1]+(z[2]||1))-0;e[3]=z[3]-0}e[0]=p++;return e},ATTR:function(C,z,A,e,D,E){var B=C[1].replace(/\\\\/g,\"\");if(!E&&h.attrMap[B]){C[1]=h.attrMap[B]}if(C[2]===\"~=\"){C[4]=\" \"+C[4]+\" \"}return C},PSEUDO:function(C,z,A,e,D){if(C[1]===\"not\"){if((w.exec(C[3])||\"\").length>1||/^\\w/.test(C[3])){C[3]=d(C[3],null,null,z)}else{var B=d.filter(C[3],z,A,true^D);if(!A){e.push.apply(e,B)}return false}}else{if(h.match.POS.test(C[0])||h.match.CHILD.test(C[0])){return true}}return C},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!==\"hidden\"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){e.parentNode.selectedIndex;return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(A,z,e){return !!d(e[3],A).length},header:function(e){return/h\\d/i.test(e.nodeName)},text:function(e){return\"text\"===e.type},radio:function(e){return\"radio\"===e.type},checkbox:function(e){return\"checkbox\"===e.type},file:function(e){return\"file\"===e.type},password:function(e){return\"password\"===e.type},submit:function(e){return\"submit\"===e.type},image:function(e){return\"image\"===e.type},reset:function(e){return\"reset\"===e.type},button:function(e){return\"button\"===e.type||e.nodeName.toUpperCase()===\"BUTTON\"},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)}},setFilters:{first:function(z,e){return e===0},last:function(A,z,e,B){return z===B.length-1},even:function(z,e){return e%2===0},odd:function(z,e){return e%2===1},lt:function(A,z,e){return z<e[3]-0},gt:function(A,z,e){return z>e[3]-0},nth:function(A,z,e){return e[3]-0==z},eq:function(A,z,e){return e[3]-0==z}},filter:{PSEUDO:function(E,A,B,F){var z=A[1],C=h.filters[z];if(C){return C(E,B,A,F)}else{if(z===\"contains\"){return(E.textContent||E.innerText||\"\").indexOf(A[3])>=0}else{if(z===\"not\"){var D=A[3];for(var B=0,e=D.length;B<e;B++){if(D[B]===E){return false}}return true}}}},CHILD:function(e,B){var E=B[1],z=e;switch(E){case\"only\":case\"first\":while((z=z.previousSibling)){if(z.nodeType===1){return false}}if(E==\"first\"){return true}z=e;case\"last\":while((z=z.nextSibling)){if(z.nodeType===1){return false}}return true;case\"nth\":var A=B[2],H=B[3];if(A==1&&H==0){return true}var D=B[0],G=e.parentNode;if(G&&(G.sizcache!==D||!e.nodeIndex)){var C=0;for(z=G.firstChild;z;z=z.nextSibling){if(z.nodeType===1){z.nodeIndex=++C}}G.sizcache=D}var F=e.nodeIndex-H;if(A==0){return F==0}else{return(F%A==0&&F/A>=0)}}},ID:function(z,e){return z.nodeType===1&&z.getAttribute(\"id\")===e},TAG:function(z,e){return(e===\"*\"&&z.nodeType===1)||z.nodeName===e},CLASS:function(z,e){return(\" \"+(z.className||z.getAttribute(\"class\"))+\" \").indexOf(e)>-1},ATTR:function(D,B){var A=B[1],e=h.attrHandle[A]?h.attrHandle[A](D):D[A]!=null?D[A]:D.getAttribute(A),E=e+\"\",C=B[2],z=B[4];return e==null?C===\"!=\":C===\"=\"?E===z:C===\"*=\"?E.indexOf(z)>=0:C===\"~=\"?(\" \"+E+\" \").indexOf(z)>=0:!z?E&&e!==false:C===\"!=\"?E!=z:C===\"^=\"?E.indexOf(z)===0:C===\"$=\"?E.substr(E.length-z.length)===z:C===\"|=\"?E===z||E.substr(0,z.length+1)===z+\"-\":false},POS:function(C,z,A,D){var e=z[2],B=h.setFilters[e];if(B){return B(C,A,z,D)}}}};var q=h.match.POS;for(var s in h.match){h.match[s]=new RegExp(h.match[s].source+/(?![^\\[]*\\])(?![^\\(]*\\))/.source);h.leftMatch[s]=new RegExp(/(^(?:.|\\r|\\n)*?)/.source+h.match[s].source)}var b=function(z,e){z=Array.prototype.slice.call(z,0);if(e){e.push.apply(e,z);return e}return z};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(r){b=function(C,B){var z=B||[];if(g.call(C)===\"[object Array]\"){Array.prototype.push.apply(z,C)}else{if(typeof C.length===\"number\"){for(var A=0,e=C.length;A<e;A++){z.push(C[A])}}else{for(var A=0;C[A];A++){z.push(C[A])}}}return z}}var f;if(document.documentElement.compareDocumentPosition){f=function(z,e){if(!z.compareDocumentPosition||!e.compareDocumentPosition){if(z==e){u=true}return 0}var A=z.compareDocumentPosition(e)&4?-1:z===e?0:1;if(A===0){u=true}return A}}else{if(\"sourceIndex\" in document.documentElement){f=function(z,e){if(!z.sourceIndex||!e.sourceIndex){if(z==e){u=true}return 0}var A=z.sourceIndex-e.sourceIndex;if(A===0){u=true}return A}}else{if(document.createRange){f=function(B,z){if(!B.ownerDocument||!z.ownerDocument){if(B==z){u=true}return 0}var A=B.ownerDocument.createRange(),e=z.ownerDocument.createRange();A.setStart(B,0);A.setEnd(B,0);e.setStart(z,0);e.setEnd(z,0);var C=A.compareBoundaryPoints(Range.START_TO_END,e);if(C===0){u=true}return C}}}}(function(){var z=document.createElement(\"div\"),A=\"script\"+(new Date).getTime();z.innerHTML=\"<a name='\"+A+\"'/>\";var e=document.documentElement;e.insertBefore(z,e.firstChild);if(!!document.getElementById(A)){h.find.ID=function(C,D,E){if(typeof D.getElementById!==\"undefined\"&&!E){var B=D.getElementById(C[1]);return B?B.id===C[1]||typeof B.getAttributeNode!==\"undefined\"&&B.getAttributeNode(\"id\").nodeValue===C[1]?[B]:undefined:[]}};h.filter.ID=function(D,B){var C=typeof D.getAttributeNode!==\"undefined\"&&D.getAttributeNode(\"id\");return D.nodeType===1&&C&&C.nodeValue===B}}e.removeChild(z);e=z=null})();(function(){var e=document.createElement(\"div\");e.appendChild(document.createComment(\"\"));if(e.getElementsByTagName(\"*\").length>0){h.find.TAG=function(z,D){var C=D.getElementsByTagName(z[1]);if(z[1]===\"*\"){var B=[];for(var A=0;C[A];A++){if(C[A].nodeType===1){B.push(C[A])}}C=B}return C}}e.innerHTML=\"<a href='#'></a>\";if(e.firstChild&&typeof e.firstChild.getAttribute!==\"undefined\"&&e.firstChild.getAttribute(\"href\")!==\"#\"){h.attrHandle.href=function(z){return z.getAttribute(\"href\",2)}}e=null})();if(document.querySelectorAll){(function(){var e=d,A=document.createElement(\"div\");A.innerHTML=\"<p class='TEST'></p>\";if(A.querySelectorAll&&A.querySelectorAll(\".TEST\").length===0){return}d=function(E,D,B,C){D=D||document;if(!C&&D.nodeType===9&&!v(D)){try{return b(D.querySelectorAll(E),B)}catch(F){}}return e(E,D,B,C)};for(var z in e){d[z]=e[z]}A=null})()}if(document.getElementsByClassName&&document.documentElement.getElementsByClassName){(function(){var e=document.createElement(\"div\");e.innerHTML=\"<div class='test e'></div><div class='test'></div>\";if(e.getElementsByClassName(\"e\").length===0){return}e.lastChild.className=\"e\";if(e.getElementsByClassName(\"e\").length===1){return}h.order.splice(1,0,\"CLASS\");h.find.CLASS=function(z,A,B){if(typeof A.getElementsByClassName!==\"undefined\"&&!B){return A.getElementsByClassName(z[1])}};e=null})()}function t(z,E,D,I,F,H){var G=z==\"previousSibling\"&&!H;for(var B=0,A=I.length;B<A;B++){var e=I[B];if(e){if(G&&e.nodeType===1){e.sizcache=D;e.sizset=B}e=e[z];var C=false;while(e){if(e.sizcache===D){C=I[e.sizset];break}if(e.nodeType===1&&!H){e.sizcache=D;e.sizset=B}if(e.nodeName===E){C=e;break}e=e[z]}I[B]=C}}}function y(z,E,D,I,F,H){var G=z==\"previousSibling\"&&!H;for(var B=0,A=I.length;B<A;B++){var e=I[B];if(e){if(G&&e.nodeType===1){e.sizcache=D;e.sizset=B}e=e[z];var C=false;while(e){if(e.sizcache===D){C=I[e.sizset];break}if(e.nodeType===1){if(!H){e.sizcache=D;e.sizset=B}if(typeof E!==\"string\"){if(e===E){C=true;break}}else{if(d.filter(E,[e]).length>0){C=e;break}}}e=e[z]}I[B]=C}}}var n=document.compareDocumentPosition?function(z,e){return z.compareDocumentPosition(e)&16}:function(z,e){return z!==e&&(z.contains?z.contains(e):true)};var v=function(e){return e.nodeType===9&&e.documentElement.nodeName!==\"HTML\"||!!e.ownerDocument&&e.ownerDocument.documentElement.nodeName!==\"HTML\"};var l=function(e,F){var B=[],C=\"\",D,A=F.nodeType?[F]:F;while((D=h.match.PSEUDO.exec(e))){C+=D[0];e=e.replace(h.match.PSEUDO,\"\")}e=h.relative[e]?e+\"*\":e;for(var E=0,z=A.length;E<z;E++){d(e,A[E],B)}return d.filter(C,B)};window.Sizzle=d})();(function(e){var f=Prototype.Selector.extendElements;function b(g,h){return f(e(g,h||document))}function d(h,g){return e.matches(g,[h]).length==1}Prototype.Selector.engine=e;Prototype.Selector.select=b;Prototype.Selector.match=d})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;var Form={reset:function(b){b=$(b);b.reset();return b},serializeElements:function(n,f){if(typeof f!=\"object\"){f={hash:!!f}}else{if(Object.isUndefined(f.hash)){f.hash=true}}var g,l,b=false,h=f.submit,d,e;if(f.hash){e={};d=function(o,p,q){if(p in o){if(!Object.isArray(o[p])){o[p]=[o[p]]}o[p].push(q)}else{o[p]=q}return o}}else{e=\"\";d=function(o,p,q){return o+(o?\"&\":\"\")+encodeURIComponent(p)+\"=\"+encodeURIComponent(q)}}return n.inject(e,function(o,p){if(!p.disabled&&p.name){g=p.name;l=$(p).getValue();if(l!=null&&p.type!=\"file\"&&(p.type!=\"submit\"||(!b&&h!==false&&(!h||g==h)&&(b=true)))){o=d(o,g,l)}}return o})}};Form.Methods={serialize:function(d,b){return Form.serializeElements(Form.getElements(d),b)},getElements:function(g){var h=$(g).getElementsByTagName(\"*\"),f,b=[],e=Form.Element.Serializers;for(var d=0;f=h[d];d++){b.push(f)}return b.inject([],function(l,n){if(e[n.tagName.toLowerCase()]){l.push(Element.extend(n))}return l})},getInputs:function(l,e,f){l=$(l);var b=l.getElementsByTagName(\"input\");if(!e&&!f){return $A(b).map(Element.extend)}for(var g=0,n=[],h=b.length;g<h;g++){var d=b[g];if((e&&d.type!=e)||(f&&d.name!=f)){continue}n.push(Element.extend(d))}return n},disable:function(b){b=$(b);Form.getElements(b).invoke(\"disable\");return b},enable:function(b){b=$(b);Form.getElements(b).invoke(\"enable\");return b},findFirstElement:function(d){var e=$(d).getElements().findAll(function(f){return\"hidden\"!=f.type&&!f.disabled});var b=e.findAll(function(f){return f.hasAttribute(\"tabIndex\")&&f.tabIndex>=0}).sortBy(function(f){return f.tabIndex}).first();return b?b:e.find(function(f){return/^(?:input|select|textarea)$/i.test(f.tagName)})},focusFirstElement:function(d){d=$(d);var b=d.findFirstElement();if(b){b.activate()}return d},request:function(d,b){d=$(d),b=Object.clone(b||{});var f=b.parameters,e=d.readAttribute(\"action\")||\"\";if(e.blank()){e=window.location.href}b.parameters=d.serialize(true);if(f){if(Object.isString(f)){f=f.toQueryParams()}Object.extend(b.parameters,f)}if(d.hasAttribute(\"method\")&&!b.method){b.method=d.method}return new Ajax.Request(e,b)}};Form.Element={focus:function(b){$(b).focus();return b},select:function(b){$(b).select();return b}};Form.Element.Methods={serialize:function(b){b=$(b);if(!b.disabled&&b.name){var d=b.getValue();if(d!=undefined){var e={};e[b.name]=d;return Object.toQueryString(e)}}return\"\"},getValue:function(b){b=$(b);var d=b.tagName.toLowerCase();return Form.Element.Serializers[d](b)},setValue:function(b,d){b=$(b);var e=b.tagName.toLowerCase();Form.Element.Serializers[e](b,d);return b},clear:function(b){$(b).value=\"\";return b},present:function(b){return $(b).value!=\"\"},activate:function(b){b=$(b);try{b.focus();if(b.select&&(b.tagName.toLowerCase()!=\"input\"||!(/^(?:button|reset|submit)$/i.test(b.type)))){b.select()}}catch(d){}return b},disable:function(b){b=$(b);b.disabled=true;return b},enable:function(b){b=$(b);b.disabled=false;return b}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers=(function(){function d(n,o){switch(n.type.toLowerCase()){case\"checkbox\":case\"radio\":return h(n,o);default:return g(n,o)}}function h(n,o){if(Object.isUndefined(o)){return n.checked?n.value:null}else{n.checked=!!o}}function g(n,o){if(Object.isUndefined(o)){return n.value}else{n.value=o}}function b(p,s){if(Object.isUndefined(s)){return(p.type===\"select-one\"?e:f)(p)}var o,q,t=!Object.isArray(s);for(var n=0,r=p.length;n<r;n++){o=p.options[n];q=this.optionValue(o);if(t){if(q==s){o.selected=true;return}}else{o.selected=s.include(q)}}}function e(o){var n=o.selectedIndex;return n>=0?l(o.options[n]):null}function f(q){var n,r=q.length;if(!r){return null}for(var p=0,n=[];p<r;p++){var o=q.options[p];if(o.selected){n.push(l(o))}}return n}function l(n){return Element.hasAttribute(n,\"value\")?n.value:n.text}return{input:d,inputSelector:h,textarea:g,select:b,selectOne:e,selectMany:f,optionValue:l,button:g}})();Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,d,e){$super(e,d);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var b=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(b)?this.lastValue!=b:String(this.lastValue)!=String(b)){this.callback(this.element,b);this.lastValue=b}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=Class.create({initialize:function(b,d){this.element=$(b);this.callback=d;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()==\"form\"){this.registerFormCallbacks()}else{this.registerCallback(this.element)}},onElementEvent:function(){var b=this.getValue();if(this.lastValue!=b){this.callback(this.element,b);this.lastValue=b}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(b){if(b.type){switch(b.type.toLowerCase()){case\"checkbox\":case\"radio\":Event.observe(b,\"click\",this.onElementEvent.bind(this));break;default:Event.observe(b,\"change\",this.onElementEvent.bind(this));break}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});(function(){var J={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}};var h=document.documentElement;var K=\"onmouseenter\" in h&&\"onmouseleave\" in h;var b=function(L){return false};if(window.attachEvent){if(window.addEventListener){b=function(L){return !(L instanceof window.Event)}}else{b=function(L){return true}}}var y;function H(M,L){return M.which?(M.which===L+1):(M.button===L)}var u={0:1,1:4,2:2};function F(M,L){return M.button===u[L]}function I(M,L){switch(L){case 0:return M.which==1&&!M.metaKey;case 1:return M.which==2||(M.which==1&&M.metaKey);case 2:return M.which==3;default:return false}}if(window.attachEvent){if(!window.addEventListener){y=F}else{y=function(M,L){return b(M)?F(M,L):H(M,L)}}}else{if(Prototype.Browser.WebKit){y=I}else{y=H}}function C(L){return y(L,0)}function A(L){return y(L,1)}function t(L){return y(L,2)}function f(N){N=J.extend(N);var M=N.target,L=N.type,O=N.currentTarget;if(O&&O.tagName){if(L===\"load\"||L===\"error\"||(L===\"click\"&&O.tagName.toLowerCase()===\"input\"&&O.type===\"radio\")){M=O}}if(M.nodeType==Node.TEXT_NODE){M=M.parentNode}return Element.extend(M)}function v(M,N){var L=J.element(M);if(!N){return L}while(L){if(Object.isElement(L)&&Prototype.Selector.match(L,N)){return Element.extend(L)}L=L.parentNode}}function z(L){return{x:e(L),y:d(L)}}function e(N){var M=document.documentElement,L=document.body||{scrollLeft:0};return N.pageX||(N.clientX+(M.scrollLeft||L.scrollLeft)-(M.clientLeft||0))}function d(N){var M=document.documentElement,L=document.body||{scrollTop:0};return N.pageY||(N.clientY+(M.scrollTop||L.scrollTop)-(M.clientTop||0))}function w(L){J.extend(L);L.preventDefault();L.stopPropagation();L.stopped=true}J.Methods={isLeftClick:C,isMiddleClick:A,isRightClick:t,element:f,findElement:v,pointer:z,pointerX:e,pointerY:d,stop:w};var E=Object.keys(J.Methods).inject({},function(L,M){L[M]=J.Methods[M].methodize();return L});if(window.attachEvent){function o(M){var L;switch(M.type){case\"mouseover\":case\"mouseenter\":L=M.fromElement;break;case\"mouseout\":case\"mouseleave\":L=M.toElement;break;default:return null}return Element.extend(L)}var B={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return\"[object Event]\"}};J.extend=function(M,L){if(!M){return false}if(!b(M)){return M}if(M._extendedByPrototype){return M}M._extendedByPrototype=Prototype.emptyFunction;var N=J.pointer(M);Object.extend(M,{target:M.srcElement||L,relatedTarget:o(M),pageX:N.x,pageY:N.y});Object.extend(M,E);Object.extend(M,B);return M}}else{J.extend=Prototype.K}if(window.addEventListener){J.prototype=window.Event.prototype||document.createEvent(\"HTMLEvents\").__proto__;Object.extend(J.prototype,E)}function s(P,O,Q){var N=Element.retrieve(P,\"prototype_event_registry\");if(Object.isUndefined(N)){g.push(P);N=Element.retrieve(P,\"prototype_event_registry\",$H())}var L=N.get(O);if(Object.isUndefined(L)){L=[];N.set(O,L)}if(L.pluck(\"handler\").include(Q)){return false}var M;if(O.include(\":\")){M=function(R){if(Object.isUndefined(R.eventName)){return false}if(R.eventName!==O){return false}J.extend(R,P);Q.call(P,R)}}else{if(!K&&(O===\"mouseenter\"||O===\"mouseleave\")){if(O===\"mouseenter\"||O===\"mouseleave\"){M=function(S){J.extend(S,P);var R=S.relatedTarget;while(R&&R!==P){try{R=R.parentNode}catch(T){R=P}}if(R===P){return}Q.call(P,S)}}}else{M=function(R){J.extend(R,P);Q.call(P,R)}}}M.handler=Q;L.push(M);return M}function n(){for(var L=0,M=g.length;L<M;L++){J.stopObserving(g[L]);g[L]=null}}var g=[];if(Prototype.Browser.IE){window.attachEvent(\"onunload\",n)}if(Prototype.Browser.WebKit){window.addEventListener(\"unload\",Prototype.emptyFunction,false)}var r=Prototype.K,l={mouseenter:\"mouseover\",mouseleave:\"mouseout\"};if(!K){r=function(L){return(l[L]||L)}}function D(O,N,P){O=$(O);var M=s(O,N,P);if(!M){return O}if(N.include(\":\")){if(O.addEventListener){O.addEventListener(\"dataavailable\",M,false)}else{O.attachEvent(\"ondataavailable\",M);O.attachEvent(\"onlosecapture\",M)}}else{var L=r(N);if(O.addEventListener){O.addEventListener(L,M,false)}else{O.attachEvent(\"on\"+L,M)}}return O}function q(R,O,S){R=$(R);var N=Element.retrieve(R,\"prototype_event_registry\");if(!N){return R}if(!O){N.each(function(U){var T=U.key;q(R,T)});return R}var P=N.get(O);if(!P){return R}if(!S){P.each(function(T){q(R,O,T.handler)});return R}var Q=P.length,M;while(Q--){if(P[Q].handler===S){M=P[Q];break}}if(!M){return R}if(O.include(\":\")){if(R.removeEventListener){R.removeEventListener(\"dataavailable\",M,false)}else{R.detachEvent(\"ondataavailable\",M);R.detachEvent(\"onlosecapture\",M)}}else{var L=r(O);if(R.removeEventListener){R.removeEventListener(L,M,false)}else{R.detachEvent(\"on\"+L,M)}}N.set(O,P.without(M));return R}function G(O,N,M,L){O=$(O);if(Object.isUndefined(L)){L=true}if(O==document&&document.createEvent&&!O.dispatchEvent){O=document.documentElement}var P;if(document.createEvent){P=document.createEvent(\"HTMLEvents\");P.initEvent(\"dataavailable\",L,true)}else{P=document.createEventObject();P.eventType=L?\"ondataavailable\":\"onlosecapture\"}P.eventName=N;P.memo=M||{};if(document.createEvent){O.dispatchEvent(P)}else{O.fireEvent(P.eventType,P)}return J.extend(P)}J.Handler=Class.create({initialize:function(N,M,L,O){this.element=$(N);this.eventName=M;this.selector=L;this.callback=O;this.handler=this.handleEvent.bind(this)},start:function(){J.observe(this.element,this.eventName,this.handler);return this},stop:function(){J.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(M){var L=J.findElement(M,this.selector);if(L){this.callback.call(this.element,M,L)}}});function p(N,M,L,O){N=$(N);if(Object.isFunction(L)&&Object.isUndefined(O)){O=L,L=null}return new J.Handler(N,M,L,O).start()}Object.extend(J,J.Methods);Object.extend(J,{fire:G,observe:D,stopObserving:q,on:p});Element.addMethods({fire:G,observe:D,stopObserving:q,on:p});Object.extend(document,{fire:G.methodize(),observe:D.methodize(),stopObserving:q.methodize(),on:p.methodize(),loaded:false});if(window.Event){Object.extend(window.Event,J)}else{window.Event=J}})();(function(){var e;function b(){if(document.loaded){return}if(e){window.clearTimeout(e)}document.loaded=true;document.fire(\"dom:loaded\")}function d(){if(document.readyState===\"complete\"){document.stopObserving(\"readystatechange\",d);b()}}if(document.addEventListener){document.addEventListener(\"DOMContentLoaded\",b,false)}else{document.observe(\"readystatechange\",d);if(window==top){var e=window.setInterval(function(){try{document.documentElement.doScroll(\"left\")}catch(f){return}window.clearInterval(e);b()},5)}}Event.observe(window,\"load\",b)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(b,d){return Element.insert(b,{before:d})},Top:function(b,d){return Element.insert(b,{top:d})},Bottom:function(b,d){return Element.insert(b,{bottom:d})},After:function(b,d){return Element.insert(b,{after:d})}};var $continue=new Error('\"throw $continue\" is deprecated, use \"return\" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(d,b,e){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(d,b,e)}this.xcomp=b;this.ycomp=e;this.offset=Element.cumulativeOffset(d);return(e>=this.offset[1]&&e<this.offset[1]+d.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+d.offsetWidth)},withinIncludingScrolloffsets:function(d,b,f){var e=Element.cumulativeScrollOffset(d);this.xcomp=b+e[0]-this.deltaX;this.ycomp=f+e[1]-this.deltaY;this.offset=Element.cumulativeOffset(d);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+d.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+d.offsetWidth)},overlap:function(d,b){if(!d){return 0}if(d==\"vertical\"){return((this.offset[1]+b.offsetHeight)-this.ycomp)/b.offsetHeight}if(d==\"horizontal\"){return((this.offset[0]+b.offsetWidth)-this.xcomp)/b.offsetWidth}},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(b){Position.prepare();return Element.absolutize(b)},relativize:function(b){Position.prepare();return Element.relativize(b)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(d,e,b){b=b||{};return Element.clonePosition(e,d,b)}};if(!document.getElementsByClassName){document.getElementsByClassName=function(d){function b(e){return e.blank()?null:\"[contains(concat(' ', @class, ' '), ' \"+e+\" ')]\"}d.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(e,g){g=g.toString().strip();var f=/\\s/.test(g)?$w(g).map(b).join(\"\"):b(g);return f?document._getElementsByXPath(\".//*\"+f,e):[]}:function(g,h){h=h.toString().strip();var l=[],n=(/\\s/.test(h)?$w(h):null);if(!n&&!h){return l}var e=$(g).getElementsByTagName(\"*\");h=\" \"+h+\" \";for(var f=0,p,o;p=e[f];f++){if(p.className&&(o=\" \"+p.className+\" \")&&(o.include(h)||(n&&n.all(function(q){return !q.toString().blank()&&o.include(\" \"+q+\" \")})))){l.push(Element.extend(p))}}return l};return function(f,e){return $(e||document.body).getElementsByClassName(f)}}(Element.Methods)}Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(b){this.element=$(b)},_each:function(b){this.element.className.split(/\\s+/).select(function(d){return d.length>0})._each(b)},set:function(b){this.element.className=b},add:function(b){if(this.include(b)){return}this.set($A(this).concat(b).join(\" \"))},remove:function(b){if(!this.include(b)){return}this.set($A(this).without(b).join(\" \"))},toString:function(){return $A(this).join(\" \")}};Object.extend(Element.ClassNames.prototype,Enumerable);(function(){window.Selector=Class.create({initialize:function(b){this.expression=b.strip()},findElements:function(b){return Prototype.Selector.select(this.expression,b)},match:function(b){return Prototype.Selector.match(b,this.expression)},toString:function(){return this.expression},inspect:function(){return\"#<Selector: \"+this.expression+\">\"}});Object.extend(Selector,{matchElements:function(h,l){var b=Prototype.Selector.match,f=[];for(var e=0,g=h.length;e<g;e++){var d=h[e];if(b(d,l)){f.push(Element.extend(d))}}return f},findElement:function(h,l,d){d=d||0;var b=0,f;for(var e=0,g=h.length;e<g;e++){f=h[e];if(Prototype.Selector.match(f,l)&&d===b++){return Element.extend(f)}}},findChildElements:function(d,e){var b=e.toArray().join(\", \");return Prototype.Selector.select(b,d||document)}})})();var Window=Class.create();Window.keepMultiModalWindow=false;Window.hasEffectLib=(typeof Effect!=\"undefined\");Window.resizeEffectDuration=0.4;Window.prototype={initialize:function(){var e;var d=0;if(arguments.length>0){if(typeof arguments[0]==\"string\"){e=arguments[0];d=1}else{e=arguments[0]?arguments[0].id:null}}if(!e){e=\"window_\"+new Date().getTime()}if($(e)){alert(\"Window \"+e+\" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor\")}this.options=Object.extend({className:\"dialog\",windowClassName:null,blurClassName:null,minWidth:100,minHeight:20,resizable:true,closable:true,minimizable:true,maximizable:true,draggable:true,userData:null,showEffect:(Window.hasEffectLib?Effect.Appear:Element.show),hideEffect:(Window.hasEffectLib?Effect.Fade:Element.hide),showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:\"&nbsp;\",url:null,onload:Prototype.emptyFunction,width:200,height:300,opacity:1,recenterAuto:true,wiredDrag:false,closeOnEsc:true,closeCallback:null,destroyOnClose:false,gridX:1,gridY:1},arguments[d]||{});if(this.options.blurClassName){this.options.focusClassName=this.options.className}if(typeof this.options.top==\"undefined\"&&typeof this.options.bottom==\"undefined\"){this.options.top=this._round(Math.random()*500,this.options.gridY)}if(typeof this.options.left==\"undefined\"&&typeof this.options.right==\"undefined\"){this.options.left=this._round(Math.random()*500,this.options.gridX)}if(this.options.effectOptions){Object.extend(this.options.hideEffectOptions,this.options.effectOptions);Object.extend(this.options.showEffectOptions,this.options.effectOptions);if(this.options.showEffect==Element.Appear){this.options.showEffectOptions.to=this.options.opacity}}if(Window.hasEffectLib){if(this.options.showEffect==Effect.Appear){this.options.showEffectOptions.to=this.options.opacity}if(this.options.hideEffect==Effect.Fade){this.options.hideEffectOptions.from=this.options.opacity}}if(this.options.hideEffect==Element.hide){this.options.hideEffect=function(){Element.hide(this.element);if(this.options.destroyOnClose){this.destroy()}}.bind(this)}if(this.options.parent!=document.body){this.options.parent=$(this.options.parent)}this.element=this._createWindow(e);this.element.win=this;this.eventMouseDown=this._initDrag.bindAsEventListener(this);this.eventMouseUp=this._endDrag.bindAsEventListener(this);this.eventMouseMove=this._updateDrag.bindAsEventListener(this);this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this);this.eventMouseDownContent=this.toFront.bindAsEventListener(this);this.eventResize=this._recenter.bindAsEventListener(this);this.eventKeyUp=this._keyUp.bindAsEventListener(this);this.topbar=$(this.element.id+\"_top\");this.bottombar=$(this.element.id+\"_bottom\");this.content=$(this.element.id+\"_content\");Event.observe(this.topbar,\"mousedown\",this.eventMouseDown);Event.observe(this.bottombar,\"mousedown\",this.eventMouseDown);Event.observe(this.content,\"mousedown\",this.eventMouseDownContent);Event.observe(window,\"load\",this.eventOnLoad);Event.observe(window,\"resize\",this.eventResize);Event.observe(window,\"scroll\",this.eventResize);Event.observe(document,\"keyup\",this.eventKeyUp);Event.observe(this.options.parent,\"scroll\",this.eventResize);if(this.options.draggable){var b=this;[this.topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(f){f.observe(\"mousedown\",b.eventMouseDown);f.addClassName(\"top_draggable\")});[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(f){f.observe(\"mousedown\",b.eventMouseDown);f.addClassName(\"bottom_draggable\")})}if(this.options.resizable){this.sizer=$(this.element.id+\"_sizer\");Event.observe(this.sizer,\"mousedown\",this.eventMouseDown)}this.useLeft=null;this.useTop=null;if(typeof this.options.left!=\"undefined\"){this.element.setStyle({left:parseFloat(this.options.left)+\"px\"});this.useLeft=true}else{this.element.setStyle({right:parseFloat(this.options.right)+\"px\"});this.useLeft=false}if(typeof this.options.top!=\"undefined\"){this.element.setStyle({top:parseFloat(this.options.top)+\"px\"});this.useTop=true}else{this.element.setStyle({bottom:parseFloat(this.options.bottom)+\"px\"});this.useTop=false}this.storedLocation=null;this.setOpacity(this.options.opacity);if(this.options.zIndex){this.setZIndex(this.options.zIndex)}else{this.setZIndex(this.getMaxZIndex())}if(this.options.destroyOnClose){this.setDestroyOnClose(true)}this._getWindowBorderSize();this.width=this.options.width;this.height=this.options.height;this.visible=false;this.constraint=false;this.constraintPad={top:0,left:0,bottom:0,right:0};if(this.width&&this.height){this.setSize(this.options.width,this.options.height)}this.setTitle(this.options.title);Windows.register(this)},getMaxZIndex:function(){var b=0,d;var g=document.body.childNodes;for(d=0;d<g.length;d++){var e=g[d];var f=e.nodeType==1?parseInt(e.style.zIndex,10)||0:0;if(f<10000){b=Math.max(b,f)}}return b+10},destroy:function(){this._notify(\"onDestroy\");Event.stopObserving(this.topbar,\"mousedown\",this.eventMouseDown);Event.stopObserving(this.bottombar,\"mousedown\",this.eventMouseDown);Event.stopObserving(this.content,\"mousedown\",this.eventMouseDownContent);Event.stopObserving(window,\"load\",this.eventOnLoad);Event.stopObserving(window,\"resize\",this.eventResize);Event.stopObserving(window,\"scroll\",this.eventResize);Event.stopObserving(this.content,\"load\",this.options.onload);Event.stopObserving(document,\"keyup\",this.eventKeyUp);if(this._oldParent){var e=this.getContent();var b=null;for(var d=0;d<e.childNodes.length;d++){b=e.childNodes[d];if(b.nodeType==1){break}b=null}if(b){this._oldParent.appendChild(b)}this._oldParent=null}if(this.sizer){Event.stopObserving(this.sizer,\"mousedown\",this.eventMouseDown)}if(this.options.url){this.content.src=null}if(this.iefix){Element.remove(this.iefix)}Element.remove(this.element);Windows.unregister(this)},setCloseCallback:function(b){this.options.closeCallback=b},getContent:function(){return this.content},setContent:function(n,l,e){var b=$(n);if(null==b){throw\"Unable to find element '\"+n+\"' in DOM\"}this._oldParent=b.parentNode;var h=null;var g=null;if(l){h=Element.getDimensions(b)}if(e){g=Position.cumulativeOffset(b)}var f=this.getContent();this.setHTMLContent(\"\");f=this.getContent();f.appendChild(b);b.show();if(l){this.setSize(h.width,h.height)}if(e){this.setLocation(g[1]-this.heightN,g[0]-this.widthW)}},setHTMLContent:function(b){if(this.options.url){this.content.src=null;this.options.url=null;var d='<div id=\"'+this.getId()+'_content\" class=\"'+this.options.className+'_content\"> </div>';$(this.getId()+\"_table_content\").innerHTML=d;this.content=$(this.element.id+\"_content\")}this.getContent().innerHTML=b},setAjaxContent:function(d,b,f,e){this.showFunction=f?\"showCenter\":\"show\";this.showModal=e||false;b=b||{};this.setHTMLContent(\"\");this.onComplete=b.onComplete;if(!this._onCompleteHandler){this._onCompleteHandler=this._setAjaxContent.bind(this)}b.onComplete=this._onCompleteHandler;new Ajax.Request(d,b);b.onComplete=this.onComplete},_setAjaxContent:function(b){Element.update(this.getContent(),b.responseText);if(this.onComplete){this.onComplete(b)}this.onComplete=null;this[this.showFunction](this.showModal)},setURL:function(b){if(this.options.url){this.content.src=null}this.options.url=b;var d=\"<iframe frameborder='0' name='\"+this.getId()+\"_content'  id='\"+this.getId()+\"_content' src='\"+b+\"' width='\"+this.width+\"' height='\"+this.height+\"'> </iframe>\";$(this.getId()+\"_table_content\").innerHTML=d;this.content=$(this.element.id+\"_content\")},getURL:function(){return this.options.url?this.options.url:null},refresh:function(){if(this.options.url){$(this.element.getAttribute(\"id\")+\"_content\").src=this.options.url}},setCookie:function(d,e,t,g,b){d=d||this.element.id;this.cookie=[d,e,t,g,b];var r=WindowUtilities.getCookie(d);if(r){var s=r.split(\",\");var p=s[0].split(\":\");var o=s[1].split(\":\");var q=parseFloat(s[2]),l=parseFloat(s[3]);var n=s[4];var f=s[5];this.setSize(q,l);if(n==\"true\"){this.doMinimize=true}else{if(f==\"true\"){this.doMaximize=true}}this.useLeft=p[0]==\"l\";this.useTop=o[0]==\"t\";this.element.setStyle(this.useLeft?{left:p[1]}:{right:p[1]});this.element.setStyle(this.useTop?{top:o[1]}:{bottom:o[1]})}},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=true},setConstraint:function(b,d){this.constraint=b;this.constraintPad=Object.extend(this.constraintPad,d||{});if(this.useTop&&this.useLeft){this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))}},_initDrag:function(d){if(Event.element(d)==this.sizer&&this.isMinimized()){return}if(Event.element(d)!=this.sizer&&this.isMaximized()){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}this.pointer=[this._round(Event.pointerX(d),this.options.gridX),this._round(Event.pointerY(d),this.options.gridY)];if(this.options.wiredDrag){this.currentDrag=this._createWiredElement()}else{this.currentDrag=this.element}if(Event.element(d)==this.sizer){this.doResize=true;this.widthOrg=this.width;this.heightOrg=this.height;this.bottomOrg=parseFloat(this.element.getStyle(\"bottom\"));this.rightOrg=parseFloat(this.element.getStyle(\"right\"));this._notify(\"onStartResize\")}else{this.doResize=false;var b=$(this.getId()+\"_close\");if(b&&Position.within(b,this.pointer[0],this.pointer[1])){this.currentDrag=null;return}this.toFront();if(!this.options.draggable){return}this._notify(\"onStartMove\")}Event.observe(document,\"mouseup\",this.eventMouseUp,false);Event.observe(document,\"mousemove\",this.eventMouseMove,false);WindowUtilities.disableScreen(\"__invisible__\",\"__invisible__\",this.overlayOpacity);document.body.ondrag=function(){return false};document.body.onselectstart=function(){return false};this.currentDrag.show();Event.stop(d)},_round:function(d,b){return b==1?d:d=Math.floor(d/b)*b},_updateDrag:function(d){var b=[this._round(Event.pointerX(d),this.options.gridX),this._round(Event.pointerY(d),this.options.gridY)];var q=b[0]-this.pointer[0];var p=b[1]-this.pointer[1];if(this.doResize){var o=this.widthOrg+q;var f=this.heightOrg+p;q=this.width-this.widthOrg;p=this.height-this.heightOrg;if(this.useLeft){o=this._updateWidthConstraint(o)}else{this.currentDrag.setStyle({right:(this.rightOrg-q)+\"px\"})}if(this.useTop){f=this._updateHeightConstraint(f)}else{this.currentDrag.setStyle({bottom:(this.bottomOrg-p)+\"px\"})}this.setSize(o,f);this._notify(\"onResize\")}else{this.pointer=b;if(this.useLeft){var e=parseFloat(this.currentDrag.getStyle(\"left\"))+q;var n=this._updateLeftConstraint(e);this.pointer[0]+=n-e;this.currentDrag.setStyle({left:n+\"px\"})}else{this.currentDrag.setStyle({right:parseFloat(this.currentDrag.getStyle(\"right\"))-q+\"px\"})}if(this.useTop){var l=parseFloat(this.currentDrag.getStyle(\"top\"))+p;var g=this._updateTopConstraint(l);this.pointer[1]+=g-l;this.currentDrag.setStyle({top:g+\"px\"})}else{this.currentDrag.setStyle({bottom:parseFloat(this.currentDrag.getStyle(\"bottom\"))-p+\"px\"})}this._notify(\"onMove\")}if(this.iefix){this._fixIEOverlapping()}this._removeStoreLocation();Event.stop(d)},_endDrag:function(b){WindowUtilities.enableScreen(\"__invisible__\");if(this.doResize){this._notify(\"onEndResize\")}else{this._notify(\"onEndMove\")}Event.stopObserving(document,\"mouseup\",this.eventMouseUp,false);Event.stopObserving(document,\"mousemove\",this.eventMouseMove,false);Event.stop(b);this._hideWiredElement();this._saveCookie();document.body.ondrag=null;document.body.onselectstart=null},_updateLeftConstraint:function(d){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;if(d<this.constraintPad.left){d=this.constraintPad.left}if(d+this.width+this.widthE+this.widthW>b-this.constraintPad.right){d=b-this.constraintPad.right-this.width-this.widthE-this.widthW}}return d},_updateTopConstraint:function(e){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var d=this.height+this.heightN+this.heightS;if(e<this.constraintPad.top){e=this.constraintPad.top}if(e+d>b-this.constraintPad.bottom){e=b-this.constraintPad.bottom-d}}return e},_updateWidthConstraint:function(b){if(this.constraint&&this.useLeft&&this.useTop){var d=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;var e=parseFloat(this.element.getStyle(\"left\"));if(e+b+this.widthE+this.widthW>d-this.constraintPad.right){b=d-this.constraintPad.right-e-this.widthE-this.widthW}}return b},_updateHeightConstraint:function(d){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height;var e=parseFloat(this.element.getStyle(\"top\"));if(e+d+this.heightN+this.heightS>b-this.constraintPad.bottom){d=b-this.constraintPad.bottom-e-this.heightN-this.heightS}}return d},_createWindow:function(b){var h=this.options.className;var f=document.createElement(\"div\");f.setAttribute(\"id\",b);f.className=\"dialog\";if(this.options.windowClassName){f.className+=\" \"+this.options.windowClassName}var g;if(this.options.url){g='<iframe frameborder=\"0\" name=\"'+b+'_content\"  id=\"'+b+'_content\" src=\"'+this.options.url+'\"> </iframe>'}else{g='<div id=\"'+b+'_content\" class=\"'+h+'_content\"> </div>'}var l=this.options.closable?\"<div class='\"+h+\"_close' id='\"+b+\"_close' onclick='Windows.close(\\\"\"+b+\"\\\", event)'> </div>\":\"\";var n=this.options.minimizable?\"<div class='\"+h+\"_minimize' id='\"+b+\"_minimize' onclick='Windows.minimize(\\\"\"+b+\"\\\", event)'> </div>\":\"\";var o=this.options.maximizable?\"<div class='\"+h+\"_maximize' id='\"+b+\"_maximize' onclick='Windows.maximize(\\\"\"+b+\"\\\", event)'> </div>\":\"\";var e=this.options.resizable?\"class='\"+h+\"_sizer' id='\"+b+\"_sizer'\":\"class='\"+h+\"_se'\";var d=\"../themes/default/blank.gif\";f.innerHTML=l+n+o+\"      <a href='#' id='\"+b+\"_focus_anchor'><!-- --></a>      <table id='\"+b+\"_row1' class=\\\"top table_window\\\">        <tr>          <td class='\"+h+\"_nw'></td>          <td class='\"+h+\"_n'><div id='\"+b+\"_top' class='\"+h+\"_title title_window'>\"+this.options.title+\"</div></td>          <td class='\"+h+\"_ne'></td>        </tr>      </table>      <table id='\"+b+\"_row2' class=\\\"mid table_window\\\">        <tr>          <td class='\"+h+\"_w'></td>            <td id='\"+b+\"_table_content' class='\"+h+\"_content' valign='top'>\"+g+\"</td>          <td class='\"+h+\"_e'></td>        </tr>      </table>        <table id='\"+b+\"_row3' class=\\\"bot table_window\\\">        <tr>          <td class='\"+h+\"_sw'></td>            <td class='\"+h+\"_s'><div id='\"+b+\"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>            <td \"+e+\"></td>        </tr>      </table>    \";Element.hide(f);this.options.parent.insertBefore(f,this.options.parent.firstChild);Event.observe($(b+\"_content\"),\"load\",this.options.onload);return f},changeClassName:function(b){var d=this.options.className;var e=this.getId();$A([\"_close\",\"_minimize\",\"_maximize\",\"_sizer\",\"_content\"]).each(function(f){this._toggleClassName($(e+f),d+f,b+f)}.bind(this));this._toggleClassName($(e+\"_top\"),d+\"_title\",b+\"_title\");$$(\"#\"+e+\" td\").each(function(f){f.className=f.className.sub(d,b)});this.options.className=b},_toggleClassName:function(e,d,b){if(e){e.removeClassName(d);e.addClassName(b)}},setLocation:function(f,d){f=this._updateTopConstraint(f);d=this._updateLeftConstraint(d);var b=this.currentDrag||this.element;b.setStyle({top:f+\"px\"});b.setStyle({left:d+\"px\"});this.useLeft=true;this.useTop=true},getLocation:function(){var b={};if(this.useTop){b=Object.extend(b,{top:this.element.getStyle(\"top\")})}else{b=Object.extend(b,{bottom:this.element.getStyle(\"bottom\")})}if(this.useLeft){b=Object.extend(b,{left:this.element.getStyle(\"left\")})}else{b=Object.extend(b,{right:this.element.getStyle(\"right\")})}return b},getSize:function(){return{width:this.width,height:this.height}},setSize:function(f,d,b){f=parseFloat(f);d=parseFloat(d);if(!this.minimized&&f<this.options.minWidth){f=this.options.minWidth}if(!this.minimized&&d<this.options.minHeight){d=this.options.minHeight}if(this.options.maxHeight&&d>this.options.maxHeight){d=this.options.maxHeight}if(this.options.maxWidth&&f>this.options.maxWidth){f=this.options.maxWidth}if(this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&b){new Effect.ResizeWindow(this,null,null,f,d,{duration:Window.resizeEffectDuration})}else{this.width=f;this.height=d;var h=this.currentDrag?this.currentDrag:this.element;h.setStyle({width:f+this.widthW+this.widthE+\"px\"});h.setStyle({height:d+this.heightN+this.heightS+\"px\"});if(!this.currentDrag||this.currentDrag==this.element){var g=$(this.element.id+\"_content\");g.setStyle({height:d+\"px\"});g.setStyle({width:f+\"px\"})}}},updateHeight:function(){this.setSize(this.width,this.content.scrollHeight,true)},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,true)},toFront:function(){if(this.element.style.zIndex<Windows.maxZIndex){this.setZIndex(Windows.maxZIndex+1)}if(this.iefix){this._fixIEOverlapping()}},getBounds:function(d){if(!this.width||!this.height||!this.visible){this.computeBounds()}var b=this.width;var e=this.height;if(!d){b+=this.widthW+this.widthE;e+=this.heightN+this.heightS}var f=Object.extend(this.getLocation(),{width:b+\"px\",height:e+\"px\"});return f},computeBounds:function(){if(!this.width||!this.height){var b=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className);if(this.height){this.width=b+5}else{this.height=b+5}}this.setSize(this.width,this.height);if(this.centered){this._center(this.centerTop,this.centerLeft)}},show:function(d){this.visible=true;if(d){if(typeof this.overlayOpacity==\"undefined\"){var b=this;setTimeout(function(){b.show(d)},10);return}Windows.addModalWindow(this);this.modal=true;this.setZIndex(Windows.maxZIndex+1);Windows.unsetOverflow(this)}else{if(!this.element.style.zIndex){this.setZIndex(Windows.maxZIndex+1)}}if(this.oldStyle){this.getContent().setStyle({overflow:this.oldStyle})}this.computeBounds();this._notify(\"onBeforeShow\");if(this.options.showEffect!=Element.show&&this.options.showEffectOptions){this.options.showEffect(this.element,this.options.showEffectOptions)}else{this.options.showEffect(this.element)}this._checkIEOverlapping();WindowUtilities.focusedWindow=this;this._notify(\"onShow\");$(this.element.id+\"_focus_anchor\").focus()},showCenter:function(b,e,d){this.centered=true;this.centerTop=e;this.centerLeft=d;this.show(b)},isVisible:function(){return this.visible},_center:function(e,d){var f=WindowUtilities.getWindowScroll(this.options.parent);var b=WindowUtilities.getPageSize(this.options.parent);if(typeof e==\"undefined\"){e=(b.windowHeight-(this.height+this.heightN+this.heightS))/2}e+=f.top;if(typeof d==\"undefined\"){d=(b.windowWidth-(this.width+this.widthW+this.widthE))/2}d+=f.left;this.setLocation(e,d);this.toFront()},_recenter:function(d){if(this.centered){var b=WindowUtilities.getPageSize(this.options.parent);var e=WindowUtilities.getWindowScroll(this.options.parent);if(this.pageSize&&this.pageSize.windowWidth==b.windowWidth&&this.pageSize.windowHeight==b.windowHeight&&this.windowScroll.left==e.left&&this.windowScroll.top==e.top){return}this.pageSize=b;this.windowScroll=e;if($(\"overlay_modal\")){$(\"overlay_modal\").setStyle({height:(b.pageHeight+\"px\")})}if(this.options.recenterAuto){this._center(this.centerTop,this.centerLeft)}}},hide:function(){this.visible=false;if(this.modal){Windows.removeModalWindow(this);Windows.resetOverflow()}this.oldStyle=this.getContent().getStyle(\"overflow\")||\"auto\";this.getContent().setStyle({overflow:\"hidden\"});this.options.hideEffect(this.element,this.options.hideEffectOptions);if(this.iefix){this.iefix.hide()}if(!this.doNotNotifyHide){this._notify(\"onHide\")}},close:function(){if(this.visible){if(this.options.closeCallback&&!this.options.closeCallback(this)){return}if(this.options.destroyOnClose){var b=this.destroy.bind(this);if(this.options.hideEffectOptions.afterFinish){var d=this.options.hideEffectOptions.afterFinish;this.options.hideEffectOptions.afterFinish=function(){d();b()}}else{this.options.hideEffectOptions.afterFinish=function(){b()}}}Windows.updateFocusedWindow();this.doNotNotifyHide=true;this.hide();this.doNotNotifyHide=false;this._notify(\"onClose\")}},minimize:function(){if(this.resizing){return}var b=$(this.getId()+\"_row2\");if(!this.minimized){this.minimized=true;var f=b.getDimensions().height;this.r2Height=f;var e=this.element.getHeight()-f;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height-f,{duration:Window.resizeEffectDuration})}else{this.height-=f;this.element.setStyle({height:e+\"px\"});b.hide()}if(!this.useTop){var d=parseFloat(this.element.getStyle(\"bottom\"));this.element.setStyle({bottom:(d+f)+\"px\"})}}else{this.minimized=false;var f=this.r2Height;this.r2Height=null;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,null,null,null,this.height+f,{duration:Window.resizeEffectDuration})}else{var e=this.element.getHeight()+f;this.height+=f;this.element.setStyle({height:e+\"px\"});b.show()}if(!this.useTop){var d=parseFloat(this.element.getStyle(\"bottom\"));this.element.setStyle({bottom:(d-f)+\"px\"})}this.toFront()}this._notify(\"onMinimize\");this._saveCookie()},maximize:function(){if(this.isMinimized()||this.resizing){return}if(Prototype.Browser.IE&&this.heightN==0){this._getWindowBorderSize()}if(this.storedLocation!=null){this._restoreLocation();if(this.iefix){this.iefix.hide()}}else{this._storeLocation();Windows.unsetOverflow(this);var l=WindowUtilities.getWindowScroll(this.options.parent);var d=WindowUtilities.getPageSize(this.options.parent);var h=l.left;var g=l.top;if(this.options.parent!=document.body){l={top:0,left:0,bottom:0,right:0};var f=this.options.parent.getDimensions();d.windowWidth=f.width;d.windowHeight=f.height;g=0;h=0}if(this.constraint){d.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right);d.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom);h+=Math.max(0,this.constraintPad.left);g+=Math.max(0,this.constraintPad.top)}var e=d.windowWidth-this.widthW-this.widthE;var b=d.windowHeight-this.heightN-this.heightS;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,g,h,e,b,{duration:Window.resizeEffectDuration})}else{this.setSize(e,b);this.element.setStyle(this.useLeft?{left:h}:{right:h});this.element.setStyle(this.useTop?{top:g}:{bottom:g})}this.toFront();if(this.iefix){this._fixIEOverlapping()}}this._notify(\"onMaximize\");this._saveCookie()},isMinimized:function(){return this.minimized},isMaximized:function(){return(this.storedLocation!=null)},setOpacity:function(b){if(Element.setOpacity){Element.setOpacity(this.element,b)}},setZIndex:function(b){this.element.setStyle({zIndex:b});Windows.updateZindex(b,this)},setTitle:function(b){if(!b||b==\"\"){b=\"&nbsp;\"}Element.update(this.element.id+\"_top\",b)},getTitle:function(){return $(this.element.id+\"_top\").innerHTML},setStatusBar:function(d){var b=$(this.getId()+\"_bottom\");if(typeof(d)==\"object\"){if(this.bottombar.firstChild){this.bottombar.replaceChild(d,this.bottombar.firstChild)}else{this.bottombar.appendChild(d)}}else{this.bottombar.innerHTML=d}},_checkIEOverlapping:function(){if(!this.iefix&&(navigator.appVersion.indexOf(\"MSIE\")>0)&&(navigator.userAgent.indexOf(\"Opera\")<0)&&(this.element.getStyle(\"position\")==\"absolute\")){new Insertion.After(this.element.id,'<iframe id=\"'+this.element.id+'_iefix\" style=\"display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);\" src=\"javascript:false;\" frameborder=\"0\" scrolling=\"no\"></iframe>');this.iefix=$(this.element.id+\"_iefix\")}if(this.iefix){setTimeout(this._fixIEOverlapping.bind(this),50)}},_fixIEOverlapping:function(){Position.clone(this.element,this.iefix);this.iefix.style.zIndex=this.element.style.zIndex-1;this.iefix.show()},_keyUp:function(b){if(27==b.keyCode&&this.options.closeOnEsc){this.close()}},_getWindowBorderSize:function(d){var e=this._createHiddenDiv(this.options.className+\"_n\");this.heightN=Element.getDimensions(e).height;e.parentNode.removeChild(e);var e=this._createHiddenDiv(this.options.className+\"_s\");this.heightS=Element.getDimensions(e).height;e.parentNode.removeChild(e);var e=this._createHiddenDiv(this.options.className+\"_e\");this.widthE=Element.getDimensions(e).width;e.parentNode.removeChild(e);var e=this._createHiddenDiv(this.options.className+\"_w\");this.widthW=Element.getDimensions(e).width;e.parentNode.removeChild(e);var e=document.createElement(\"div\");e.className=\"overlay_\"+this.options.className;document.body.appendChild(e);var b=this;setTimeout(function(){b.overlayOpacity=($(e).getStyle(\"opacity\"));e.parentNode.removeChild(e)},10);if(Prototype.Browser.IE){this.heightS=$(this.getId()+\"_row3\").getDimensions().height;this.heightN=$(this.getId()+\"_row1\").getDimensions().height}if(Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420){this.setSize(this.width,this.height)}if(this.doMaximize){this.maximize()}if(this.doMinimize){this.minimize()}},_createHiddenDiv:function(d){var b=document.body;var e=document.createElement(\"div\");e.setAttribute(\"id\",this.element.id+\"_tmp\");e.className=d;e.style.display=\"none\";e.innerHTML=\"\";b.insertBefore(e,b.firstChild);return e},_storeLocation:function(){if(this.storedLocation==null){this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:this.element.getStyle(\"top\"),bottom:this.element.getStyle(\"bottom\"),left:this.element.getStyle(\"left\"),right:this.element.getStyle(\"right\"),width:this.width,height:this.height}}},_restoreLocation:function(){if(this.storedLocation!=null){this.useLeft=this.storedLocation.useLeft;this.useTop=this.storedLocation.useTop;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow){new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration})}else{this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right});this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom});this.setSize(this.storedLocation.width,this.storedLocation.height)}Windows.resetOverflow();this._removeStoreLocation()}},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){if(this.cookie){var b=\"\";if(this.useLeft){b+=\"l:\"+(this.storedLocation?this.storedLocation.left:this.element.getStyle(\"left\"))}else{b+=\"r:\"+(this.storedLocation?this.storedLocation.right:this.element.getStyle(\"right\"))}if(this.useTop){b+=\",t:\"+(this.storedLocation?this.storedLocation.top:this.element.getStyle(\"top\"))}else{b+=\",b:\"+(this.storedLocation?this.storedLocation.bottom:this.element.getStyle(\"bottom\"))}b+=\",\"+(this.storedLocation?this.storedLocation.width:this.width);b+=\",\"+(this.storedLocation?this.storedLocation.height:this.height);b+=\",\"+this.isMinimized();b+=\",\"+this.isMaximized();WindowUtilities.setCookie(b,this.cookie)}},_createWiredElement:function(){if(!this.wiredElement){if(Prototype.Browser.IE){this._getWindowBorderSize()}var d=document.createElement(\"div\");d.className=\"wired_frame \"+this.options.className+\"_wired_frame\";d.style.position=\"absolute\";this.options.parent.insertBefore(d,this.options.parent.firstChild);this.wiredElement=$(d)}if(this.useLeft){this.wiredElement.setStyle({left:this.element.getStyle(\"left\")})}else{this.wiredElement.setStyle({right:this.element.getStyle(\"right\")})}if(this.useTop){this.wiredElement.setStyle({top:this.element.getStyle(\"top\")})}else{this.wiredElement.setStyle({bottom:this.element.getStyle(\"bottom\")})}var b=this.element.getDimensions();this.wiredElement.setStyle({width:b.width+\"px\",height:b.height+\"px\"});this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30});return this.wiredElement},_hideWiredElement:function(){if(!this.wiredElement||!this.currentDrag){return}if(this.currentDrag==this.element){this.currentDrag=null}else{if(this.useLeft){this.element.setStyle({left:this.currentDrag.getStyle(\"left\")})}else{this.element.setStyle({right:this.currentDrag.getStyle(\"right\")})}if(this.useTop){this.element.setStyle({top:this.currentDrag.getStyle(\"top\")})}else{this.element.setStyle({bottom:this.currentDrag.getStyle(\"bottom\")})}this.currentDrag.hide();this.currentDrag=null;if(this.doResize){this.setSize(this.width,this.height)}}},_notify:function(b){if(this.options[b]){this.options[b](this)}else{Windows.notify(b,this)}}};var Windows={windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:0,overlayShowEffectOptions:{duration:0.5},overlayHideEffectOptions:{duration:0.5},addObserver:function(b){this.removeObserver(b);this.observers.push(b)},removeObserver:function(b){this.observers=this.observers.reject(function(d){return d==b})},notify:function(b,d){this.observers.each(function(e){if(e[b]){e[b](b,d)}})},getWindow:function(b){return this.windows.detect(function(e){return e.getId()==b})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=this.windows.length>=2?this.windows[this.windows.length-2]:null},register:function(b){this.windows.push(b)},addModalWindow:function(b){if(this.modalWindows.length==0){WindowUtilities.disableScreen(b.options.className,\"overlay_modal\",b.overlayOpacity,b.getId(),b.options.parent)}else{if(Window.keepMultiModalWindow){$(\"overlay_modal\").style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex+=1;WindowUtilities._hideSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.hide()}WindowUtilities._showSelect(b.getId())}this.modalWindows.push(b)},removeModalWindow:function(b){this.modalWindows.pop();if(this.modalWindows.length==0){WindowUtilities.enableScreen()}else{if(Window.keepMultiModalWindow){this.modalWindows.last().toFront();WindowUtilities._showSelect(this.modalWindows.last().getId())}else{this.modalWindows.last().element.show()}}},register:function(b){this.windows.push(b)},unregister:function(b){this.windows=this.windows.reject(function(e){return e==b})},closeAll:function(){this.windows.each(function(b){Windows.close(b.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen();this.modalWindows.each(function(b){if(b){b.close()}})},minimize:function(e,b){var d=this.getWindow(e);if(d&&d.visible){d.minimize()}Event.stop(b)},maximize:function(e,b){var d=this.getWindow(e);if(d&&d.visible){d.maximize()}Event.stop(b)},close:function(e,b){var d=this.getWindow(e);if(d){d.close()}if(b){Event.stop(b)}},blur:function(d){var b=this.getWindow(d);if(!b){return}if(b.options.blurClassName){b.changeClassName(b.options.blurClassName)}if(this.focusedWindow==b){this.focusedWindow=null}b._notify(\"onBlur\")},focus:function(d){var b=this.getWindow(d);if(!b){return}if(this.focusedWindow){this.blur(this.focusedWindow.getId())}if(b.options.focusClassName){b.changeClassName(b.options.focusClassName)}this.focusedWindow=b;b._notify(\"onFocus\")},unsetOverflow:function(b){this.windows.each(function(e){e.oldOverflow=e.getContent().getStyle(\"overflow\")||\"auto\";e.getContent().setStyle({overflow:\"hidden\"})});if(b&&b.oldOverflow){b.getContent().setStyle({overflow:b.oldOverflow})}},resetOverflow:function(){this.windows.each(function(b){if(b.oldOverflow){b.getContent().setStyle({overflow:b.oldOverflow})}})},updateZindex:function(b,d){if(b>this.maxZIndex){this.maxZIndex=b;if(this.focusedWindow){this.blur(this.focusedWindow.getId())}}this.focusedWindow=d;if(this.focusedWindow){this.focus(this.focusedWindow.getId())}}};var Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,confirm:function(f,e){if(f&&typeof f!=\"string\"){Dialog._runAjaxRequest(f,e,Dialog.confirm);return}f=f||\"\";e=e||{};var h=e.okLabel?e.okLabel:\"Ok\";var b=e.cancelLabel?e.cancelLabel:\"Cancel\";e=Object.extend(e,e.windowParameters||{});e.windowParameters=e.windowParameters||{};e.className=e.className||\"alert\";var d=\"class ='\"+(e.buttonClass?e.buttonClass+\" \":\"\")+\" ok_button'\";var g=\"class ='\"+(e.buttonClass?e.buttonClass+\" \":\"\")+\" cancel_button'\";var f=\"      <div class='\"+e.className+\"_message'>\"+f+\"</div>        <div class='\"+e.className+\"_buttons'>          <button type='button' title='\"+h+\"' onclick='Dialog.okCallback()' \"+d+\"><span><span><span>\"+h+\"</span></span></span></button>          <button type='button' title='\"+b+\"' onclick='Dialog.cancelCallback()' \"+g+\"><span><span><span>\"+b+\"</span></span></span></button>        </div>    \";return this._openDialog(f,e)},alert:function(e,d){if(e&&typeof e!=\"string\"){Dialog._runAjaxRequest(e,d,Dialog.alert);return}e=e||\"\";d=d||{};var f=d.okLabel?d.okLabel:\"Ok\";d=Object.extend(d,d.windowParameters||{});d.windowParameters=d.windowParameters||{};d.className=d.className||\"alert\";var b=\"class ='\"+(d.buttonClass?d.buttonClass+\" \":\"\")+\" ok_button'\";var e=\"      <div class='\"+d.className+\"_message'>\"+e+\"</div>        <div class='\"+d.className+\"_buttons'>          <button type='button' title='\"+f+\"' onclick='Dialog.okCallback()' \"+b+\"><span><span><span>\"+f+\"</span></span></span></button>        </div>\";return this._openDialog(e,d)},info:function(d,b){if(d&&typeof d!=\"string\"){Dialog._runAjaxRequest(d,b,Dialog.info);return}d=d||\"\";b=b||{};b=Object.extend(b,b.windowParameters||{});b.windowParameters=b.windowParameters||{};b.className=b.className||\"alert\";var d=\"<div id='modal_dialog_message' class='\"+b.className+\"_message'>\"+d+\"</div>\";if(b.showProgress){d+=\"<div id='modal_dialog_progress' class='\"+b.className+\"_progress'>  </div>\"}b.ok=null;b.cancel=null;return this._openDialog(d,b)},setInfoMessage:function(b){$(\"modal_dialog_message\").update(b)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(g,f){var e=f.className;if(!f.height&&!f.width){f.width=WindowUtilities.getPageSize(f.options.parent||document.body).pageWidth/2}if(f.id){this.dialogId=f.id}else{var d=new Date();this.dialogId=\"modal_dialog_\"+d.getTime();f.id=this.dialogId}if(!f.height||!f.width){var b=WindowUtilities._computeSize(g,this.dialogId,f.width,f.height,5,e);if(f.height){f.width=b+5}else{f.height=b+5}}f.effectOptions=f.effectOptions;f.resizable=f.resizable||false;f.minimizable=f.minimizable||false;f.maximizable=f.maximizable||false;f.draggable=f.draggable||false;f.closable=f.closable||false;var h=new Window(f);h.getContent().innerHTML=g;h.showCenter(true,f.top,f.left);h.setDestroyOnClose();h.cancelCallback=f.onCancel||f.cancel;h.okCallback=f.onOk||f.ok;return h},_getAjaxContent:function(b){Dialog.callFunc(b.responseText,Dialog.parameters)},_runAjaxRequest:function(e,d,b){if(e.options==null){e.options={}}Dialog.onCompleteFunc=e.options.onComplete;Dialog.parameters=d;Dialog.callFunc=b;e.options.onComplete=Dialog._getAjaxContent;new Ajax.Request(e.url,e.options)},okCallback:function(){var b=Windows.focusedWindow;if(!b.okCallback||b.okCallback(b)){$$(\"#\"+b.getId()+\" input\").each(function(d){d.onclick=null});b.close()}},cancelCallback:function(){var b=Windows.focusedWindow;$$(\"#\"+b.getId()+\" input\").each(function(d){d.onclick=null});b.close();if(b.cancelCallback){b.cancelCallback(b)}}};if(Prototype.Browser.WebKit){var array=navigator.userAgent.match(new RegExp(/AppleWebKit\\/([\\d\\.\\+]*)/));Prototype.Browser.WebKitVersion=parseFloat(array[1])}var WindowUtilities={getWindowScroll:function(parent){var T,L,W,H;parent=parent||document.body;if(parent!=document.body){T=parent.scrollTop;L=parent.scrollLeft;W=parent.scrollWidth;H=parent.scrollHeight}else{var w=window;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}}return{top:T,left:L,width:W,height:H}},getPageSize:function(f){f=f||document.body;var e,l;var g,d;if(f!=document.body){e=f.getWidth();l=f.getHeight();d=f.scrollWidth;g=f.scrollHeight}else{var h,b;if(window.innerHeight&&window.scrollMaxY){h=document.body.scrollWidth;b=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){h=document.body.scrollWidth;b=document.body.scrollHeight}else{h=document.body.offsetWidth;b=document.body.offsetHeight}}if(self.innerHeight){e=document.documentElement.clientWidth;l=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){e=document.documentElement.clientWidth;l=document.documentElement.clientHeight}else{if(document.body){e=document.body.clientWidth;l=document.body.clientHeight}}}if(b<l){g=l}else{g=b}if(h<e){d=e}else{d=h}}return{pageWidth:d,pageHeight:g,windowWidth:e,windowHeight:l}},disableScreen:function(e,b,f,g,d){WindowUtilities.initLightbox(b,e,function(){this._disableScreen(e,b,f,g)}.bind(this),d||document.body)},_disableScreen:function(e,d,g,h){var f=$(d);var b=WindowUtilities.getPageSize(f.parentNode);if(h&&Prototype.Browser.IE){WindowUtilities._hideSelect();WindowUtilities._showSelect(h)}f.style.height=(b.pageHeight+\"px\");f.style.display=\"none\";if(d==\"overlay_modal\"&&Window.hasEffectLib&&Windows.overlayShowEffectOptions){f.overlayOpacity=g;new Effect.Appear(f,Object.extend({from:0,to:g},Windows.overlayShowEffectOptions))}else{f.style.display=\"block\"}},enableScreen:function(d){d=d||\"overlay_modal\";var b=$(d);if(b){if(d==\"overlay_modal\"&&Window.hasEffectLib&&Windows.overlayHideEffectOptions){new Effect.Fade(b,Object.extend({from:b.overlayOpacity,to:0},Windows.overlayHideEffectOptions))}else{b.style.display=\"none\";b.parentNode.removeChild(b)}if(d!=\"__invisible__\"){WindowUtilities._showSelect()}}},_hideSelect:function(b){if(Prototype.Browser.IE){b=b==null?\"\":\"#\"+b+\" \";$$(b+\"select\").each(function(d){if(!WindowUtilities.isDefined(d.oldVisibility)){d.oldVisibility=d.style.visibility?d.style.visibility:\"visible\";d.style.visibility=\"hidden\"}})}},_showSelect:function(b){if(Prototype.Browser.IE){b=b==null?\"\":\"#\"+b+\" \";$$(b+\"select\").each(function(d){if(WindowUtilities.isDefined(d.oldVisibility)){try{d.style.visibility=d.oldVisibility}catch(f){d.style.visibility=\"visible\"}d.oldVisibility=null}else{if(d.style.visibility){d.style.visibility=\"visible\"}}})}},isDefined:function(b){return typeof(b)!=\"undefined\"&&b!=null},initLightbox:function(g,e,b,d){if($(g)){Element.setStyle(g,{zIndex:Windows.maxZIndex+1});Windows.maxZIndex++;b()}else{var f=document.createElement(\"div\");f.setAttribute(\"id\",g);f.className=\"overlay_\"+e;f.style.display=\"none\";f.style.position=\"absolute\";f.style.top=\"0\";f.style.left=\"0\";f.style.zIndex=Windows.maxZIndex+1;Windows.maxZIndex++;f.style.width=\"100%\";d.insertBefore(f,d.firstChild);if(Prototype.Browser.WebKit&&g==\"overlay_modal\"){setTimeout(function(){b()},10)}else{b()}}},setCookie:function(d,b){document.cookie=b[0]+\"=\"+escape(d)+((b[1])?\"; expires=\"+b[1].toGMTString():\"\")+((b[2])?\"; path=\"+b[2]:\"\")+((b[3])?\"; domain=\"+b[3]:\"\")+((b[4])?\"; secure\":\"\")},getCookie:function(e){var d=document.cookie;var g=e+\"=\";var f=d.indexOf(\"; \"+g);if(f==-1){f=d.indexOf(g);if(f!=0){return null}}else{f+=2}var b=document.cookie.indexOf(\";\",f);if(b==-1){b=d.length}return unescape(d.substring(f+g.length,b))},_computeSize:function(g,b,d,l,f,h){var o=document.body;var e=document.createElement(\"div\");e.setAttribute(\"id\",b);e.className=h+\"_content\";if(l){e.style.height=l+\"px\"}else{e.style.width=d+\"px\"}e.style.position=\"absolute\";e.style.top=\"0\";e.style.left=\"0\";e.style.display=\"none\";e.innerHTML=g;o.insertBefore(e,o.firstChild);var n;if(l){n=$(e).getDimensions().width+f}else{n=$(e).getDimensions().height+f}o.removeChild(e);return n}};var Builder={NODEMAP:{AREA:\"map\",CAPTION:\"table\",COL:\"table\",COLGROUP:\"table\",LEGEND:\"fieldset\",OPTGROUP:\"select\",OPTION:\"select\",PARAM:\"object\",TBODY:\"table\",TD:\"table\",TFOOT:\"table\",TH:\"table\",THEAD:\"table\",TR:\"table\"},node:function(b){b=b.toUpperCase();var l=this.NODEMAP[b]||\"div\";var d=document.createElement(l);try{d.innerHTML=\"<\"+b+\"></\"+b+\">\"}catch(h){}var g=d.firstChild||null;if(g&&(g.tagName.toUpperCase()!=b)){g=g.getElementsByTagName(b)[0]}if(!g){g=document.createElement(b)}if(!g){return}if(arguments[1]){if(this._isStringOrNumber(arguments[1])||(arguments[1] instanceof Array)||arguments[1].tagName){this._children(g,arguments[1])}else{var f=this._attributes(arguments[1]);if(f.length){try{d.innerHTML=\"<\"+b+\" \"+f+\"></\"+b+\">\"}catch(h){}g=d.firstChild||null;if(!g){g=document.createElement(b);for(attr in arguments[1]){g[attr==\"class\"?\"className\":attr]=arguments[1][attr]}}if(g.tagName.toUpperCase()!=b){g=d.getElementsByTagName(b)[0]}}}}if(arguments[2]){this._children(g,arguments[2])}return $(g)},_text:function(b){return document.createTextNode(b)},ATTR_MAP:{className:\"class\",htmlFor:\"for\"},_attributes:function(b){var d=[];for(attribute in b){d.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'=\"'+b[attribute].toString().escapeHTML().gsub(/\"/,\"&quot;\")+'\"')}return d.join(\" \")},_children:function(d,b){if(b.tagName){d.appendChild(b);return}if(typeof b==\"object\"){b.flatten().each(function(f){if(typeof f==\"object\"){d.appendChild(f)}else{if(Builder._isStringOrNumber(f)){d.appendChild(Builder._text(f))}}})}else{if(Builder._isStringOrNumber(b)){d.appendChild(Builder._text(b))}}},_isStringOrNumber:function(b){return(typeof b==\"string\"||typeof b==\"number\")},build:function(d){var b=this.node(\"div\");$(b).update(d.strip());return b.down()},dump:function(d){if(typeof d!=\"object\"&&typeof d!=\"function\"){d=window}var b=(\"A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR\").split(/\\s+/);b.each(function(e){d[e]=function(){return Builder.node.apply(Builder,[e].concat($A(arguments)))}})}};String.prototype.parseColor=function(){var b=\"#\";if(this.slice(0,4)==\"rgb(\"){var e=this.slice(4,this.length-1).split(\",\");var d=0;do{b+=parseInt(e[d]).toColorPart()}while(++d<3)}else{if(this.slice(0,1)==\"#\"){if(this.length==4){for(var d=1;d<4;d++){b+=(this.charAt(d)+this.charAt(d)).toLowerCase()}}if(this.length==7){b=this.toLowerCase()}}}return(b.length==7?b:(arguments[0]||this))};Element.collectTextNodes=function(b){return $A($(b).childNodes).collect(function(d){return(d.nodeType==3?d.nodeValue:(d.hasChildNodes()?Element.collectTextNodes(d):\"\"))}).flatten().join(\"\")};Element.collectTextNodesIgnoreClass=function(b,d){return $A($(b).childNodes).collect(function(e){return(e.nodeType==3?e.nodeValue:((e.hasChildNodes()&&!Element.hasClassName(e,d))?Element.collectTextNodesIgnoreClass(e,d):\"\"))}).flatten().join(\"\")};Element.setContentZoom=function(b,d){b=$(b);b.setStyle({fontSize:(d/100)+\"em\"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return b};Element.getInlineOpacity=function(b){return $(b).style.opacity||\"\"};Element.forceRerendering=function(b){try{b=$(b);var f=document.createTextNode(\" \");b.appendChild(f);b.removeChild(f)}catch(d){}};var Effect={_elementDoesNotExistError:{name:\"ElementDoesNotExistError\",message:\"The specified DOM element does not exist, but is required for this effect to operate\"},Transitions:{linear:Prototype.K,sinoidal:function(b){return(-Math.cos(b*Math.PI)/2)+0.5},reverse:function(b){return 1-b},flicker:function(b){var b=((-Math.cos(b*Math.PI)/4)+0.75)+Math.random()/4;return b>1?1:b},wobble:function(b){return(-Math.cos(b*Math.PI*(9*b))/2)+0.5},pulse:function(d,b){return(-Math.cos((d*((b||5)-0.5)*2)*Math.PI)/2)+0.5},spring:function(b){return 1-(Math.cos(b*4.5*Math.PI)*Math.exp(-b*6))},none:function(b){return 0},full:function(b){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:\"parallel\"},tagifyText:function(b){var d=\"position:relative\";if(Prototype.Browser.IE){d+=\";zoom:1\"}b=$(b);$A(b.childNodes).each(function(e){if(e.nodeType==3){e.nodeValue.toArray().each(function(f){b.insertBefore(new Element(\"span\",{style:d}).update(f==\" \"?String.fromCharCode(160):f),e)});Element.remove(e)}})},multiple:function(d,e){var g;if(((typeof d==\"object\")||Object.isFunction(d))&&(d.length)){g=d}else{g=$(d).childNodes}var b=Object.extend({speed:0.1,delay:0},arguments[2]||{});var f=b.delay;$A(g).each(function(l,h){new e(l,Object.extend(b,{delay:h*b.speed+f}))})},PAIRS:{slide:[\"SlideDown\",\"SlideUp\"],blind:[\"BlindDown\",\"BlindUp\"],appear:[\"Appear\",\"Fade\"]},toggle:function(d,e){d=$(d);e=(e||\"appear\").toLowerCase();var b=Object.extend({queue:{position:\"end\",scope:(d.id||\"global\"),limit:1}},arguments[2]||{});Effect[d.visible()?Effect.PAIRS[e][1]:Effect.PAIRS[e][0]](d,b)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(b){this.effects._each(b)},add:function(d){var e=new Date().getTime();var b=Object.isString(d.options.queue)?d.options.queue:d.options.queue.position;switch(b){case\"front\":this.effects.findAll(function(f){return f.state==\"idle\"}).each(function(f){f.startOn+=d.finishOn;f.finishOn+=d.finishOn});break;case\"with-last\":e=this.effects.pluck(\"startOn\").max()||e;break;case\"end\":e=this.effects.pluck(\"finishOn\").max()||e;break}d.startOn+=e;d.finishOn+=e;if(!d.options.queue.limit||(this.effects.length<d.options.queue.limit)){this.effects.push(d)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(b){this.effects=this.effects.reject(function(d){return d==b});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var e=new Date().getTime();for(var d=0,b=this.effects.length;d<b;d++){this.effects[d]&&this.effects[d].loop(e)}}});Effect.Queues={instances:$H(),get:function(b){if(!Object.isString(b)){return b}return this.instances.get(b)||this.instances.set(b,new Effect.ScopedQueue())}};Effect.Queue=Effect.Queues.get(\"global\");Effect.Base=Class.create({position:null,start:function(b){function d(f,e){return((f[e+\"Internal\"]?\"this.options.\"+e+\"Internal(this);\":\"\")+(f[e]?\"this.options.\"+e+\"(this);\":\"\"))}if(b&&b.transition===false){b.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),b||{});this.currentFrame=0;this.state=\"idle\";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function e(g,f){if(g.options[f+\"Internal\"]){g.options[f+\"Internal\"](g)}if(g.options[f]){g.options[f](g)}}return function(f){if(this.state===\"idle\"){this.state=\"running\";e(this,\"beforeSetup\");if(this.setup){this.setup()}e(this,\"afterSetup\")}if(this.state===\"running\"){f=(this.options.transition(f)*this.fromToDelta)+this.options.from;this.position=f;e(this,\"beforeUpdate\");if(this.update){this.update(f)}e(this,\"afterUpdate\")}}})();this.event(\"beforeStart\");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?\"global\":this.options.queue.scope).add(this)}},loop:function(e){if(e>=this.startOn){if(e>=this.finishOn){this.render(1);this.cancel();this.event(\"beforeFinish\");if(this.finish){this.finish()}this.event(\"afterFinish\");return}var d=(e-this.startOn)/this.totalTime,b=(d*this.totalFrames).round();if(b>this.currentFrame){this.render(d);this.currentFrame=b}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?\"global\":this.options.queue.scope).remove(this)}this.state=\"finished\"},event:function(b){if(this.options[b+\"Internal\"]){this.options[b+\"Internal\"](this)}if(this.options[b]){this.options[b](this)}},inspect:function(){var b=$H();for(property in this){if(!Object.isFunction(this[property])){b.set(property,this[property])}}return\"#<Effect:\"+b.inspect()+\",options:\"+$H(this.options).inspect()+\">\"}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(b){this.effects=b||[];this.start(arguments[1])},update:function(b){this.effects.invoke(\"render\",b)},finish:function(b){this.effects.each(function(d){d.render(1);d.cancel();d.event(\"beforeFinish\");if(d.finish){d.finish(b)}d.event(\"afterFinish\")})}});Effect.Tween=Class.create(Effect.Base,{initialize:function(e,h,g){e=Object.isString(e)?$(e):e;var d=$A(arguments),f=d.last(),b=d.length==5?d[3]:null;this.method=Object.isFunction(f)?f.bind(e):Object.isFunction(e[f])?e[f].bind(e):function(l){e[f]=l};this.start(Object.extend({from:h,to:g},b||{}))},update:function(b){this.method(b)}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(d){this.element=$(d);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var b=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(b)},update:function(b){this.element.setOpacity(b)}});Effect.Move=Class.create(Effect.Base,{initialize:function(d){this.element=$(d);if(!this.element){throw (Effect._elementDoesNotExistError)}var b=Object.extend({x:0,y:0,mode:\"relative\"},arguments[1]||{});this.start(b)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle(\"left\")||\"0\");this.originalTop=parseFloat(this.element.getStyle(\"top\")||\"0\");if(this.options.mode==\"absolute\"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(b){this.element.setStyle({left:(this.options.x*b+this.originalLeft).round()+\"px\",top:(this.options.y*b+this.originalTop).round()+\"px\"})}});Effect.MoveBy=function(d,b,e){return new Effect.Move(d,Object.extend({x:e,y:b},arguments[3]||{}))};Effect.Scale=Class.create(Effect.Base,{initialize:function(d,e){this.element=$(d);if(!this.element){throw (Effect._elementDoesNotExistError)}var b=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:\"box\",scaleFrom:100,scaleTo:e},arguments[2]||{});this.start(b)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle(\"position\");this.originalStyle={};[\"top\",\"left\",\"width\",\"height\",\"fontSize\"].each(function(d){this.originalStyle[d]=this.element.style[d]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var b=this.element.getStyle(\"font-size\")||\"100%\";[\"em\",\"px\",\"%\",\"pt\"].each(function(d){if(b.indexOf(d)>0){this.fontSize=parseFloat(b);this.fontSizeType=d}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode==\"box\"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}},update:function(b){var d=(this.options.scaleFrom/100)+(this.factor*b);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*d+this.fontSizeType})}this.setDimensions(this.dims[0]*d,this.dims[1]*d)},finish:function(b){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle)}},setDimensions:function(b,g){var h={};if(this.options.scaleX){h.width=g.round()+\"px\"}if(this.options.scaleY){h.height=b.round()+\"px\"}if(this.options.scaleFromCenter){var f=(b-this.dims[0])/2;var e=(g-this.dims[1])/2;if(this.elementPositioning==\"absolute\"){if(this.options.scaleY){h.top=this.originalTop-f+\"px\"}if(this.options.scaleX){h.left=this.originalLeft-e+\"px\"}}else{if(this.options.scaleY){h.top=-f+\"px\"}if(this.options.scaleX){h.left=-e+\"px\"}}}this.element.setStyle(h)}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(d){this.element=$(d);if(!this.element){throw (Effect._elementDoesNotExistError)}var b=Object.extend({startcolor:\"#ffff99\"},arguments[1]||{});this.start(b)},setup:function(){if(this.element.getStyle(\"display\")==\"none\"){this.cancel();return}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle(\"background-image\");this.element.setStyle({backgroundImage:\"none\"})}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle(\"background-color\").parseColor(\"#ffffff\")}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle(\"background-color\")}this._base=$R(0,2).map(function(b){return parseInt(this.options.startcolor.slice(b*2+1,b*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(b){return parseInt(this.options.endcolor.slice(b*2+1,b*2+3),16)-this._base[b]}.bind(this))},update:function(b){this.element.setStyle({backgroundColor:$R(0,2).inject(\"#\",function(d,e,f){return d+((this._base[f]+(this._delta[f]*b)).round().toColorPart())}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(e){var d=arguments[1]||{},b=document.viewport.getScrollOffsets(),f=$(e).cumulativeOffset();if(d.offset){f[1]+=d.offset}return new Effect.Tween(null,b.top,f[1],d,function(g){scrollTo(b.left,g.round())})};Effect.Fade=function(e){e=$(e);var b=e.getInlineOpacity();var d=Object.extend({from:e.getOpacity()||1,to:0,afterFinishInternal:function(f){if(f.options.to!=0){return}f.element.hide().setStyle({opacity:b})}},arguments[1]||{});return new Effect.Opacity(e,d)};Effect.Appear=function(d){d=$(d);var b=Object.extend({from:(d.getStyle(\"display\")==\"none\"?0:d.getOpacity()||0),to:1,afterFinishInternal:function(e){e.element.forceRerendering()},beforeSetup:function(e){e.element.setOpacity(e.options.from).show()}},arguments[1]||{});return new Effect.Opacity(d,b)};Effect.Puff=function(d){d=$(d);var b={opacity:d.getInlineOpacity(),position:d.getStyle(\"position\"),top:d.style.top,left:d.style.left,width:d.style.width,height:d.style.height};return new Effect.Parallel([new Effect.Scale(d,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(d,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(e){Position.absolutize(e.effects[0].element)},afterFinishInternal:function(e){e.effects[0].element.hide().setStyle(b)}},arguments[1]||{}))};Effect.BlindUp=function(b){b=$(b);b.makeClipping();return new Effect.Scale(b,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(d){d.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(d){d=$(d);var b=d.getDimensions();return new Effect.Scale(d,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:b.height,originalWidth:b.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makeClipping().setStyle({height:\"0px\"}).show()},afterFinishInternal:function(e){e.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(d){d=$(d);var b=d.getInlineOpacity();return new Effect.Appear(d,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(e){new Effect.Scale(e.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(f){f.element.makePositioned().makeClipping()},afterFinishInternal:function(f){f.element.hide().undoClipping().undoPositioned().setStyle({opacity:b})}})}},arguments[1]||{}))};Effect.DropOut=function(d){d=$(d);var b={top:d.getStyle(\"top\"),left:d.getStyle(\"left\"),opacity:d.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(d,{x:0,y:100,sync:true}),new Effect.Opacity(d,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(e){e.effects[0].element.makePositioned()},afterFinishInternal:function(e){e.effects[0].element.hide().undoPositioned().setStyle(b)}},arguments[1]||{}))};Effect.Shake=function(f){f=$(f);var d=Object.extend({distance:20,duration:0.5},arguments[1]||{});var g=parseFloat(d.distance);var e=parseFloat(d.duration)/10;var b={top:f.getStyle(\"top\"),left:f.getStyle(\"left\")};return new Effect.Move(f,{x:g,y:0,duration:e,afterFinishInternal:function(h){new Effect.Move(h.element,{x:-g*2,y:0,duration:e*2,afterFinishInternal:function(l){new Effect.Move(l.element,{x:g*2,y:0,duration:e*2,afterFinishInternal:function(n){new Effect.Move(n.element,{x:-g*2,y:0,duration:e*2,afterFinishInternal:function(o){new Effect.Move(o.element,{x:g*2,y:0,duration:e*2,afterFinishInternal:function(p){new Effect.Move(p.element,{x:-g,y:0,duration:e,afterFinishInternal:function(q){q.element.undoPositioned().setStyle(b)}})}})}})}})}})}})};Effect.SlideDown=function(e){e=$(e).cleanWhitespace();var b=e.down().getStyle(\"bottom\");var d=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:d.height,originalWidth:d.width},restoreAfterFinish:true,afterSetup:function(f){f.element.makePositioned();f.element.down().makePositioned();if(window.opera){f.element.setStyle({top:\"\"})}f.element.makeClipping().setStyle({height:\"0px\"}).show()},afterUpdateInternal:function(f){f.element.down().setStyle({bottom:(f.dims[0]-f.element.clientHeight)+\"px\"})},afterFinishInternal:function(f){f.element.undoClipping().undoPositioned();f.element.down().undoPositioned().setStyle({bottom:b})}},arguments[1]||{}))};Effect.SlideUp=function(e){e=$(e).cleanWhitespace();var b=e.down().getStyle(\"bottom\");var d=e.getDimensions();return new Effect.Scale(e,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:\"box\",scaleFrom:100,scaleMode:{originalHeight:d.height,originalWidth:d.width},restoreAfterFinish:true,afterSetup:function(f){f.element.makePositioned();f.element.down().makePositioned();if(window.opera){f.element.setStyle({top:\"\"})}f.element.makeClipping().show()},afterUpdateInternal:function(f){f.element.down().setStyle({bottom:(f.dims[0]-f.element.clientHeight)+\"px\"})},afterFinishInternal:function(f){f.element.hide().undoClipping().undoPositioned();f.element.down().undoPositioned().setStyle({bottom:b})}},arguments[1]||{}))};Effect.Squish=function(b){return new Effect.Scale(b,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(d){d.element.makeClipping()},afterFinishInternal:function(d){d.element.hide().undoClipping()}})};Effect.Grow=function(e){e=$(e);var d=Object.extend({direction:\"center\",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var b={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()};var l=e.getDimensions();var n,h;var g,f;switch(d.direction){case\"top-left\":n=h=g=f=0;break;case\"top-right\":n=l.width;h=f=0;g=-l.width;break;case\"bottom-left\":n=g=0;h=l.height;f=-l.height;break;case\"bottom-right\":n=l.width;h=l.height;g=-l.width;f=-l.height;break;case\"center\":n=l.width/2;h=l.height/2;g=-l.width/2;f=-l.height/2;break}return new Effect.Move(e,{x:n,y:h,duration:0.01,beforeSetup:function(o){o.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(o){new Effect.Parallel([new Effect.Opacity(o.element,{sync:true,to:1,from:0,transition:d.opacityTransition}),new Effect.Move(o.element,{x:g,y:f,sync:true,transition:d.moveTransition}),new Effect.Scale(o.element,100,{scaleMode:{originalHeight:l.height,originalWidth:l.width},sync:true,scaleFrom:window.opera?1:0,transition:d.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(p){p.effects[0].element.setStyle({height:\"0px\"}).show()},afterFinishInternal:function(p){p.effects[0].element.undoClipping().undoPositioned().setStyle(b)}},d))}})};Effect.Shrink=function(e){e=$(e);var d=Object.extend({direction:\"center\",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var b={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()};var h=e.getDimensions();var g,f;switch(d.direction){case\"top-left\":g=f=0;break;case\"top-right\":g=h.width;f=0;break;case\"bottom-left\":g=0;f=h.height;break;case\"bottom-right\":g=h.width;f=h.height;break;case\"center\":g=h.width/2;f=h.height/2;break}return new Effect.Parallel([new Effect.Opacity(e,{sync:true,to:0,from:1,transition:d.opacityTransition}),new Effect.Scale(e,window.opera?1:0,{sync:true,transition:d.scaleTransition,restoreAfterFinish:true}),new Effect.Move(e,{x:g,y:f,sync:true,transition:d.moveTransition})],Object.extend({beforeStartInternal:function(l){l.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(l){l.effects[0].element.hide().undoClipping().undoPositioned().setStyle(b)}},d))};Effect.Pulsate=function(e){e=$(e);var d=arguments[1]||{},b=e.getInlineOpacity(),g=d.transition||Effect.Transitions.linear,f=function(h){return 1-g((-Math.cos((h*(d.pulses||5)*2)*Math.PI)/2)+0.5)};return new Effect.Opacity(e,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(h){h.element.setStyle({opacity:b})}},d),{transition:f}))};Effect.Fold=function(d){d=$(d);var b={top:d.style.top,left:d.style.left,width:d.style.width,height:d.style.height};d.makeClipping();return new Effect.Scale(d,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(e){new Effect.Scale(d,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(f){f.element.hide().undoClipping().setStyle(b)}})}},arguments[1]||{}))};Effect.Morph=Class.create(Effect.Base,{initialize:function(e){this.element=$(e);if(!this.element){throw (Effect._elementDoesNotExistError)}var b=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(b.style)){this.style=$H(b.style)}else{if(b.style.include(\":\")){this.style=b.style.parseStyle()}else{this.element.addClassName(b.style);this.style=$H(this.element.getStyles());this.element.removeClassName(b.style);var d=this.element.getStyles();this.style=this.style.reject(function(f){return f.value==d[f.key]});b.afterFinishInternal=function(f){f.element.addClassName(f.options.style);f.transforms.each(function(g){f.element.style[g.style]=\"\"})}}}this.start(b)},setup:function(){function b(d){if(!d||[\"rgba(0, 0, 0, 0)\",\"transparent\"].include(d)){d=\"#ffffff\"}d=d.parseColor();return $R(0,2).map(function(e){return parseInt(d.slice(e*2+1,e*2+3),16)})}this.transforms=this.style.map(function(l){var h=l[0],g=l[1],f=null;if(g.parseColor(\"#zzzzzz\")!=\"#zzzzzz\"){g=g.parseColor();f=\"color\"}else{if(h==\"opacity\"){g=parseFloat(g);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}}else{if(Element.CSS_LENGTH.test(g)){var e=g.match(/^([\\+\\-]?[0-9\\.]+)(.*)$/);g=parseFloat(e[1]);f=(e.length==3)?e[2]:null}}}var d=this.element.getStyle(h);return{style:h.camelize(),originalValue:f==\"color\"?b(d):parseFloat(d||0),targetValue:f==\"color\"?b(g):g,unit:f}}.bind(this)).reject(function(d){return((d.originalValue==d.targetValue)||(d.unit!=\"color\"&&(isNaN(d.originalValue)||isNaN(d.targetValue))))})},update:function(b){var f={},d,e=this.transforms.length;while(e--){f[(d=this.transforms[e]).style]=d.unit==\"color\"?\"#\"+(Math.round(d.originalValue[0]+(d.targetValue[0]-d.originalValue[0])*b)).toColorPart()+(Math.round(d.originalValue[1]+(d.targetValue[1]-d.originalValue[1])*b)).toColorPart()+(Math.round(d.originalValue[2]+(d.targetValue[2]-d.originalValue[2])*b)).toColorPart():(d.originalValue+(d.targetValue-d.originalValue)*b).toFixed(3)+(d.unit===null?\"\":d.unit)}this.element.setStyle(f,true)}});Effect.Transform=Class.create({initialize:function(b){this.tracks=[];this.options=arguments[1]||{};this.addTracks(b)},addTracks:function(b){b.each(function(d){d=$H(d);var e=d.values().first();this.tracks.push($H({ids:d.keys().first(),effect:Effect.Morph,options:{style:e}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(b){var f=b.get(\"ids\"),e=b.get(\"effect\"),d=b.get(\"options\");var g=[$(f)||$$(f)].flatten();return g.map(function(h){return new e(h,Object.extend({sync:true},d))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w(\"backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex\");Element.CSS_LENGTH=/^(([\\+\\-]?[0-9\\.]+)(em|ex|px|in|cm|mm|pt|pc|\\%))|0$/;String.__parseStyleElement=document.createElement(\"div\");String.prototype.parseStyle=function(){var d,b=$H();if(Prototype.Browser.WebKit){d=new Element(\"div\",{style:this}).style}else{String.__parseStyleElement.innerHTML='<div style=\"'+this+'\"></div>';d=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(e){if(d[e]){b.set(e,d[e])}});if(Prototype.Browser.IE&&this.include(\"opacity\")){b.set(\"opacity\",this.match(/opacity:\\s*((?:0|1)?(?:\\.\\d*)?)/)[1])}return b};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(d){var b=document.defaultView.getComputedStyle($(d),null);return Element.CSS_PROPERTIES.inject({},function(e,f){e[f]=b[f];return e})}}else{Element.getStyles=function(d){d=$(d);var b=d.currentStyle,e;e=Element.CSS_PROPERTIES.inject({},function(f,g){f[g]=b[g];return f});if(!e.opacity){e.opacity=d.getOpacity()}return e}}Effect.Methods={morph:function(b,d){b=$(b);new Effect.Morph(b,Object.extend({style:d},arguments[2]||{}));return b},visualEffect:function(e,g,d){e=$(e);var f=g.dasherize().camelize(),b=f.charAt(0).toUpperCase()+f.substring(1);new Effect[b](e,d);return e},highlight:function(d,b){d=$(d);new Effect.Highlight(d,b);return d}};$w(\"fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut\").each(function(b){Effect.Methods[b]=function(e,d){e=$(e);Effect[b.charAt(0).toUpperCase()+b.substring(1)](e,d);return e}});$w(\"getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles\").each(function(b){Effect.Methods[b]=Element[b]});Element.addMethods(Effect.Methods);function validateCreditCard(e){var d=\"0123456789\";var b=\"\";for(i=0;i<e.length;i++){x=e.charAt(i);if(d.indexOf(x,0)!=-1){b+=x}}j=b.length/2;k=Math.floor(j);m=Math.ceil(j)-k;c=0;for(i=0;i<k;i++){a=b.charAt(i*2+m)*2;c+=a>9?Math.floor(a/10+a%10):a}for(i=0;i<k+m;i++){c+=b.charAt(i*2+1-m)*1}return(c%10==0)}var Validator=Class.create();Validator.prototype={initialize:function(e,d,f,b){if(typeof f==\"function\"){this.options=$H(b);this._test=f}else{this.options=$H(f);this._test=function(){return true}}this.error=d||\"Validation failed.\";this.className=e},test:function(b,d){return(this._test(b,d)&&this.options.all(function(e){return Validator.methods[e.key]?Validator.methods[e.key](b,d,e.value):true}))}};Validator.methods={pattern:function(b,e,d){return Validation.get(\"IsEmpty\").test(b)||d.test(b)},minLength:function(b,e,d){return b.length>=d},maxLength:function(b,e,d){return b.length<=d},min:function(b,e,d){return b>=parseFloat(d)},max:function(b,e,d){return b<=parseFloat(d)},notOneOf:function(b,e,d){return $A(d).all(function(f){return b!=f})},oneOf:function(b,e,d){return $A(d).any(function(f){return b==f})},is:function(b,e,d){return b==d},isNot:function(b,e,d){return b!=d},equalToField:function(b,e,d){return b==$F(d)},notEqualToField:function(b,e,d){return b!=$F(d)},include:function(b,e,d){return $A(d).all(function(f){return Validation.get(f).test(b,e)})}};var Validation=Class.create();Validation.defaultOptions={onSubmit:true,stopOnFirst:false,immediate:false,focusOnError:true,useTitles:false,addClassNameToContainer:false,containerClassName:\".input-box\",onFormValidate:function(b,d){},onElementValidate:function(b,d){}};Validation.prototype={initialize:function(d,b){this.form=$(d);if(!this.form){return}this.options=Object.extend({onSubmit:Validation.defaultOptions.onSubmit,stopOnFirst:Validation.defaultOptions.stopOnFirst,immediate:Validation.defaultOptions.immediate,focusOnError:Validation.defaultOptions.focusOnError,useTitles:Validation.defaultOptions.useTitles,onFormValidate:Validation.defaultOptions.onFormValidate,onElementValidate:Validation.defaultOptions.onElementValidate},b||{});if(this.options.onSubmit){Event.observe(this.form,\"submit\",this.onSubmit.bind(this),false)}if(this.options.immediate){Form.getElements(this.form).each(function(e){if(e.tagName.toLowerCase()==\"select\"){Event.observe(e,\"blur\",this.onChange.bindAsEventListener(this))}if(e.type.toLowerCase()==\"radio\"||e.type.toLowerCase()==\"checkbox\"){Event.observe(e,\"click\",this.onChange.bindAsEventListener(this))}else{Event.observe(e,\"change\",this.onChange.bindAsEventListener(this))}},this)}},onChange:function(b){Validation.isOnChange=true;Validation.validate(Event.element(b),{useTitle:this.options.useTitles,onElementValidate:this.options.onElementValidate});Validation.isOnChange=false},onSubmit:function(b){if(!this.validate()){Event.stop(b)}},validate:function(){var b=false;var d=this.options.useTitles;var g=this.options.onElementValidate;try{if(this.options.stopOnFirst){b=Form.getElements(this.form).all(function(e){if(e.hasClassName(\"local-validation\")&&!this.isElementInForm(e,this.form)){return true}return Validation.validate(e,{useTitle:d,onElementValidate:g})},this)}else{b=Form.getElements(this.form).collect(function(e){if(e.hasClassName(\"local-validation\")&&!this.isElementInForm(e,this.form)){return true}if(e.hasClassName(\"validation-disabled\")){return true}return Validation.validate(e,{useTitle:d,onElementValidate:g})},this).all()}}catch(f){}if(!b&&this.options.focusOnError){try{Form.getElements(this.form).findAll(function(e){return $(e).hasClassName(\"validation-failed\")}).first().focus()}catch(f){}}this.options.onFormValidate(b,this.form);return b},reset:function(){Form.getElements(this.form).each(Validation.reset)},isElementInForm:function(e,d){var b=e.up(\"form\");if(b==d){return true}return false}};Object.extend(Validation,{validate:function(e,b){b=Object.extend({useTitle:false,onElementValidate:function(f,g){}},b||{});e=$(e);var d=$w(e.className);return result=d.all(function(f){var g=Validation.test(f,e,b.useTitle);b.onElementValidate(g,e);return g})},insertAdvice:function(f,d){var b=$(f).up(\".field-row\");if(b){Element.insert(b,{after:d})}else{if(f.up(\"td.value\")){f.up(\"td.value\").insert({bottom:d})}else{if(f.advaiceContainer&&$(f.advaiceContainer)){$(f.advaiceContainer).update(d)}else{switch(f.type.toLowerCase()){case\"checkbox\":case\"radio\":var e=f.parentNode;if(e){Element.insert(e,{bottom:d})}else{Element.insert(f,{after:d})}break;default:Element.insert(f,{after:d})}}}}},showAdvice:function(e,d,b){if(!e.advices){e.advices=new Hash()}else{e.advices.each(function(f){if(!d||f.value.id!=d.id){this.hideAdvice(e,f.value)}}.bind(this))}e.advices.set(b,d);if(typeof Effect==\"undefined\"){d.style.display=\"block\"}else{if(!d._adviceAbsolutize){new Effect.Appear(d,{duration:1})}else{Position.absolutize(d);d.show();d.setStyle({top:d._adviceTop,left:d._adviceLeft,width:d._adviceWidth,\"z-index\":1000});d.addClassName(\"advice-absolute\")}}},hideAdvice:function(d,b){if(b!=null){new Effect.Fade(b,{duration:1,afterFinishInternal:function(){b.hide()}})}},updateCallback:function(elm,status){if(typeof elm.callbackFunction!=\"undefined\"){eval(elm.callbackFunction+\"('\"+elm.id+\"','\"+status+\"')\")}},ajaxError:function(g,f){var e=\"validate-ajax\";var d=Validation.getAdvice(e,g);if(d==null){d=this.createAdvice(e,g,false,f)}this.showAdvice(g,d,\"validate-ajax\");this.updateCallback(g,\"failed\");g.addClassName(\"validation-failed\");g.addClassName(\"validate-ajax\");if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=\"\"){var b=g.up(Validation.defaultOptions.containerClassName);if(b&&this.allowContainerClassName(g)){b.removeClassName(\"validation-passed\");b.addClassName(\"validation-error\")}}},allowContainerClassName:function(b){if(b.type==\"radio\"||b.type==\"checkbox\"){return b.hasClassName(\"change-container-classname\")}return true},test:function(g,o,l){var d=Validation.get(g);var n=\"__advice\"+g.camelize();try{if(Validation.isVisible(o)&&!d.test($F(o),o)){var f=Validation.getAdvice(g,o);if(f==null){f=this.createAdvice(g,o,l)}this.showAdvice(o,f,g);this.updateCallback(o,\"failed\");o[n]=1;if(!o.advaiceContainer){o.removeClassName(\"validation-passed\");o.addClassName(\"validation-failed\")}if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=\"\"){var b=o.up(Validation.defaultOptions.containerClassName);if(b&&this.allowContainerClassName(o)){b.removeClassName(\"validation-passed\");b.addClassName(\"validation-error\")}}return false}else{var f=Validation.getAdvice(g,o);this.hideAdvice(o,f);this.updateCallback(o,\"passed\");o[n]=\"\";o.removeClassName(\"validation-failed\");o.addClassName(\"validation-passed\");if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=\"\"){var b=o.up(Validation.defaultOptions.containerClassName);if(b&&!b.down(\".validation-failed\")&&this.allowContainerClassName(o)){if(!Validation.get(\"IsEmpty\").test(o.value)||!this.isVisible(o)){b.addClassName(\"validation-passed\")}else{b.removeClassName(\"validation-passed\")}b.removeClassName(\"validation-error\")}}return true}}catch(h){throw (h)}},isVisible:function(b){while(b.tagName!=\"BODY\"){if(!$(b).visible()){return false}b=b.parentNode}return true},getAdvice:function(b,d){return $(\"advice-\"+b+\"-\"+Validation.getElmID(d))||$(\"advice-\"+Validation.getElmID(d))},createAdvice:function(e,n,l,d){var b=Validation.get(e);var h=l?((n&&n.title)?n.title:b.error):b.error;if(d){h=d}if(jQuery.mage.__){h=jQuery.mage.__(h)}advice='<div class=\"validation-advice\" id=\"advice-'+e+\"-\"+Validation.getElmID(n)+'\" style=\"display:none\">'+h+\"</div>\";Validation.insertAdvice(n,advice);advice=Validation.getAdvice(e,n);if($(n).hasClassName(\"absolute-advice\")){var g=$(n).getDimensions();var f=Position.cumulativeOffset(n);advice._adviceTop=(f[1]+g.height)+\"px\";advice._adviceLeft=(f[0])+\"px\";advice._adviceWidth=(g.width)+\"px\";advice._adviceAbsolutize=true}return advice},getElmID:function(b){return b.id?b.id:b.name},reset:function(d){d=$(d);var b=$w(d.className);b.each(function(g){var h=\"__advice\"+g.camelize();if(d[h]){var f=Validation.getAdvice(g,d);if(f){f.hide()}d[h]=\"\"}d.removeClassName(\"validation-failed\");d.removeClassName(\"validation-passed\");if(Validation.defaultOptions.addClassNameToContainer&&Validation.defaultOptions.containerClassName!=\"\"){var e=d.up(Validation.defaultOptions.containerClassName);if(e){e.removeClassName(\"validation-passed\");e.removeClassName(\"validation-error\")}}})},add:function(f,e,g,d){var b={};b[f]=new Validator(f,e,g,d);Object.extend(Validation.methods,b)},addAllThese:function(b){var d={};$A(b).each(function(e){d[e[0]]=new Validator(e[0],e[1],e[2],(e.length>3?e[3]:{}))});Object.extend(Validation.methods,d)},get:function(b){return Validation.methods[b]?Validation.methods[b]:Validation.methods._LikeNoIDIEverSaw_},methods:{_LikeNoIDIEverSaw_:new Validator(\"_LikeNoIDIEverSaw_\",\"\",{})}});Validation.add(\"IsEmpty\",\"\",function(b){return(b==\"\"||(b==null)||(b.length==0)||/^\\s+$/.test(b))});Validation.addAllThese([[\"validate-no-html-tags\",\"HTML tags are not allowed\",function(b){return !/<(\\/)?\\w+/.test(b)}],[\"validate-select\",\"Please select an option.\",function(b){return((b!=\"none\")&&(b!=null)&&(b.length!=0))}],[\"required-entry\",\"This is a required field.\",function(b){return !Validation.get(\"IsEmpty\").test(b)}],[\"validate-number\",\"Please enter a valid number in this field.\",function(b){return Validation.get(\"IsEmpty\").test(b)||(!isNaN(parseNumber(b))&&/^\\s*-?\\d*(\\.\\d*)?\\s*$/.test(b))}],[\"validate-number-range\",\"The value is not within the specified range.\",function(e,g){if(Validation.get(\"IsEmpty\").test(e)){return true}var f=parseNumber(e);if(isNaN(f)){return false}var d=/^number-range-(-?[\\d.,]+)?-(-?[\\d.,]+)?$/,b=true;$w(g.className).each(function(l){var h=d.exec(l);if(h){b=b&&(h[1]==null||h[1]==\"\"||f>=parseNumber(h[1]))&&(h[2]==null||h[2]==\"\"||f<=parseNumber(h[2]))}});return b}],[\"validate-digits\",\"Please use numbers only in this field. Please avoid spaces or other characters such as dots or commas.\",function(b){return Validation.get(\"IsEmpty\").test(b)||!/[^\\d]/.test(b)}],[\"validate-digits-range\",\"The value is not within the specified range.\",function(e,g){if(Validation.get(\"IsEmpty\").test(e)){return true}var f=parseNumber(e);if(isNaN(f)){return false}var d=/^digits-range-(-?\\d+)?-(-?\\d+)?$/,b=true;$w(g.className).each(function(l){var h=d.exec(l);if(h){b=b&&(h[1]==null||h[1]==\"\"||f>=parseNumber(h[1]))&&(h[2]==null||h[2]==\"\"||f<=parseNumber(h[2]))}});return b}],[\"validate-range\",\"The value is not within the specified range.\",function(f,l){var g,h;if(Validation.get(\"IsEmpty\").test(f)){return true}else{if(Validation.get(\"validate-digits\").test(f)){g=h=parseNumber(f)}else{var e=/^(-?\\d+)?-(-?\\d+)?$/.exec(f);if(e){g=parseNumber(e[1]);h=parseNumber(e[2]);if(g>h){return false}}else{return false}}}var d=/^range-(-?\\d+)?-(-?\\d+)?$/,b=true;$w(l.className).each(function(n){var q=d.exec(n);if(q){var p=parseNumber(q[1]);var o=parseNumber(q[2]);b=b&&(isNaN(p)||g>=p)&&(isNaN(o)||h<=o)}});return b}],[\"validate-alpha\",\"Please use letters only (a-z or A-Z) in this field.\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^[a-zA-Z]+$/.test(b)}],[\"validate-code\",\"Please use only letters (a-z), numbers (0-9) or underscore (_) in this field, and the first character should be a letter.\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^[a-z]+[a-z0-9_]+$/.test(b)}],[\"validate-alphanum\",\"Please use only letters (a-z or A-Z) or numbers (0-9) in this field. No spaces or other characters are allowed.\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^[a-zA-Z0-9]+$/.test(b)}],[\"validate-alphanum-with-spaces\",\"Please use only letters (a-z or A-Z), numbers (0-9) or spaces only in this field.\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^[a-zA-Z0-9 ]+$/.test(b)}],[\"validate-street\",'Please use only letters (a-z or A-Z), numbers (0-9), spaces and \"#\" in this field.',function(b){return Validation.get(\"IsEmpty\").test(b)||/^[ \\w]{3,}([A-Za-z]\\.)?([ \\w]*\\#\\d+)?(\\r\\n| )[ \\w]{3,}/.test(b)}],[\"validate-phoneStrict\",\"Please enter a valid phone number (Ex: 123-456-7890).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^(\\()?\\d{3}(\\))?(-|\\s)?\\d{3}(-|\\s)\\d{4}$/.test(b)}],[\"validate-phoneLax\",\"Please enter a valid phone number (Ex: 123-456-7890).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^((\\d[-. ]?)?((\\(\\d{3}\\))|\\d{3}))?[-. ]?\\d{3}[-. ]?\\d{4}$/.test(b)}],[\"validate-fax\",\"Please enter a valid fax number (Ex: 123-456-7890).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^(\\()?\\d{3}(\\))?(-|\\s)?\\d{3}(-|\\s)\\d{4}$/.test(b)}],[\"validate-date\",\"Please enter a valid date.\",function(b){var d=new Date(b);return Validation.get(\"IsEmpty\").test(b)||!isNaN(d)}],[\"validate-date-range\",\"Make sure the To Date is later than or the same as the From Date.\",function(e,h){var d=/\\bdate-range-(\\w+)-(\\w+)\\b/.exec(h.className);if(!d||d[2]==\"to\"||Validation.get(\"IsEmpty\").test(e)){return true}var f=new Date().getFullYear()+\"\";var b=function(l){l=l.split(/[.\\/]/);if(l[2]&&l[2].length<4){l[2]=f.substr(0,l[2].length)+l[2]}return new Date(l.join(\"/\")).getTime()};var g=Element.select(h.form,\".validate-date-range.date-range-\"+d[1]+\"-to\");return !g.length||Validation.get(\"IsEmpty\").test(g[0].value)||b(e)<=b(g[0].value)}],[\"validate-email\",\"Please enter a valid email address (Ex: johndoe@domain.com).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^([a-z0-9,!\\#\\$%&'\\*\\+\\/=\\?\\^_`\\{\\|\\}~-]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z0-9,!\\#\\$%&'\\*\\+\\/=\\?\\^_`\\{\\|\\}~-]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*@([a-z0-9-]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z0-9-]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*\\.(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]){2,})$/i.test(b)}],[\"validate-emailSender\",\"Please use only visible characters and spaces.\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^[\\S ]+$/.test(b)}],[\"validate-password\",\"Please enter 6 or more characters. Leading or trailing spaces will be ignored.\",function(b){var d=b.strip();return !(d.length>0&&d.length<6)}],[\"validate-admin-password\",\"Please enter 7 or more characters, using both numeric and alphabetic.\",function(b){var d=b.strip();if(0==d.length){return true}if(!(/[a-z]/i.test(b))||!(/[0-9]/.test(b))){return false}return !(d.length<7)}],[\"validate-cpassword\",\"Please make sure your passwords match.\",function(b){var d=$(\"confirmation\")?$(\"confirmation\"):$$(\".validate-cpassword\")[0];var g=false;if($(\"password\")){g=$(\"password\")}var h=$$(\".validate-password\");for(var e=0;e<h.size();e++){var f=h[e];if(f.up(\"form\").id==d.up(\"form\").id){g=f}}if($$(\".validate-admin-password\").size()){g=$$(\".validate-admin-password\")[0]}return(g.value==d.value)}],[\"validate-both-passwords\",\"Please make sure your passwords match.\",function(e,d){var b=$(d.form[d.name==\"password\"?\"confirmation\":\"password\"]),f=d.value==b.value;if(f&&b.hasClassName(\"validation-failed\")){Validation.test(this.className,b)}return b.value==\"\"||f}],[\"validate-url\",\"Please enter a valid URL. Protocol is required (http://, https:// or ftp://)\",function(b){b=(b||\"\").replace(/^\\s+/,\"\").replace(/\\s+$/,\"\");return Validation.get(\"IsEmpty\").test(b)||/^(http|https|ftp):\\/\\/(([A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))(\\.[A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))*)(:(\\d+))?(\\/[A-Z0-9~](([A-Z0-9_~-]|\\.)*[A-Z0-9~]|))*\\/?(.*)?$/i.test(b)}],[\"validate-clean-url\",'Please enter a valid URL (Ex: \"http://www.example.com\" or \"www.example.com\").',function(b){return Validation.get(\"IsEmpty\").test(b)||/^(http|https|ftp):\\/\\/(([A-Z0-9][A-Z0-9_-]*)(\\.[A-Z0-9][A-Z0-9_-]*)+.(com|org|net|dk|at|us|tv|info|uk|co.uk|biz|se)$)(:(\\d+))?\\/?/i.test(b)||/^(www)((\\.[A-Z0-9][A-Z0-9_-]*)+.(com|org|net|dk|at|us|tv|info|uk|co.uk|biz|se)$)(:(\\d+))?\\/?/i.test(b)}],[\"validate-identifier\",'Please enter a valid URL Key (Ex: \"example-page\", \"example-page.html\" or \"anotherlevel/example-page\").',function(b){return Validation.get(\"IsEmpty\").test(b)||/^[a-z0-9][a-z0-9_\\/-]+(\\.[a-z0-9_-]+)?$/.test(b)}],[\"validate-xml-identifier\",\"Please enter a valid XML-identifier (Ex: something_1, block5, id-4).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^[A-Z][A-Z0-9_\\/-]*$/i.test(b)}],[\"validate-ssn\",\"Please enter a valid social security number (Ex: 123-45-6789).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^\\d{3}-?\\d{2}-?\\d{4}$/.test(b)}],[\"validate-zip-us\",\"Please enter a valid zip code (Ex: 90602 or 90602-1234).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/(^\\d{5}$)|(^\\d{5}-\\d{4}$)/.test(b)}],[\"validate-zip-international\",\"Please enter a valid zip code.\",function(b){return true}],[\"validate-date-au\",'Please use this date format: dd/mm/yyyy (Ex: \"17/03/2006\" for the 17th of March, 2006).',function(b){if(Validation.get(\"IsEmpty\").test(b)){return true}var e=/^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/;if(!e.test(b)){return false}var f=new Date(b.replace(e,\"$2/$1/$3\"));return(parseInt(RegExp.$2,10)==(1+f.getMonth()))&&(parseInt(RegExp.$1,10)==f.getDate())&&(parseInt(RegExp.$3,10)==f.getFullYear())}],[\"validate-currency-dollar\",\"Please enter a valid $ amount (Ex: $100.00).\",function(b){return Validation.get(\"IsEmpty\").test(b)||/^\\$?\\-?([1-9]{1}[0-9]{0,2}(\\,[0-9]{3})*(\\.[0-9]{0,2})?|[1-9]{1}\\d*(\\.[0-9]{0,2})?|0(\\.[0-9]{0,2})?|(\\.[0-9]{1,2})?)$/.test(b)}],[\"validate-one-required\",\"Please select one of the options above.\",function(b,f){var e=f.parentNode;var d=e.getElementsByTagName(\"INPUT\");return $A(d).any(function(g){return $F(g)})}],[\"validate-one-required-by-name\",\"Please select one of the options.\",function(d,g){var b=$$('input[name=\"'+g.name.replace(/([\\\\\"])/g,\"\\\\$1\")+'\"]');var e=1;for(var f=0;f<b.length;f++){if((b[f].type==\"checkbox\"||b[f].type==\"radio\")&&b[f].checked==true){e=0}if(Validation.isOnChange&&(b[f].type==\"checkbox\"||b[f].type==\"radio\")){Validation.reset(b[f])}}if(e==0){return true}else{return false}}],[\"validate-not-negative-number\",\"Please enter a number 0 or greater in this field.\",function(b){if(Validation.get(\"IsEmpty\").test(b)){return true}b=parseNumber(b);return !isNaN(b)&&b>=0}],[\"validate-zero-or-greater\",\"Please enter a number 0 or greater in this field.\",function(b){return Validation.get(\"validate-not-negative-number\").test(b)}],[\"validate-greater-than-zero\",\"Please enter a number greater than 0 in this field.\",function(b){if(Validation.get(\"IsEmpty\").test(b)){return true}b=parseNumber(b);return !isNaN(b)&&b>0}],[\"validate-state\",\"Please select State/Province.\",function(b){return(b!=0||b==\"\")}],[\"validate-new-password\",\"Please enter 6 or more characters. Leading or trailing spaces will be ignored.\",function(b){if(!Validation.get(\"validate-password\").test(b)){return false}if(Validation.get(\"IsEmpty\").test(b)&&b!=\"\"){return false}return true}],[\"validate-cc-number\",\"Please enter a valid credit card number.\",function(b,e){var d=$(e.id.substr(0,e.id.indexOf(\"_cc_number\"))+\"_cc_type\");if(d&&typeof Validation.creditCartTypes.get(d.value)!=\"undefined\"&&Validation.creditCartTypes.get(d.value)[2]==false){if(!Validation.get(\"IsEmpty\").test(b)&&Validation.get(\"validate-digits\").test(b)){return true}else{return false}}return validateCreditCard(b)}],[\"validate-cc-type\",\"Credit card number does not match credit card type.\",function(d,g){g.value=removeDelimiters(g.value);d=removeDelimiters(d);var f=$(g.id.substr(0,g.id.indexOf(\"_cc_number\"))+\"_cc_type\");if(!f){return true}var e=f.value;if(typeof Validation.creditCartTypes.get(e)==\"undefined\"){return false}if(Validation.creditCartTypes.get(e)[0]==false){return true}var b=\"\";Validation.creditCartTypes.each(function(h){if(h.value[0]&&d.match(h.value[0])){b=h.key;throw $break}});if(b!=e){return false}if(f.hasClassName(\"validation-failed\")&&Validation.isOnChange){Validation.validate(f)}return true}],[\"validate-cc-type-select\",\"Card type does not match credit card number.\",function(d,e){var b=$(e.id.substr(0,e.id.indexOf(\"_cc_type\"))+\"_cc_number\");if(Validation.isOnChange&&Validation.get(\"IsEmpty\").test(b.value)){return true}if(Validation.get(\"validate-cc-type\").test(b.value,b)){Validation.validate(b)}return Validation.get(\"validate-cc-type\").test(b.value,b)}],[\"validate-cc-exp\",\"Incorrect credit card expiration date.\",function(b,l){var h=b;var g=$(l.id.substr(0,l.id.indexOf(\"_expiration\"))+\"_expiration_yr\").value;var f=new Date();var e=f.getMonth()+1;var d=f.getFullYear();if(h<e&&g==d){return false}return true}],[\"validate-cc-cvn\",\"Please enter a valid credit card verification number.\",function(b,g){var f=$(g.id.substr(0,g.id.indexOf(\"_cc_cid\"))+\"_cc_type\");if(!f){return true}var d=f.value;if(typeof Validation.creditCartTypes.get(d)==\"undefined\"){return false}var e=Validation.creditCartTypes.get(d)[1];if(b.match(e)){return true}return false}],[\"validate-ajax\",\"\",function(b,d){return true}],[\"validate-data\",\"Please use only letters (a-z or A-Z), numbers (0-9) or underscore (_) in this field, and the first character should be a letter.\",function(b){if(b!=\"\"&&b){return/^[A-Za-z]+[A-Za-z0-9_]+$/.test(b)}return true}],[\"validate-css-length\",\"Please input a valid CSS-length (Ex: 100px, 77pt, 20em, .5ex or 50%).\",function(b){if(b!=\"\"&&b){return/^[0-9\\.]+(px|pt|em|ex|%)?$/.test(b)&&(!(/\\..*\\./.test(b)))&&!(/\\.$/.test(b))}return true}],[\"validate-length\",\"Text length does not meet the specified text range.\",function(d,g){var e=new RegExp(/^maximum-length-[0-9]+$/);var f=new RegExp(/^minimum-length-[0-9]+$/);var b=true;$w(g.className).each(function(l,h){if(l.match(e)&&b){var n=l.split(\"-\")[2];b=(d.length<=n)}if(l.match(f)&&b&&!Validation.get(\"IsEmpty\").test(d)){var n=l.split(\"-\")[2];b=(d.length>=n)}});return b}],[\"validate-percents\",\"Please enter a number lower than 100.\",{max:100}],[\"required-file\",\"Please select a file.\",function(d,e){var b=!Validation.get(\"IsEmpty\").test(d);if(b===false){ovId=e.id+\"_value\";if($(ovId)){b=!Validation.get(\"IsEmpty\").test($(ovId).value)}}return b}],[\"validate-cc-ukss\",\"Please enter issue number or start date for switch/solo card type.\",function(o,g){var b;if(g.id.match(/(.)+_cc_issue$/)){b=g.id.indexOf(\"_cc_issue\")}else{if(g.id.match(/(.)+_start_month$/)){b=g.id.indexOf(\"_start_month\")}else{b=g.id.indexOf(\"_start_year\")}}var f=g.id.substr(0,b);var d=$(f+\"_cc_type\");if(!d){return true}var n=d.value;if([\"SS\",\"SM\",\"SO\"].indexOf(n)==-1){return true}$(f+\"_cc_issue\").advaiceContainer=$(f+\"_start_month\").advaiceContainer=$(f+\"_start_year\").advaiceContainer=$(f+\"_cc_type_ss_div\").down(\".adv-container\");var h=$(f+\"_cc_issue\").value;var l=$(f+\"_start_month\").value;var p=$(f+\"_start_year\").value;var e=(l&&p)?true:false;if(!e&&!h){return false}return true}]]);function removeDelimiters(b){b=b.replace(/\\s/g,\"\");b=b.replace(/\\-/g,\"\");return b}function parseNumber(b){if(typeof b!=\"string\"){return parseFloat(b)}var e=b.indexOf(\".\");var d=b.indexOf(\",\");if(e!=-1&&d!=-1){if(d>e){b=b.replace(\".\",\"\").replace(\",\",\".\")}else{b=b.replace(\",\",\"\")}}else{if(d!=-1){b=b.replace(\",\",\".\")}}return parseFloat(b)}Validation.creditCartTypes=$H({SO:[new RegExp(\"^(6334[5-9]([0-9]{11}|[0-9]{13,14}))|(6767([0-9]{12}|[0-9]{14,15}))$\"),new RegExp(\"^([0-9]{3}|[0-9]{4})?$\"),true],SM:[new RegExp(\"(^(5[0678])[0-9]{11,18}$)|(^(6[^05])[0-9]{11,18}$)|(^(601)[^1][0-9]{9,16}$)|(^(6011)[0-9]{9,11}$)|(^(6011)[0-9]{13,16}$)|(^(65)[0-9]{11,13}$)|(^(65)[0-9]{15,18}$)|(^(49030)[2-9]([0-9]{10}$|[0-9]{12,13}$))|(^(49033)[5-9]([0-9]{10}$|[0-9]{12,13}$))|(^(49110)[1-2]([0-9]{10}$|[0-9]{12,13}$))|(^(49117)[4-9]([0-9]{10}$|[0-9]{12,13}$))|(^(49118)[0-2]([0-9]{10}$|[0-9]{12,13}$))|(^(4936)([0-9]{12}$|[0-9]{14,15}$))\"),new RegExp(\"^([0-9]{3}|[0-9]{4})?$\"),true],VI:[new RegExp(\"^4[0-9]{12}([0-9]{3})?$\"),new RegExp(\"^[0-9]{3}$\"),true],MC:[new RegExp(\"^5[1-5][0-9]{14}$\"),new RegExp(\"^[0-9]{3}$\"),true],AE:[new RegExp(\"^3[47][0-9]{13}$\"),new RegExp(\"^[0-9]{4}$\"),true],DI:[new RegExp(\"^6(011|4[4-9][0-9]|5[0-9]{2})[0-9]{12}$\"),new RegExp(\"^[0-9]{3}$\"),true],JCB:[new RegExp(\"^(3[0-9]{15}|(2131|1800)[0-9]{11})$\"),new RegExp(\"^[0-9]{3,4}$\"),true],OT:[false,new RegExp(\"^([0-9]{3}|[0-9]{4})?$\"),false]});function popWin(d,e,b){var e=window.open(d,e,b);e.focus()}function setLocation(b){window.location.href=b}function setPLocation(d,b){if(b){window.opener.focus()}window.opener.location.href=d}function setLanguageCode(e,f){var b=window.location.href;var h=\"\",g;if(g=b.match(/\\#(.*)$/)){b=b.replace(/\\#(.*)$/,\"\");h=g[0]}if(b.match(/[?]/)){var d=/([?&]store=)[a-z0-9_]*/;if(b.match(d)){b=b.replace(d,\"$1\"+e)}else{b+=\"&store=\"+e}var d=/([?&]from_store=)[a-z0-9_]*/;if(b.match(d)){b=b.replace(d,\"\")}}else{b+=\"?store=\"+e}if(typeof(f)!=\"undefined\"){b+=\"&from_store=\"+f}b+=h;setLocation(b)}function decorateGeneric(h,e){var l=[\"odd\",\"even\",\"first\",\"last\"];var d={};var g=h.length;if(g){if(typeof(e)==\"undefined\"){e=l}if(!e.length){return}for(var b in l){d[l[b]]=false}for(var b in e){d[e[b]]=true}if(d.first){Element.addClassName(h[0],\"first\")}if(d.last){Element.addClassName(h[g-1],\"last\")}for(var f=0;f<g;f++){if((f+1)%2==0){if(d.even){Element.addClassName(h[f],\"even\")}}else{if(d.odd){Element.addClassName(h[f],\"odd\")}}}}}function decorateTable(h,e){var h=$(h);if(h){var b={tbody:false,\"tbody tr\":[\"odd\",\"even\",\"first\",\"last\"],\"thead tr\":[\"first\",\"last\"],\"tfoot tr\":[\"first\",\"last\"],\"tr td\":[\"last\"]};if(typeof(e)!=\"undefined\"){for(var d in e){b[d]=e[d]}}if(b.tbody){decorateGeneric(h.select(\"tbody\"),b.tbody)}if(b[\"tbody tr\"]){decorateGeneric(h.select(\"tbody tr\"),b[\"tbody tr\"])}if(b[\"thead tr\"]){decorateGeneric(h.select(\"thead tr\"),b[\"thead tr\"])}if(b[\"tfoot tr\"]){decorateGeneric(h.select(\"tfoot tr\"),b[\"tfoot tr\"])}if(b[\"tr td\"]){var g=h.select(\"tr\");if(g.length){for(var f=0;f<g.length;f++){decorateGeneric(g[f].getElementsByTagName(\"TD\"),b[\"tr td\"])}}}}}function decorateList(e,d){if($(e)){if(typeof(d)==\"undefined\"){var b=$(e).select(\"li\")}else{var b=$(e).childElements()}decorateGeneric(b,[\"odd\",\"even\",\"last\"])}}function decorateDataList(b){b=$(b);if(b){decorateGeneric(b.select(\"dt\"),[\"odd\",\"even\",\"last\"]);decorateGeneric(b.select(\"dd\"),[\"odd\",\"even\",\"last\"])}}function parseSidUrl(f,e){var d=f.indexOf(\"/?SID=\");var b=\"\";e=(e!=undefined)?e:\"\";if(d>-1){b=\"?\"+f.substring(d+2);f=f.substring(0,d+1)}return f+e+b}function formatCurrency(n,q,g){var l=isNaN(q.precision=Math.abs(q.precision))?2:q.precision;var v=isNaN(q.requiredPrecision=Math.abs(q.requiredPrecision))?2:q.requiredPrecision;l=v;var t=isNaN(q.integerRequired=Math.abs(q.integerRequired))?1:q.integerRequired;var p=q.decimalSymbol==undefined?\",\":q.decimalSymbol;var e=q.groupSymbol==undefined?\".\":q.groupSymbol;var d=q.groupLength==undefined?3:q.groupLength;var u=\"\";if(g==undefined||g==true){u=n<0?\"-\":(g?\"+\":\"\")}else{if(g==false){u=\"\"}}var h=parseInt(n=Math.abs(+n||0).toFixed(l))+\"\";var f=(h.length<t)?(t-h.length):0;while(f){h=\"0\"+h;f--}j=(j=h.length)>d?j%d:0;re=new RegExp(\"(\\\\d{\"+d+\"})(?=\\\\d)\",\"g\");var b=(j?h.substr(0,j)+e:\"\")+h.substr(j).replace(re,\"$1\"+e)+(l?p+Math.abs(n-h).toFixed(l).replace(/-/,0).slice(2):\"\");var o=\"\";if(q.pattern.indexOf(\"{sign}\")==-1){o=u+q.pattern}else{o=q.pattern.replace(\"{sign}\",u)}return o.replace(\"%s\",b).replace(/^\\s\\s*/,\"\").replace(/\\s\\s*$/,\"\")}function expandDetails(d,b){if(Element.hasClassName(d,\"show-details\")){$$(b).each(function(e){e.hide()});Element.removeClassName(d,\"show-details\")}else{$$(b).each(function(e){e.show()});Element.addClassName(d,\"show-details\")}}var isIE=navigator.appVersion.match(/MSIE/)==\"MSIE\";if(!window.Varien){var Varien=new Object()}Varien.showLoading=function(){var b=$(\"loading-process\");b&&b.show()};Varien.hideLoading=function(){var b=$(\"loading-process\");b&&b.hide()};Varien.GlobalHandlers={onCreate:function(){Varien.showLoading()},onComplete:function(){if(Ajax.activeRequestCount==0){Varien.hideLoading()}}};Ajax.Responders.register(Varien.GlobalHandlers);Varien.searchForm=Class.create();Varien.searchForm.prototype={initialize:function(d,e,b){this.form=$(d);this.field=$(e);this.emptyText=b;Event.observe(this.form,\"submit\",this.submit.bind(this));Event.observe(this.field,\"focus\",this.focus.bind(this));Event.observe(this.field,\"blur\",this.blur.bind(this));this.blur()},submit:function(b){if(this.field.value==this.emptyText||this.field.value==\"\"){Event.stop(b);return false}return true},focus:function(b){if(this.field.value==this.emptyText){this.field.value=\"\"}},blur:function(b){if(this.field.value==\"\"){this.field.value=this.emptyText}}};Varien.DateElement=Class.create();Varien.DateElement.prototype={initialize:function(b,d,f,e){if(b==\"id\"){this.day=$(d+\"day\");this.month=$(d+\"month\");this.year=$(d+\"year\");this.full=$(d+\"full\");this.advice=$(d+\"date-advice\")}else{if(b==\"container\"){this.day=d.day;this.month=d.month;this.year=d.year;this.full=d.full;this.advice=d.advice}else{return}}this.required=f;this.format=e;this.day.addClassName(\"validate-custom\");this.day.validate=this.validate.bind(this);this.month.addClassName(\"validate-custom\");this.month.validate=this.validate.bind(this);this.year.addClassName(\"validate-custom\");this.year.validate=this.validate.bind(this);this.setDateRange(false,false);this.year.setAttribute(\"autocomplete\",\"off\");this.advice.hide()},validate:function(){var l=false,o=parseInt(this.day.value,10)||0,f=parseInt(this.month.value,10)||0,h=parseInt(this.year.value,10)||0;if(this.day.value.strip().empty()&&this.month.value.strip().empty()&&this.year.value.strip().empty()){if(this.required){l=\"Please enter a date.\"}else{this.full.value=\"\"}}else{if(!o||!f||!h){l=\"Please enter a valid full date.\"}else{var d=new Date,n=0,e=null;d.setYear(h);d.setMonth(f-1);d.setDate(32);n=32-d.getDate();if(!n||n>31){n=31}if(o<1||o>n){e=\"day\";l=\"Please enter a valid day (1-%1).\"}else{if(f<1||f>12){e=\"month\";l=\"Please enter a valid month (1-12).\"}else{if(o%10==o){this.day.value=\"0\"+o}if(f%10==f){this.month.value=\"0\"+f}this.full.value=this.format.replace(/%[mb]/i,this.month.value).replace(/%[de]/i,this.day.value).replace(/%y/i,this.year.value);var b=this.month.value+\"/\"+this.day.value+\"/\"+this.year.value;var g=new Date(b);if(isNaN(g)){l=\"Please enter a valid date.\"}else{this.setFullDate(g)}}}var p=false;if(!l&&!this.validateData()){e=this.validateDataErrorType;p=this.validateDataErrorText;l=p}}}if(l!==false){if(jQuery.mage.__){l=jQuery.mage.__(l)}if(!p){this.advice.innerHTML=l.replace(\"%1\",n)}else{this.advice.innerHTML=this.errorTextModifier(l)}this.advice.show();return false}this.day.removeClassName(\"validation-failed\");this.month.removeClassName(\"validation-failed\");this.year.removeClassName(\"validation-failed\");this.advice.hide();return true},validateData:function(){var d=this.fullDate.getFullYear();var b=new Date;this.curyear=b.getFullYear();return(d>=1900&&d<=this.curyear)},validateDataErrorType:\"year\",validateDataErrorText:\"Please enter a valid year (1900-%1).\",errorTextModifier:function(b){return b.replace(\"%1\",this.curyear)},setDateRange:function(b,d){this.minDate=b;this.maxDate=d},setFullDate:function(b){this.fullDate=b}};Varien.DOB=Class.create();Varien.DOB.prototype={initialize:function(b,g,f){var e=$$(b)[0];var d={};d.day=Element.select(e,\".dob-day input\")[0];d.month=Element.select(e,\".dob-month input\")[0];d.year=Element.select(e,\".dob-year input\")[0];d.full=Element.select(e,\".dob-full input\")[0];d.advice=Element.select(e,\".validation-advice\")[0];new Varien.DateElement(\"container\",d,g,f)}};Varien.dateRangeDate=Class.create();Varien.dateRangeDate.prototype=Object.extend(new Varien.DateElement(),{validateData:function(){var b=true;if(this.minDate||this.maxValue){if(this.minDate){this.minDate=new Date(this.minDate);this.minDate.setHours(0);if(isNaN(this.minDate)){this.minDate=new Date(\"1/1/1900\")}b=b&&(this.fullDate>=this.minDate)}if(this.maxDate){this.maxDate=new Date(this.maxDate);this.minDate.setHours(0);if(isNaN(this.maxDate)){this.maxDate=new Date()}b=b&&(this.fullDate<=this.maxDate)}if(this.maxDate&&this.minDate){this.validateDataErrorText=\"Please enter a valid date between %s and %s\"}else{if(this.maxDate){this.validateDataErrorText=\"Please enter a valid date less than or equal to %s\"}else{if(this.minDate){this.validateDataErrorText=\"Please enter a valid date equal to or greater than %s\"}else{this.validateDataErrorText=\"\"}}}}return b},validateDataErrorText:\"Date should be between %s and %s\",errorTextModifier:function(b){if(this.minDate){b=b.sub(\"%s\",this.dateFormat(this.minDate))}if(this.maxDate){b=b.sub(\"%s\",this.dateFormat(this.maxDate))}return b},dateFormat:function(b){return(b.getMonth()+1)+\"/\"+b.getDate()+\"/\"+b.getFullYear()}});Varien.FileElement=Class.create();Varien.FileElement.prototype={initialize:function(b){this.fileElement=$(b);this.hiddenElement=$(b+\"_value\");this.fileElement.observe(\"change\",this.selectFile.bind(this))},selectFile:function(b){this.hiddenElement.value=this.fileElement.getValue()}};Validation.addAllThese([[\"validate-custom\",\" \",function(b,d){return d.validate()}]]);Element.addMethods({getInnerText:function(b){b=$(b);if(b.innerText&&!Prototype.Browser.Opera){return b.innerText}return b.innerHTML.stripScripts().unescapeHTML().replace(/[\\n\\r\\s]+/g,\" \").strip()}});function fireEvent(d,e){if(document.createEvent){var b=document.createEvent(\"HTMLEvents\");b.initEvent(e,true,true);return d.dispatchEvent(b)}else{var b=document.createEventObject();return d.fireEvent(\"on\"+e,b)}}function modulo(b,f){var e=f/10000;var d=b%f;if(Math.abs(d-f)<e||Math.abs(d)<e){d=0}return d}if((typeof Range!=\"undefined\")&&!Range.prototype.createContextualFragment){Range.prototype.createContextualFragment=function(b){var e=document.createDocumentFragment(),d=document.createElement(\"div\");e.appendChild(d);d.outerHTML=b;return e}}var byteConvert=function(b){if(isNaN(b)){return\"\"}var d=[\"bytes\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"];var f=Math.floor(Math.log(b)/Math.log(2));if(f<1){f=0}var e=Math.floor(f/10);b=b/Math.pow(2,10*e);if(b.toString().length>b.toFixed(2).toString().length){b=b.toFixed(2)}return b+\" \"+d[e]};var SessionError=Class.create();SessionError.prototype={initialize:function(b){this.errorText=b},toString:function(){return\"Session Error:\"+this.errorText}};Ajax.Request.addMethods({initialize:function($super,d,b){$super(b);this.transport=Ajax.getTransport();if(!d.match(new RegExp(\"[?&]isAjax=true\",\"\"))){d=d.match(new RegExp(\"\\\\?\",\"g\"))?d+\"&isAjax=true\":d+\"?isAjax=true\"}if(Object.isString(this.options.parameters)&&this.options.parameters.indexOf(\"form_key=\")==-1){this.options.parameters+=\"&\"+Object.toQueryString({form_key:FORM_KEY})}else{if(!this.options.parameters){this.options.parameters={form_key:FORM_KEY}}if(!this.options.parameters.form_key){this.options.parameters.form_key=FORM_KEY}}this.request(d)},respondToReadyState:function(b){var g=Ajax.Request.Events[b],d=new Ajax.Response(this);if(g==\"Complete\"){try{this._complete=true;if(d.responseText.isJSON()){var f=d.responseText.evalJSON();if(f.ajaxExpired&&f.ajaxRedirect){window.location.replace(f.ajaxRedirect);throw new SessionError(\"session expired\")}}(this.options[\"on\"+d.status]||this.options[\"on\"+(this.success()?\"Success\":\"Failure\")]||Prototype.emptyFunction)(d,d.headerJSON)}catch(h){this.dispatchException(h);if(h instanceof SessionError){return}}var l=d.getHeader(\"Content-type\");if(this.options.evalJS==\"force\"||(this.options.evalJS&&this.isSameOrigin()&&l&&l.match(/^\\s*(text|application)\\/(x-)?(java|ecma)script(;.*)?\\s*$/i))){this.evalResponse()}}try{(this.options[\"on\"+g]||Prototype.emptyFunction)(d,d.headerJSON);Ajax.Responders.dispatch(\"on\"+g,this,d,d.headerJSON)}catch(h){this.dispatchException(h)}if(g==\"Complete\"){this.transport.onreadystatechange=Prototype.emptyFunction}}});Ajax.Updater.respondToReadyState=Ajax.Request.respondToReadyState;var varienLoader=new Class.create();varienLoader.prototype={initialize:function(b){this.callback=false;this.cache=$H();this.caching=b||false;this.url=false},getCache:function(b){if(this.cache.get(b)){return this.cache.get(b)}return false},load:function(b,d,f){this.url=b;this.callback=f;if(this.caching){var e=this.getCache(b);if(e){this.processResult(e);return}}if(typeof(d.updaterId)!=\"undefined\"){new varienUpdater(d.updaterId,b,{evalScripts:true,onComplete:this.processResult.bind(this),onFailure:this._processFailure.bind(this)})}else{new Ajax.Request(b,{method:\"post\",parameters:d||{},onComplete:this.processResult.bind(this),onFailure:this._processFailure.bind(this)})}},_processFailure:function(b){location.href=BASE_URL},processResult:function(b){if(this.caching){this.cache.set(this.url,b)}if(this.callback){this.callback(b.responseText)}}};if(!window.varienLoaderHandler){var varienLoaderHandler=new Object()}varienLoaderHandler.handler={onCreate:function(b){if(b.options.loaderArea===false){return}jQuery(\"body\").trigger(\"processStart\")},onException:function(b){jQuery(\"body\").trigger(\"processStop\")},onComplete:function(b){jQuery(\"body\").trigger(\"processStop\")}};function setLoaderPosition(){var e=$(\"loading_mask_loader\");if(e&&Prototype.Browser.IE){var d=e.getDimensions();var f=document.viewport.getDimensions();var b=document.viewport.getScrollOffsets();e.style.left=Math.floor(f.width/2+b.left-d.width/2)+\"px\";e.style.top=Math.floor(f.height/2+b.top-d.height/2)+\"px\";e.style.position=\"absolute\"}}function toggleSelectsUnderBlock(f,b){if(Prototype.Browser.IE){var e=document.getElementsByTagName(\"select\");for(var d=0;d<e.length;d++){if(b){if(e[d].needShowOnSuccess){e[d].needShowOnSuccess=false;e[d].style.visibility=\"\"}}else{if(Element.visible(e[d])){e[d].style.visibility=\"hidden\";e[d].needShowOnSuccess=true}}}}}Ajax.Responders.register(varienLoaderHandler.handler);var varienUpdater=Class.create(Ajax.Updater,{updateContent:function($super,b){if(b.isJSON()){var d=b.evalJSON();if(d.ajaxExpired&&d.ajaxRedirect){window.location.replace(d.ajaxRedirect)}}else{$super(b)}}});function setLocation(b){window.location.href=b}function setElementDisable(d,b){if($(d)){$(d).disabled=b}}function toggleParentVis(b){b=$(b).parentNode;if(b.style.display==\"none\"){b.style.display=\"\"}else{b.style.display=\"none\"}}function toggleFieldsetVis(d){id=d;d=$(d);if(d.style.display==\"none\"){d.style.display=\"\"}else{d.style.display=\"none\"}d=d.parentNode.childElements();for(var b=0;b<d.length;b++){if(d[b].id!=undefined&&d[b].id==id&&d[(b-1)].classNames()==\"entry-edit-head\"){if(d[b-1].style.display==\"none\"){d[b-1].style.display=\"\"}else{d[b-1].style.display=\"none\"}}}}function toggleVis(b){b=$(b);if(b.style.display==\"none\"){b.style.display=\"\"}else{b.style.display=\"none\"}}function imagePreview(b){if($(b)){var d=window.open(\"\",\"preview\",\"width=400,height=400,resizable=1,scrollbars=1\");d.document.open();d.document.write('<body style=\"padding:0;margin:0\"><img src=\"'+$(b).src+'\" id=\"image_preview\"/></body>');d.document.close();Event.observe(d,\"load\",function(){var e=d.document.getElementById(\"image_preview\");d.resizeTo(e.width+40,e.height+80)})}}function checkByProductPriceType(b){if(b.id==\"price_type\"){this.productPriceType=b.value;return false}else{if(b.id==\"price\"&&this.productPriceType==0){return false}return true}}Event.observe(window,\"load\",function(){if($(\"price_default\")&&$(\"price_default\").checked){$(\"price\").disabled=\"disabled\"}});function toggleSeveralValueElements(f,e,b,d){if(e&&f){if(Object.prototype.toString.call(e)!=\"[object Array]\"){e=[e]}e.each(function(g){toggleValueElements(f,g,b,d)})}}function toggleValueElements(l,d,f,h){if(d&&l){var n=[l];if(typeof f!=\"undefined\"){if(Object.prototype.toString.call(f)!=\"[object Array]\"){f=[f]}for(var g=0;g<f.length;g++){n.push(f[g])}}var e=Element.select(d,[\"select\",\"input\",\"textarea\",\"button\",\"img\"]).filter(function(o){return(o.readAttribute(\"type\")!=\"hidden\")});var b=(h!=undefined?h:l.checked);e.each(function(p){if(checkByProductPriceType(p)){var o=n.length;while(o--&&p!=n[o]){}if(o!=-1){return}p.disabled=b;if(b){p.addClassName(\"disabled\")}else{p.removeClassName(\"disabled\")}if(p.nodeName.toLowerCase()==\"img\"){b?p.hide():p.show()}}})}}function submitAndReloadArea(e,d){if($(e)){var b=$(e).select(\"input\",\"select\",\"textarea\");var f=Form.serializeElements(b,true);d=d+(d.match(new RegExp(\"\\\\?\"))?\"&isAjax=true\":\"?isAjax=true\");new Ajax.Request(d,{parameters:$H(f),loaderArea:e,onSuccess:function(l){try{if(l.responseText.isJSON()){var g=l.responseText.evalJSON();if(g.error){alert(g.message)}if(g.ajaxExpired&&g.ajaxRedirect){setLocation(g.ajaxRedirect)}}else{$(e).update(l.responseText)}}catch(h){$(e).update(l.responseText)}}})}}function syncOnchangeValue(d,e){var b={baseElem:d,distElem:e};Event.observe(d,\"change\",function(){if($(this.baseElem)&&$(this.distElem)){$(this.distElem).value=$(this.baseElem).value}}.bind(b))}function updateElementAtCursor(e,f,g){if(g==undefined){g=window.self}if(document.selection){e.focus();sel=g.document.selection.createRange();sel.text=f}else{if(e.selectionStart||e.selectionStart==\"0\"){var d=e.selectionStart;var b=e.selectionEnd;e.value=e.value.substring(0,d)+f+e.value.substring(b,e.value.length)}else{e.value+=f}}}function firebugEnabled(){if(window.console&&window.console.firebug){return true}return false}function disableElement(b){b.disabled=true;b.addClassName(\"disabled\")}function enableElement(b){b.disabled=false;b.removeClassName(\"disabled\")}function disableElements(b){$$(\".\"+b).each(disableElement)}function enableElements(b){$$(\".\"+b).each(enableElement)}var Cookie={all:function(){var d=document.cookie.split(\";\");var b={};d.each(function(f,e){var g=f.strip().split(\"=\");b[unescape(g[0])]=unescape(g[1])});return b},read:function(d){var b=this.all();if(b[d]){return b[d]}return null},write:function(h,f,g){var b=\"\";if(g){var e=new Date();e.setTime(e.getTime()+(g*1000));b=\"; expires=\"+e.toGMTString()}var d=\"/\"+BASE_URL.split(\"/\").slice(3).join(\"/\");document.cookie=escape(h)+\"=\"+escape(f)+b+\"; path=\"+d},clear:function(b){this.write(b,\"\",-1)}};var Fieldset={cookiePrefix:\"fh-\",applyCollapse:function(b){if($(b+\"-state\")){collapsed=$(b+\"-state\").value==1?0:1}else{collapsed=$(b+\"-head\").collapsed}if(collapsed==1||collapsed===undefined){$(b+\"-head\").removeClassName(\"open\");if($(b+\"-head\").up(\".section-config\")){$(b+\"-head\").up(\".section-config\").removeClassName(\"active\")}$(b).hide()}else{$(b+\"-head\").addClassName(\"open\");if($(b+\"-head\").up(\".section-config\")){$(b+\"-head\").up(\".section-config\").addClassName(\"active\")}$(b).show()}},toggleCollapse:function(b,d){if($(b+\"-state\")){collapsed=$(b+\"-state\").value==1?0:1}else{collapsed=$(b+\"-head\").collapsed}if(collapsed==1||collapsed===undefined){if($(b+\"-state\")){$(b+\"-state\").value=1}$(b+\"-head\").collapsed=0}else{if($(b+\"-state\")){$(b+\"-state\").value=0}$(b+\"-head\").collapsed=1}this.applyCollapse(b);if(typeof d!=\"undefined\"){this.saveState(d,{container:b,value:$(b+\"-state\").value})}},addToPrefix:function(b){this.cookiePrefix+=b+\"-\"},saveState:function(b,d){new Ajax.Request(b,{method:\"get\",parameters:Object.toQueryString(d),loaderArea:false})}};var Base64={_keyStr:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",encode:function(e){var b=\"\";var p,n,h,o,l,g,f;var d=0;if(typeof window.btoa===\"function\"){return window.btoa(e)}e=Base64._utf8_encode(e);while(d<e.length){p=e.charCodeAt(d++);n=e.charCodeAt(d++);h=e.charCodeAt(d++);o=p>>2;l=((p&3)<<4)|(n>>4);g=((n&15)<<2)|(h>>6);f=h&63;if(isNaN(n)){g=f=64}else{if(isNaN(h)){f=64}}b=b+this._keyStr.charAt(o)+this._keyStr.charAt(l)+this._keyStr.charAt(g)+this._keyStr.charAt(f)}return b},decode:function(e){var b=\"\";var p,n,h;var o,l,g,f;var d=0;if(typeof window.atob===\"function\"){return window.atob(e)}e=e.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\");while(d<e.length){o=this._keyStr.indexOf(e.charAt(d++));l=this._keyStr.indexOf(e.charAt(d++));g=this._keyStr.indexOf(e.charAt(d++));f=this._keyStr.indexOf(e.charAt(d++));p=(o<<2)|(l>>4);n=((l&15)<<4)|(g>>2);h=((g&3)<<6)|f;b=b+String.fromCharCode(p);if(g!=64){b=b+String.fromCharCode(n)}if(f!=64){b=b+String.fromCharCode(h)}}b=Base64._utf8_decode(b);return b},mageEncode:function(b){return this.encode(b).replace(/\\+/g,\"-\").replace(/\\//g,\"_\").replace(/=/g,\",\")},mageDecode:function(b){b=b.replace(/\\-/g,\"+\").replace(/_/g,\"/\").replace(/,/g,\"=\");return this.decode(b)},idEncode:function(b){return this.encode(b).replace(/\\+/g,\":\").replace(/\\//g,\"_\").replace(/=/g,\"-\")},idDecode:function(b){b=b.replace(/\\-/g,\"=\").replace(/_/g,\"/\").replace(/\\:/g,\"+\");return this.decode(b)},_utf8_encode:function(d){d=d.replace(/\\r\\n/g,\"\\n\");var b=\"\";for(var f=0;f<d.length;f++){var e=d.charCodeAt(f);if(e<128){b+=String.fromCharCode(e)}else{if((e>127)&&(e<2048)){b+=String.fromCharCode((e>>6)|192);b+=String.fromCharCode((e&63)|128)}else{b+=String.fromCharCode((e>>12)|224);b+=String.fromCharCode(((e>>6)&63)|128);b+=String.fromCharCode((e&63)|128)}}}return b},_utf8_decode:function(b){var d=\"\";var e=0;var f=c1=c2=0;while(e<b.length){f=b.charCodeAt(e);if(f<128){d+=String.fromCharCode(f);e++}else{if((f>191)&&(f<224)){c2=b.charCodeAt(e+1);d+=String.fromCharCode(((f&31)<<6)|(c2&63));e+=2}else{c2=b.charCodeAt(e+1);c3=b.charCodeAt(e+2);d+=String.fromCharCode(((f&15)<<12)|((c2&63)<<6)|(c3&63));e+=3}}}return d}};function sortNumeric(d,b){return d-b}(function(){var globals=[\"Prototype\",\"Abstract\",\"Try\",\"Class\",\"PeriodicalExecuter\",\"Template\",\"$break\",\"Enumerable\",\"$A\",\"$w\",\"$H\",\"Hash\",\"$R\",\"ObjectRange\",\"Ajax\",\"$\",\"Form\",\"Field\",\"$F\",\"Toggle\",\"Insertion\",\"$continue\",\"Position\",\"Windows\",\"Dialog\",\"array\",\"WindowUtilities\",\"Builder\",\"Effect\",\"validateCreditCard\",\"Validator\",\"Validation\",\"removeDelimiters\",\"parseNumber\",\"popWin\",\"setLocation\",\"setPLocation\",\"setLanguageCode\",\"decorateGeneric\",\"decorateTable\",\"decorateList\",\"decorateDataList\",\"parseSidUrl\",\"formatCurrency\",\"expandDetails\",\"isIE\",\"Varien\",\"fireEvent\",\"modulo\",\"byteConvert\",\"SessionError\",\"varienLoader\",\"varienLoaderHandler\",\"setLoaderPosition\",\"toggleSelectsUnderBlock\",\"varienUpdater\",\"setElementDisable\",\"toggleParentVis\",\"toggleFieldsetVis\",\"toggleVis\",\"imagePreview\",\"checkByProductPriceType\",\"toggleSeveralValueElements\",\"toggleValueElements\",\"submitAndReloadArea\",\"syncOnchangeValue\",\"updateElementAtCursor\",\"firebugEnabled\",\"disableElement\",\"enableElement\",\"disableElements\",\"enableElements\",\"Cookie\",\"Fieldset\",\"Base64\",\"sortNumeric\",\"Element\",\"$$\",\"Sizzle\",\"Selector\",\"Window\"];globals.forEach(function(prop){window[prop]=eval(prop)})})();","underscore.js":"//     Underscore.js 1.8.2\r\n//     http://underscorejs.org\r\n//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\r\n//     Underscore may be freely distributed under the MIT license.\r\n\r\n(function() {\r\n\r\n  // Baseline setup\r\n  // --------------\r\n\r\n  // Establish the root object, `window` in the browser, or `exports` on the server.\r\n  var root = this;\r\n\r\n  // Save the previous value of the `_` variable.\r\n  var previousUnderscore = root._;\r\n\r\n  // Save bytes in the minified (but not gzipped) version:\r\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\r\n\r\n  // Create quick reference variables for speed access to core prototypes.\r\n  var\r\n    push             = ArrayProto.push,\r\n    slice            = ArrayProto.slice,\r\n    toString         = ObjProto.toString,\r\n    hasOwnProperty   = ObjProto.hasOwnProperty;\r\n\r\n  // All **ECMAScript 5** native function implementations that we hope to use\r\n  // are declared here.\r\n  var\r\n    nativeIsArray      = Array.isArray,\r\n    nativeKeys         = Object.keys,\r\n    nativeBind         = FuncProto.bind,\r\n    nativeCreate       = Object.create;\r\n\r\n  // Naked function reference for surrogate-prototype-swapping.\r\n  var Ctor = function(){};\r\n\r\n  // Create a safe reference to the Underscore object for use below.\r\n  var _ = function(obj) {\r\n    if (obj instanceof _) return obj;\r\n    if (!(this instanceof _)) return new _(obj);\r\n    this._wrapped = obj;\r\n  };\r\n\r\n  // Export the Underscore object for **Node.js**, with\r\n  // backwards-compatibility for the old `require()` API. If we're in\r\n  // the browser, add `_` as a global object.\r\n  if (typeof exports !== 'undefined') {\r\n    if (typeof module !== 'undefined' && module.exports) {\r\n      exports = module.exports = _;\r\n    }\r\n    exports._ = _;\r\n  } else {\r\n    root._ = _;\r\n  }\r\n\r\n  // Current version.\r\n  _.VERSION = '1.8.2';\r\n\r\n  // Internal function that returns an efficient (for current engines) version\r\n  // of the passed-in callback, to be repeatedly applied in other Underscore\r\n  // functions.\r\n  var optimizeCb = function(func, context, argCount) {\r\n    if (context === void 0) return func;\r\n    switch (argCount == null ? 3 : argCount) {\r\n      case 1: return function(value) {\r\n        return func.call(context, value);\r\n      };\r\n      case 2: return function(value, other) {\r\n        return func.call(context, value, other);\r\n      };\r\n      case 3: return function(value, index, collection) {\r\n        return func.call(context, value, index, collection);\r\n      };\r\n      case 4: return function(accumulator, value, index, collection) {\r\n        return func.call(context, accumulator, value, index, collection);\r\n      };\r\n    }\r\n    return function() {\r\n      return func.apply(context, arguments);\r\n    };\r\n  };\r\n\r\n  // A mostly-internal function to generate callbacks that can be applied\r\n  // to each element in a collection, returning the desired result \u00e2\u0080\u0094 either\r\n  // identity, an arbitrary callback, a property matcher, or a property accessor.\r\n  var cb = function(value, context, argCount) {\r\n    if (value == null) return _.identity;\r\n    if (_.isFunction(value)) return optimizeCb(value, context, argCount);\r\n    if (_.isObject(value)) return _.matcher(value);\r\n    return _.property(value);\r\n  };\r\n  _.iteratee = function(value, context) {\r\n    return cb(value, context, Infinity);\r\n  };\r\n\r\n  // An internal function for creating assigner functions.\r\n  var createAssigner = function(keysFunc, undefinedOnly) {\r\n    return function(obj) {\r\n      var length = arguments.length;\r\n      if (length < 2 || obj == null) return obj;\r\n      for (var index = 1; index < length; index++) {\r\n        var source = arguments[index],\r\n            keys = keysFunc(source),\r\n            l = keys.length;\r\n        for (var i = 0; i < l; i++) {\r\n          var key = keys[i];\r\n          if (!undefinedOnly || obj[key] === void 0) obj[key] = source[key];\r\n        }\r\n      }\r\n      return obj;\r\n    };\r\n  };\r\n\r\n  // An internal function for creating a new object that inherits from another.\r\n  var baseCreate = function(prototype) {\r\n    if (!_.isObject(prototype)) return {};\r\n    if (nativeCreate) return nativeCreate(prototype);\r\n    Ctor.prototype = prototype;\r\n    var result = new Ctor;\r\n    Ctor.prototype = null;\r\n    return result;\r\n  };\r\n\r\n  // Helper for collection methods to determine whether a collection\r\n  // should be iterated as an array or as an object\r\n  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\r\n  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\r\n  var isArrayLike = function(collection) {\r\n    var length = collection && collection.length;\r\n    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;\r\n  };\r\n\r\n  // Collection Functions\r\n  // --------------------\r\n\r\n  // The cornerstone, an `each` implementation, aka `forEach`.\r\n  // Handles raw objects in addition to array-likes. Treats all\r\n  // sparse array-likes as if they were dense.\r\n  _.each = _.forEach = function(obj, iteratee, context) {\r\n    iteratee = optimizeCb(iteratee, context);\r\n    var i, length;\r\n    if (isArrayLike(obj)) {\r\n      for (i = 0, length = obj.length; i < length; i++) {\r\n        iteratee(obj[i], i, obj);\r\n      }\r\n    } else {\r\n      var keys = _.keys(obj);\r\n      for (i = 0, length = keys.length; i < length; i++) {\r\n        iteratee(obj[keys[i]], keys[i], obj);\r\n      }\r\n    }\r\n    return obj;\r\n  };\r\n\r\n  // Return the results of applying the iteratee to each element.\r\n  _.map = _.collect = function(obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context);\r\n    var keys = !isArrayLike(obj) && _.keys(obj),\r\n        length = (keys || obj).length,\r\n        results = Array(length);\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys ? keys[index] : index;\r\n      results[index] = iteratee(obj[currentKey], currentKey, obj);\r\n    }\r\n    return results;\r\n  };\r\n\r\n  // Create a reducing function iterating left or right.\r\n  function createReduce(dir) {\r\n    // Optimized iterator function as using arguments.length\r\n    // in the main function will deoptimize the, see #1991.\r\n    function iterator(obj, iteratee, memo, keys, index, length) {\r\n      for (; index >= 0 && index < length; index += dir) {\r\n        var currentKey = keys ? keys[index] : index;\r\n        memo = iteratee(memo, obj[currentKey], currentKey, obj);\r\n      }\r\n      return memo;\r\n    }\r\n\r\n    return function(obj, iteratee, memo, context) {\r\n      iteratee = optimizeCb(iteratee, context, 4);\r\n      var keys = !isArrayLike(obj) && _.keys(obj),\r\n          length = (keys || obj).length,\r\n          index = dir > 0 ? 0 : length - 1;\r\n      // Determine the initial value if none is provided.\r\n      if (arguments.length < 3) {\r\n        memo = obj[keys ? keys[index] : index];\r\n        index += dir;\r\n      }\r\n      return iterator(obj, iteratee, memo, keys, index, length);\r\n    };\r\n  }\r\n\r\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\r\n  // or `foldl`.\r\n  _.reduce = _.foldl = _.inject = createReduce(1);\r\n\r\n  // The right-associative version of reduce, also known as `foldr`.\r\n  _.reduceRight = _.foldr = createReduce(-1);\r\n\r\n  // Return the first value which passes a truth test. Aliased as `detect`.\r\n  _.find = _.detect = function(obj, predicate, context) {\r\n    var key;\r\n    if (isArrayLike(obj)) {\r\n      key = _.findIndex(obj, predicate, context);\r\n    } else {\r\n      key = _.findKey(obj, predicate, context);\r\n    }\r\n    if (key !== void 0 && key !== -1) return obj[key];\r\n  };\r\n\r\n  // Return all the elements that pass a truth test.\r\n  // Aliased as `select`.\r\n  _.filter = _.select = function(obj, predicate, context) {\r\n    var results = [];\r\n    predicate = cb(predicate, context);\r\n    _.each(obj, function(value, index, list) {\r\n      if (predicate(value, index, list)) results.push(value);\r\n    });\r\n    return results;\r\n  };\r\n\r\n  // Return all the elements for which a truth test fails.\r\n  _.reject = function(obj, predicate, context) {\r\n    return _.filter(obj, _.negate(cb(predicate)), context);\r\n  };\r\n\r\n  // Determine whether all of the elements match a truth test.\r\n  // Aliased as `all`.\r\n  _.every = _.all = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var keys = !isArrayLike(obj) && _.keys(obj),\r\n        length = (keys || obj).length;\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys ? keys[index] : index;\r\n      if (!predicate(obj[currentKey], currentKey, obj)) return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  // Determine if at least one element in the object matches a truth test.\r\n  // Aliased as `any`.\r\n  _.some = _.any = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var keys = !isArrayLike(obj) && _.keys(obj),\r\n        length = (keys || obj).length;\r\n    for (var index = 0; index < length; index++) {\r\n      var currentKey = keys ? keys[index] : index;\r\n      if (predicate(obj[currentKey], currentKey, obj)) return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Determine if the array or object contains a given value (using `===`).\r\n  // Aliased as `includes` and `include`.\r\n  _.contains = _.includes = _.include = function(obj, target, fromIndex) {\r\n    if (!isArrayLike(obj)) obj = _.values(obj);\r\n    return _.indexOf(obj, target, typeof fromIndex == 'number' && fromIndex) >= 0;\r\n  };\r\n\r\n  // Invoke a method (with arguments) on every item in a collection.\r\n  _.invoke = function(obj, method) {\r\n    var args = slice.call(arguments, 2);\r\n    var isFunc = _.isFunction(method);\r\n    return _.map(obj, function(value) {\r\n      var func = isFunc ? method : value[method];\r\n      return func == null ? func : func.apply(value, args);\r\n    });\r\n  };\r\n\r\n  // Convenience version of a common use case of `map`: fetching a property.\r\n  _.pluck = function(obj, key) {\r\n    return _.map(obj, _.property(key));\r\n  };\r\n\r\n  // Convenience version of a common use case of `filter`: selecting only objects\r\n  // containing specific `key:value` pairs.\r\n  _.where = function(obj, attrs) {\r\n    return _.filter(obj, _.matcher(attrs));\r\n  };\r\n\r\n  // Convenience version of a common use case of `find`: getting the first object\r\n  // containing specific `key:value` pairs.\r\n  _.findWhere = function(obj, attrs) {\r\n    return _.find(obj, _.matcher(attrs));\r\n  };\r\n\r\n  // Return the maximum element (or element-based computation).\r\n  _.max = function(obj, iteratee, context) {\r\n    var result = -Infinity, lastComputed = -Infinity,\r\n        value, computed;\r\n    if (iteratee == null && obj != null) {\r\n      obj = isArrayLike(obj) ? obj : _.values(obj);\r\n      for (var i = 0, length = obj.length; i < length; i++) {\r\n        value = obj[i];\r\n        if (value > result) {\r\n          result = value;\r\n        }\r\n      }\r\n    } else {\r\n      iteratee = cb(iteratee, context);\r\n      _.each(obj, function(value, index, list) {\r\n        computed = iteratee(value, index, list);\r\n        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {\r\n          result = value;\r\n          lastComputed = computed;\r\n        }\r\n      });\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Return the minimum element (or element-based computation).\r\n  _.min = function(obj, iteratee, context) {\r\n    var result = Infinity, lastComputed = Infinity,\r\n        value, computed;\r\n    if (iteratee == null && obj != null) {\r\n      obj = isArrayLike(obj) ? obj : _.values(obj);\r\n      for (var i = 0, length = obj.length; i < length; i++) {\r\n        value = obj[i];\r\n        if (value < result) {\r\n          result = value;\r\n        }\r\n      }\r\n    } else {\r\n      iteratee = cb(iteratee, context);\r\n      _.each(obj, function(value, index, list) {\r\n        computed = iteratee(value, index, list);\r\n        if (computed < lastComputed || computed === Infinity && result === Infinity) {\r\n          result = value;\r\n          lastComputed = computed;\r\n        }\r\n      });\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Shuffle a collection, using the modern version of the\r\n  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher\u00e2\u0080\u0093Yates_shuffle).\r\n  _.shuffle = function(obj) {\r\n    var set = isArrayLike(obj) ? obj : _.values(obj);\r\n    var length = set.length;\r\n    var shuffled = Array(length);\r\n    for (var index = 0, rand; index < length; index++) {\r\n      rand = _.random(0, index);\r\n      if (rand !== index) shuffled[index] = shuffled[rand];\r\n      shuffled[rand] = set[index];\r\n    }\r\n    return shuffled;\r\n  };\r\n\r\n  // Sample **n** random values from a collection.\r\n  // If **n** is not specified, returns a single random element.\r\n  // The internal `guard` argument allows it to work with `map`.\r\n  _.sample = function(obj, n, guard) {\r\n    if (n == null || guard) {\r\n      if (!isArrayLike(obj)) obj = _.values(obj);\r\n      return obj[_.random(obj.length - 1)];\r\n    }\r\n    return _.shuffle(obj).slice(0, Math.max(0, n));\r\n  };\r\n\r\n  // Sort the object's values by a criterion produced by an iteratee.\r\n  _.sortBy = function(obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context);\r\n    return _.pluck(_.map(obj, function(value, index, list) {\r\n      return {\r\n        value: value,\r\n        index: index,\r\n        criteria: iteratee(value, index, list)\r\n      };\r\n    }).sort(function(left, right) {\r\n      var a = left.criteria;\r\n      var b = right.criteria;\r\n      if (a !== b) {\r\n        if (a > b || a === void 0) return 1;\r\n        if (a < b || b === void 0) return -1;\r\n      }\r\n      return left.index - right.index;\r\n    }), 'value');\r\n  };\r\n\r\n  // An internal function used for aggregate \"group by\" operations.\r\n  var group = function(behavior) {\r\n    return function(obj, iteratee, context) {\r\n      var result = {};\r\n      iteratee = cb(iteratee, context);\r\n      _.each(obj, function(value, index) {\r\n        var key = iteratee(value, index, obj);\r\n        behavior(result, value, key);\r\n      });\r\n      return result;\r\n    };\r\n  };\r\n\r\n  // Groups the object's values by a criterion. Pass either a string attribute\r\n  // to group by, or a function that returns the criterion.\r\n  _.groupBy = group(function(result, value, key) {\r\n    if (_.has(result, key)) result[key].push(value); else result[key] = [value];\r\n  });\r\n\r\n  // Indexes the object's values by a criterion, similar to `groupBy`, but for\r\n  // when you know that your index values will be unique.\r\n  _.indexBy = group(function(result, value, key) {\r\n    result[key] = value;\r\n  });\r\n\r\n  // Counts instances of an object that group by a certain criterion. Pass\r\n  // either a string attribute to count by, or a function that returns the\r\n  // criterion.\r\n  _.countBy = group(function(result, value, key) {\r\n    if (_.has(result, key)) result[key]++; else result[key] = 1;\r\n  });\r\n\r\n  // Safely create a real, live array from anything iterable.\r\n  _.toArray = function(obj) {\r\n    if (!obj) return [];\r\n    if (_.isArray(obj)) return slice.call(obj);\r\n    if (isArrayLike(obj)) return _.map(obj, _.identity);\r\n    return _.values(obj);\r\n  };\r\n\r\n  // Return the number of elements in an object.\r\n  _.size = function(obj) {\r\n    if (obj == null) return 0;\r\n    return isArrayLike(obj) ? obj.length : _.keys(obj).length;\r\n  };\r\n\r\n  // Split a collection into two arrays: one whose elements all satisfy the given\r\n  // predicate, and one whose elements all do not satisfy the predicate.\r\n  _.partition = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var pass = [], fail = [];\r\n    _.each(obj, function(value, key, obj) {\r\n      (predicate(value, key, obj) ? pass : fail).push(value);\r\n    });\r\n    return [pass, fail];\r\n  };\r\n\r\n  // Array Functions\r\n  // ---------------\r\n\r\n  // Get the first element of an array. Passing **n** will return the first N\r\n  // values in the array. Aliased as `head` and `take`. The **guard** check\r\n  // allows it to work with `_.map`.\r\n  _.first = _.head = _.take = function(array, n, guard) {\r\n    if (array == null) return void 0;\r\n    if (n == null || guard) return array[0];\r\n    return _.initial(array, array.length - n);\r\n  };\r\n\r\n  // Returns everything but the last entry of the array. Especially useful on\r\n  // the arguments object. Passing **n** will return all the values in\r\n  // the array, excluding the last N.\r\n  _.initial = function(array, n, guard) {\r\n    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\r\n  };\r\n\r\n  // Get the last element of an array. Passing **n** will return the last N\r\n  // values in the array.\r\n  _.last = function(array, n, guard) {\r\n    if (array == null) return void 0;\r\n    if (n == null || guard) return array[array.length - 1];\r\n    return _.rest(array, Math.max(0, array.length - n));\r\n  };\r\n\r\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\r\n  // Especially useful on the arguments object. Passing an **n** will return\r\n  // the rest N values in the array.\r\n  _.rest = _.tail = _.drop = function(array, n, guard) {\r\n    return slice.call(array, n == null || guard ? 1 : n);\r\n  };\r\n\r\n  // Trim out all falsy values from an array.\r\n  _.compact = function(array) {\r\n    return _.filter(array, _.identity);\r\n  };\r\n\r\n  // Internal implementation of a recursive `flatten` function.\r\n  var flatten = function(input, shallow, strict, startIndex) {\r\n    var output = [], idx = 0;\r\n    for (var i = startIndex || 0, length = input && input.length; i < length; i++) {\r\n      var value = input[i];\r\n      if (isArrayLike(value) && (_.isArray(value) || _.isArguments(value))) {\r\n        //flatten current level of array or arguments object\r\n        if (!shallow) value = flatten(value, shallow, strict);\r\n        var j = 0, len = value.length;\r\n        output.length += len;\r\n        while (j < len) {\r\n          output[idx++] = value[j++];\r\n        }\r\n      } else if (!strict) {\r\n        output[idx++] = value;\r\n      }\r\n    }\r\n    return output;\r\n  };\r\n\r\n  // Flatten out an array, either recursively (by default), or just one level.\r\n  _.flatten = function(array, shallow) {\r\n    return flatten(array, shallow, false);\r\n  };\r\n\r\n  // Return a version of the array that does not contain the specified value(s).\r\n  _.without = function(array) {\r\n    return _.difference(array, slice.call(arguments, 1));\r\n  };\r\n\r\n  // Produce a duplicate-free version of the array. If the array has already\r\n  // been sorted, you have the option of using a faster algorithm.\r\n  // Aliased as `unique`.\r\n  _.uniq = _.unique = function(array, isSorted, iteratee, context) {\r\n    if (array == null) return [];\r\n    if (!_.isBoolean(isSorted)) {\r\n      context = iteratee;\r\n      iteratee = isSorted;\r\n      isSorted = false;\r\n    }\r\n    if (iteratee != null) iteratee = cb(iteratee, context);\r\n    var result = [];\r\n    var seen = [];\r\n    for (var i = 0, length = array.length; i < length; i++) {\r\n      var value = array[i],\r\n          computed = iteratee ? iteratee(value, i, array) : value;\r\n      if (isSorted) {\r\n        if (!i || seen !== computed) result.push(value);\r\n        seen = computed;\r\n      } else if (iteratee) {\r\n        if (!_.contains(seen, computed)) {\r\n          seen.push(computed);\r\n          result.push(value);\r\n        }\r\n      } else if (!_.contains(result, value)) {\r\n        result.push(value);\r\n      }\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Produce an array that contains the union: each distinct element from all of\r\n  // the passed-in arrays.\r\n  _.union = function() {\r\n    return _.uniq(flatten(arguments, true, true));\r\n  };\r\n\r\n  // Produce an array that contains every item shared between all the\r\n  // passed-in arrays.\r\n  _.intersection = function(array) {\r\n    if (array == null) return [];\r\n    var result = [];\r\n    var argsLength = arguments.length;\r\n    for (var i = 0, length = array.length; i < length; i++) {\r\n      var item = array[i];\r\n      if (_.contains(result, item)) continue;\r\n      for (var j = 1; j < argsLength; j++) {\r\n        if (!_.contains(arguments[j], item)) break;\r\n      }\r\n      if (j === argsLength) result.push(item);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Take the difference between one array and a number of other arrays.\r\n  // Only the elements present in just the first array will remain.\r\n  _.difference = function(array) {\r\n    var rest = flatten(arguments, true, true, 1);\r\n    return _.filter(array, function(value){\r\n      return !_.contains(rest, value);\r\n    });\r\n  };\r\n\r\n  // Zip together multiple lists into a single array -- elements that share\r\n  // an index go together.\r\n  _.zip = function() {\r\n    return _.unzip(arguments);\r\n  };\r\n\r\n  // Complement of _.zip. Unzip accepts an array of arrays and groups\r\n  // each array's elements on shared indices\r\n  _.unzip = function(array) {\r\n    var length = array && _.max(array, 'length').length || 0;\r\n    var result = Array(length);\r\n\r\n    for (var index = 0; index < length; index++) {\r\n      result[index] = _.pluck(array, index);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Converts lists into objects. Pass either a single array of `[key, value]`\r\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\r\n  // the corresponding values.\r\n  _.object = function(list, values) {\r\n    var result = {};\r\n    for (var i = 0, length = list && list.length; i < length; i++) {\r\n      if (values) {\r\n        result[list[i]] = values[i];\r\n      } else {\r\n        result[list[i][0]] = list[i][1];\r\n      }\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Return the position of the first occurrence of an item in an array,\r\n  // or -1 if the item is not included in the array.\r\n  // If the array is large and already in sort order, pass `true`\r\n  // for **isSorted** to use binary search.\r\n  _.indexOf = function(array, item, isSorted) {\r\n    var i = 0, length = array && array.length;\r\n    if (typeof isSorted == 'number') {\r\n      i = isSorted < 0 ? Math.max(0, length + isSorted) : isSorted;\r\n    } else if (isSorted && length) {\r\n      i = _.sortedIndex(array, item);\r\n      return array[i] === item ? i : -1;\r\n    }\r\n    if (item !== item) {\r\n      return _.findIndex(slice.call(array, i), _.isNaN);\r\n    }\r\n    for (; i < length; i++) if (array[i] === item) return i;\r\n    return -1;\r\n  };\r\n\r\n  _.lastIndexOf = function(array, item, from) {\r\n    var idx = array ? array.length : 0;\r\n    if (typeof from == 'number') {\r\n      idx = from < 0 ? idx + from + 1 : Math.min(idx, from + 1);\r\n    }\r\n    if (item !== item) {\r\n      return _.findLastIndex(slice.call(array, 0, idx), _.isNaN);\r\n    }\r\n    while (--idx >= 0) if (array[idx] === item) return idx;\r\n    return -1;\r\n  };\r\n\r\n  // Generator function to create the findIndex and findLastIndex functions\r\n  function createIndexFinder(dir) {\r\n    return function(array, predicate, context) {\r\n      predicate = cb(predicate, context);\r\n      var length = array != null && array.length;\r\n      var index = dir > 0 ? 0 : length - 1;\r\n      for (; index >= 0 && index < length; index += dir) {\r\n        if (predicate(array[index], index, array)) return index;\r\n      }\r\n      return -1;\r\n    };\r\n  }\r\n\r\n  // Returns the first index on an array-like that passes a predicate test\r\n  _.findIndex = createIndexFinder(1);\r\n\r\n  _.findLastIndex = createIndexFinder(-1);\r\n\r\n  // Use a comparator function to figure out the smallest index at which\r\n  // an object should be inserted so as to maintain order. Uses binary search.\r\n  _.sortedIndex = function(array, obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context, 1);\r\n    var value = iteratee(obj);\r\n    var low = 0, high = array.length;\r\n    while (low < high) {\r\n      var mid = Math.floor((low + high) / 2);\r\n      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;\r\n    }\r\n    return low;\r\n  };\r\n\r\n  // Generate an integer Array containing an arithmetic progression. A port of\r\n  // the native Python `range()` function. See\r\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\r\n  _.range = function(start, stop, step) {\r\n    if (arguments.length <= 1) {\r\n      stop = start || 0;\r\n      start = 0;\r\n    }\r\n    step = step || 1;\r\n\r\n    var length = Math.max(Math.ceil((stop - start) / step), 0);\r\n    var range = Array(length);\r\n\r\n    for (var idx = 0; idx < length; idx++, start += step) {\r\n      range[idx] = start;\r\n    }\r\n\r\n    return range;\r\n  };\r\n\r\n  // Function (ahem) Functions\r\n  // ------------------\r\n\r\n  // Determines whether to execute a function as a constructor\r\n  // or a normal function with the provided arguments\r\n  var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) {\r\n    if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);\r\n    var self = baseCreate(sourceFunc.prototype);\r\n    var result = sourceFunc.apply(self, args);\r\n    if (_.isObject(result)) return result;\r\n    return self;\r\n  };\r\n\r\n  // Create a function bound to a given object (assigning `this`, and arguments,\r\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\r\n  // available.\r\n  _.bind = function(func, context) {\r\n    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\r\n    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');\r\n    var args = slice.call(arguments, 2);\r\n    var bound = function() {\r\n      return executeBound(func, bound, context, this, args.concat(slice.call(arguments)));\r\n    };\r\n    return bound;\r\n  };\r\n\r\n  // Partially apply a function by creating a version that has had some of its\r\n  // arguments pre-filled, without changing its dynamic `this` context. _ acts\r\n  // as a placeholder, allowing any combination of arguments to be pre-filled.\r\n  _.partial = function(func) {\r\n    var boundArgs = slice.call(arguments, 1);\r\n    var bound = function() {\r\n      var position = 0, length = boundArgs.length;\r\n      var args = Array(length);\r\n      for (var i = 0; i < length; i++) {\r\n        args[i] = boundArgs[i] === _ ? arguments[position++] : boundArgs[i];\r\n      }\r\n      while (position < arguments.length) args.push(arguments[position++]);\r\n      return executeBound(func, bound, this, this, args);\r\n    };\r\n    return bound;\r\n  };\r\n\r\n  // Bind a number of an object's methods to that object. Remaining arguments\r\n  // are the method names to be bound. Useful for ensuring that all callbacks\r\n  // defined on an object belong to it.\r\n  _.bindAll = function(obj) {\r\n    var i, length = arguments.length, key;\r\n    if (length <= 1) throw new Error('bindAll must be passed function names');\r\n    for (i = 1; i < length; i++) {\r\n      key = arguments[i];\r\n      obj[key] = _.bind(obj[key], obj);\r\n    }\r\n    return obj;\r\n  };\r\n\r\n  // Memoize an expensive function by storing its results.\r\n  _.memoize = function(func, hasher) {\r\n    var memoize = function(key) {\r\n      var cache = memoize.cache;\r\n      var address = '' + (hasher ? hasher.apply(this, arguments) : key);\r\n      if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);\r\n      return cache[address];\r\n    };\r\n    memoize.cache = {};\r\n    return memoize;\r\n  };\r\n\r\n  // Delays a function for the given number of milliseconds, and then calls\r\n  // it with the arguments supplied.\r\n  _.delay = function(func, wait) {\r\n    var args = slice.call(arguments, 2);\r\n    return setTimeout(function(){\r\n      return func.apply(null, args);\r\n    }, wait);\r\n  };\r\n\r\n  // Defers a function, scheduling it to run after the current call stack has\r\n  // cleared.\r\n  _.defer = _.partial(_.delay, _, 1);\r\n\r\n  // Returns a function, that, when invoked, will only be triggered at most once\r\n  // during a given window of time. Normally, the throttled function will run\r\n  // as much as it can, without ever going more than once per `wait` duration;\r\n  // but if you'd like to disable the execution on the leading edge, pass\r\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n  _.throttle = function(func, wait, options) {\r\n    var context, args, result;\r\n    var timeout = null;\r\n    var previous = 0;\r\n    if (!options) options = {};\r\n    var later = function() {\r\n      previous = options.leading === false ? 0 : _.now();\r\n      timeout = null;\r\n      result = func.apply(context, args);\r\n      if (!timeout) context = args = null;\r\n    };\r\n    return function() {\r\n      var now = _.now();\r\n      if (!previous && options.leading === false) previous = now;\r\n      var remaining = wait - (now - previous);\r\n      context = this;\r\n      args = arguments;\r\n      if (remaining <= 0 || remaining > wait) {\r\n        if (timeout) {\r\n          clearTimeout(timeout);\r\n          timeout = null;\r\n        }\r\n        previous = now;\r\n        result = func.apply(context, args);\r\n        if (!timeout) context = args = null;\r\n      } else if (!timeout && options.trailing !== false) {\r\n        timeout = setTimeout(later, remaining);\r\n      }\r\n      return result;\r\n    };\r\n  };\r\n\r\n  // Returns a function, that, as long as it continues to be invoked, will not\r\n  // be triggered. The function will be called after it stops being called for\r\n  // N milliseconds. If `immediate` is passed, trigger the function on the\r\n  // leading edge, instead of the trailing.\r\n  _.debounce = function(func, wait, immediate) {\r\n    var timeout, args, context, timestamp, result;\r\n\r\n    var later = function() {\r\n      var last = _.now() - timestamp;\r\n\r\n      if (last < wait && last >= 0) {\r\n        timeout = setTimeout(later, wait - last);\r\n      } else {\r\n        timeout = null;\r\n        if (!immediate) {\r\n          result = func.apply(context, args);\r\n          if (!timeout) context = args = null;\r\n        }\r\n      }\r\n    };\r\n\r\n    return function() {\r\n      context = this;\r\n      args = arguments;\r\n      timestamp = _.now();\r\n      var callNow = immediate && !timeout;\r\n      if (!timeout) timeout = setTimeout(later, wait);\r\n      if (callNow) {\r\n        result = func.apply(context, args);\r\n        context = args = null;\r\n      }\r\n\r\n      return result;\r\n    };\r\n  };\r\n\r\n  // Returns the first function passed as an argument to the second,\r\n  // allowing you to adjust arguments, run code before and after, and\r\n  // conditionally execute the original function.\r\n  _.wrap = function(func, wrapper) {\r\n    return _.partial(wrapper, func);\r\n  };\r\n\r\n  // Returns a negated version of the passed-in predicate.\r\n  _.negate = function(predicate) {\r\n    return function() {\r\n      return !predicate.apply(this, arguments);\r\n    };\r\n  };\r\n\r\n  // Returns a function that is the composition of a list of functions, each\r\n  // consuming the return value of the function that follows.\r\n  _.compose = function() {\r\n    var args = arguments;\r\n    var start = args.length - 1;\r\n    return function() {\r\n      var i = start;\r\n      var result = args[start].apply(this, arguments);\r\n      while (i--) result = args[i].call(this, result);\r\n      return result;\r\n    };\r\n  };\r\n\r\n  // Returns a function that will only be executed on and after the Nth call.\r\n  _.after = function(times, func) {\r\n    return function() {\r\n      if (--times < 1) {\r\n        return func.apply(this, arguments);\r\n      }\r\n    };\r\n  };\r\n\r\n  // Returns a function that will only be executed up to (but not including) the Nth call.\r\n  _.before = function(times, func) {\r\n    var memo;\r\n    return function() {\r\n      if (--times > 0) {\r\n        memo = func.apply(this, arguments);\r\n      }\r\n      if (times <= 1) func = null;\r\n      return memo;\r\n    };\r\n  };\r\n\r\n  // Returns a function that will be executed at most one time, no matter how\r\n  // often you call it. Useful for lazy initialization.\r\n  _.once = _.partial(_.before, 2);\r\n\r\n  // Object Functions\r\n  // ----------------\r\n\r\n  // Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.\r\n  var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');\r\n  var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',\r\n                      'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\r\n\r\n  function collectNonEnumProps(obj, keys) {\r\n    var nonEnumIdx = nonEnumerableProps.length;\r\n    var constructor = obj.constructor;\r\n    var proto = (_.isFunction(constructor) && constructor.prototype) || ObjProto;\r\n\r\n    // Constructor is a special case.\r\n    var prop = 'constructor';\r\n    if (_.has(obj, prop) && !_.contains(keys, prop)) keys.push(prop);\r\n\r\n    while (nonEnumIdx--) {\r\n      prop = nonEnumerableProps[nonEnumIdx];\r\n      if (prop in obj && obj[prop] !== proto[prop] && !_.contains(keys, prop)) {\r\n        keys.push(prop);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Retrieve the names of an object's own properties.\r\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\r\n  _.keys = function(obj) {\r\n    if (!_.isObject(obj)) return [];\r\n    if (nativeKeys) return nativeKeys(obj);\r\n    var keys = [];\r\n    for (var key in obj) if (_.has(obj, key)) keys.push(key);\r\n    // Ahem, IE < 9.\r\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\r\n    return keys;\r\n  };\r\n\r\n  // Retrieve all the property names of an object.\r\n  _.allKeys = function(obj) {\r\n    if (!_.isObject(obj)) return [];\r\n    var keys = [];\r\n    for (var key in obj) keys.push(key);\r\n    // Ahem, IE < 9.\r\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\r\n    return keys;\r\n  };\r\n\r\n  // Retrieve the values of an object's properties.\r\n  _.values = function(obj) {\r\n    var keys = _.keys(obj);\r\n    var length = keys.length;\r\n    var values = Array(length);\r\n    for (var i = 0; i < length; i++) {\r\n      values[i] = obj[keys[i]];\r\n    }\r\n    return values;\r\n  };\r\n\r\n  // Returns the results of applying the iteratee to each element of the object\r\n  // In contrast to _.map it returns an object\r\n  _.mapObject = function(obj, iteratee, context) {\r\n    iteratee = cb(iteratee, context);\r\n    var keys =  _.keys(obj),\r\n          length = keys.length,\r\n          results = {},\r\n          currentKey;\r\n      for (var index = 0; index < length; index++) {\r\n        currentKey = keys[index];\r\n        results[currentKey] = iteratee(obj[currentKey], currentKey, obj);\r\n      }\r\n      return results;\r\n  };\r\n\r\n  // Convert an object into a list of `[key, value]` pairs.\r\n  _.pairs = function(obj) {\r\n    var keys = _.keys(obj);\r\n    var length = keys.length;\r\n    var pairs = Array(length);\r\n    for (var i = 0; i < length; i++) {\r\n      pairs[i] = [keys[i], obj[keys[i]]];\r\n    }\r\n    return pairs;\r\n  };\r\n\r\n  // Invert the keys and values of an object. The values must be serializable.\r\n  _.invert = function(obj) {\r\n    var result = {};\r\n    var keys = _.keys(obj);\r\n    for (var i = 0, length = keys.length; i < length; i++) {\r\n      result[obj[keys[i]]] = keys[i];\r\n    }\r\n    return result;\r\n  };\r\n\r\n  // Return a sorted list of the function names available on the object.\r\n  // Aliased as `methods`\r\n  _.functions = _.methods = function(obj) {\r\n    var names = [];\r\n    for (var key in obj) {\r\n      if (_.isFunction(obj[key])) names.push(key);\r\n    }\r\n    return names.sort();\r\n  };\r\n\r\n  // Extend a given object with all the properties in passed-in object(s).\r\n  _.extend = createAssigner(_.allKeys);\r\n\r\n  // Assigns a given object with all the own properties in the passed-in object(s)\r\n  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\r\n  _.extendOwn = _.assign = createAssigner(_.keys);\r\n\r\n  // Returns the first key on an object that passes a predicate test\r\n  _.findKey = function(obj, predicate, context) {\r\n    predicate = cb(predicate, context);\r\n    var keys = _.keys(obj), key;\r\n    for (var i = 0, length = keys.length; i < length; i++) {\r\n      key = keys[i];\r\n      if (predicate(obj[key], key, obj)) return key;\r\n    }\r\n  };\r\n\r\n  // Return a copy of the object only containing the whitelisted properties.\r\n  _.pick = function(object, oiteratee, context) {\r\n    var result = {}, obj = object, iteratee, keys;\r\n    if (obj == null) return result;\r\n    if (_.isFunction(oiteratee)) {\r\n      keys = _.allKeys(obj);\r\n      iteratee = optimizeCb(oiteratee, context);\r\n    } else {\r\n      keys = flatten(arguments, false, false, 1);\r\n      iteratee = function(value, key, obj) { return key in obj; };\r\n      obj = Object(obj);\r\n    }\r\n    for (var i = 0, length = keys.length; i < length; i++) {\r\n      var key = keys[i];\r\n      var value = obj[key];\r\n      if (iteratee(value, key, obj)) result[key] = value;\r\n    }\r\n    return result;\r\n  };\r\n\r\n   // Return a copy of the object without the blacklisted properties.\r\n  _.omit = function(obj, iteratee, context) {\r\n    if (_.isFunction(iteratee)) {\r\n      iteratee = _.negate(iteratee);\r\n    } else {\r\n      var keys = _.map(flatten(arguments, false, false, 1), String);\r\n      iteratee = function(value, key) {\r\n        return !_.contains(keys, key);\r\n      };\r\n    }\r\n    return _.pick(obj, iteratee, context);\r\n  };\r\n\r\n  // Fill in a given object with default properties.\r\n  _.defaults = createAssigner(_.allKeys, true);\r\n\r\n  // Create a (shallow-cloned) duplicate of an object.\r\n  _.clone = function(obj) {\r\n    if (!_.isObject(obj)) return obj;\r\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\r\n  };\r\n\r\n  // Invokes interceptor with the obj, and then returns obj.\r\n  // The primary purpose of this method is to \"tap into\" a method chain, in\r\n  // order to perform operations on intermediate results within the chain.\r\n  _.tap = function(obj, interceptor) {\r\n    interceptor(obj);\r\n    return obj;\r\n  };\r\n\r\n  // Returns whether an object has a given set of `key:value` pairs.\r\n  _.isMatch = function(object, attrs) {\r\n    var keys = _.keys(attrs), length = keys.length;\r\n    if (object == null) return !length;\r\n    var obj = Object(object);\r\n    for (var i = 0; i < length; i++) {\r\n      var key = keys[i];\r\n      if (attrs[key] !== obj[key] || !(key in obj)) return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n\r\n  // Internal recursive comparison function for `isEqual`.\r\n  var eq = function(a, b, aStack, bStack) {\r\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\r\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\r\n    if (a === b) return a !== 0 || 1 / a === 1 / b;\r\n    // A strict comparison is necessary because `null == undefined`.\r\n    if (a == null || b == null) return a === b;\r\n    // Unwrap any wrapped objects.\r\n    if (a instanceof _) a = a._wrapped;\r\n    if (b instanceof _) b = b._wrapped;\r\n    // Compare `[[Class]]` names.\r\n    var className = toString.call(a);\r\n    if (className !== toString.call(b)) return false;\r\n    switch (className) {\r\n      // Strings, numbers, regular expressions, dates, and booleans are compared by value.\r\n      case '[object RegExp]':\r\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\r\n      case '[object String]':\r\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\r\n        // equivalent to `new String(\"5\")`.\r\n        return '' + a === '' + b;\r\n      case '[object Number]':\r\n        // `NaN`s are equivalent, but non-reflexive.\r\n        // Object(NaN) is equivalent to NaN\r\n        if (+a !== +a) return +b !== +b;\r\n        // An `egal` comparison is performed for other numeric values.\r\n        return +a === 0 ? 1 / +a === 1 / b : +a === +b;\r\n      case '[object Date]':\r\n      case '[object Boolean]':\r\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\r\n        // millisecond representations. Note that invalid dates with millisecond representations\r\n        // of `NaN` are not equivalent.\r\n        return +a === +b;\r\n    }\r\n\r\n    var areArrays = className === '[object Array]';\r\n    if (!areArrays) {\r\n      if (typeof a != 'object' || typeof b != 'object') return false;\r\n\r\n      // Objects with different constructors are not equivalent, but `Object`s or `Array`s\r\n      // from different frames are.\r\n      var aCtor = a.constructor, bCtor = b.constructor;\r\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && aCtor instanceof aCtor &&\r\n                               _.isFunction(bCtor) && bCtor instanceof bCtor)\r\n                          && ('constructor' in a && 'constructor' in b)) {\r\n        return false;\r\n      }\r\n    }\r\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\r\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\r\n    \r\n    // Initializing stack of traversed objects.\r\n    // It's done here since we only need them for objects and arrays comparison.\r\n    aStack = aStack || [];\r\n    bStack = bStack || [];\r\n    var length = aStack.length;\r\n    while (length--) {\r\n      // Linear search. Performance is inversely proportional to the number of\r\n      // unique nested structures.\r\n      if (aStack[length] === a) return bStack[length] === b;\r\n    }\r\n\r\n    // Add the first object to the stack of traversed objects.\r\n    aStack.push(a);\r\n    bStack.push(b);\r\n\r\n    // Recursively compare objects and arrays.\r\n    if (areArrays) {\r\n      // Compare array lengths to determine if a deep comparison is necessary.\r\n      length = a.length;\r\n      if (length !== b.length) return false;\r\n      // Deep compare the contents, ignoring non-numeric properties.\r\n      while (length--) {\r\n        if (!eq(a[length], b[length], aStack, bStack)) return false;\r\n      }\r\n    } else {\r\n      // Deep compare objects.\r\n      var keys = _.keys(a), key;\r\n      length = keys.length;\r\n      // Ensure that both objects contain the same number of properties before comparing deep equality.\r\n      if (_.keys(b).length !== length) return false;\r\n      while (length--) {\r\n        // Deep compare each member\r\n        key = keys[length];\r\n        if (!(_.has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;\r\n      }\r\n    }\r\n    // Remove the first object from the stack of traversed objects.\r\n    aStack.pop();\r\n    bStack.pop();\r\n    return true;\r\n  };\r\n\r\n  // Perform a deep comparison to check if two objects are equal.\r\n  _.isEqual = function(a, b) {\r\n    return eq(a, b);\r\n  };\r\n\r\n  // Is a given array, string, or object empty?\r\n  // An \"empty\" object has no enumerable own-properties.\r\n  _.isEmpty = function(obj) {\r\n    if (obj == null) return true;\r\n    if (isArrayLike(obj) && (_.isArray(obj) || _.isString(obj) || _.isArguments(obj))) return obj.length === 0;\r\n    return _.keys(obj).length === 0;\r\n  };\r\n\r\n  // Is a given value a DOM element?\r\n  _.isElement = function(obj) {\r\n    return !!(obj && obj.nodeType === 1);\r\n  };\r\n\r\n  // Is a given value an array?\r\n  // Delegates to ECMA5's native Array.isArray\r\n  _.isArray = nativeIsArray || function(obj) {\r\n    return toString.call(obj) === '[object Array]';\r\n  };\r\n\r\n  // Is a given variable an object?\r\n  _.isObject = function(obj) {\r\n    var type = typeof obj;\r\n    return type === 'function' || type === 'object' && !!obj;\r\n  };\r\n\r\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError.\r\n  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp', 'Error'], function(name) {\r\n    _['is' + name] = function(obj) {\r\n      return toString.call(obj) === '[object ' + name + ']';\r\n    };\r\n  });\r\n\r\n  // Define a fallback version of the method in browsers (ahem, IE < 9), where\r\n  // there isn't any inspectable \"Arguments\" type.\r\n  if (!_.isArguments(arguments)) {\r\n    _.isArguments = function(obj) {\r\n      return _.has(obj, 'callee');\r\n    };\r\n  }\r\n\r\n  // Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,\r\n  // IE 11 (#1621), and in Safari 8 (#1929).\r\n  if (typeof /./ != 'function' && typeof Int8Array != 'object') {\r\n    _.isFunction = function(obj) {\r\n      return typeof obj == 'function' || false;\r\n    };\r\n  }\r\n\r\n  // Is a given object a finite number?\r\n  _.isFinite = function(obj) {\r\n    return isFinite(obj) && !isNaN(parseFloat(obj));\r\n  };\r\n\r\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\r\n  _.isNaN = function(obj) {\r\n    return _.isNumber(obj) && obj !== +obj;\r\n  };\r\n\r\n  // Is a given value a boolean?\r\n  _.isBoolean = function(obj) {\r\n    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';\r\n  };\r\n\r\n  // Is a given value equal to null?\r\n  _.isNull = function(obj) {\r\n    return obj === null;\r\n  };\r\n\r\n  // Is a given variable undefined?\r\n  _.isUndefined = function(obj) {\r\n    return obj === void 0;\r\n  };\r\n\r\n  // Shortcut function for checking if an object has a given property directly\r\n  // on itself (in other words, not on a prototype).\r\n  _.has = function(obj, key) {\r\n    return obj != null && hasOwnProperty.call(obj, key);\r\n  };\r\n\r\n  // Utility Functions\r\n  // -----------------\r\n\r\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\r\n  // previous owner. Returns a reference to the Underscore object.\r\n  _.noConflict = function() {\r\n    root._ = previousUnderscore;\r\n    return this;\r\n  };\r\n\r\n  // Keep the identity function around for default iteratees.\r\n  _.identity = function(value) {\r\n    return value;\r\n  };\r\n\r\n  // Predicate-generating functions. Often useful outside of Underscore.\r\n  _.constant = function(value) {\r\n    return function() {\r\n      return value;\r\n    };\r\n  };\r\n\r\n  _.noop = function(){};\r\n\r\n  _.property = function(key) {\r\n    return function(obj) {\r\n      return obj == null ? void 0 : obj[key];\r\n    };\r\n  };\r\n\r\n  // Generates a function for a given object that returns a given property.\r\n  _.propertyOf = function(obj) {\r\n    return obj == null ? function(){} : function(key) {\r\n      return obj[key];\r\n    };\r\n  };\r\n\r\n  // Returns a predicate for checking whether an object has a given set of \r\n  // `key:value` pairs.\r\n  _.matcher = _.matches = function(attrs) {\r\n    attrs = _.extendOwn({}, attrs);\r\n    return function(obj) {\r\n      return _.isMatch(obj, attrs);\r\n    };\r\n  };\r\n\r\n  // Run a function **n** times.\r\n  _.times = function(n, iteratee, context) {\r\n    var accum = Array(Math.max(0, n));\r\n    iteratee = optimizeCb(iteratee, context, 1);\r\n    for (var i = 0; i < n; i++) accum[i] = iteratee(i);\r\n    return accum;\r\n  };\r\n\r\n  // Return a random integer between min and max (inclusive).\r\n  _.random = function(min, max) {\r\n    if (max == null) {\r\n      max = min;\r\n      min = 0;\r\n    }\r\n    return min + Math.floor(Math.random() * (max - min + 1));\r\n  };\r\n\r\n  // A (possibly faster) way to get the current timestamp as an integer.\r\n  _.now = Date.now || function() {\r\n    return new Date().getTime();\r\n  };\r\n\r\n   // List of HTML entities for escaping.\r\n  var escapeMap = {\r\n    '&': '&amp;',\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#x27;',\r\n    '`': '&#x60;'\r\n  };\r\n  var unescapeMap = _.invert(escapeMap);\r\n\r\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\r\n  var createEscaper = function(map) {\r\n    var escaper = function(match) {\r\n      return map[match];\r\n    };\r\n    // Regexes for identifying a key that needs to be escaped\r\n    var source = '(?:' + _.keys(map).join('|') + ')';\r\n    var testRegexp = RegExp(source);\r\n    var replaceRegexp = RegExp(source, 'g');\r\n    return function(string) {\r\n      string = string == null ? '' : '' + string;\r\n      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;\r\n    };\r\n  };\r\n  _.escape = createEscaper(escapeMap);\r\n  _.unescape = createEscaper(unescapeMap);\r\n\r\n  // If the value of the named `property` is a function then invoke it with the\r\n  // `object` as context; otherwise, return it.\r\n  _.result = function(object, property, fallback) {\r\n    var value = object == null ? void 0 : object[property];\r\n    if (value === void 0) {\r\n      value = fallback;\r\n    }\r\n    return _.isFunction(value) ? value.call(object) : value;\r\n  };\r\n\r\n  // Generate a unique integer id (unique within the entire client session).\r\n  // Useful for temporary DOM ids.\r\n  var idCounter = 0;\r\n  _.uniqueId = function(prefix) {\r\n    var id = ++idCounter + '';\r\n    return prefix ? prefix + id : id;\r\n  };\r\n\r\n  // By default, Underscore uses ERB-style template delimiters, change the\r\n  // following template settings to use alternative delimiters.\r\n  _.templateSettings = {\r\n    evaluate    : /<%([\\s\\S]+?)%>/g,\r\n    interpolate : /<%=([\\s\\S]+?)%>/g,\r\n    escape      : /<%-([\\s\\S]+?)%>/g\r\n  };\r\n\r\n  // When customizing `templateSettings`, if you don't want to define an\r\n  // interpolation, evaluation or escaping regex, we need one that is\r\n  // guaranteed not to match.\r\n  var noMatch = /(.)^/;\r\n\r\n  // Certain characters need to be escaped so that they can be put into a\r\n  // string literal.\r\n  var escapes = {\r\n    \"'\":      \"'\",\r\n    '\\\\':     '\\\\',\r\n    '\\r':     'r',\r\n    '\\n':     'n',\r\n    '\\u2028': 'u2028',\r\n    '\\u2029': 'u2029'\r\n  };\r\n\r\n  var escaper = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\r\n\r\n  var escapeChar = function(match) {\r\n    return '\\\\' + escapes[match];\r\n  };\r\n\r\n  // JavaScript micro-templating, similar to John Resig's implementation.\r\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\r\n  // and correctly escapes quotes within interpolated code.\r\n  // NB: `oldSettings` only exists for backwards compatibility.\r\n  _.template = function(text, settings, oldSettings) {\r\n    if (!settings && oldSettings) settings = oldSettings;\r\n    settings = _.defaults({}, settings, _.templateSettings);\r\n\r\n    // Combine delimiters into one regular expression via alternation.\r\n    var matcher = RegExp([\r\n      (settings.escape || noMatch).source,\r\n      (settings.interpolate || noMatch).source,\r\n      (settings.evaluate || noMatch).source\r\n    ].join('|') + '|$', 'g');\r\n\r\n    // Compile the template source, escaping string literals appropriately.\r\n    var index = 0;\r\n    var source = \"__p+='\";\r\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\r\n      source += text.slice(index, offset).replace(escaper, escapeChar);\r\n      index = offset + match.length;\r\n\r\n      if (escape) {\r\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\r\n      } else if (interpolate) {\r\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\r\n      } else if (evaluate) {\r\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\r\n      }\r\n\r\n      // Adobe VMs need the match returned to produce the correct offest.\r\n      return match;\r\n    });\r\n    source += \"';\\n\";\r\n\r\n    // If a variable is not specified, place data values in local scope.\r\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\r\n\r\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\r\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\r\n      source + 'return __p;\\n';\r\n\r\n    try {\r\n      var render = new Function(settings.variable || 'obj', '_', source);\r\n    } catch (e) {\r\n      e.source = source;\r\n      throw e;\r\n    }\r\n\r\n    var template = function(data) {\r\n      return render.call(this, data, _);\r\n    };\r\n\r\n    // Provide the compiled source as a convenience for precompilation.\r\n    var argument = settings.variable || 'obj';\r\n    template.source = 'function(' + argument + '){\\n' + source + '}';\r\n\r\n    return template;\r\n  };\r\n\r\n  // Add a \"chain\" function. Start chaining a wrapped Underscore object.\r\n  _.chain = function(obj) {\r\n    var instance = _(obj);\r\n    instance._chain = true;\r\n    return instance;\r\n  };\r\n\r\n  // OOP\r\n  // ---------------\r\n  // If Underscore is called as a function, it returns a wrapped object that\r\n  // can be used OO-style. This wrapper holds altered versions of all the\r\n  // underscore functions. Wrapped objects may be chained.\r\n\r\n  // Helper function to continue chaining intermediate results.\r\n  var result = function(instance, obj) {\r\n    return instance._chain ? _(obj).chain() : obj;\r\n  };\r\n\r\n  // Add your own custom functions to the Underscore object.\r\n  _.mixin = function(obj) {\r\n    _.each(_.functions(obj), function(name) {\r\n      var func = _[name] = obj[name];\r\n      _.prototype[name] = function() {\r\n        var args = [this._wrapped];\r\n        push.apply(args, arguments);\r\n        return result(this, func.apply(_, args));\r\n      };\r\n    });\r\n  };\r\n\r\n  // Add all of the Underscore functions to the wrapper object.\r\n  _.mixin(_);\r\n\r\n  // Add all mutator Array functions to the wrapper.\r\n  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\r\n    var method = ArrayProto[name];\r\n    _.prototype[name] = function() {\r\n      var obj = this._wrapped;\r\n      method.apply(obj, arguments);\r\n      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];\r\n      return result(this, obj);\r\n    };\r\n  });\r\n\r\n  // Add all accessor Array functions to the wrapper.\r\n  _.each(['concat', 'join', 'slice'], function(name) {\r\n    var method = ArrayProto[name];\r\n    _.prototype[name] = function() {\r\n      return result(this, method.apply(this._wrapped, arguments));\r\n    };\r\n  });\r\n\r\n  // Extracts the result from a wrapped and chained object.\r\n  _.prototype.value = function() {\r\n    return this._wrapped;\r\n  };\r\n\r\n  // Provide unwrapping proxy for some methods used in engine operations\r\n  // such as arithmetic and JSON stringification.\r\n  _.prototype.valueOf = _.prototype.toJSON = _.prototype.value;\r\n  \r\n  _.prototype.toString = function() {\r\n    return '' + this._wrapped;\r\n  };\r\n\r\n  // AMD registration happens at the end for compatibility with AMD loaders\r\n  // that may not enforce next-turn semantics on modules. Even though general\r\n  // practice for AMD registration is to be anonymous, underscore registers\r\n  // as a named module because, like jQuery, it is a base library that is\r\n  // popular enough to be bundled in a third party lib, but not be part of\r\n  // an AMD load request. Those cases could generate an error when an\r\n  // anonymous define() is called outside of a loader request.\r\n  if (typeof define === 'function' && define.amd) {\r\n    define('underscore', [], function() {\r\n      return _;\r\n    });\r\n  }\r\n}.call(this));","extjs/ext-tree-checkbox.js":"/**\r\n * Retrieve an array of ids of checked nodes\r\n * @return {Array} array of ids of checked nodes\r\n */\r\nExt.tree.TreePanel.prototype.getChecked = function(node){\r\n    var checked = [], i;\r\n    if( typeof node == 'undefined' ) {\r\n        //node = this.rootVisible ? this.getRootNode() : this.getRootNode().firstChild;\r\n        node = this.getRootNode();\r\n    }\r\n\r\n    if( node.attributes.checked ) {\r\n        checked.push(node.id);\r\n    }\r\n    if( node.childNodes.length ) {\r\n        for( i = 0; i < node.childNodes.length; i++ ) {\r\n            checked = checked.concat( this.getChecked(node.childNodes[i]) );\r\n        }\r\n    }\r\n\r\n    return checked;\r\n};\r\n\r\n/**\r\n * @class Ext.tree.CustomUITreeLoader\r\n * @extends Ext.tree.TreeLoader\r\n * Overrides createNode to force uiProvider to be an arbitrary TreeNodeUI to save bandwidth\r\n */\r\nExt.tree.CustomUITreeLoader = function() {\r\n    Ext.tree.CustomUITreeLoader.superclass.constructor.apply(this, arguments);\r\n};\r\n\r\nExt.extend(Ext.tree.CustomUITreeLoader, Ext.tree.TreeLoader, {\r\n    createNode : function(attr){\r\n        Ext.apply(attr, this.baseAttr || {});\r\n\r\n        if(this.applyLoader !== false){\r\n            attr.loader = this;\r\n        }\r\n\r\n        if(typeof attr.uiProvider == 'string'){\r\n            attr.uiProvider = this.uiProviders[attr.uiProvider] || eval(attr.uiProvider);\r\n        }\r\n\r\n        return(attr.leaf ?\r\n            new Ext.tree.TreeNode(attr) :\r\n                new Ext.tree.AsyncTreeNode(attr));\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * @class Ext.tree.CheckboxNodeUI\r\n * @extends Ext.tree.TreeNodeUI\r\n * Adds a checkbox to all nodes\r\n */\r\nExt.tree.CheckboxNodeUI = function() {\r\n    Ext.tree.CheckboxNodeUI.superclass.constructor.apply(this, arguments);\r\n};\r\n\r\nExt.extend(Ext.tree.CheckboxNodeUI, Ext.tree.TreeNodeUI, {\r\n    /**\r\n     * This is virtually identical to Ext.tree.TreeNodeUI.render, modifications are indicated inline\r\n     */\r\n    render : function(bulkRender){\r\n        var n = this.node;\r\n        var targetNode = n.parentNode ?\r\n            n.parentNode.ui.getContainer() : n.ownerTree.container.dom; /* in later svn builds this changes to n.ownerTree.innerCt.dom */\r\n        if(!this.rendered){\r\n            this.rendered = true;\r\n            var a = n.attributes;\r\n\r\n            // add some indent caching, this helps performance when rendering a large tree\r\n            this.indentMarkup = \"\";\r\n            if(n.parentNode){\r\n                this.indentMarkup = n.parentNode.ui.getChildIndent();\r\n            }\r\n\r\n            // modification: added checkbox\r\n            var buf = ['<li class=\"x-tree-node\"><div class=\"x-tree-node-el ', n.attributes.cls,'\">',\r\n                '<span class=\"x-tree-node-indent\">',this.indentMarkup,\"</span>\",\r\n                '<img src=\"', this.emptyIcon, '\" class=\"x-tree-ec-icon\">',\r\n                '<img src=\"', a.icon || this.emptyIcon, '\" class=\"x-tree-node-icon',(a.icon ? \" x-tree-node-inline-icon\" : \"\"),(a.iconCls ? \" \"+a.iconCls : \"\"),'\" unselectable=\"on\">',\r\n                '<input class=\"l-tcb\" '+ (n.disabled ? 'disabled=\"disabled\" ' : '') +' type=\"checkbox\" ', (a.checked ? \"checked>\" : '>'),\r\n                '<a hidefocus=\"on\" href=\"',a.href ? a.href : \"#\",'\" ',\r\n                 a.hrefTarget ? ' target=\"'+a.hrefTarget+'\"' : \"\", '>',\r\n                 '<span unselectable=\"on\">',n.text,\"</span></a></div>\",\r\n                '<ul class=\"x-tree-node-ct\" style=\"display:none;\"></ul>',\r\n                \"</li>\"];\r\n\r\n            if(bulkRender !== true && n.nextSibling && n.nextSibling.ui.getEl()){\r\n                this.wrap = Ext.DomHelper.insertHtml(\"beforeBegin\",\r\n                                                            n.nextSibling.ui.getEl(), buf.join(\"\"));\r\n            }else{\r\n                this.wrap = Ext.DomHelper.insertHtml(\"beforeEnd\", targetNode, buf.join(\"\"));\r\n            }\r\n            this.elNode = this.wrap.childNodes[0];\r\n            this.ctNode = this.wrap.childNodes[1];\r\n            var cs = this.elNode.childNodes;\r\n            this.indentNode = cs[0];\r\n            this.ecNode = cs[1];\r\n            this.iconNode = cs[2];\r\n            this.checkbox = cs[3]; // modification: inserted checkbox\r\n            this.anchor = cs[4];\r\n            this.textNode = cs[4].firstChild;\r\n            if(a.qtip){\r\n             if(this.textNode.setAttributeNS){\r\n                 this.textNode.setAttributeNS(\"ext\", \"qtip\", a.qtip);\r\n                 if(a.qtipTitle){\r\n                     this.textNode.setAttributeNS(\"ext\", \"qtitle\", a.qtipTitle);\r\n                 }\r\n             }else{\r\n                 this.textNode.setAttribute(\"ext:qtip\", a.qtip);\r\n                 if(a.qtipTitle){\r\n                     this.textNode.setAttribute(\"ext:qtitle\", a.qtipTitle);\r\n                 }\r\n             }\r\n            } else if(a.qtipCfg) {\r\n                a.qtipCfg.target = Ext.id(this.textNode);\r\n                Ext.QuickTips.register(a.qtipCfg);\r\n            }\r\n\r\n            this.initEvents();\r\n\r\n            // modification: Add additional handlers here to avoid modifying Ext.tree.TreeNodeUI\r\n            Ext.fly(this.checkbox).on('click', this.check.createDelegate(this, [null]));\r\n            n.on('dblclick', function(e) {\r\n                if( this.isLeaf() ) {\r\n                    this.getUI().toggleCheck();\r\n                }\r\n            });\r\n\r\n            if(!this.node.expanded){\r\n                this.updateExpandIcon();\r\n            }\r\n        }else{\r\n            if(bulkRender === true) {\r\n                targetNode.appendChild(this.wrap);\r\n            }\r\n        }\r\n    },\r\n\r\n    checked : function() {\r\n        return this.checkbox.checked;\r\n    },\r\n\r\n    /**\r\n     * Sets a checkbox appropriately.  By default only walks down through child nodes\r\n     * if called with no arguments (onchange event from the checkbox), otherwise\r\n     * it's assumed the call is being made programatically and the correct arguments are provided.\r\n     * @param {Boolean} state true to check the checkbox, false to clear it. (defaults to the opposite of the checkbox.checked)\r\n     * @param {Boolean} descend true to walk through the nodes children and set their checkbox values. (defaults to false)\r\n     */\r\n    check : function(state, descend, bulk) {\r\n        if (this.node.disabled) {\r\n            return;\r\n        }\r\n        var n = this.node;\r\n        var tree = n.getOwnerTree();\r\n        var parentNode = n.parentNode;n\r\n        if( !n.expanded && !n.childrenRendered ) {\r\n            n.expand(false, false, this.check.createDelegate(this, arguments));\r\n        }\r\n\r\n        if( typeof bulk == 'undefined' ) {\r\n            bulk = false;\r\n        }\r\n        if( typeof state == 'undefined' || state === null ) {\r\n            state = this.checkbox.checked;\r\n            descend = !state;\r\n            if( state ) {\r\n                n.expand(false, false);\r\n            }\r\n        } else {\r\n            this.checkbox.checked = state;\r\n        }\r\n        n.attributes.checked = state;\r\n\r\n        // do we have parents?\r\n        if( parentNode !== null && state ) {\r\n            // if we're checking the box, check it all the way up\r\n            if( parentNode.getUI().check ) {\r\n                //parentNode.getUI().check(state, false, true);\r\n            }\r\n        }\r\n        if( descend && !n.isLeaf() ) {\r\n            var cs = n.childNodes;\r\n      for(var i = 0; i < cs.length; i++) {\r\n        //cs[i].getUI().check(state, true, true);\r\n      }\r\n        }\r\n        if( !bulk ) {\r\n            tree.fireEvent('check', n, state);\r\n        }\r\n    },\r\n\r\n    toggleCheck : function(state) {\r\n        this.check(!this.checkbox.checked, true);\r\n    }\r\n\r\n});\r\n\r\n\r\n/**\r\n * @class Ext.tree.CheckNodeMultiSelectionModel\r\n * @extends Ext.tree.MultiSelectionModel\r\n * Multi selection for a TreePanel containing Ext.tree.CheckboxNodeUI.\r\n * Adds enhanced selection routines for selecting multiple items\r\n * and key processing to check/clear checkboxes.\r\n */\r\nExt.tree.CheckNodeMultiSelectionModel = function(){\r\n   Ext.tree.CheckNodeMultiSelectionModel.superclass.constructor.call(this);\r\n};\r\n\r\nExt.extend(Ext.tree.CheckNodeMultiSelectionModel, Ext.tree.MultiSelectionModel, {\r\n    init : function(tree){\r\n        this.tree = tree;\r\n        tree.el.on(\"keydown\", this.onKeyDown, this);\r\n        tree.on(\"click\", this.onNodeClick, this);\r\n    },\r\n\r\n    /**\r\n     * Handle a node click\r\n     * If ctrl key is down and node is selected will unselect the node.\r\n     * If the shift key is down it will create a contiguous selection\r\n     * (see {@link Ext.tree.CheckNodeMultiSelectionModel#extendSelection} for the limitations)\r\n     */\r\n    onNodeClick : function(node, e){\r\n        if (node.disabled) {\r\n            return;\r\n        }\r\n        if( e.shiftKey && this.extendSelection(node) ) {\r\n            return true;\r\n        }\r\n        if( e.ctrlKey && this.isSelected(node) ) {\r\n            this.unselect(node);\r\n        } else {\r\n            this.select(node, e, e.ctrlKey);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Selects all nodes between the previously selected node and the one that the user has just selected.\r\n     * Will not span multiple depths, so only children of the same parent will be selected.\r\n     */\r\n    extendSelection : function(node) {\r\n        var last = this.lastSelNode;\r\n        if( node == last || !last ) {\r\n            return false; /* same selection, process normally normally */\r\n        }\r\n\r\n        if( node.parentNode == last.parentNode ) {\r\n            var cs = node.parentNode.childNodes;\r\n            var i = 0, attr='id', selecting=false, lastSelect=false;\r\n            this.clearSelections(true);\r\n            for( i = 0; i < cs.length; i++ ) {\r\n                // We have to traverse the entire tree b/c don't know of a way to find\r\n                // a numerical representation of a nodes position in a tree.\r\n                if( cs[i].attributes[attr] == last.attributes[attr] || cs[i].attributes[attr] == node.attributes[attr] ) {\r\n                    // lastSelect ensures that we select the final node in the list\r\n                    lastSelect = selecting;\r\n                    selecting = !selecting;\r\n                }\r\n                if( selecting || lastSelect ) {\r\n                    this.select(cs[i], null, true);\r\n                    // if we're selecting the last node break to avoid traversing the entire tree\r\n                    if( lastSelect ) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Traps the press of the SPACE bar and sets the check state of selected nodes to the opposite state of\r\n     * the selected or last selected node.  Assume you have the following five Ext.tree.CheckboxNodeUIs:\r\n     * [X] One, [X] Two, [X] Three, [ ] Four, [ ] Five\r\n     * If you select them in this order: One, Two, Three, Four, Five and press the space bar they all\r\n     * will be <b>checked</b> (the opposite of the checkbox state of Five).\r\n     * If you select them in this order: Five, Four, Three, Two, One and press the space bar they all\r\n     * will be <b>unchecked</b> which is the opposite of the checkbox state of One.\r\n     */\r\n    onKeyDown : Ext.tree.DefaultSelectionModel.prototype.onKeyDown.createInterceptor(function(e) {\r\n        var s = this.selNode || this.lastSelNode;\r\n        // undesirable, but required\r\n        var sm = this;\r\n        if(!s){\r\n            return;\r\n        }\r\n        var k = e.getKey();\r\n        switch(k){\r\n                case e.SPACE:\r\n                    e.stopEvent();\r\n                    var sel = this.getSelectedNodes();\r\n                    var state = !s.getUI().checked();\r\n                    if( sel.length == 1 ) {\r\n                        s.getUI().check(state, !s.isLeaf());\r\n                    } else {\r\n                        for( var i = 0; i < sel.length; i++ ) {\r\n                            sel[i].getUI().check(state, !sel[i].isLeaf() );\r\n                        }\r\n                    }\r\n            break;\r\n        }\r\n\r\n        return true;\r\n    })\r\n});\r\n","extjs/ext-tree.js":"/*\r\n * Ext JS Library 1.0.1\r\n * Copyright(c) 2006-2007, Ext JS, LLC.\r\n * licensing@extjs.com\r\n *\r\n * http://www.extjs.com/license\r\n */\r\n\r\nExt={};window[\"undefined\"]=window[\"undefined\"];Ext.apply=function(o,c,_3){if(_3){Ext.apply(o,_3);}if(o&&c&&typeof c==\"object\"){for(var p in c){o[p]=c[p];}}return o;};(function(){var _5=0;var ua=navigator.userAgent.toLowerCase();var _7=document.compatMode==\"CSS1Compat\",_8=ua.indexOf(\"opera\")>-1,_9=(/webkit|khtml/).test(ua),_a=ua.indexOf(\"msie\")>-1,_b=ua.indexOf(\"msie 7\")>-1,_c=!_9&&ua.indexOf(\"gecko\")>-1,_d=_a&&!_7,_e=(ua.indexOf(\"windows\")!=-1||ua.indexOf(\"win32\")!=-1),_f=(ua.indexOf(\"macintosh\")!=-1||ua.indexOf(\"mac os x\")!=-1),_10=window.location.href.toLowerCase().indexOf(\"https\")===0;if(_a&&!_b){try{document.execCommand(\"BackgroundImageCache\",false,true);}catch(e){}}Ext.apply(Ext,{isStrict:_7,isSecure:_10,isReady:false,SSL_SECURE_URL:\"javascript:false\",BLANK_IMAGE_URL:\"http:/\"+\"/extjs.com/s.gif\",emptyFn:function(){},applyIf:function(o,c){if(o&&c){for(var p in c){if(typeof o[p]==\"undefined\"){o[p]=c[p];}}}return o;},addBehaviors:function(o){if(!Ext.isReady){Ext.onReady(function(){Ext.addBehaviors(o);});return;}var _15={};for(var b in o){var _17=b.split(\"@\");if(_17[1]){var s=_17[0];if(!_15[s]){_15[s]=Ext.select(s);}_15[s].on(_17[1],o[b]);}}_15=null;},id:function(el,_1a){_1a=_1a||\"ext-gen\";el=Ext.getDom(el);var id=_1a+(++_5);return el?(el.id?el.id:(el.id=id)):id;},extend:function(){var io=function(o){for(var m in o){this[m]=o[m];}};return function(sb,sp,_21){if(typeof sp==\"object\"){_21=sp;sp=sb;sb=function(){sp.apply(this,arguments);};}var F=function(){},sbp,spp=sp.prototype;F.prototype=spp;sbp=sb.prototype=new F();sbp.constructor=sb;sb.superclass=spp;if(spp.constructor==Object.prototype.constructor){spp.constructor=sp;}sb.override=function(o){Ext.override(sb,o);};sbp.override=io;sbp.__extcls=sb;Ext.override(sb,_21);return sb;};}(),override:function(_26,_27){if(_27){var p=_26.prototype;for(var _29 in _27){p[_29]=_27[_29];}}},namespace:function(){var a=arguments,o=null,i,j,d,rt;for(i=0;i<a.length;++i){d=a[i].split(\".\");rt=d[0];eval(\"if (typeof \"+rt+\" == \\\"undefined\\\"){\"+rt+\" = {};} o = \"+rt+\";\");for(j=1;j<d.length;++j){o[d[j]]=o[d[j]]||{};o=o[d[j]];}}},urlEncode:function(o){if(!o){return \"\";}var buf=[];for(var key in o){var ov=o[key];var _34=typeof ov;if(_34==\"undefined\"){buf.push(encodeURIComponent(key),\"=&\");}else{if(_34!=\"function\"&&_34!=\"object\"){buf.push(encodeURIComponent(key),\"=\",encodeURIComponent(ov),\"&\");}else{if(ov instanceof Array){for(var i=0,len=ov.length;i<len;i++){buf.push(encodeURIComponent(key),\"=\",encodeURIComponent(ov[i]===undefined?\"\":ov[i]),\"&\");}}}}}buf.pop();return buf.join(\"\");},urlDecode:function(_37,_38){if(!_37||!_37.length){return {};}var obj={};var _3a=_37.split(\"&\");var _3b,_3c,_3d;for(var i=0,len=_3a.length;i<len;i++){_3b=_3a[i].split(\"=\");_3c=decodeURIComponent(_3b[0]);_3d=decodeURIComponent(_3b[1]);if(_38!==true){if(typeof obj[_3c]==\"undefined\"){obj[_3c]=_3d;}else{if(typeof obj[_3c]==\"string\"){obj[_3c]=[obj[_3c]];obj[_3c].push(_3d);}else{obj[_3c].push(_3d);}}}else{obj[_3c]=_3d;}}return obj;},each:function(_40,fn,_42){if(typeof _40.length==\"undefined\"||typeof _40==\"string\"){_40=[_40];}for(var i=0,len=_40.length;i<len;i++){if(fn.call(_42||_40[i],_40[i],i,_40)===false){return i;}}},combine:function(){var as=arguments,l=as.length,r=[];for(var i=0;i<l;i++){var a=as[i];if(a instanceof Array){r=r.concat(a);}else{if(a.length!==undefined&&!a.substr){r=r.concat(Array.prototype.slice.call(a,0));}else{r.push(a);}}}return r;},escapeRe:function(s){return s.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,\"\\\\$1\");},callback:function(cb,_4c,_4d,_4e){if(typeof cb==\"function\"){if(_4e){cb.defer(_4e,_4c,_4d||[]);}else{cb.apply(_4c,_4d||[]);}}},getDom:function(el){if(!el){return null;}return el.dom?el.dom:(typeof el==\"string\"?document.getElementById(el):el);},getCmp:function(id){return Ext.ComponentMgr.get(id);},num:function(v,_52){if(typeof v!=\"number\"){return _52;}return v;},destroy:function(){for(var i=0,a=arguments,len=a.length;i<len;i++){var as=a[i];if(as){if(as.dom){as.removeAllListeners();as.remove();continue;}if(typeof as.purgeListeners==\"function\"){as.purgeListeners();}if(typeof as.destroy==\"function\"){as.destroy();}}}},isOpera:_8,isSafari:_9,isIE:_a,isIE7:_b,isGecko:_c,isBorderBox:_d,isWindows:_e,isMac:_f,useShims:((_a&&!_b)||(_c&&_f))});})();Ext.namespace(\"Ext\",\"Ext.util\",\"Ext.grid\",\"Ext.dd\",\"Ext.tree\",\"Ext.data\",\"Ext.form\",\"Ext.menu\",\"Ext.state\",\"Ext.lib\",\"Ext.layout\");Ext.apply(Function.prototype,{createCallback:function(){var _57=arguments;var _58=this;return function(){return _58.apply(window,_57);};},createDelegate:function(obj,_5a,_5b){var _5c=this;return function(){var _5d=_5a||arguments;if(_5b===true){_5d=Array.prototype.slice.call(arguments,0);_5d=_5d.concat(_5a);}else{if(typeof _5b==\"number\"){_5d=Array.prototype.slice.call(arguments,0);var _5e=[_5b,0].concat(_5a);Array.prototype.splice.apply(_5d,_5e);}}return _5c.apply(obj||window,_5d);};},defer:function(_5f,obj,_61,_62){var fn=this.createDelegate(obj,_61,_62);if(_5f){return setTimeout(fn,_5f);}fn();return 0;},createSequence:function(fcn,_65){if(typeof fcn!=\"function\"){return this;}var _66=this;return function(){var _67=_66.apply(this||window,arguments);fcn.apply(_65||this||window,arguments);return _67;};},createInterceptor:function(fcn,_69){if(typeof fcn!=\"function\"){return this;}var _6a=this;return function(){fcn.target=this;fcn.method=_6a;if(fcn.apply(_69||this||window,arguments)===false){return;}return _6a.apply(this||window,arguments);};}});Ext.applyIf(String,{escape:function(_6b){return _6b.replace(/('|\\\\)/g,\"\\\\$1\");},leftPad:function(val,_6d,ch){var _6f=new String(val);if(ch==null){ch=\" \";}while(_6f.length<_6d){_6f=ch+_6f;}return _6f;},format:function(_70){var _71=Array.prototype.slice.call(arguments,1);return _70.replace(/\\{(\\d+)\\}/g,function(m,i){return _71[i];});}});String.prototype.toggle=function(_74,_75){return this==_74?_75:_74;};Ext.applyIf(Number.prototype,{constrain:function(min,max){return Math.min(Math.max(this,min),max);}});Ext.applyIf(Array.prototype,{indexOf:function(o){for(var i=0,len=this.length;i<len;i++){if(this[i]==o){return i;}}return -1;},remove:function(o){var _7c=this.indexOf(o);if(_7c!=-1){this.splice(_7c,1);}}});Date.prototype.getElapsed=function(_7d){return Math.abs((_7d||new Date()).getTime()-this.getTime());};\r\n\r\n\r\n\r\n(function(){var _1;Ext.lib.Dom={getViewWidth:function(_2){return _2?this.getDocumentWidth():this.getViewportWidth();},getViewHeight:function(_3){return _3?this.getDocumentHeight():this.getViewportHeight();},getDocumentHeight:function(){var _4=(document.compatMode!=\"CSS1Compat\")?document.body.scrollHeight:document.documentElement.scrollHeight;return Math.max(_4,this.getViewportHeight());},getDocumentWidth:function(){var _5=(document.compatMode!=\"CSS1Compat\")?document.body.scrollWidth:document.documentElement.scrollWidth;return Math.max(_5,this.getViewportWidth());},getViewportHeight:function(){var _6=self.innerHeight;var _7=document.compatMode;if((_7||Ext.isIE)&&!Ext.isOpera){_6=(_7==\"CSS1Compat\")?document.documentElement.clientHeight:document.body.clientHeight;}return _6;},getViewportWidth:function(){var _8=self.innerWidth;var _9=document.compatMode;if(_9||Ext.isIE){_8=(_9==\"CSS1Compat\")?document.documentElement.clientWidth:document.body.clientWidth;}return _8;},isAncestor:function(p,c){p=Ext.getDom(p);c=Ext.getDom(c);if(!p||!c){return false;}if(p.contains&&!Ext.isSafari){return p.contains(c);}else{if(p.compareDocumentPosition){return !!(p.compareDocumentPosition(c)&16);}else{var _c=c.parentNode;while(_c){if(_c==p){return true;}else{if(!_c.tagName||_c.tagName.toUpperCase()==\"HTML\"){return false;}}_c=_c.parentNode;}return false;}}},getRegion:function(el){return Ext.lib.Region.getRegion(el);},getY:function(el){return this.getXY(el)[1];},getX:function(el){return this.getXY(el)[0];},getXY:function(el){var p,pe,b,_14,bd=document.body;el=Ext.getDom(el);if(el.getBoundingClientRect){b=el.getBoundingClientRect();_14=fly(document).getScroll();return [b.left+_14.left,b.top+_14.top];}else{var x=el.offsetLeft,y=el.offsetTop;p=el.offsetParent;var _18=false;if(p!=el){while(p){x+=p.offsetLeft;y+=p.offsetTop;if(Ext.isSafari&&!_18&&fly(p).getStyle(\"position\")==\"absolute\"){_18=true;}if(Ext.isGecko){pe=fly(p);var bt=parseInt(pe.getStyle(\"borderTopWidth\"),10)||0;var bl=parseInt(pe.getStyle(\"borderLeftWidth\"),10)||0;x+=bl;y+=bt;if(p!=el&&pe.getStyle(\"overflow\")!=\"visible\"){x+=bl;y+=bt;}}p=p.offsetParent;}}if(Ext.isSafari&&(_18||fly(el).getStyle(\"position\")==\"absolute\")){x-=bd.offsetLeft;y-=bd.offsetTop;}}p=el.parentNode;while(p&&p!=bd){if(!Ext.isOpera||(Ext.isOpera&&p.tagName!=\"TR\"&&fly(p).getStyle(\"display\")!=\"inline\")){x-=p.scrollLeft;y-=p.scrollTop;}p=p.parentNode;}return [x,y];},setXY:function(el,xy){el=Ext.fly(el,\"_setXY\");el.position();var pts=el.translatePoints(xy);if(xy[0]!==false){el.dom.style.left=pts.left+\"px\";}if(xy[1]!==false){el.dom.style.top=pts.top+\"px\";}},setX:function(el,x){this.setXY(el,[x,false]);},setY:function(el,y){this.setXY(el,[false,y]);}};Ext.lib.Event={getPageX:function(e){return Event.pointerX(e.browserEvent||e);},getPageY:function(e){return Event.pointerY(e.browserEvent||e);},getXY:function(e){e=e.browserEvent||e;return [Event.pointerX(e),Event.pointerY(e)];},getTarget:function(e){return Event.element(e.browserEvent||e);},resolveTextNode:function(_26){if(_26&&3==_26.nodeType){return _26.parentNode;}else{return _26;}},getRelatedTarget:function(ev){ev=ev.browserEvent||ev;var t=ev.relatedTarget;if(!t){if(ev.type==\"mouseout\"){t=ev.toElement;}else{if(ev.type==\"mouseover\"){t=ev.fromElement;}}}return this.resolveTextNode(t);},on:function(el,_2a,fn){Event.observe(el,_2a,fn,false);},un:function(el,_2d,fn){Event.stopObserving(el,_2d,fn,false);},purgeElement:function(el){},preventDefault:function(e){e=e.browserEvent||e;if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}},stopPropagation:function(e){e=e.browserEvent||e;if(e.stopPropagation){e.stopPropagation();}else{e.cancelBubble=true;}},stopEvent:function(e){Event.stop(e.browserEvent||e);},onAvailable:function(el,fn,_35,_36){var _37=new Date(),iid;var f=function(){if(_37.getElapsed()>10000){clearInterval(iid);}var el=document.getElementById(id);if(el){clearInterval(iid);fn.call(_35||window,el);}};iid=setInterval(f,50);}};Ext.lib.Ajax=function(){var _3b=function(cb){return cb.success?function(xhr){cb.success.call(cb.scope||window,{responseText:xhr.responseText,responseXML:xhr.responseXML,argument:cb.argument});}:Ext.emptyFn;};var _3e=function(cb){return cb.failure?function(xhr){cb.failure.call(cb.scope||window,{responseText:xhr.responseText,responseXML:xhr.responseXML,argument:cb.argument});}:Ext.emptyFn;};return {request:function(_41,uri,cb,_44){new Ajax.Request(uri,{method:_41,parameters:_44||\"\",timeout:cb.timeout,onSuccess:_3b(cb),onFailure:_3e(cb)});},formRequest:function(_45,uri,cb,_48,_49,_4a){new Ajax.Request(uri,{method:Ext.getDom(_45).method||\"POST\",parameters:Form.serialize(_45)+(_48?\"&\"+_48:\"\"),timeout:cb.timeout,onSuccess:_3b(cb),onFailure:_3e(cb)});},isCallInProgress:function(_4b){return false;},abort:function(_4c){return false;},serializeForm:function(_4d){return Form.serialize(_4d.dom||_4d,true);}};}();Ext.lib.Anim=function(){var _4e={easeOut:function(pos){return 1-Math.pow(1-pos,2);},easeIn:function(pos){return 1-Math.pow(1-pos,2);}};var _51=function(cb,_53){return {stop:function(_54){this.effect.cancel();},isAnimated:function(){return this.effect.state==\"running\";},proxyCallback:function(){Ext.callback(cb,_53);}};};return {scroll:function(el,_56,_57,_58,cb,_5a){var _5b=_51(cb,_5a);el=Ext.getDom(el);el.scrollLeft=_56.to[0];el.scrollTop=_56.to[1];_5b.proxyCallback();return _5b;},motion:function(el,_5d,_5e,_5f,cb,_61){return this.run(el,_5d,_5e,_5f,cb,_61);},color:function(el,_63,_64,_65,cb,_67){return this.run(el,_63,_64,_65,cb,_67);},run:function(el,_69,_6a,_6b,cb,_6d,_6e){var o={};for(var k in _69){switch(k){case \"points\":var by,pts,e=Ext.fly(el,\"_animrun\");e.position();if(by=_69.points.by){var xy=e.getXY();pts=e.translatePoints([xy[0]+by[0],xy[1]+by[1]]);}else{pts=e.translatePoints(_69.points.to);}o.left=pts.left+\"px\";o.top=pts.top+\"px\";break;case \"width\":o.width=_69.width.to+\"px\";break;case \"height\":o.height=_69.height.to+\"px\";break;case \"opacity\":o.opacity=String(_69.opacity.to);break;default:o[k]=String(_69[k].to);break;}}var _75=_51(cb,_6d);_75.effect=new Effect.Morph(Ext.id(el),{duration:_6a,afterFinish:_75.proxyCallback,transition:_4e[_6b]||Effect.Transitions.linear,style:o});return _75;}};}();function fly(el){if(!_1){_1=new Ext.Element.Flyweight();}_1.dom=el;return _1;}Ext.lib.Region=function(t,r,b,l){this.top=t;this[1]=t;this.right=r;this.bottom=b;this.left=l;this[0]=l;};Ext.lib.Region.prototype={contains:function(_7b){return (_7b.left>=this.left&&_7b.right<=this.right&&_7b.top>=this.top&&_7b.bottom<=this.bottom);},getArea:function(){return ((this.bottom-this.top)*(this.right-this.left));},intersect:function(_7c){var t=Math.max(this.top,_7c.top);var r=Math.min(this.right,_7c.right);var b=Math.min(this.bottom,_7c.bottom);var l=Math.max(this.left,_7c.left);if(b>=t&&r>=l){return new Ext.lib.Region(t,r,b,l);}else{return null;}},union:function(_81){var t=Math.min(this.top,_81.top);var r=Math.max(this.right,_81.right);var b=Math.max(this.bottom,_81.bottom);var l=Math.min(this.left,_81.left);return new Ext.lib.Region(t,r,b,l);},adjust:function(t,l,b,r){this.top+=t;this.left+=l;this.right+=r;this.bottom+=b;return this;}};Ext.lib.Region.getRegion=function(el){var p=Ext.lib.Dom.getXY(el);var t=p[1];var r=p[0]+el.offsetWidth;var b=p[1]+el.offsetHeight;var l=p[0];return new Ext.lib.Region(t,r,b,l);};Ext.lib.Point=function(x,y){if(x instanceof Array){y=x[1];x=x[0];}this.x=this.right=this.left=this[0]=x;this.y=this.top=this.bottom=this[1]=y;};Ext.lib.Point.prototype=new Ext.lib.Region();if(Ext.isIE){Event.observe(window,\"unload\",function(){var p=Function.prototype;delete p.createSequence;delete p.defer;delete p.createDelegate;delete p.createCallback;delete p.createInterceptor;});}})();\r\n\r\n\r\n\r\nExt.DomHelper=function(){var _1=null;var _2=/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i;var _3=function(o){if(typeof o==\"string\"){return o;}var b=\"\";if(!o.tag){o.tag=\"div\";}b+=\"<\"+o.tag;for(var _6 in o){if(_6==\"tag\"||_6==\"children\"||_6==\"cn\"||_6==\"html\"||typeof o[_6]==\"function\"){continue;}if(_6==\"style\"){var s=o[\"style\"];if(typeof s==\"function\"){s=s.call();}if(typeof s==\"string\"){b+=\" style=\\\"\"+s+\"\\\"\";}else{if(typeof s==\"object\"){b+=\" style=\\\"\";for(var _8 in s){if(typeof s[_8]!=\"function\"){b+=_8+\":\"+s[_8]+\";\";}}b+=\"\\\"\";}}}else{if(_6==\"cls\"){b+=\" class=\\\"\"+o[\"cls\"]+\"\\\"\";}else{if(_6==\"htmlFor\"){b+=\" for=\\\"\"+o[\"htmlFor\"]+\"\\\"\";}else{b+=\" \"+_6+\"=\\\"\"+o[_6]+\"\\\"\";}}}}if(_2.test(o.tag)){b+=\"/>\";}else{b+=\">\";var cn=o.children||o.cn;if(cn){if(cn instanceof Array){for(var i=0,_b=cn.length;i<_b;i++){b+=_3(cn[i],b);}}else{b+=_3(cn,b);}}if(o.html){b+=o.html;}b+=\"</\"+o.tag+\">\";}return b;};var _c=function(o,_e){var el=document.createElement(o.tag);var _10=el.setAttribute?true:false;for(var _11 in o){if(_11==\"tag\"||_11==\"children\"||_11==\"cn\"||_11==\"html\"||_11==\"style\"||typeof o[_11]==\"function\"){continue;}if(_11==\"cls\"){el.className=o[\"cls\"];}else{if(_10){el.setAttribute(_11,o[_11]);}else{el[_11]=o[_11];}}}Ext.DomHelper.applyStyles(el,o.style);var cn=o.children||o.cn;if(cn){if(cn instanceof Array){for(var i=0,len=cn.length;i<len;i++){_c(cn[i],el);}}else{_c(cn,el);}}if(o.html){el.innerHTML=o.html;}if(_e){_e.appendChild(el);}return el;};var _15=function(_16,s,h,e){_1.innerHTML=[s,h,e].join(\"\");var i=-1,el=_1;while(++i<_16){el=el.firstChild;}return el;};var ts=\"<table>\",te=\"</table>\",tbs=ts+\"<tbody>\",tbe=\"</tbody>\"+te,trs=tbs+\"<tr>\",tre=\"</tr>\"+tbe;var _22=function(tag,_24,el,_26){if(!_1){_1=document.createElement(\"div\");}var _27;var _28=null;if(tag==\"td\"){if(_24==\"afterbegin\"||_24==\"beforeend\"){return;}if(_24==\"beforebegin\"){_28=el;el=el.parentNode;}else{_28=el.nextSibling;el=el.parentNode;}_27=_15(4,trs,_26,tre);}else{if(tag==\"tr\"){if(_24==\"beforebegin\"){_28=el;el=el.parentNode;_27=_15(3,tbs,_26,tbe);}else{if(_24==\"afterend\"){_28=el.nextSibling;el=el.parentNode;_27=_15(3,tbs,_26,tbe);}else{if(_24==\"afterbegin\"){_28=el.firstChild;}_27=_15(4,trs,_26,tre);}}}else{if(tag==\"tbody\"){if(_24==\"beforebegin\"){_28=el;el=el.parentNode;_27=_15(2,ts,_26,te);}else{if(_24==\"afterend\"){_28=el.nextSibling;el=el.parentNode;_27=_15(2,ts,_26,te);}else{if(_24==\"afterbegin\"){_28=el.firstChild;}_27=_15(3,tbs,_26,tbe);}}}else{if(_24==\"beforebegin\"||_24==\"afterend\"){return;}if(_24==\"afterbegin\"){_28=el.firstChild;}_27=_15(2,ts,_26,te);}}}el.insertBefore(_27,_28);return _27;};return {useDom:false,markup:function(o){return _3(o);},applyStyles:function(el,_2b){if(_2b){el=Ext.fly(el);if(typeof _2b==\"string\"){var re=/\\s?([a-z\\-]*)\\:\\s?([^;]*);?/gi;var _2d;while((_2d=re.exec(_2b))!=null){el.setStyle(_2d[1],_2d[2]);}}else{if(typeof _2b==\"object\"){for(var _2e in _2b){el.setStyle(_2e,_2b[_2e]);}}else{if(typeof _2b==\"function\"){Ext.DomHelper.applyStyles(el,_2b.call());}}}}},insertHtml:function(_2f,el,_31){_2f=_2f.toLowerCase();if(el.insertAdjacentHTML){var tag=el.tagName.toLowerCase();if(tag==\"table\"||tag==\"tbody\"||tag==\"tr\"||tag==\"td\"){var rs;if(rs=_22(tag,_2f,el,_31)){return rs;}}switch(_2f){case \"beforebegin\":el.insertAdjacentHTML(_2f,_31);return el.previousSibling;case \"afterbegin\":el.insertAdjacentHTML(_2f,_31);return el.firstChild;case \"beforeend\":el.insertAdjacentHTML(_2f,_31);return el.lastChild;case \"afterend\":el.insertAdjacentHTML(_2f,_31);return el.nextSibling;}throw \"Illegal insertion point -> \\\"\"+_2f+\"\\\"\";}var _34=el.ownerDocument.createRange();var _35;switch(_2f){case \"beforebegin\":_34.setStartBefore(el);_35=_34.createContextualFragment(_31);el.parentNode.insertBefore(_35,el);return el.previousSibling;case \"afterbegin\":if(el.firstChild){_34.setStartBefore(el.firstChild);_35=_34.createContextualFragment(_31);el.insertBefore(_35,el.firstChild);return el.firstChild;}else{el.innerHTML=_31;return el.firstChild;}case \"beforeend\":if(el.lastChild){_34.setStartAfter(el.lastChild);_35=_34.createContextualFragment(_31);el.appendChild(_35);return el.lastChild;}else{el.innerHTML=_31;return el.lastChild;}case \"afterend\":_34.setStartAfter(el);_35=_34.createContextualFragment(_31);el.parentNode.insertBefore(_35,el.nextSibling);return el.nextSibling;}throw \"Illegal insertion point -> \\\"\"+_2f+\"\\\"\";},insertBefore:function(el,o,_38){return this.doInsert(el,o,_38,\"beforeBegin\");},insertAfter:function(el,o,_3b){return this.doInsert(el,o,_3b,\"afterEnd\",\"nextSibling\");},insertFirst:function(el,o,_3e){return this.doInsert(el,o,_3e,\"afterBegin\");},doInsert:function(el,o,_41,pos,_43){el=Ext.getDom(el);var _44;if(this.useDom){_44=_c(o,null);el.parentNode.insertBefore(_44,_43?el[_43]:el);}else{var _45=_3(o);_44=this.insertHtml(pos,el,_45);}return _41?Ext.get(_44,true):_44;},append:function(el,o,_48){el=Ext.getDom(el);var _49;if(this.useDom){_49=_c(o,null);el.appendChild(_49);}else{var _4a=_3(o);_49=this.insertHtml(\"beforeEnd\",el,_4a);}return _48?Ext.get(_49,true):_49;},overwrite:function(el,o,_4d){el=Ext.getDom(el);el.innerHTML=_3(o);return _4d?Ext.get(el.firstChild,true):el.firstChild;},createTemplate:function(o){var _4f=_3(o);return new Ext.Template(_4f);}};}();\r\n\r\n\r\n\r\nExt.Template=function(_1){if(_1 instanceof Array){_1=_1.join(\"\");}else{if(arguments.length>1){_1=Array.prototype.join.call(arguments,\"\");}}this.html=_1;};Ext.Template.prototype={applyTemplate:function(_2){if(this.compiled){return this.compiled(_2);}var _3=this.disableFormats!==true;var fm=Ext.util.Format,_5=this;var fn=function(m,_8,_9,_a){if(_9&&_3){if(_9.substr(0,5)==\"this.\"){return _5.call(_9.substr(5),_2[_8]);}else{if(_a){var re=/^\\s*['\"](.*)[\"']\\s*$/;_a=_a.split(\",\");for(var i=0,_d=_a.length;i<_d;i++){_a[i]=_a[i].replace(re,\"$1\");}_a=[_2[_8]].concat(_a);}else{_a=[_2[_8]];}return fm[_9].apply(fm,_a);}}else{return _2[_8]!==undefined?_2[_8]:\"\";}};return this.html.replace(this.re,fn);},set:function(_e,_f){this.html=_e;this.compiled=null;if(_f){this.compile();}return this;},disableFormats:false,re:/\\{([\\w-]+)(?:\\:([\\w\\.]*)(?:\\((.*?)?\\))?)?\\}/g,compile:function(){var fm=Ext.util.Format;var _11=this.disableFormats!==true;var sep=Ext.isGecko?\"+\":\",\";var fn=function(m,_15,_16,_17){if(_16&&_11){_17=_17?\",\"+_17:\"\";if(_16.substr(0,5)!=\"this.\"){_16=\"fm.\"+_16+\"(\";}else{_16=\"this.call(\\\"\"+_16.substr(5)+\"\\\", \";_17=\"\";}}else{_17=\"\",_16=\"(values['\"+_15+\"'] == undefined ? '' : \";}return \"'\"+sep+_16+\"values['\"+_15+\"']\"+_17+\")\"+sep+\"'\";};var _18;if(Ext.isGecko){_18=\"this.compiled = function(values){ return '\"+this.html.replace(/(\\r\\n|\\n)/g,\"\\\\n\").replace(\"'\",\"\\\\'\").replace(this.re,fn)+\"';};\";}else{_18=[\"this.compiled = function(values){ return ['\"];_18.push(this.html.replace(/(\\r\\n|\\n)/g,\"\\\\n\").replace(\"'\",\"\\\\'\").replace(this.re,fn));_18.push(\"'].join('');};\");_18=_18.join(\"\");}eval(_18);return this;},call:function(_19,_1a){return this[_19](_1a);},insertFirst:function(el,_1c,_1d){return this.doInsert(\"afterBegin\",el,_1c,_1d);},insertBefore:function(el,_1f,_20){return this.doInsert(\"beforeBegin\",el,_1f,_20);},insertAfter:function(el,_22,_23){return this.doInsert(\"afterEnd\",el,_22,_23);},append:function(el,_25,_26){return this.doInsert(\"beforeEnd\",el,_25,_26);},doInsert:function(_27,el,_29,_2a){el=Ext.getDom(el);var _2b=Ext.DomHelper.insertHtml(_27,el,this.applyTemplate(_29));return _2a?Ext.get(_2b,true):_2b;},overwrite:function(el,_2d,_2e){el=Ext.getDom(el);el.innerHTML=this.applyTemplate(_2d);return _2e?Ext.get(el.firstChild,true):el.firstChild;}};Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate;Ext.DomHelper.Template=Ext.Template;Ext.Template.from=function(el){el=Ext.getDom(el);return new Ext.Template(el.value||el.innerHTML);};Ext.MasterTemplate=function(){Ext.MasterTemplate.superclass.constructor.apply(this,arguments);this.originalHtml=this.html;var st={};var m,re=this.subTemplateRe;re.lastIndex=0;var _33=0;while(m=re.exec(this.html)){var _34=m[1],_35=m[2];st[_33]={name:_34,index:_33,buffer:[],tpl:new Ext.Template(_35)};if(_34){st[_34]=st[_33];}st[_33].tpl.compile();st[_33].tpl.call=this.call.createDelegate(this);_33++;}this.subCount=_33;this.subs=st;};Ext.extend(Ext.MasterTemplate,Ext.Template,{subTemplateRe:/<tpl(?:\\sname=\"([\\w-]+)\")?>((?:.|\\n)*?)<\\/tpl>/gi,add:function(_36,_37){if(arguments.length==1){_37=arguments[0];_36=0;}var s=this.subs[_36];s.buffer[s.buffer.length]=s.tpl.apply(_37);return this;},fill:function(_39,_3a,_3b){var a=arguments;if(a.length==1||(a.length==2&&typeof a[1]==\"boolean\")){_3a=a[0];_39=0;_3b=a[1];}if(_3b){this.reset();}for(var i=0,len=_3a.length;i<len;i++){this.add(_39,_3a[i]);}return this;},reset:function(){var s=this.subs;for(var i=0;i<this.subCount;i++){s[i].buffer=[];}return this;},applyTemplate:function(_41){var s=this.subs;var _43=-1;this.html=this.originalHtml.replace(this.subTemplateRe,function(m,_45){return s[++_43].buffer.join(\"\");});return Ext.MasterTemplate.superclass.applyTemplate.call(this,_41);},apply:function(){return this.applyTemplate.apply(this,arguments);},compile:function(){return this;}});Ext.MasterTemplate.prototype.addAll=Ext.MasterTemplate.prototype.fill;Ext.MasterTemplate.from=function(el){el=Ext.getDom(el);return new Ext.MasterTemplate(el.value||el.innerHTML);};\r\n\r\n\r\n\r\nExt.DomQuery=function(){var _1={},_2={},_3={};var _4=/\\S/;var _5=/^\\s+|\\s+$/g;var _6=/\\{(\\d+)\\}/g;var _7=/^(\\s?[\\/>]\\s?|\\s|$)/;var _8=/^(#)?([\\w-\\*]+)/;function child(p,_a){var i=0;var n=p.firstChild;while(n){if(n.nodeType==1){if(++i==_a){return n;}}n=n.nextSibling;}return null;}function next(n){while((n=n.nextSibling)&&n.nodeType!=1){}return n;}function prev(n){while((n=n.previousSibling)&&n.nodeType!=1){}return n;}function clean(d){var n=d.firstChild,ni=-1;while(n){var nx=n.nextSibling;if(n.nodeType==3&&!_4.test(n.nodeValue)){d.removeChild(n);}else{n.nodeIndex=++ni;}n=nx;}return this;}function byClassName(c,a,v,re,cn){if(!v){return c;}var r=[];for(var i=0,ci;ci=c[i];i++){cn=ci.className;if(cn&&(\" \"+cn+\" \").indexOf(v)!=-1){r[r.length]=ci;}}return r;}function attrValue(n,_1c){if(!n.tagName&&typeof n.length!=\"undefined\"){n=n[0];}if(!n){return null;}if(_1c==\"for\"){return n.htmlFor;}if(_1c==\"class\"||_1c==\"className\"){return n.className;}return n.getAttribute(_1c)||n[_1c];}function getNodes(ns,_1e,_1f){var _20=[],cs;if(!ns){return _20;}_1e=_1e?_1e.replace(_5,\"\"):\"\";_1f=_1f||\"*\";if(typeof ns.getElementsByTagName!=\"undefined\"){ns=[ns];}if(_1e!=\"/\"&&_1e!=\">\"){for(var i=0,ni;ni=ns[i];i++){cs=ni.getElementsByTagName(_1f);for(var j=0,ci;ci=cs[j];j++){_20[_20.length]=ci;}}}else{for(var i=0,ni;ni=ns[i];i++){var cn=ni.getElementsByTagName(_1f);for(var j=0,cj;cj=cn[j];j++){if(cj.parentNode==ni){_20[_20.length]=cj;}}}}return _20;}function concat(a,b){if(b.slice){return a.concat(b);}for(var i=0,l=b.length;i<l;i++){a[a.length]=b[i];}return a;}function byTag(cs,_2d){if(cs.tagName||cs==document){cs=[cs];}if(!_2d){return cs;}var r=[];_2d=_2d.toLowerCase();for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType==1&&ci.tagName.toLowerCase()==_2d){r[r.length]=ci;}}return r;}function byId(cs,_32,id){if(cs.tagName||cs==document){cs=[cs];}if(!id){return cs;}var r=[];for(var i=0,ci;ci=cs[i];i++){if(ci&&ci.id==id){r[r.length]=ci;return r;}}return r;}function byAttribute(cs,_38,_39,op,_3b){var r=[],st=_3b==\"{\";var f=Ext.DomQuery.operators[op];for(var i=0;ci=cs[i];i++){var a;if(st){a=Ext.DomQuery.getStyle(ci,_38);}else{if(_38==\"class\"||_38==\"className\"){a=ci.className;}else{if(_38==\"for\"){a=ci.htmlFor;}else{if(_38==\"href\"){a=ci.getAttribute(\"href\",2);}else{a=ci.getAttribute(_38);}}}}if((f&&f(a,_39))||(!f&&a)){r[r.length]=ci;}}return r;}function byPseudo(cs,_42,_43){return Ext.DomQuery.pseudos[_42](cs,_43);}var _44=window.ActiveXObject?true:false;var key=30803;function nodupIEXml(cs){var d=++key;cs[0].setAttribute(\"_nodup\",d);var r=[cs[0]];for(var i=1,len=cs.length;i<len;i++){var c=cs[i];if(!c.getAttribute(\"_nodup\")!=d){c.setAttribute(\"_nodup\",d);r[r.length]=c;}}for(var i=0,len=cs.length;i<len;i++){cs[i].removeAttribute(\"_nodup\");}return r;}function nodup(cs){if(!cs){return [];}var len=cs.length,c,i,r=cs,cj;if(!len||typeof cs.nodeType!=\"undefined\"||len==1){return cs;}if(_44&&typeof cs[0].selectSingleNode!=\"undefined\"){return nodupIEXml(cs);}var d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d;}else{r=[];for(var j=0;j<i;j++){r[r.length]=cs[j];}for(j=i+1;cj=cs[j];j++){if(cj._nodup!=d){cj._nodup=d;r[r.length]=cj;}}return r;}}return r;}function quickDiffIEXml(c1,c2){var d=++key;for(var i=0,len=c1.length;i<len;i++){c1[i].setAttribute(\"_qdiff\",d);}var r=[];for(var i=0,len=c2.length;i<len;i++){if(c2[i].getAttribute(\"_qdiff\")!=d){r[r.length]=c2[i];}}for(var i=0,len=c1.length;i<len;i++){c1[i].removeAttribute(\"_qdiff\");}return r;}function quickDiff(c1,c2){var _5c=c1.length;if(!_5c){return c2;}if(_44&&c1[0].selectSingleNode){return quickDiffIEXml(c1,c2);}var d=++key;for(var i=0;i<_5c;i++){c1[i]._qdiff=d;}var r=[];for(var i=0,len=c2.length;i<len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i];}}return r;}function quickId(ns,_62,_63,id){if(ns==_63){var d=_63.ownerDocument||_63;return d.getElementById(id);}ns=getNodes(ns,_62,\"*\");return byId(ns,null,id);}return {getStyle:function(el,_67){return Ext.fly(el).getStyle(_67);},compile:function(_68,_69){while(_68.substr(0,1)==\"/\"){_68=_68.substr(1);}_69=_69||\"select\";var fn=[\"var f = function(root){\\n var mode; var n = root || document;\\n\"];var q=_68,_6c,lq;var tk=Ext.DomQuery.matchers;var _6f=tk.length;var mm;while(q&&lq!=q){lq=q;var tm=q.match(_8);if(_69==\"select\"){if(tm){if(tm[1]==\"#\"){fn[fn.length]=\"n = quickId(n, mode, root, \\\"\"+tm[2]+\"\\\");\";}else{fn[fn.length]=\"n = getNodes(n, mode, \\\"\"+tm[2]+\"\\\");\";}q=q.replace(tm[0],\"\");}else{if(q.substr(0,1)!=\"@\"){fn[fn.length]=\"n = getNodes(n, mode, \\\"*\\\");\";}}}else{if(tm){if(tm[1]==\"#\"){fn[fn.length]=\"n = byId(n, null, \\\"\"+tm[2]+\"\\\");\";}else{fn[fn.length]=\"n = byTag(n, \\\"\"+tm[2]+\"\\\");\";}q=q.replace(tm[0],\"\");}}while(!(mm=q.match(_7))){var _72=false;for(var j=0;j<_6f;j++){var t=tk[j];var m=q.match(t.re);if(m){fn[fn.length]=t.select.replace(_6,function(x,i){return m[i];});q=q.replace(m[0],\"\");_72=true;break;}}if(!_72){throw \"Error parsing selector, parsing failed at \\\"\"+q+\"\\\"\";}}if(mm[1]){fn[fn.length]=\"mode=\\\"\"+mm[1]+\"\\\";\";q=q.replace(mm[1],\"\");}}fn[fn.length]=\"return nodup(n);\\n}\";eval(fn.join(\"\"));return f;},select:function(_78,_79,_7a){if(!_79||_79==document){_79=document;}if(typeof _79==\"string\"){_79=document.getElementById(_79);}var _7b=_78.split(\",\");var _7c=[];for(var i=0,len=_7b.length;i<len;i++){var p=_7b[i].replace(_5,\"\");if(!_1[p]){_1[p]=Ext.DomQuery.compile(p);if(!_1[p]){throw p+\" is not a valid selector\";}}var _80=_1[p](_79);if(_80&&_80!=document){_7c=_7c.concat(_80);}}return _7c;},selectNode:function(_81,_82){return Ext.DomQuery.select(_81,_82)[0];},selectValue:function(_83,_84,_85){_83=_83.replace(_5,\"\");if(!_3[_83]){_3[_83]=Ext.DomQuery.compile(_83,\"select\");}var n=_3[_83](_84);n=n[0]?n[0]:n;var v=(n&&n.firstChild?n.firstChild.nodeValue:null);return (v===null?_85:v);},selectNumber:function(_88,_89,_8a){var v=Ext.DomQuery.selectValue(_88,_89,_8a||0);return parseFloat(v);},is:function(el,ss){if(typeof el==\"string\"){el=document.getElementById(el);}var _8e=(el instanceof Array);var _8f=Ext.DomQuery.filter(_8e?el:[el],ss);return _8e?(_8f.length==el.length):(_8f.length>0);},filter:function(els,ss,_92){ss=ss.replace(_5,\"\");if(!_2[ss]){_2[ss]=Ext.DomQuery.compile(ss,\"simple\");}var _93=_2[ss](els);return _92?quickDiff(_93,els):_93;},matchers:[{re:/^\\.([\\w-]+)/,select:\"n = byClassName(n, null, \\\" {1} \\\");\"},{re:/^\\:([\\w-]+)(?:\\(((?:[^\\s>\\/]*|.*?))\\))?/,select:\"n = byPseudo(n, \\\"{1}\\\", \\\"{2}\\\");\"},{re:/^(?:([\\[\\{])(?:@)?([\\w-]+)\\s?(?:(=|.=)\\s?['\"]?(.*?)[\"']?)?[\\]\\}])/,select:\"n = byAttribute(n, \\\"{2}\\\", \\\"{4}\\\", \\\"{3}\\\", \\\"{1}\\\");\"},{re:/^#([\\w-]+)/,select:\"n = byId(n, null, \\\"{1}\\\");\"},{re:/^@([\\w-]+)/,select:\"return {firstChild:{nodeValue:attrValue(n, \\\"{1}\\\")}};\"}],operators:{\"=\":function(a,v){return a==v;},\"!=\":function(a,v){return a!=v;},\"^=\":function(a,v){return a&&a.substr(0,v.length)==v;},\"$=\":function(a,v){return a&&a.substr(a.length-v.length)==v;},\"*=\":function(a,v){return a&&a.indexOf(v)!==-1;},\"%=\":function(a,v){return (a%v)==0;}},pseudos:{\"first-child\":function(c){var r=[],n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.previousSibling)&&n.nodeType!=1){}if(!n){r[r.length]=ci;}}return r;},\"last-child\":function(c){var r=[];for(var i=0,ci;ci=n=c[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(!n){r[r.length]=ci;}}return r;},\"nth-child\":function(c,a){var r=[];if(a!=\"odd\"&&a!=\"even\"){for(var i=0,ci;ci=c[i];i++){var m=child(ci.parentNode,a);if(m==ci){r[r.length]=m;}}return r;}var p;for(var i=0,l=c.length;i<l;i++){var cp=c[i].parentNode;if(cp!=p){clean(cp);p=cp;}}for(var i=0,ci;ci=c[i];i++){var m=false;if(a==\"odd\"){m=((ci.nodeIndex+1)%2==1);}else{if(a==\"even\"){m=((ci.nodeIndex+1)%2==0);}}if(m){r[r.length]=ci;}}return r;},\"only-child\":function(c){var r=[];for(var i=0,ci;ci=c[i];i++){if(!prev(ci)&&!next(ci)){r[r.length]=ci;}}return r;},\"empty\":function(c){var r=[];for(var i=0,ci;ci=c[i];i++){var cns=ci.childNodes,j=0,cn,_bd=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){_bd=false;break;}}if(_bd){r[r.length]=ci;}}return r;},\"contains\":function(c,v){var r=[];for(var i=0,ci;ci=c[i];i++){if(ci.innerHTML.indexOf(v)!==-1){r[r.length]=ci;}}return r;},\"nodeValue\":function(c,v){var r=[];for(var i=0,ci;ci=c[i];i++){if(ci.firstChild&&ci.firstChild.nodeValue==v){r[r.length]=ci;}}return r;},\"checked\":function(c){var r=[];for(var i=0,ci;ci=c[i];i++){if(ci.checked==true){r[r.length]=ci;}}return r;},\"not\":function(c,ss){return Ext.DomQuery.filter(c,ss,true);},\"odd\":function(c){return this[\"nth-child\"](c,\"odd\");},\"even\":function(c){return this[\"nth-child\"](c,\"even\");},\"nth\":function(c,a){return c[a-1]||[];},\"first\":function(c){return c[0]||[];},\"last\":function(c){return c[c.length-1]||[];},\"has\":function(c,ss){var s=Ext.DomQuery.select;var r=[];for(var i=0,ci;ci=c[i];i++){if(s(ss,ci).length>0){r[r.length]=ci;}}return r;},\"next\":function(c,ss){var is=Ext.DomQuery.is;var r=[];for(var i=0,ci;ci=c[i];i++){var n=next(ci);if(n&&is(n,ss)){r[r.length]=ci;}}return r;},\"prev\":function(c,ss){var is=Ext.DomQuery.is;var r=[];for(var i=0,ci;ci=c[i];i++){var n=prev(ci);if(n&&is(n,ss)){r[r.length]=ci;}}return r;}}};}();Ext.query=Ext.DomQuery.select;\r\n\r\n\r\n\r\nExt.util.Observable=function(){if(this.listeners){this.on(this.listeners);delete this.listeners;}};Ext.util.Observable.prototype={fireEvent:function(){var ce=this.events[arguments[0].toLowerCase()];if(typeof ce==\"object\"){return ce.fire.apply(ce,Array.prototype.slice.call(arguments,1));}else{return true;}},filterOptRe:/^(?:scope|delay|buffer|single)$/,addListener:function(_2,fn,_4,o){if(typeof _2==\"object\"){o=_2;for(var e in o){if(this.filterOptRe.test(e)){continue;}if(typeof o[e]==\"function\"){this.addListener(e,o[e],o.scope,o);}else{this.addListener(e,o[e].fn,o[e].scope,o[e]);}}return;}o=(!o||typeof o==\"boolean\")?{}:o;_2=_2.toLowerCase();var ce=this.events[_2]||true;if(typeof ce==\"boolean\"){ce=new Ext.util.Event(this,_2);this.events[_2]=ce;}ce.addListener(fn,_4,o);},removeListener:function(_8,fn,_a){var ce=this.events[_8.toLowerCase()];if(typeof ce==\"object\"){ce.removeListener(fn,_a);}},purgeListeners:function(){for(var _c in this.events){if(typeof this.events[_c]==\"object\"){this.events[_c].clearListeners();}}},relayEvents:function(o,_e){var _f=function(_10){return function(){return this.fireEvent.apply(this,Ext.combine(_10,Array.prototype.slice.call(arguments,0)));};};for(var i=0,len=_e.length;i<len;i++){var _13=_e[i];if(!this.events[_13]){this.events[_13]=true;}o.on(_13,_f(_13),this);}},addEvents:function(o){if(!this.events){this.events={};}Ext.applyIf(this.events,o);},hasListener:function(_15){var e=this.events[_15];return typeof e==\"object\"&&e.listeners.length>0;}};Ext.util.Observable.prototype.on=Ext.util.Observable.prototype.addListener;Ext.util.Observable.prototype.un=Ext.util.Observable.prototype.removeListener;Ext.util.Observable.capture=function(o,fn,_19){o.fireEvent=o.fireEvent.createInterceptor(fn,_19);};Ext.util.Observable.releaseCapture=function(o){o.fireEvent=Ext.util.Observable.prototype.fireEvent;};(function(){var _1b=function(h,o,_1e){var _1f=new Ext.util.DelayedTask();return function(){_1f.delay(o.buffer,h,_1e,Array.prototype.slice.call(arguments,0));};};var _20=function(h,e,fn,_24){return function(){e.removeListener(fn,_24);return h.apply(_24,arguments);};};var _25=function(h,o,_28){return function(){var _29=Array.prototype.slice.call(arguments,0);setTimeout(function(){h.apply(_28,_29);},o.delay||10);};};Ext.util.Event=function(obj,_2b){this.name=_2b;this.obj=obj;this.listeners=[];};Ext.util.Event.prototype={addListener:function(fn,_2d,_2e){var o=_2e||{};_2d=_2d||this.obj;if(!this.isListening(fn,_2d)){var l={fn:fn,scope:_2d,options:o};var h=fn;if(o.delay){h=_25(h,o,_2d);}if(o.single){h=_20(h,this,fn,_2d);}if(o.buffer){h=_1b(h,o,_2d);}l.fireFn=h;if(!this.firing){this.listeners.push(l);}else{this.listeners=this.listeners.slice(0);this.listeners.push(l);}}},findListener:function(fn,_33){_33=_33||this.obj;var ls=this.listeners;for(var i=0,len=ls.length;i<len;i++){var l=ls[i];if(l.fn==fn&&l.scope==_33){return i;}}return -1;},isListening:function(fn,_39){return this.findListener(fn,_39)!=-1;},removeListener:function(fn,_3b){var _3c;if((_3c=this.findListener(fn,_3b))!=-1){if(!this.firing){this.listeners.splice(_3c,1);}else{this.listeners=this.listeners.slice(0);this.listeners.splice(_3c,1);}return true;}return false;},clearListeners:function(){this.listeners=[];},fire:function(){var ls=this.listeners,_3e,len=ls.length;if(len>0){this.firing=true;var _40=Array.prototype.slice.call(arguments,0);for(var i=0;i<len;i++){var l=ls[i];if(l.fireFn.apply(l.scope,arguments)===false){this.firing=false;return false;}}this.firing=false;}return true;}};})();\r\n\r\n\r\n\r\nExt.EventManager=function(){var _1,_2,_3=false;var _4,_5,_6,_7;var E=Ext.lib.Event;var D=Ext.lib.Dom;var _a=function(){if(!_3){_3=true;Ext.isReady=true;if(_2){clearInterval(_2);}if(Ext.isGecko||Ext.isOpera){document.removeEventListener(\"DOMContentLoaded\",_a,false);}if(_1){_1.fire();_1.clearListeners();}}};var _b=function(){_1=new Ext.util.Event();if(Ext.isGecko||Ext.isOpera){document.addEventListener(\"DOMContentLoaded\",_a,false);}else{if(Ext.isIE){document.write(\"<s\"+\"cript id=\\\"ie-deferred-loader\\\" defer=\\\"defer\\\" src=\\\"/\"+\"/:\\\"></s\"+\"cript>\");var _c=document.getElementById(\"ie-deferred-loader\");_c.onreadystatechange=function(){if(this.readyState==\"complete\"){_a();_c.onreadystatechange=null;_c.parentNode.removeChild(_c);}};}else{if(Ext.isSafari){_2=setInterval(function(){var rs=document.readyState;if(rs==\"complete\"){_a();}},10);}}}E.on(window,\"load\",_a);};var _e=function(h,o){var _11=new Ext.util.DelayedTask(h);return function(e){e=new Ext.EventObjectImpl(e);_11.delay(o.buffer,h,null,[e]);};};var _13=function(h,el,_16,fn){return function(e){Ext.EventManager.removeListener(el,_16,fn);h(e);};};var _19=function(h,o){return function(e){e=new Ext.EventObjectImpl(e);setTimeout(function(){h(e);},o.delay||10);};};var _1d=function(_1e,_1f,opt,fn,_22){var o=(!opt||typeof opt==\"boolean\")?{}:opt;fn=fn||o.fn;_22=_22||o.scope;var el=Ext.getDom(_1e);if(!el){throw \"Error listening for \\\"\"+_1f+\"\\\". Element \\\"\"+_1e+\"\\\" doesn't exist.\";}var h=function(e){e=Ext.EventObject.setEvent(e);var t;if(o.delegate){t=e.getTarget(o.delegate,el);if(!t){return;}}else{t=e.target;}if(o.stopEvent===true){e.stopEvent();}if(o.preventDefault===true){e.preventDefault();}if(o.stopPropagation===true){e.stopPropagation();}if(o.normalized===false){e=e.browserEvent;}fn.call(_22||el,e,t,o);};if(o.delay){h=_19(h,o);}if(o.single){h=_13(h,el,_1f,fn);}if(o.buffer){h=_e(h,o);}fn._handlers=fn._handlers||[];fn._handlers.push([Ext.id(el),_1f,h]);E.on(el,_1f,h);if(_1f==\"mousewheel\"&&el.addEventListener){el.addEventListener(\"DOMMouseScroll\",h,false);E.on(window,\"unload\",function(){el.removeEventListener(\"DOMMouseScroll\",h,false);});}if(_1f==\"mousedown\"&&el==document){Ext.EventManager.stoppedMouseDownEvent.addListener(h);}return h;};var _28=function(el,_2a,fn){var id=Ext.id(el),hds=fn._handlers,hd=fn;if(hds){for(var i=0,len=hds.length;i<len;i++){var h=hds[i];if(h[0]==id&&h[1]==_2a){hd=h[2];hds.splice(i,1);break;}}}E.un(el,_2a,hd);el=Ext.getDom(el);if(_2a==\"mousewheel\"&&el.addEventListener){el.removeEventListener(\"DOMMouseScroll\",hd,false);}if(_2a==\"mousedown\"&&el==document){Ext.EventManager.stoppedMouseDownEvent.removeListener(hd);}};var _32=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized)$/;var pub={wrap:function(fn,_35,_36){return function(e){Ext.EventObject.setEvent(e);fn.call(_36?_35||window:window,Ext.EventObject,_35);};},addListener:function(_38,_39,fn,_3b,_3c){if(typeof _39==\"object\"){var o=_39;for(var e in o){if(_32.test(e)){continue;}if(typeof o[e]==\"function\"){_1d(_38,e,o,o[e],o.scope);}else{_1d(_38,e,o[e]);}}return;}return _1d(_38,_39,_3c,fn,_3b);},removeListener:function(_3f,_40,fn){return _28(_3f,_40,fn);},onDocumentReady:function(fn,_43,_44){if(_3){fn.call(_43||window,_43);return;}if(!_1){_b();}_1.addListener(fn,_43,_44);},onWindowResize:function(fn,_46,_47){if(!_4){_4=new Ext.util.Event();_5=new Ext.util.DelayedTask(function(){_4.fire(D.getViewWidth(),D.getViewHeight());});E.on(window,\"resize\",function(){if(Ext.isIE){_5.delay(50);}else{_4.fire(D.getViewWidth(),D.getViewHeight());}});}_4.addListener(fn,_46,_47);},onTextResize:function(fn,_49,_4a){if(!_6){_6=new Ext.util.Event();var _4b=new Ext.Element(document.createElement(\"div\"));_4b.dom.className=\"x-text-resize\";_4b.dom.innerHTML=\"X\";_4b.appendTo(document.body);_7=_4b.dom.offsetHeight;setInterval(function(){if(_4b.dom.offsetHeight!=_7){_6.fire(_7,_7=_4b.dom.offsetHeight);}},this.textResizeInterval);}_6.addListener(fn,_49,_4a);},removeResizeListener:function(fn,_4d){if(_4){_4.removeListener(fn,_4d);}},fireResize:function(){if(_4){_4.fire(D.getViewWidth(),D.getViewHeight());}},ieDeferSrc:false,textResizeInterval:50};pub.on=pub.addListener;pub.un=pub.removeListener;pub.stoppedMouseDownEvent=new Ext.util.Event();return pub;}();Ext.onReady=Ext.EventManager.onDocumentReady;Ext.onReady(function(){var bd=Ext.get(document.body);if(!bd){return;}var cls=Ext.isIE?\"ext-ie\":Ext.isGecko?\"ext-gecko\":Ext.isOpera?\"ext-opera\":Ext.isSafari?\"ext-safari\":\"\";if(Ext.isBorderBox){cls+=\" ext-border-box\";}if(Ext.isStrict){cls+=\" ext-strict\";}bd.addClass(cls);});Ext.EventObject=function(){var E=Ext.lib.Event;var _51={63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35};var _52=Ext.isIE?{1:0,4:1,2:2}:(Ext.isSafari?{1:0,2:1,3:2}:{0:0,1:1,2:2});Ext.EventObjectImpl=function(e){if(e){this.setEvent(e.browserEvent||e);}};Ext.EventObjectImpl.prototype={browserEvent:null,button:-1,shiftKey:false,ctrlKey:false,altKey:false,BACKSPACE:8,TAB:9,RETURN:13,ENTER:13,SHIFT:16,CONTROL:17,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,F5:116,setEvent:function(e){if(e==this||(e&&e.browserEvent)){return e;}this.browserEvent=e;if(e){this.button=e.button?_52[e.button]:(e.which?e.which-1:-1);this.shiftKey=e.shiftKey;this.ctrlKey=e.ctrlKey||e.metaKey;this.altKey=e.altKey;this.keyCode=e.keyCode;this.charCode=e.charCode;this.target=E.getTarget(e);this.xy=E.getXY(e);}else{this.button=-1;this.shiftKey=false;this.ctrlKey=false;this.altKey=false;this.keyCode=0;this.charCode=0;this.target=null;this.xy=[0,0];}return this;},stopEvent:function(){if(this.browserEvent){if(this.browserEvent.type==\"mousedown\"){Ext.EventManager.stoppedMouseDownEvent.fire(this);}E.stopEvent(this.browserEvent);}},preventDefault:function(){if(this.browserEvent){E.preventDefault(this.browserEvent);}},isNavKeyPress:function(){var k=this.keyCode;k=Ext.isSafari?(_51[k]||k):k;return (k>=33&&k<=40)||k==this.RETURN||k==this.TAB||k==this.ESC;},isSpecialKey:function(){var k=this.keyCode;return k==9||k==13||k==40||k==27||(k==16)||(k==17)||(k>=18&&k<=20)||(k>=33&&k<=35)||(k>=36&&k<=39)||(k>=44&&k<=45);},stopPropagation:function(){if(this.browserEvent){if(this.browserEvent.type==\"mousedown\"){Ext.EventManager.stoppedMouseDownEvent.fire(this);}E.stopPropagation(this.browserEvent);}},getCharCode:function(){return this.charCode||this.keyCode;},getKey:function(){var k=this.keyCode||this.charCode;return Ext.isSafari?(_51[k]||k):k;},getPageX:function(){return this.xy[0];},getPageY:function(){return this.xy[1];},getTime:function(){if(this.browserEvent){return E.getTime(this.browserEvent);}return null;},getXY:function(){return this.xy;},getTarget:function(_58,_59,_5a){return _58?Ext.fly(this.target).findParent(_58,_59,_5a):this.target;},getRelatedTarget:function(){if(this.browserEvent){return E.getRelatedTarget(this.browserEvent);}return null;},getWheelDelta:function(){var e=this.browserEvent;var _5c=0;if(e.wheelDelta){_5c=e.wheelDelta/120;if(window.opera){_5c=-_5c;}}else{if(e.detail){_5c=-e.detail/3;}}return _5c;},hasModifier:function(){return ((this.ctrlKey||this.altKey)||this.shiftKey)?true:false;},within:function(el,_5e){var t=this[_5e?\"getRelatedTarget\":\"getTarget\"]();return t&&Ext.fly(el).contains(t);},getPoint:function(){return new Ext.lib.Point(this.xy[0],this.xy[1]);}};return new Ext.EventObjectImpl();}();\r\n\r\n\r\n\r\n(function(){var D=Ext.lib.Dom;var E=Ext.lib.Event;var A=Ext.lib.Anim;var _4={};var _5=/(-[a-z])/gi;var _6=function(m,a){return a.charAt(1).toUpperCase();};var _9=document.defaultView;Ext.Element=function(_a,_b){var _c=typeof _a==\"string\"?document.getElementById(_a):_a;if(!_c){return null;}if(!_b&&Ext.Element.cache[_c.id]){return Ext.Element.cache[_c.id];}this.dom=_c;this.id=_c.id||Ext.id(_c);};var El=Ext.Element;El.prototype={originalDisplay:\"\",visibilityMode:1,defaultUnit:\"px\",setVisibilityMode:function(_e){this.visibilityMode=_e;return this;},enableDisplayMode:function(_f){this.setVisibilityMode(El.DISPLAY);if(typeof _f!=\"undefined\"){this.originalDisplay=_f;}return this;},findParent:function(_10,_11,_12){var p=this.dom,b=document.body,_15=0,dq=Ext.DomQuery,_17;_11=_11||50;if(typeof _11!=\"number\"){_17=Ext.getDom(_11);_11=10;}while(p&&p.nodeType==1&&_15<_11&&p!=b&&p!=_17){if(dq.is(p,_10)){return _12?Ext.get(p):p;}_15++;p=p.parentNode;}return null;},findParentNode:function(_18,_19,_1a){var p=Ext.fly(this.dom.parentNode,\"_internal\");return p?p.findParent(_18,_19,_1a):null;},up:function(_1c,_1d){return this.findParentNode(_1c,_1d,true);},is:function(_1e){return Ext.DomQuery.is(this.dom,_1e);},animate:function(_1f,_20,_21,_22,_23){this.anim(_1f,{duration:_20,callback:_21,easing:_22},_23);return this;},anim:function(_24,opt,_26,_27,_28,cb){_26=_26||\"run\";opt=opt||{};var _2a=Ext.lib.Anim[_26](this.dom,_24,(opt.duration||_27)||0.35,(opt.easing||_28)||\"easeOut\",function(){Ext.callback(cb,this);Ext.callback(opt.callback,opt.scope||this,[this,opt]);},this);opt.anim=_2a;return _2a;},preanim:function(a,i){return !a[i]?false:(typeof a[i]==\"object\"?a[i]:{duration:a[i+1],callback:a[i+2],easing:a[i+3]});},clean:function(_2d){if(this.isCleaned&&_2d!==true){return this;}var ns=/\\S/;var d=this.dom,n=d.firstChild,ni=-1;while(n){var nx=n.nextSibling;if(n.nodeType==3&&!ns.test(n.nodeValue)){d.removeChild(n);}else{n.nodeIndex=++ni;}n=nx;}this.isCleaned=true;return this;},calcOffsetsTo:function(el){el=Ext.get(el),d=el.dom;var _34=false;if(el.getStyle(\"position\")==\"static\"){el.position(\"relative\");_34=true;}var x=0,y=0;var op=this.dom;while(op&&op!=d&&op.tagName!=\"HTML\"){x+=op.offsetLeft;y+=op.offsetTop;op=op.offsetParent;}if(_34){el.position(\"static\");}return [x,y];},scrollIntoView:function(_38,_39){var c=Ext.getDom(_38)||document.body;var el=this.dom;var o=this.calcOffsetsTo(c),l=o[0],t=o[1],b=t+el.offsetHeight,r=l+el.offsetWidth;var ch=c.clientHeight;var ct=parseInt(c.scrollTop,10);var cl=parseInt(c.scrollLeft,10);var cb=ct+ch;var cr=cl+c.clientWidth;if(t<ct){c.scrollTop=t;}else{if(b>cb){c.scrollTop=b-ch;}}if(_39!==false){if(l<cl){c.scrollLeft=l;}else{if(r>cr){c.scrollLeft=r-c.clientWidth;}}}return this;},scrollChildIntoView:function(_46){Ext.fly(_46,\"_scrollChildIntoView\").scrollIntoView(this);},autoHeight:function(_47,_48,_49,_4a){var _4b=this.getHeight();this.clip();this.setHeight(1);setTimeout(function(){var _4c=parseInt(this.dom.scrollHeight,10);if(!_47){this.setHeight(_4c);this.unclip();if(typeof _49==\"function\"){_49();}}else{this.setHeight(_4b);this.setHeight(_4c,_47,_48,function(){this.unclip();if(typeof _49==\"function\"){_49();}}.createDelegate(this),_4a);}}.createDelegate(this),0);return this;},contains:function(el){if(!el){return false;}return D.isAncestor(this.dom,el.dom?el.dom:el);},isVisible:function(_4e){var vis=!(this.getStyle(\"visibility\")==\"hidden\"||this.getStyle(\"display\")==\"none\");if(_4e!==true||!vis){return vis;}var p=this.dom.parentNode;while(p&&p.tagName.toLowerCase()!=\"body\"){if(!Ext.fly(p,\"_isVisible\").isVisible()){return false;}p=p.parentNode;}return true;},select:function(_51,_52){return El.select(\"#\"+Ext.id(this.dom)+\" \"+_51,_52);},query:function(_53,_54){return Ext.DomQuery.select(\"#\"+Ext.id(this.dom)+\" \"+_53);},child:function(_55,_56){var n=Ext.DomQuery.selectNode(\"#\"+Ext.id(this.dom)+\" \"+_55);return _56?n:Ext.get(n);},down:function(_58,_59){var n=Ext.DomQuery.selectNode(\"#\"+Ext.id(this.dom)+\" > \"+_58);return _59?n:Ext.get(n);},initDD:function(_5b,_5c,_5d){var dd=new Ext.dd.DD(Ext.id(this.dom),_5b,_5c);return Ext.apply(dd,_5d);},initDDProxy:function(_5f,_60,_61){var dd=new Ext.dd.DDProxy(Ext.id(this.dom),_5f,_60);return Ext.apply(dd,_61);},initDDTarget:function(_63,_64,_65){var dd=new Ext.dd.DDTarget(Ext.id(this.dom),_63,_64);return Ext.apply(dd,_65);},setVisible:function(_67,_68){if(!_68||!A){if(this.visibilityMode==El.DISPLAY){this.setDisplayed(_67);}else{this.fixDisplay();this.dom.style.visibility=_67?\"visible\":\"hidden\";}}else{var dom=this.dom;var _6a=this.visibilityMode;if(_67){this.setOpacity(0.01);this.setVisible(true);}this.anim({opacity:{to:(_67?1:0)}},this.preanim(arguments,1),null,0.35,\"easeIn\",function(){if(!_67){if(_6a==El.DISPLAY){dom.style.display=\"none\";}else{dom.style.visibility=\"hidden\";}Ext.get(dom).setOpacity(1);}});}return this;},isDisplayed:function(){return this.getStyle(\"display\")!=\"none\";},toggle:function(_6b){this.setVisible(!this.isVisible(),this.preanim(arguments,0));return this;},setDisplayed:function(_6c){if(typeof _6c==\"boolean\"){_6c=_6c?this.originalDisplay:\"none\";}this.setStyle(\"display\",_6c);return this;},focus:function(){try{this.dom.focus();}catch(e){}return this;},blur:function(){try{this.dom.blur();}catch(e){}return this;},addClass:function(_6d){if(_6d instanceof Array){for(var i=0,len=_6d.length;i<len;i++){this.addClass(_6d[i]);}}else{if(_6d&&!this.hasClass(_6d)){this.dom.className=this.dom.className+\" \"+_6d;}}return this;},radioClass:function(_70){var _71=this.dom.parentNode.childNodes;for(var i=0;i<_71.length;i++){var s=_71[i];if(s.nodeType==1){Ext.get(s).removeClass(_70);}}this.addClass(_70);return this;},removeClass:function(_74){if(!_74||!this.dom.className){return this;}if(_74 instanceof Array){for(var i=0,len=_74.length;i<len;i++){this.removeClass(_74[i]);}}else{if(this.hasClass(_74)){var re=this.classReCache[_74];if(!re){re=new RegExp(\"(?:^|\\\\s+)\"+_74+\"(?:\\\\s+|$)\",\"g\");this.classReCache[_74]=re;}this.dom.className=this.dom.className.replace(re,\" \");}}return this;},classReCache:{},toggleClass:function(_78){if(this.hasClass(_78)){this.removeClass(_78);}else{this.addClass(_78);}return this;},hasClass:function(_79){return _79&&(\" \"+this.dom.className+\" \").indexOf(\" \"+_79+\" \")!=-1;},replaceClass:function(_7a,_7b){this.removeClass(_7a);this.addClass(_7b);return this;},getStyles:function(){var a=arguments,len=a.length,r={};for(var i=0;i<len;i++){r[a[i]]=this.getStyle(a[i]);}return r;},getStyle:function(){return _9&&_9.getComputedStyle?function(_80){var el=this.dom,v,cs,_84;if(_80==\"float\"){_80=\"cssFloat\";}if(v=el.style[_80]){return v;}if(cs=_9.getComputedStyle(el,\"\")){if(!(_84=_4[_80])){_84=_4[_80]=_80.replace(_5,_6);}return cs[_84];}return null;}:function(_85){var el=this.dom,v,cs,_89;if(_85==\"opacity\"){if(typeof el.filter==\"string\"){var fv=parseFloat(el.filter.match(/alpha\\(opacity=(.*)\\)/i)[1]);if(!isNaN(fv)){return fv?fv/100:0;}}return 1;}else{if(_85==\"float\"){_85=\"styleFloat\";}}if(!(_89=_4[_85])){_89=_4[_85]=_85.replace(_5,_6);}if(v=el.style[_89]){return v;}if(cs=el.currentStyle){return cs[_89];}return null;};}(),setStyle:function(_8b,_8c){if(typeof _8b==\"string\"){var _8d;if(!(_8d=_4[_8b])){_8d=_4[_8b]=_8b.replace(_5,_6);}if(_8d==\"opacity\"){this.setOpacity(_8c);}else{this.dom.style[_8d]=_8c;}}else{for(var _8e in _8b){if(typeof _8b[_8e]!=\"function\"){this.setStyle(_8e,_8b[_8e]);}}}return this;},applyStyles:function(_8f){Ext.DomHelper.applyStyles(this.dom,_8f);return this;},getX:function(){return D.getX(this.dom);},getY:function(){return D.getY(this.dom);},getXY:function(){return D.getXY(this.dom);},setX:function(x,_91){if(!_91||!A){D.setX(this.dom,x);}else{this.setXY([x,this.getY()],this.preanim(arguments,1));}return this;},setY:function(y,_93){if(!_93||!A){D.setY(this.dom,y);}else{this.setXY([this.getX(),y],this.preanim(arguments,1));}return this;},setLeft:function(_94){this.setStyle(\"left\",this.addUnits(_94));return this;},setTop:function(top){this.setStyle(\"top\",this.addUnits(top));return this;},setRight:function(_96){this.setStyle(\"right\",this.addUnits(_96));return this;},setBottom:function(_97){this.setStyle(\"bottom\",this.addUnits(_97));return this;},setXY:function(pos,_99){if(!_99||!A){D.setXY(this.dom,pos);}else{this.anim({points:{to:pos}},this.preanim(arguments,1),\"motion\");}return this;},setLocation:function(x,y,_9c){this.setXY([x,y],this.preanim(arguments,2));return this;},moveTo:function(x,y,_9f){this.setXY([x,y],this.preanim(arguments,2));return this;},getRegion:function(){return D.getRegion(this.dom);},getHeight:function(_a0){var h=this.dom.offsetHeight||0;return _a0!==true?h:h-this.getBorderWidth(\"tb\")-this.getPadding(\"tb\");},getWidth:function(_a2){var w=this.dom.offsetWidth||0;return _a2!==true?w:w-this.getBorderWidth(\"lr\")-this.getPadding(\"lr\");},getComputedHeight:function(){var h=Math.max(this.dom.offsetHeight,this.dom.clientHeight);if(!h){h=parseInt(this.getStyle(\"height\"),10)||0;if(!this.isBorderBox()){h+=this.getFrameWidth(\"tb\");}}return h;},getComputedWidth:function(){var w=Math.max(this.dom.offsetWidth,this.dom.clientWidth);if(!w){w=parseInt(this.getStyle(\"width\"),10)||0;if(!this.isBorderBox()){w+=this.getFrameWidth(\"lr\");}}return w;},getSize:function(_a6){return {width:this.getWidth(_a6),height:this.getHeight(_a6)};},getViewSize:function(){var d=this.dom,doc=document,aw=0,ah=0;if(d==doc||d==doc.body){return {width:D.getViewWidth(),height:D.getViewHeight()};}else{return {width:d.clientWidth,height:d.clientHeight};}},getValue:function(_ab){return _ab?parseInt(this.dom.value,10):this.dom.value;},adjustWidth:function(_ac){if(typeof _ac==\"number\"){if(this.autoBoxAdjust&&!this.isBorderBox()){_ac-=(this.getBorderWidth(\"lr\")+this.getPadding(\"lr\"));}if(_ac<0){_ac=0;}}return _ac;},adjustHeight:function(_ad){if(typeof _ad==\"number\"){if(this.autoBoxAdjust&&!this.isBorderBox()){_ad-=(this.getBorderWidth(\"tb\")+this.getPadding(\"tb\"));}if(_ad<0){_ad=0;}}return _ad;},setWidth:function(_ae,_af){_ae=this.adjustWidth(_ae);if(!_af||!A){this.dom.style.width=this.addUnits(_ae);}else{this.anim({width:{to:_ae}},this.preanim(arguments,1));}return this;},setHeight:function(_b0,_b1){_b0=this.adjustHeight(_b0);if(!_b1||!A){this.dom.style.height=this.addUnits(_b0);}else{this.anim({height:{to:_b0}},this.preanim(arguments,1));}return this;},setSize:function(_b2,_b3,_b4){if(typeof _b2==\"object\"){_b3=_b2.height;_b2=_b2.width;}_b2=this.adjustWidth(_b2);_b3=this.adjustHeight(_b3);if(!_b4||!A){this.dom.style.width=this.addUnits(_b2);this.dom.style.height=this.addUnits(_b3);}else{this.anim({width:{to:_b2},height:{to:_b3}},this.preanim(arguments,2));}return this;},setBounds:function(x,y,_b7,_b8,_b9){if(!_b9||!A){this.setSize(_b7,_b8);this.setLocation(x,y);}else{_b7=this.adjustWidth(_b7);_b8=this.adjustHeight(_b8);this.anim({points:{to:[x,y]},width:{to:_b7},height:{to:_b8}},this.preanim(arguments,4),\"motion\");}return this;},setRegion:function(_ba,_bb){this.setBounds(_ba.left,_ba.top,_ba.right-_ba.left,_ba.bottom-_ba.top,this.preanim(arguments,1));return this;},addListener:function(_bc,fn,_be,_bf){Ext.EventManager.on(this.dom,_bc,fn,_be||this,_bf);},removeListener:function(_c0,fn){Ext.EventManager.removeListener(this.dom,_c0,fn);return this;},removeAllListeners:function(){E.purgeElement(this.dom);return this;},relayEvent:function(_c2,_c3){this.on(_c2,function(e){_c3.fireEvent(_c2,e);});},setOpacity:function(_c5,_c6){if(!_c6||!A){var s=this.dom.style;if(Ext.isIE){s.zoom=1;s.filter=(s.filter||\"\").replace(/alpha\\([^\\)]*\\)/gi,\"\")+(_c5==1?\"\":\"alpha(opacity=\"+_c5*100+\")\");}else{s.opacity=_c5;}}else{this.anim({opacity:{to:_c5}},this.preanim(arguments,1),null,0.35,\"easeIn\");}return this;},getLeft:function(_c8){if(!_c8){return this.getX();}else{return parseInt(this.getStyle(\"left\"),10)||0;}},getRight:function(_c9){if(!_c9){return this.getX()+this.getWidth();}else{return (this.getLeft(true)+this.getWidth())||0;}},getTop:function(_ca){if(!_ca){return this.getY();}else{return parseInt(this.getStyle(\"top\"),10)||0;}},getBottom:function(_cb){if(!_cb){return this.getY()+this.getHeight();}else{return (this.getTop(true)+this.getHeight())||0;}},position:function(pos,_cd,x,y){if(!pos){if(this.getStyle(\"position\")==\"static\"){this.setStyle(\"position\",\"relative\");}}else{this.setStyle(\"position\",pos);}if(_cd){this.setStyle(\"z-index\",_cd);}if(x!==undefined&&y!==undefined){this.setXY([x,y]);}else{if(x!==undefined){this.setX(x);}else{if(y!==undefined){this.setY(y);}}}},clearPositioning:function(_d0){_d0=_d0||\"\";this.setStyle({\"left\":_d0,\"right\":_d0,\"top\":_d0,\"bottom\":_d0,\"z-index\":\"\",\"position\":\"static\"});return this;},getPositioning:function(){var l=this.getStyle(\"left\");var t=this.getStyle(\"top\");return {\"position\":this.getStyle(\"position\"),\"left\":l,\"right\":l?\"\":this.getStyle(\"right\"),\"top\":t,\"bottom\":t?\"\":this.getStyle(\"bottom\"),\"z-index\":this.getStyle(\"z-index\")};},getBorderWidth:function(_d3){return this.addStyles(_d3,El.borders);},getPadding:function(_d4){return this.addStyles(_d4,El.paddings);},setPositioning:function(pc){this.applyStyles(pc);if(pc.right==\"auto\"){this.dom.style.right=\"\";}if(pc.bottom==\"auto\"){this.dom.style.bottom=\"\";}return this;},fixDisplay:function(){if(this.getStyle(\"display\")==\"none\"){this.setStyle(\"visibility\",\"hidden\");this.setStyle(\"display\",this.originalDisplay);if(this.getStyle(\"display\")==\"none\"){this.setStyle(\"display\",\"block\");}}},setLeftTop:function(_d6,top){this.dom.style.left=this.addUnits(_d6);this.dom.style.top=this.addUnits(top);return this;},move:function(_d8,_d9,_da){var xy=this.getXY();_d8=_d8.toLowerCase();switch(_d8){case \"l\":case \"left\":this.moveTo(xy[0]-_d9,xy[1],this.preanim(arguments,2));break;case \"r\":case \"right\":this.moveTo(xy[0]+_d9,xy[1],this.preanim(arguments,2));break;case \"t\":case \"top\":case \"up\":this.moveTo(xy[0],xy[1]-_d9,this.preanim(arguments,2));break;case \"b\":case \"bottom\":case \"down\":this.moveTo(xy[0],xy[1]+_d9,this.preanim(arguments,2));break;}return this;},clip:function(){if(!this.isClipped){this.isClipped=true;this.originalClip={\"o\":this.getStyle(\"overflow\"),\"x\":this.getStyle(\"overflow-x\"),\"y\":this.getStyle(\"overflow-y\")};this.setStyle(\"overflow\",\"hidden\");this.setStyle(\"overflow-x\",\"hidden\");this.setStyle(\"overflow-y\",\"hidden\");}return this;},unclip:function(){if(this.isClipped){this.isClipped=false;var o=this.originalClip;if(o.o){this.setStyle(\"overflow\",o.o);}if(o.x){this.setStyle(\"overflow-x\",o.x);}if(o.y){this.setStyle(\"overflow-y\",o.y);}}return this;},getAnchorXY:function(_dd,_de,s){var w,h,vp=false;if(!s){var d=this.dom;if(d==document.body||d==document){vp=true;w=D.getViewWidth();h=D.getViewHeight();}else{w=this.getWidth();h=this.getHeight();}}else{w=s.width;h=s.height;}var x=0,y=0,r=Math.round;switch((_dd||\"tl\").toLowerCase()){case \"c\":x=r(w*0.5);y=r(h*0.5);break;case \"t\":x=r(w*0.5);y=0;break;case \"l\":x=0;y=r(h*0.5);break;case \"r\":x=w;y=r(h*0.5);break;case \"b\":x=r(w*0.5);y=h;break;case \"tl\":x=0;y=0;break;case \"bl\":x=0;y=h;break;case \"br\":x=w;y=h;break;case \"tr\":x=w;y=0;break;}if(_de===true){return [x,y];}if(vp){var sc=this.getScroll();return [x+sc.left,y+sc.top];}var o=this.getXY();return [x+o[0],y+o[1]];},getAlignToXY:function(el,p,o){el=Ext.get(el),d=this.dom;if(!el.dom){throw \"Element.alignTo with an element that doesn't exist\";}var c=false;var p1=\"\",p2=\"\";o=o||[0,0];if(!p){p=\"tl-bl\";}else{if(p==\"?\"){p=\"tl-bl?\";}else{if(p.indexOf(\"-\")==-1){p=\"tl-\"+p;}}}p=p.toLowerCase();var m=p.match(/^([a-z]+)-([a-z]+)(\\?)?$/);if(!m){throw \"Element.alignTo with an invalid alignment \"+p;}p1=m[1],p2=m[2],c=m[3]?true:false;var a1=this.getAnchorXY(p1,true);var a2=el.getAnchorXY(p2,false);var x=a2[0]-a1[0]+o[0];var y=a2[1]-a1[1]+o[1];if(c){var w=this.getWidth(),h=this.getHeight(),r=el.getRegion();var dw=D.getViewWidth()-5,dh=D.getViewHeight()-5;var p1y=p1.charAt(0),p1x=p1.charAt(p1.length-1);var p2y=p2.charAt(0),p2x=p2.charAt(p2.length-1);var _fd=((p1y==\"t\"&&p2y==\"b\")||(p1y==\"b\"&&p2y==\"t\"));var _fe=((p1x==\"r\"&&p2x==\"l\")||(p1x==\"l\"&&p2x==\"r\"));var doc=document;var _100=(doc.documentElement.scrollLeft||doc.body.scrollLeft||0)+5;var _101=(doc.documentElement.scrollTop||doc.body.scrollTop||0)+5;if((x+w)>dw){x=_fe?r.left-w:dw-w;}if(x<_100){x=_fe?r.right:_100;}if((y+h)>dh){y=_fd?r.top-h:dh-h;}if(y<_101){y=_fd?r.bottom:_101;}}return [x,y];},getConstrainToXY:function(){var os={top:0,left:0,bottom:0,right:0};return function(el,_104,_105){el=Ext.get(el);_105=_105?Ext.applyIf(_105,os):os;var vw,vh,vx=0,vy=0;if(el.dom==document.body||el.dom==document){vw=Ext.lib.Dom.getViewWidth();vh=Ext.lib.Dom.getViewHeight();}else{vw=el.dom.clientWidth;vh=el.dom.clientHeight;if(!_104){var vxy=el.getXY();vx=vxy[0];vy=vxy[1];}}var s=el.getScroll();vx+=_105.left+s.left;vy+=_105.top+s.top;vw-=_105.right;vh-=_105.bottom;var vr=vx+vw;var vb=vy+vh;var xy=!_104?this.getXY():[this.getLeft(true),this.getTop(true)];var x=xy[0],y=xy[1];var w=this.dom.offsetWidth,h=this.dom.offsetHeight;var _113=false;if((x+w)>vr){x=vr-w;_113=true;}if((y+h)>vb){y=vb-h;_113=true;}if(x<vx){x=vx;_113=true;}if(y<vy){y=vy;_113=true;}return _113?[x,y]:false;};}(),alignTo:function(_114,_115,_116,_117){var xy=this.getAlignToXY(_114,_115,_116);this.setXY(xy,this.preanim(arguments,3));return this;},anchorTo:function(el,_11a,_11b,_11c,_11d,_11e){var _11f=function(){this.alignTo(el,_11a,_11b,_11c);Ext.callback(_11e,this);};Ext.EventManager.onWindowResize(_11f,this);var tm=typeof _11d;if(tm!=\"undefined\"){Ext.EventManager.on(window,\"scroll\",_11f,this,{buffer:tm==\"number\"?_11d:50});}_11f.call(this);return this;},clearOpacity:function(){if(window.ActiveXObject){this.dom.style.filter=\"\";}else{this.dom.style.opacity=\"\";this.dom.style[\"-moz-opacity\"]=\"\";this.dom.style[\"-khtml-opacity\"]=\"\";}return this;},hide:function(_121){this.setVisible(false,this.preanim(arguments,0));return this;},show:function(_122){this.setVisible(true,this.preanim(arguments,0));return this;},addUnits:function(size){return Ext.Element.addUnits(size,this.defaultUnit);},beginMeasure:function(){var el=this.dom;if(el.offsetWidth||el.offsetHeight){return this;}var _125=[];var p=this.dom,b=document.body;while((!el.offsetWidth&&!el.offsetHeight)&&p&&p.tagName&&p!=b){var pe=Ext.get(p);if(pe.getStyle(\"display\")==\"none\"){_125.push({el:p,visibility:pe.getStyle(\"visibility\")});p.style.visibility=\"hidden\";p.style.display=\"block\";}p=p.parentNode;}this._measureChanged=_125;return this;},endMeasure:function(){var _129=this._measureChanged;if(_129){for(var i=0,len=_129.length;i<len;i++){var r=_129[i];r.el.style.visibility=r.visibility;r.el.style.display=\"none\";}this._measureChanged=null;}return this;},update:function(html,_12e,_12f){if(typeof html==\"undefined\"){html=\"\";}if(_12e!==true){this.dom.innerHTML=html;if(typeof _12f==\"function\"){_12f();}return this;}var id=Ext.id();var dom=this.dom;html+=\"<span id=\\\"\"+id+\"\\\"></span>\";E.onAvailable(id,function(){var hd=document.getElementsByTagName(\"head\")[0];var re=/(?:<script([^>]*)?>)((\\n|\\r|.)*?)(?:<\\/script>)/ig;var _134=/\\ssrc=([\\'\\\"])(.*?)\\1/i;var _135=/\\stype=([\\'\\\"])(.*?)\\1/i;var _136;while(_136=re.exec(html)){var _137=_136[1];var _138=_137?_137.match(_134):false;if(_138&&_138[2]){var s=document.createElement(\"script\");s.src=_138[2];var _13a=_137.match(_135);if(_13a&&_13a[2]){s.type=_13a[2];}hd.appendChild(s);}else{if(_136[2]&&_136[2].length>0){eval(_136[2]);}}}var el=document.getElementById(id);if(el){el.parentNode.removeChild(el);}if(typeof _12f==\"function\"){_12f();}});dom.innerHTML=html.replace(/(?:<script.*?>)((\\n|\\r|.)*?)(?:<\\/script>)/ig,\"\");return this;},load:function(){var um=this.getUpdateManager();um.update.apply(um,arguments);return this;},getUpdateManager:function(){if(!this.updateManager){this.updateManager=new Ext.UpdateManager(this);}return this.updateManager;},unselectable:function(){this.dom.unselectable=\"on\";this.swallowEvent(\"selectstart\",true);this.applyStyles(\"-moz-user-select:none;-khtml-user-select:none;\");this.addClass(\"x-unselectable\");return this;},getCenterXY:function(){return this.getAlignToXY(document,\"c-c\");},center:function(_13d){this.alignTo(_13d||document,\"c-c\");return this;},isBorderBox:function(){return _13e[this.dom.tagName.toLowerCase()]||Ext.isBorderBox;},getBox:function(_13f,_140){var xy;if(!_140){xy=this.getXY();}else{var left=parseInt(this.getStyle(\"left\"),10)||0;var top=parseInt(this.getStyle(\"top\"),10)||0;xy=[left,top];}var el=this.dom,w=el.offsetWidth,h=el.offsetHeight,bx;if(!_13f){bx={x:xy[0],y:xy[1],0:xy[0],1:xy[1],width:w,height:h};}else{var l=this.getBorderWidth(\"l\")+this.getPadding(\"l\");var r=this.getBorderWidth(\"r\")+this.getPadding(\"r\");var t=this.getBorderWidth(\"t\")+this.getPadding(\"t\");var b=this.getBorderWidth(\"b\")+this.getPadding(\"b\");bx={x:xy[0]+l,y:xy[1]+t,0:xy[0]+l,1:xy[1]+t,width:w-(l+r),height:h-(t+b)};}bx.right=bx.x+bx.width;bx.bottom=bx.y+bx.height;return bx;},getFrameWidth:function(_14c){return this.getPadding(_14c)+this.getBorderWidth(_14c);},setBox:function(box,_14e,_14f){var w=box.width,h=box.height;if((_14e&&!this.autoBoxAdjust)&&!this.isBorderBox()){w-=(this.getBorderWidth(\"lr\")+this.getPadding(\"lr\"));h-=(this.getBorderWidth(\"tb\")+this.getPadding(\"tb\"));}this.setBounds(box.x,box.y,w,h,this.preanim(arguments,2));return this;},repaint:function(){var dom=this.dom;this.addClass(\"x-repaint\");setTimeout(function(){Ext.get(dom).removeClass(\"x-repaint\");},1);return this;},getMargins:function(side){if(!side){return {top:parseInt(this.getStyle(\"margin-top\"),10)||0,left:parseInt(this.getStyle(\"margin-left\"),10)||0,bottom:parseInt(this.getStyle(\"margin-bottom\"),10)||0,right:parseInt(this.getStyle(\"margin-right\"),10)||0};}else{return this.addStyles(side,El.margins);}},addStyles:function(_154,_155){var val=0;for(var i=0,len=_154.length;i<len;i++){var w=parseInt(this.getStyle(_155[_154.charAt(i)]),10);if(!isNaN(w)){val+=w;}}return val;},createProxy:function(_15a,_15b,_15c){if(_15b){_15b=Ext.getDom(_15b);}else{_15b=document.body;}_15a=typeof _15a==\"object\"?_15a:{tag:\"div\",cls:_15a};var _15d=Ext.DomHelper.append(_15b,_15a,true);if(_15c){_15d.setBox(this.getBox());}return _15d;},mask:function(msg,_15f){if(this.getStyle(\"position\")==\"static\"){this.setStyle(\"position\",\"relative\");}if(!this._mask){this._mask=Ext.DomHelper.append(this.dom,{tag:\"div\",cls:\"ext-el-mask\"},true);}this.addClass(\"x-masked\");this._mask.setDisplayed(true);if(typeof msg==\"string\"){if(!this._maskMsg){this._maskMsg=Ext.DomHelper.append(this.dom,{tag:\"div\",cls:\"ext-el-mask-msg\",cn:{tag:\"div\"}},true);}var mm=this._maskMsg;mm.dom.className=_15f?\"ext-el-mask-msg \"+_15f:\"ext-el-mask-msg\";mm.dom.firstChild.innerHTML=msg;mm.setDisplayed(true);mm.center(this);}return this._mask;},unmask:function(_161){if(this._mask){if(_161===true){this._mask.remove();delete this._mask;if(this._maskMsg){this._maskMsg.remove();delete this._maskMsg;}}else{this._mask.setDisplayed(false);if(this._maskMsg){this._maskMsg.setDisplayed(false);}}}this.removeClass(\"x-masked\");},isMasked:function(){return this._mask&&this._mask.isVisible();},createShim:function(){var el=document.createElement(\"iframe\");el.frameBorder=\"no\";el.className=\"ext-shim\";if(Ext.isIE&&Ext.isSecure){el.src=Ext.SSL_SECURE_URL;}var shim=Ext.get(this.dom.parentNode.insertBefore(el,this.dom));shim.autoBoxAdjust=false;return shim;},remove:function(){if(this.dom.parentNode){this.dom.parentNode.removeChild(this.dom);}delete El.cache[this.dom.id];},addClassOnOver:function(_164,_165){this.on(\"mouseover\",function(){Ext.fly(this,\"_internal\").addClass(_164);},this.dom);var _166=function(e){if(_165!==true||!e.within(this,true)){Ext.fly(this,\"_internal\").removeClass(_164);}};this.on(\"mouseout\",_166,this.dom);return this;},addClassOnFocus:function(_168){this.on(\"focus\",function(){Ext.fly(this,\"_internal\").addClass(_168);},this.dom);this.on(\"blur\",function(){Ext.fly(this,\"_internal\").removeClass(_168);},this.dom);return this;},addClassOnClick:function(_169){var dom=this.dom;this.on(\"mousedown\",function(){Ext.fly(dom,\"_internal\").addClass(_169);var d=Ext.get(document);var fn=function(){Ext.fly(dom,\"_internal\").removeClass(_169);d.removeListener(\"mouseup\",fn);};d.on(\"mouseup\",fn);});return this;},swallowEvent:function(_16d,_16e){var fn=function(e){e.stopPropagation();if(_16e){e.preventDefault();}};if(_16d instanceof Array){for(var i=0,len=_16d.length;i<len;i++){this.on(_16d[i],fn);}return this;}this.on(_16d,fn);return this;},fitToParent:function(_173,_174){var p=Ext.get(_174||this.dom.parentNode);this.setSize(p.getComputedWidth()-p.getFrameWidth(\"lr\"),p.getComputedHeight()-p.getFrameWidth(\"tb\"));if(_173===true){Ext.EventManager.onWindowResize(this.fitToParent.createDelegate(this,[]));}return this;},getNextSibling:function(){var n=this.dom.nextSibling;while(n&&n.nodeType!=1){n=n.nextSibling;}return n;},getPrevSibling:function(){var n=this.dom.previousSibling;while(n&&n.nodeType!=1){n=n.previousSibling;}return n;},appendChild:function(el){el=Ext.get(el);el.appendTo(this);return this;},createChild:function(_179,_17a,_17b){_179=_179||{tag:\"div\"};if(_17a){return Ext.DomHelper.insertBefore(_17a,_179,_17b!==true);}return Ext.DomHelper[!this.dom.firstChild?\"overwrite\":\"append\"](this.dom,_179,_17b!==true);},appendTo:function(el){el=Ext.getDom(el);el.appendChild(this.dom);return this;},insertBefore:function(el){el=Ext.getDom(el);el.parentNode.insertBefore(this.dom,el);return this;},insertAfter:function(el){el=Ext.getDom(el);el.parentNode.insertBefore(this.dom,el.nextSibling);return this;},insertFirst:function(el,_180){el=el||{};if(typeof el==\"object\"&&!el.nodeType){return this.createChild(el,this.dom.firstChild,_180);}else{el=Ext.getDom(el);this.dom.insertBefore(el,this.dom.firstChild);return !_180?Ext.get(el):el;}},insertSibling:function(el,_182,_183){_182=_182?_182.toLowerCase():\"before\";el=el||{};var rt,_185=_182==\"before\"?this.dom:this.dom.nextSibling;if(typeof el==\"object\"&&!el.nodeType){if(_182==\"after\"&&!this.dom.nextSibling){rt=Ext.DomHelper.append(this.dom.parentNode,el,!_183);}else{rt=Ext.DomHelper[_182==\"after\"?\"insertAfter\":\"insertBefore\"](this.dom,el,!_183);}}else{rt=this.dom.parentNode.insertBefore(Ext.getDom(el),_182==\"before\"?this.dom:this.dom.nextSibling);if(!_183){rt=Ext.get(rt);}}return rt;},wrap:function(_186,_187){if(!_186){_186={tag:\"div\"};}var _188=Ext.DomHelper.insertBefore(this.dom,_186,!_187);_188.dom?_188.dom.appendChild(this.dom):_188.appendChild(this.dom);return _188;},replace:function(el){el=Ext.get(el);this.insertBefore(el);el.remove();return this;},insertHtml:function(_18a,html){return Ext.DomHelper.insertHtml(_18a,this.dom,html);},set:function(o,_18d){var el=this.dom;_18d=typeof _18d==\"undefined\"?(el.setAttribute?true:false):_18d;for(var attr in o){if(attr==\"style\"||typeof o[attr]==\"function\"){continue;}if(attr==\"cls\"){el.className=o[\"cls\"];}else{if(_18d){el.setAttribute(attr,o[attr]);}else{el[attr]=o[attr];}}}Ext.DomHelper.applyStyles(el,o.style);return this;},addKeyListener:function(key,fn,_192){var _193;if(typeof key!=\"object\"||key instanceof Array){_193={key:key,fn:fn,scope:_192};}else{_193={key:key.key,shift:key.shift,ctrl:key.ctrl,alt:key.alt,fn:fn,scope:_192};}return new Ext.KeyMap(this,_193);},addKeyMap:function(_194){return new Ext.KeyMap(this,_194);},isScrollable:function(){var dom=this.dom;return dom.scrollHeight>dom.clientHeight||dom.scrollWidth>dom.clientWidth;},scrollTo:function(side,_197,_198){var prop=side.toLowerCase()==\"left\"?\"scrollLeft\":\"scrollTop\";if(!_198||!A){this.dom[prop]=_197;}else{var to=prop==\"scrollLeft\"?[_197,this.dom.scrollTop]:[this.dom.scrollLeft,_197];this.anim({scroll:{\"to\":to}},this.preanim(arguments,2),\"scroll\");}return this;},scroll:function(_19b,_19c,_19d){if(!this.isScrollable()){return;}var el=this.dom;var l=el.scrollLeft,t=el.scrollTop;var w=el.scrollWidth,h=el.scrollHeight;var cw=el.clientWidth,ch=el.clientHeight;_19b=_19b.toLowerCase();var _1a5=false;var a=this.preanim(arguments,2);switch(_19b){case \"l\":case \"left\":if(w-l>cw){var v=Math.min(l+_19c,w-cw);this.scrollTo(\"left\",v,a);_1a5=true;}break;case \"r\":case \"right\":if(l>0){var v=Math.max(l-_19c,0);this.scrollTo(\"left\",v,a);_1a5=true;}break;case \"t\":case \"top\":case \"up\":if(t>0){var v=Math.max(t-_19c,0);this.scrollTo(\"top\",v,a);_1a5=true;}break;case \"b\":case \"bottom\":case \"down\":if(h-t>ch){var v=Math.min(t+_19c,h-ch);this.scrollTo(\"top\",v,a);_1a5=true;}break;}return _1a5;},translatePoints:function(x,y){if(typeof x==\"object\"||x instanceof Array){y=x[1];x=x[0];}var p=this.getStyle(\"position\");var o=this.getXY();var l=parseInt(this.getStyle(\"left\"),10);var t=parseInt(this.getStyle(\"top\"),10);if(isNaN(l)){l=(p==\"relative\")?0:this.dom.offsetLeft;}if(isNaN(t)){t=(p==\"relative\")?0:this.dom.offsetTop;}return {left:(x-o[0]+l),top:(y-o[1]+t)};},getScroll:function(){var d=this.dom,doc=document;if(d==doc||d==doc.body){var l=window.pageXOffset||doc.documentElement.scrollLeft||doc.body.scrollLeft||0;var t=window.pageYOffset||doc.documentElement.scrollTop||doc.body.scrollTop||0;return {left:l,top:t};}else{return {left:d.scrollLeft,top:d.scrollTop};}},getColor:function(attr,_1b3,_1b4){var v=this.getStyle(attr);if(!v||v==\"transparent\"||v==\"inherit\"){return _1b3;}var _1b6=typeof _1b4==\"undefined\"?\"#\":_1b4;if(v.substr(0,4)==\"rgb(\"){var rvs=v.slice(4,v.length-1).split(\",\");for(var i=0;i<3;i++){var h=parseInt(rvs[i]).toString(16);if(h<16){h=\"0\"+h;}_1b6+=h;}}else{if(v.substr(0,1)==\"#\"){if(v.length==4){for(var i=1;i<4;i++){var c=v.charAt(i);_1b6+=c+c;}}else{if(v.length==7){_1b6+=v.substr(1);}}}}return (_1b6.length>5?_1b6.toLowerCase():_1b3);},boxWrap:function(cls){cls=cls||\"x-box\";var el=Ext.get(this.insertHtml(\"beforeBegin\",String.format(\"<div class=\\\"{0}\\\">\"+El.boxMarkup+\"</div>\",cls)));el.child(\".\"+cls+\"-mc\").dom.appendChild(this.dom);return el;},getAttributeNS:Ext.isIE?function(ns,name){var d=this.dom;var type=typeof d[ns+\":\"+name];if(type!=\"undefined\"&&type!=\"unknown\"){return d[ns+\":\"+name];}return d[name];}:function(ns,name){var d=this.dom;return d.getAttributeNS(ns,name)||d.getAttribute(ns+\":\"+name)||d.getAttribute(name)||d[name];}};var ep=El.prototype;ep.on=ep.addListener;ep.mon=ep.addListener;ep.un=ep.removeListener;ep.autoBoxAdjust=true;ep.autoDisplayMode=true;El.unitPattern=/\\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i;El.addUnits=function(v,_1c6){if(v===\"\"||v==\"auto\"){return v;}if(v===undefined){return \"\";}if(typeof v==\"number\"||!El.unitPattern.test(v)){return v+(_1c6||\"px\");}return v;};El.boxMarkup=\"<div class=\\\"{0}-tl\\\"><div class=\\\"{0}-tr\\\"><div class=\\\"{0}-tc\\\"></div></div></div><div class=\\\"{0}-ml\\\"><div class=\\\"{0}-mr\\\"><div class=\\\"{0}-mc\\\"></div></div></div><div class=\\\"{0}-bl\\\"><div class=\\\"{0}-br\\\"><div class=\\\"{0}-bc\\\"></div></div></div>\";El.VISIBILITY=1;El.DISPLAY=2;El.borders={l:\"border-left-width\",r:\"border-right-width\",t:\"border-top-width\",b:\"border-bottom-width\"};El.paddings={l:\"padding-left\",r:\"padding-right\",t:\"padding-top\",b:\"padding-bottom\"};El.margins={l:\"margin-left\",r:\"margin-right\",t:\"margin-top\",b:\"margin-bottom\"};El.cache={};var _1c7;El.get=function(el){var ex,elm,id;if(!el){return null;}if(typeof el==\"string\"){if(!(elm=document.getElementById(el))){return null;}if(ex=El.cache[el]){ex.dom=elm;}else{ex=El.cache[el]=new El(elm);}return ex;}else{if(el.tagName){if(!(id=el.id)){id=Ext.id(el);}if(ex=El.cache[id]){ex.dom=el;}else{ex=El.cache[id]=new El(el);}return ex;}else{if(el instanceof El){if(el!=_1c7){el.dom=document.getElementById(el.id)||el.dom;El.cache[el.id]=el;}return el;}else{if(el.isComposite){return el;}else{if(el instanceof Array){return El.select(el);}else{if(el==document){if(!_1c7){var f=function(){};f.prototype=El.prototype;_1c7=new f();_1c7.dom=document;}return _1c7;}}}}}}return null;};El.uncache=function(el){for(var i=0,a=arguments,len=a.length;i<len;i++){if(a[i]){delete El.cache[a[i].id||a[i]];}}};El.Flyweight=function(dom){this.dom=dom;};El.Flyweight.prototype=El.prototype;El._flyweights={};El.fly=function(el,_1d3){_1d3=_1d3||\"_global\";el=Ext.getDom(el);if(!el){return null;}if(!El._flyweights[_1d3]){El._flyweights[_1d3]=new El.Flyweight();}El._flyweights[_1d3].dom=el;return El._flyweights[_1d3];};Ext.get=El.get;Ext.fly=El.fly;var _13e=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1};if(Ext.isIE||Ext.isGecko){_13e[\"button\"]=1;}Ext.EventManager.on(window,\"unload\",function(){delete El.cache;delete El._flyweights;});})();\r\n\r\n\r\n\r\nExt.enableFx=true;Ext.Fx={slideIn:function(_1,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){_1=_1||\"t\";this.fixDisplay();var r=this.getFxRestore();var b=this.getBox();this.setSize(b);var _6=this.fxWrap(r.pos,o,\"hidden\");var st=this.dom.style;st.visibility=\"visible\";st.position=\"absolute\";var _8=function(){el.fxUnwrap(_6,r.pos,o);st.width=r.width;st.height=r.height;el.afterFx(o);};var a,pt={to:[b.x,b.y]},bw={to:b.width},bh={to:b.height};switch(_1.toLowerCase()){case \"t\":_6.setSize(b.width,0);st.left=st.bottom=\"0\";a={height:bh};break;case \"l\":_6.setSize(0,b.height);st.right=st.top=\"0\";a={width:bw};break;case \"r\":_6.setSize(0,b.height);_6.setX(b.right);st.left=st.top=\"0\";a={width:bw,points:pt};break;case \"b\":_6.setSize(b.width,0);_6.setY(b.bottom);st.left=st.top=\"0\";a={height:bh,points:pt};break;case \"tl\":_6.setSize(0,0);st.right=st.bottom=\"0\";a={width:bw,height:bh};break;case \"bl\":_6.setSize(0,0);_6.setY(b.y+b.height);st.right=st.top=\"0\";a={width:bw,height:bh,points:pt};break;case \"br\":_6.setSize(0,0);_6.setXY([b.right,b.bottom]);st.left=st.top=\"0\";a={width:bw,height:bh,points:pt};break;case \"tr\":_6.setSize(0,0);_6.setX(b.x+b.width);st.left=st.bottom=\"0\";a={width:bw,height:bh,points:pt};break;}this.dom.style.visibility=\"visible\";_6.show();arguments.callee.anim=_6.fxanim(a,o,\"motion\",0.5,\"easeOut\",_8);});return this;},slideOut:function(_d,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){_d=_d||\"t\";var r=this.getFxRestore();var b=this.getBox();this.setSize(b);var _12=this.fxWrap(r.pos,o,\"visible\");var st=this.dom.style;st.visibility=\"visible\";st.position=\"absolute\";_12.setSize(b);var _14=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}el.fxUnwrap(_12,r.pos,o);st.width=r.width;st.height=r.height;el.afterFx(o);};var a,_16={to:0};switch(_d.toLowerCase()){case \"t\":st.left=st.bottom=\"0\";a={height:_16};break;case \"l\":st.right=st.top=\"0\";a={width:_16};break;case \"r\":st.left=st.top=\"0\";a={width:_16,points:{to:[b.right,b.y]}};break;case \"b\":st.left=st.top=\"0\";a={height:_16,points:{to:[b.x,b.bottom]}};break;case \"tl\":st.right=st.bottom=\"0\";a={width:_16,height:_16};break;case \"bl\":st.right=st.top=\"0\";a={width:_16,height:_16,points:{to:[b.x,b.bottom]}};break;case \"br\":st.left=st.top=\"0\";a={width:_16,height:_16,points:{to:[b.x+b.width,b.bottom]}};break;case \"tr\":st.left=st.bottom=\"0\";a={width:_16,height:_16,points:{to:[b.right,b.y]}};break;}arguments.callee.anim=_12.fxanim(a,o,\"motion\",0.5,\"easeOut\",_14);});return this;},puff:function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){this.clearOpacity();this.show();var r=this.getFxRestore();var st=this.dom.style;var _1b=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}el.clearOpacity();el.setPositioning(r.pos);st.width=r.width;st.height=r.height;st.fontSize=\"\";el.afterFx(o);};var _1c=this.getWidth();var _1d=this.getHeight();arguments.callee.anim=this.fxanim({width:{to:this.adjustWidth(_1c*2)},height:{to:this.adjustHeight(_1d*2)},points:{by:[-(_1c*0.5),-(_1d*0.5)]},opacity:{to:0},fontSize:{to:200,unit:\"%\"}},o,\"motion\",0.5,\"easeOut\",_1b);});return this;},switchOff:function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){this.clearOpacity();this.clip();var r=this.getFxRestore();var st=this.dom.style;var _22=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}el.clearOpacity();el.setPositioning(r.pos);st.width=r.width;st.height=r.height;el.afterFx(o);};this.fxanim({opacity:{to:0.3}},null,null,0.1,null,function(){this.clearOpacity();(function(){this.fxanim({height:{to:1},points:{by:[0,this.getHeight()*0.5]}},o,\"motion\",0.3,\"easeIn\",_22);}).defer(100,this);});});return this;},highlight:function(_23,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){_23=_23||\"ffff9c\";attr=o.attr||\"backgroundColor\";this.clearOpacity();this.show();var _26=this.getColor(attr);var _27=this.dom.style[attr];endColor=(o.endColor||_26)||\"ffffff\";var _28=function(){el.dom.style[attr]=_27;el.afterFx(o);};var a={};a[attr]={from:_23,to:endColor};arguments.callee.anim=this.fxanim(a,o,\"color\",1,\"easeIn\",_28);});return this;},frame:function(_2a,_2b,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){_2a=_2a||\"#C3DAF9\";if(_2a.length==6){_2a=\"#\"+_2a;}_2b=_2b||1;duration=o.duration||1;this.show();var b=this.getBox();var _2f=function(){var _30=this.createProxy({tag:\"div\",style:{visbility:\"hidden\",position:\"absolute\",\"z-index\":\"35000\",border:\"0px solid \"+_2a}});var _31=Ext.isBorderBox?2:1;_30.animate({top:{from:b.y,to:b.y-20},left:{from:b.x,to:b.x-20},borderWidth:{from:0,to:10},opacity:{from:1,to:0},height:{from:b.height,to:(b.height+(20*_31))},width:{from:b.width,to:(b.width+(20*_31))}},duration,function(){_30.remove();});if(--_2b>0){_2f.defer((duration/2)*1000,this);}else{el.afterFx(o);}};_2f.call(this);});return this;},pause:function(_32){var el=this.getFxEl();var o={};el.queueFx(o,function(){setTimeout(function(){el.afterFx(o);},_32*1000);});return this;},fadeIn:function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){this.setOpacity(0);this.fixDisplay();this.dom.style.visibility=\"visible\";var to=o.endOpacity||1;arguments.callee.anim=this.fxanim({opacity:{to:to}},o,null,0.5,\"easeOut\",function(){if(to==1){this.clearOpacity();}el.afterFx(o);});});return this;},fadeOut:function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){arguments.callee.anim=this.fxanim({opacity:{to:o.endOpacity||0}},o,null,0.5,\"easeOut\",function(){if(this.visibilityMode==Ext.Element.DISPLAY||o.useDisplay){this.dom.style.display=\"none\";}else{this.dom.style.visibility=\"hidden\";}this.clearOpacity();el.afterFx(o);});});return this;},scale:function(w,h,o){this.shift(Ext.apply({},o,{width:w,height:h}));return this;},shift:function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){var a={},w=o.width,h=o.height,x=o.x,y=o.y,op=o.opacity;if(w!==undefined){a.width={to:this.adjustWidth(w)};}if(h!==undefined){a.height={to:this.adjustHeight(h)};}if(x!==undefined||y!==undefined){a.points={to:[x!==undefined?x:this.getX(),y!==undefined?y:this.getY()]};}if(op!==undefined){a.opacity={to:op};}if(o.xy!==undefined){a.points={to:o.xy};}arguments.callee.anim=this.fxanim(a,o,\"motion\",0.35,\"easeOut\",function(){el.afterFx(o);});});return this;},ghost:function(_45,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){_45=_45||\"b\";var r=this.getFxRestore();var w=this.getWidth(),h=this.getHeight();var st=this.dom.style;var _4c=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}el.clearOpacity();el.setPositioning(r.pos);st.width=r.width;st.height=r.height;el.afterFx(o);};var a={opacity:{to:0},points:{}},pt=a.points;switch(_45.toLowerCase()){case \"t\":pt.by=[0,-h];break;case \"l\":pt.by=[-w,0];break;case \"r\":pt.by=[w,0];break;case \"b\":pt.by=[0,h];break;case \"tl\":pt.by=[-w,-h];break;case \"bl\":pt.by=[-w,h];break;case \"br\":pt.by=[w,h];break;case \"tr\":pt.by=[w,-h];break;}arguments.callee.anim=this.fxanim(a,o,\"motion\",0.5,\"easeOut\",_4c);});return this;},syncFx:function(){this.fxDefaults=Ext.apply(this.fxDefaults||{},{block:false,concurrent:true,stopFx:false});return this;},sequenceFx:function(){this.fxDefaults=Ext.apply(this.fxDefaults||{},{block:false,concurrent:false,stopFx:false});return this;},nextFx:function(){var ef=this.fxQueue[0];if(ef){ef.call(this);}},hasActiveFx:function(){return this.fxQueue&&this.fxQueue[0];},stopFx:function(){if(this.hasActiveFx()){var cur=this.fxQueue[0];if(cur&&cur.anim&&cur.anim.isAnimated()){this.fxQueue=[cur];cur.anim.stop(true);}}return this;},beforeFx:function(o){if(this.hasActiveFx()&&!o.concurrent){if(o.stopFx){this.stopFx();return true;}return false;}return true;},hasFxBlock:function(){var q=this.fxQueue;return q&&q[0]&&q[0].block;},queueFx:function(o,fn){if(!this.fxQueue){this.fxQueue=[];}if(!this.hasFxBlock()){Ext.applyIf(o,this.fxDefaults);if(!o.concurrent){var run=this.beforeFx(o);fn.block=o.block;this.fxQueue.push(fn);if(run){this.nextFx();}}else{fn.call(this);}}return this;},fxWrap:function(pos,o,vis){var _59;if(!o.wrap||!(_59=Ext.get(o.wrap))){var _5a;if(o.fixPosition){_5a=this.getXY();}var div=document.createElement(\"div\");div.style.visibility=vis;_59=Ext.get(this.dom.parentNode.insertBefore(div,this.dom));_59.setPositioning(pos);if(_59.getStyle(\"position\")==\"static\"){_59.position(\"relative\");}this.clearPositioning(\"auto\");_59.clip();_59.dom.appendChild(this.dom);if(_5a){_59.setXY(_5a);}}return _59;},fxUnwrap:function(_5c,pos,o){this.clearPositioning();this.setPositioning(pos);if(!o.wrap){_5c.dom.parentNode.insertBefore(this.dom,_5c.dom);_5c.remove();}},getFxRestore:function(){var st=this.dom.style;return {pos:this.getPositioning(),width:st.width,height:st.height};},afterFx:function(o){if(o.afterStyle){this.applyStyles(o.afterStyle);}if(o.afterCls){this.addClass(o.afterCls);}if(o.remove===true){this.remove();}Ext.callback(o.callback,o.scope,[this]);if(!o.concurrent){this.fxQueue.shift();this.nextFx();}},getFxEl:function(){return Ext.get(this.dom);},fxanim:function(_61,opt,_63,_64,_65,cb){_63=_63||\"run\";opt=opt||{};var _67=Ext.lib.Anim[_63](this.dom,_61,(opt.duration||_64)||0.35,(opt.easing||_65)||\"easeOut\",function(){Ext.callback(cb,this);},this);opt.anim=_67;return _67;}};Ext.Fx.resize=Ext.Fx.scale;Ext.apply(Ext.Element.prototype,Ext.Fx);\r\n\r\n\r\n\r\nExt.CompositeElement=function(_1){this.elements=[];this.addElements(_1);};Ext.CompositeElement.prototype={isComposite:true,addElements:function(_2){if(!_2){return this;}if(typeof _2==\"string\"){_2=Ext.Element.selectorFunction(_2);}var _3=this.elements;var _4=_3.length-1;for(var i=0,_6=_2.length;i<_6;i++){_3[++_4]=Ext.get(_2[i],true);}return this;},invoke:function(fn,_8){var _9=this.elements;for(var i=0,_b=_9.length;i<_b;i++){Ext.Element.prototype[fn].apply(_9[i],_8);}return this;},add:function(_c){if(typeof _c==\"string\"){this.addElements(Ext.Element.selectorFunction(_c));}else{if(_c.length!==undefined){this.addElements(_c);}else{this.addElements([_c]);}}return this;},each:function(fn,_e){var _f=this.elements;for(var i=0,len=_f.length;i<len;i++){if(fn.call(_e||_f[i],_f[i],this,i)===false){break;}}return this;},item:function(_12){return this.elements[_12];}};(function(){Ext.CompositeElement.createCall=function(_13,_14){if(!_13[_14]){_13[_14]=function(){return this.invoke(_14,arguments);};}};for(var _15 in Ext.Element.prototype){if(typeof Ext.Element.prototype[_15]==\"function\"){Ext.CompositeElement.createCall(Ext.CompositeElement.prototype,_15);}}})();Ext.CompositeElementLite=function(els){Ext.CompositeElementLite.superclass.constructor.call(this,els);var _17=function(){};_17.prototype=Ext.Element.prototype;this.el=new Ext.Element.Flyweight();};Ext.extend(Ext.CompositeElementLite,Ext.CompositeElement,{addElements:function(els){if(els){if(els instanceof Array){this.elements=this.elements.concat(els);}else{var _19=this.elements;var _1a=_19.length-1;for(var i=0,len=els.length;i<len;i++){_19[++_1a]=els[i];}}}return this;},invoke:function(fn,_1e){var els=this.elements;var el=this.el;for(var i=0,len=els.length;i<len;i++){el.dom=els[i];Ext.Element.prototype[fn].apply(el,_1e);}return this;},item:function(_23){this.el.dom=this.elements[_23];return this.el;},addListener:function(_24,_25,_26,opt){var els=this.elements;for(var i=0,len=els.length;i<len;i++){Ext.EventManager.on(els[i],_24,_25,_26||els[i],opt);}return this;},each:function(fn,_2c){var els=this.elements;var el=this.el;for(var i=0,len=els.length;i<len;i++){el.dom=els[i];if(fn.call(_2c||el,el,this,i)===false){break;}}return this;}});Ext.CompositeElementLite.prototype.on=Ext.CompositeElementLite.prototype.addListener;if(Ext.DomQuery){Ext.Element.selectorFunction=Ext.DomQuery.select;}Ext.Element.select=function(_31,_32){var els;if(typeof _31==\"string\"){els=Ext.Element.selectorFunction(_31);}else{if(_31.length!==undefined){els=_31;}else{throw \"Invalid selector\";}}if(_32===true){return new Ext.CompositeElement(els);}else{return new Ext.CompositeElementLite(els);}};Ext.select=Ext.Element.select;\r\n\r\n\r\n\r\nExt.UpdateManager=function(el,_2){el=Ext.get(el);if(!_2&&el.updateManager){return el.updateManager;}this.el=el;this.defaultUrl=null;this.addEvents({\"beforeupdate\":true,\"update\":true,\"failure\":true});var d=Ext.UpdateManager.defaults;this.sslBlankUrl=d.sslBlankUrl;this.disableCaching=d.disableCaching;this.indicatorText=d.indicatorText;this.showLoadIndicator=d.showLoadIndicator;this.timeout=d.timeout;this.loadScripts=d.loadScripts;this.transaction=null;this.autoRefreshProcId=null;this.refreshDelegate=this.refresh.createDelegate(this);this.updateDelegate=this.update.createDelegate(this);this.formUpdateDelegate=this.formUpdate.createDelegate(this);this.successDelegate=this.processSuccess.createDelegate(this);this.failureDelegate=this.processFailure.createDelegate(this);this.renderer=new Ext.UpdateManager.BasicRenderer();Ext.UpdateManager.superclass.constructor.call(this);};Ext.extend(Ext.UpdateManager,Ext.util.Observable,{getEl:function(){return this.el;},update:function(_4,_5,_6,_7){if(this.fireEvent(\"beforeupdate\",this.el,_4,_5)!==false){var _8=this.method;if(typeof _4==\"object\"){var _9=_4;_4=_9.url;_5=_5||_9.params;_6=_6||_9.callback;_7=_7||_9.discardUrl;if(_6&&_9.scope){_6=_6.createDelegate(_9.scope);}if(typeof _9.method!=\"undefined\"){_8=_9.method;}if(typeof _9.nocache!=\"undefined\"){this.disableCaching=_9.nocache;}if(typeof _9.text!=\"undefined\"){this.indicatorText=\"<div class=\\\"loading-indicator\\\">\"+_9.text+\"</div>\";}if(typeof _9.scripts!=\"undefined\"){this.loadScripts=_9.scripts;}if(typeof _9.timeout!=\"undefined\"){this.timeout=_9.timeout;}}this.showLoading();if(!_7){this.defaultUrl=_4;}if(typeof _4==\"function\"){_4=_4.call(this);}if(typeof _5==\"function\"){_5=_5();}if(_5&&typeof _5!=\"string\"){var _a=[];for(var _b in _5){if(typeof _5[_b]!=\"function\"){_a.push(encodeURIComponent(_b),\"=\",encodeURIComponent(_5[_b]),\"&\");}}delete _a[_a.length-1];_5=_a.join(\"\");}var cb={success:this.successDelegate,failure:this.failureDelegate,timeout:(this.timeout*1000),argument:{\"url\":_4,\"form\":null,\"callback\":_6,\"params\":_5}};_8=_8||(_5?\"POST\":\"GET\");if(_8==\"GET\"){_4=this.prepareUrl(_4);}this.transaction=Ext.lib.Ajax.request(_8,_4,cb,_5);}},formUpdate:function(_d,_e,_f,_10){if(this.fireEvent(\"beforeupdate\",this.el,_d,_e)!==false){formEl=Ext.getDom(_d);if(typeof _e==\"function\"){_e=_e.call(this);}if(typeof params==\"function\"){params=params();}_e=_e||formEl.action;var cb={success:this.successDelegate,failure:this.failureDelegate,timeout:(this.timeout*1000),argument:{\"url\":_e,\"form\":formEl,\"callback\":_10,\"reset\":_f}};var _12=false;var _13=formEl.getAttribute(\"enctype\");if(_13&&_13.toLowerCase()==\"multipart/form-data\"){_12=true;cb.upload=this.successDelegate;}this.transaction=Ext.lib.Ajax.formRequest(formEl,_e,cb,null,_12,this.sslBlankUrl);this.showLoading.defer(1,this);}},refresh:function(_14){if(this.defaultUrl==null){return;}this.update(this.defaultUrl,null,_14,true);},startAutoRefresh:function(_15,url,_17,_18,_19){if(_19){this.update(url||this.defaultUrl,_17,_18,true);}if(this.autoRefreshProcId){clearInterval(this.autoRefreshProcId);}this.autoRefreshProcId=setInterval(this.update.createDelegate(this,[url||this.defaultUrl,_17,_18,true]),_15*1000);},stopAutoRefresh:function(){if(this.autoRefreshProcId){clearInterval(this.autoRefreshProcId);delete this.autoRefreshProcId;}},isAutoRefreshing:function(){return this.autoRefreshProcId?true:false;},showLoading:function(){if(this.showLoadIndicator){this.el.update(this.indicatorText);}},prepareUrl:function(url){if(this.disableCaching){var _1b=\"_dc=\"+(new Date().getTime());if(url.indexOf(\"?\")!==-1){url+=\"&\"+_1b;}else{url+=\"?\"+_1b;}}return url;},processSuccess:function(_1c){this.transaction=null;if(_1c.argument.form&&_1c.argument.reset){try{_1c.argument.form.reset();}catch(e){}}if(this.loadScripts){this.renderer.render(this.el,_1c,this,this.updateComplete.createDelegate(this,[_1c]));}else{this.renderer.render(this.el,_1c,this);this.updateComplete(_1c);}},updateComplete:function(_1d){this.fireEvent(\"update\",this.el,_1d);if(typeof _1d.argument.callback==\"function\"){_1d.argument.callback(this.el,true,_1d);}},processFailure:function(_1e){this.transaction=null;this.fireEvent(\"failure\",this.el,_1e);if(typeof _1e.argument.callback==\"function\"){_1e.argument.callback(this.el,false,_1e);}},setRenderer:function(_1f){this.renderer=_1f;},getRenderer:function(){return this.renderer;},setDefaultUrl:function(_20){this.defaultUrl=_20;},abort:function(){if(this.transaction){Ext.lib.Ajax.abort(this.transaction);}},isUpdating:function(){if(this.transaction){return Ext.lib.Ajax.isCallInProgress(this.transaction);}return false;}});Ext.UpdateManager.defaults={timeout:30,loadScripts:false,sslBlankUrl:(Ext.SSL_SECURE_URL||\"javascript:false\"),disableCaching:false,showLoadIndicator:true,indicatorText:\"<div class=\\\"loading-indicator\\\">Loading...</div>\"};Ext.UpdateManager.updateElement=function(el,url,_23,_24){var um=Ext.get(el,true).getUpdateManager();Ext.apply(um,_24);um.update(url,_23,_24?_24.callback:null);};Ext.UpdateManager.update=Ext.UpdateManager.updateElement;Ext.UpdateManager.BasicRenderer=function(){};Ext.UpdateManager.BasicRenderer.prototype={render:function(el,_27,_28,_29){el.update(_27.responseText,_28.loadScripts,_29);}};\r\n\r\n\r\n\r\nExt.util.DelayedTask=function(fn,_2,_3){var id=null,d,t;var _7=function(){var _8=new Date().getTime();if(_8-t>=d){clearInterval(id);id=null;fn.apply(_2,_3||[]);}};this.delay=function(_9,_a,_b,_c){if(id&&_9!=d){this.cancel();}d=_9;t=new Date().getTime();fn=_a||fn;_2=_b||_2;_3=_c||_3;if(!id){id=setInterval(_7,d);}};this.cancel=function(){if(id){clearInterval(id);id=null;}};};\r\n\r\n\r\n\r\nExt.util.TaskRunner=function(_1){_1=_1||10;var _2=[],_3=[];var id=0;var _5=false;var _6=function(){_5=false;clearInterval(id);id=0;};var _7=function(){if(!_5){_5=true;id=setInterval(_8,_1);}};var _9=function(_a){_3.push(_a);if(_a.onStop){_a.onStop();}};var _8=function(){if(_3.length>0){for(var i=0,_c=_3.length;i<_c;i++){_2.remove(_3[i]);}_3=[];if(_2.length<1){_6();return;}}var _d=new Date().getTime();for(var i=0,_c=_2.length;i<_c;++i){var t=_2[i];var _f=_d-t.taskRunTime;if(t.interval<=_f){var rt=t.run.apply(t.scope||t,t.args||[++t.taskRunCount]);t.taskRunTime=_d;if(rt===false||t.taskRunCount===t.repeat){_9(t);return;}}if(t.duration&&t.duration<=(_d-t.taskStartTime)){_9(t);}}};this.start=function(_11){_2.push(_11);_11.taskStartTime=new Date().getTime();_11.taskRunTime=0;_11.taskRunCount=0;_7();return _11;};this.stop=function(_12){_9(_12);return _12;};this.stopAll=function(){_6();for(var i=0,len=_2.length;i<len;i++){if(_2[i].onStop){_2[i].onStop();}}_2=[];_3=[];};};Ext.TaskMgr=new Ext.util.TaskRunner();\r\n\r\n\r\n\r\nExt.util.MixedCollection=function(_1,_2){this.items=[];this.map={};this.keys=[];this.length=0;this.addEvents({\"clear\":true,\"add\":true,\"replace\":true,\"remove\":true,\"sort\":true});this.allowFunctions=_1===true;if(_2){this.getKey=_2;}Ext.util.MixedCollection.superclass.constructor.call(this);};Ext.extend(Ext.util.MixedCollection,Ext.util.Observable,{allowFunctions:false,add:function(_3,o){if(arguments.length==1){o=arguments[0];_3=this.getKey(o);}if(typeof _3==\"undefined\"||_3===null){this.length++;this.items.push(o);this.keys.push(null);}else{var _5=this.map[_3];if(_5){return this.replace(_3,o);}this.length++;this.items.push(o);this.map[_3]=o;this.keys.push(_3);}this.fireEvent(\"add\",this.length-1,o,_3);return o;},getKey:function(o){return o.id;},replace:function(_7,o){if(arguments.length==1){o=arguments[0];_7=this.getKey(o);}var _9=this.item(_7);if(typeof _7==\"undefined\"||_7===null||typeof _9==\"undefined\"){return this.add(_7,o);}var _a=this.indexOfKey(_7);this.items[_a]=o;this.map[_7]=o;this.fireEvent(\"replace\",_7,_9,o);return o;},addAll:function(_b){if(arguments.length>1||_b instanceof Array){var _c=arguments.length>1?arguments:_b;for(var i=0,_e=_c.length;i<_e;i++){this.add(_c[i]);}}else{for(var _f in _b){if(this.allowFunctions||typeof _b[_f]!=\"function\"){this.add(_b[_f],_f);}}}},each:function(fn,_11){var _12=[].concat(this.items);for(var i=0,len=_12.length;i<len;i++){if(fn.call(_11||_12[i],_12[i],i,len)===false){break;}}},eachKey:function(fn,_16){for(var i=0,len=this.keys.length;i<len;i++){fn.call(_16||window,this.keys[i],this.items[i],i,len);}},find:function(fn,_1a){for(var i=0,len=this.items.length;i<len;i++){if(fn.call(_1a||window,this.items[i],this.keys[i])){return this.items[i];}}return null;},insert:function(_1d,key,o){if(arguments.length==2){o=arguments[1];key=this.getKey(o);}if(_1d>=this.length){return this.add(key,o);}this.length++;this.items.splice(_1d,0,o);if(typeof key!=\"undefined\"&&key!=null){this.map[key]=o;}this.keys.splice(_1d,0,key);this.fireEvent(\"add\",_1d,o,key);return o;},remove:function(o){return this.removeAt(this.indexOf(o));},removeAt:function(_21){if(_21<this.length&&_21>=0){this.length--;var o=this.items[_21];this.items.splice(_21,1);var key=this.keys[_21];if(typeof key!=\"undefined\"){delete this.map[key];}this.keys.splice(_21,1);this.fireEvent(\"remove\",o,key);}},removeKey:function(key){return this.removeAt(this.indexOfKey(key));},getCount:function(){return this.length;},indexOf:function(o){if(!this.items.indexOf){for(var i=0,len=this.items.length;i<len;i++){if(this.items[i]==o){return i;}}return -1;}else{return this.items.indexOf(o);}},indexOfKey:function(key){if(!this.keys.indexOf){for(var i=0,len=this.keys.length;i<len;i++){if(this.keys[i]==key){return i;}}return -1;}else{return this.keys.indexOf(key);}},item:function(key){var _2c=typeof this.map[key]!=\"undefined\"?this.map[key]:this.items[key];return typeof _2c!=\"function\"||this.allowFunctions?_2c:null;},itemAt:function(_2d){return this.items[_2d];},key:function(key){return this.map[key];},contains:function(o){return this.indexOf(o)!=-1;},containsKey:function(key){return typeof this.map[key]!=\"undefined\";},clear:function(){this.length=0;this.items=[];this.keys=[];this.map={};this.fireEvent(\"clear\");},first:function(){return this.items[0];},last:function(){return this.items[this.length-1];},_sort:function(_31,dir,fn){var dsc=String(dir).toUpperCase()==\"DESC\"?-1:1;fn=fn||function(a,b){return a-b;};var c=[],k=this.keys,_39=this.items;for(var i=0,len=_39.length;i<len;i++){c[c.length]={key:k[i],value:_39[i],index:i};}c.sort(function(a,b){var v=fn(a[_31],b[_31])*dsc;if(v==0){v=(a.index<b.index?-1:1);}return v;});for(var i=0,len=c.length;i<len;i++){_39[i]=c[i].value;k[i]=c[i].key;}this.fireEvent(\"sort\",this);},sort:function(dir,fn){this._sort(\"value\",dir,fn);},keySort:function(dir,fn){this._sort(\"key\",dir,fn||function(a,b){return String(a).toUpperCase()-String(b).toUpperCase();});},getRange:function(_45,end){var _47=this.items;if(_47.length<1){return [];}_45=_45||0;end=Math.min(typeof end==\"undefined\"?this.length-1:end,this.length-1);var r=[];if(_45<=end){for(var i=_45;i<=end;i++){r[r.length]=_47[i];}}else{for(var i=_45;i>=end;i--){r[r.length]=_47[i];}}return r;},filter:function(_4a,_4b){if(!_4b.exec){_4b=String(_4b);if(_4b.length==0){return this.clone();}_4b=new RegExp(\"^\"+Ext.escapeRe(_4b),\"i\");}return this.filterBy(function(o){return o&&_4b.test(o[_4a]);});},filterBy:function(fn,_4e){var r=new Ext.util.MixedCollection();r.getKey=this.getKey;var k=this.keys,it=this.items;for(var i=0,len=it.length;i<len;i++){if(fn.call(_4e||this,it[i],k[i])){r.add(k[i],it[i]);}}return r;},clone:function(){var r=new Ext.util.MixedCollection();var k=this.keys,it=this.items;for(var i=0,len=it.length;i<len;i++){r.add(k[i],it[i]);}r.getKey=this.getKey;return r;}});Ext.util.MixedCollection.prototype.get=Ext.util.MixedCollection.prototype.item;\r\n\r\n\r\n\r\nExt.util.JSON=new (function(){var _1={}.hasOwnProperty?true:false;var _2=function(n){return n<10?\"0\"+n:n;};var m={\"\\b\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\f\":\"\\\\f\",\"\\r\":\"\\\\r\",\"\\\"\":\"\\\\\\\"\",\"\\\\\":\"\\\\\\\\\"};var _5=function(s){if(/[\"\\\\\\x00-\\x1f]/.test(s)){return \"\\\"\"+s.replace(/([\\x00-\\x1f\\\\\"])/g,function(a,b){var c=m[b];if(c){return c;}c=b.charCodeAt();return \"\\\\u00\"+Math.floor(c/16).toString(16)+(c%16).toString(16);})+\"\\\"\";}return \"\\\"\"+s+\"\\\"\";};var _a=function(o){var a=[\"[\"],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case \"undefined\":case \"function\":case \"unknown\":break;default:if(b){a.push(\",\");}a.push(v===null?\"null\":Ext.util.JSON.encode(v));b=true;}}a.push(\"]\");return a.join(\"\");};var _11=function(o){return \"\\\"\"+o.getFullYear()+\"-\"+_2(o.getMonth()+1)+\"-\"+_2(o.getDate())+\"T\"+_2(o.getHours())+\":\"+_2(o.getMinutes())+\":\"+_2(o.getSeconds())+\"\\\"\";};this.encode=function(o){if(typeof o==\"undefined\"||o===null){return \"null\";}else{if(o instanceof Array){return _a(o);}else{if(o instanceof Date){return _11(o);}else{if(typeof o==\"string\"){return _5(o);}else{if(typeof o==\"number\"){return isFinite(o)?String(o):\"null\";}else{if(typeof o==\"boolean\"){return String(o);}else{var a=[\"{\"],b,i,v;for(i in o){if(!_1||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case \"undefined\":case \"function\":case \"unknown\":break;default:if(b){a.push(\",\");}a.push(this.encode(i),\":\",v===null?\"null\":this.encode(v));b=true;}}}a.push(\"}\");return a.join(\"\");}}}}}}};this.decode=function(_18){return eval(\"(\"+_18+\")\");};})();Ext.encode=Ext.util.JSON.encode;Ext.decode=Ext.util.JSON.decode;\r\n\r\n\r\n\r\nExt.util.Format=function(){var _1=/^\\s+|\\s+$/g;return {ellipsis:function(_2,_3){if(_2&&_2.length>_3){return _2.substr(0,_3-3)+\"...\";}return _2;},undef:function(_4){return typeof _4!=\"undefined\"?_4:\"\";},htmlEncode:function(_5){return !_5?_5:String(_5).replace(/&/g,\"&amp;\").replace(/>/g,\"&gt;\").replace(/</g,\"&lt;\").replace(/\"/g,\"&quot;\");},trim:function(_6){return String(_6).replace(_1,\"\");},substr:function(_7,_8,_9){return String(_7).substr(_8,_9);},lowercase:function(_a){return String(_a).toLowerCase();},uppercase:function(_b){return String(_b).toUpperCase();},capitalize:function(_c){return !_c?_c:_c.charAt(0).toUpperCase()+_c.substr(1).toLowerCase();},call:function(_d,fn){if(arguments.length>2){var _f=Array.prototype.slice.call(arguments,2);_f.unshift(_d);return eval(fn).apply(window,_f);}else{return eval(fn).call(window,_d);}},usMoney:function(v){v=(Math.round((v-0)*100))/100;v=(v==Math.floor(v))?v+\".00\":((v*10==Math.floor(v*10))?v+\"0\":v);return \"$\"+v;},date:function(v,_12){if(!v){return \"\";}if(!(v instanceof Date)){v=new Date(Date.parse(v));}return v.dateFormat(_12||\"m/d/Y\");},dateRenderer:function(_13){return function(v){return Ext.util.Format.date(v,_13);};},stripTagsRE:/<\\/?[^>]+>/gi,stripTags:function(v){return !v?v:String(v).replace(this.stripTagsRE,\"\");}};}();\r\n\r\n\r\n\r\nExt.util.CSS=function(){var _1=null;var _2=document;var _3=/(-[a-z])/gi;var _4=function(m,a){return a.charAt(1).toUpperCase();};return {createStyleSheet:function(_7){var ss;if(Ext.isIE){ss=_2.createStyleSheet();ss.cssText=_7;}else{var _9=_2.getElementsByTagName(\"head\")[0];var _a=_2.createElement(\"style\");_a.setAttribute(\"type\",\"text/css\");try{_a.appendChild(_2.createTextNode(_7));}catch(e){_a.cssText=_7;}_9.appendChild(_a);ss=_a.styleSheet?_a.styleSheet:(_a.sheet||_2.styleSheets[_2.styleSheets.length-1]);}this.cacheStyleSheet(ss);return ss;},removeStyleSheet:function(id){var _c=_2.getElementById(id);if(_c){_c.parentNode.removeChild(_c);}},swapStyleSheet:function(id,_e){this.removeStyleSheet(id);var ss=_2.createElement(\"link\");ss.setAttribute(\"rel\",\"stylesheet\");ss.setAttribute(\"type\",\"text/css\");ss.setAttribute(\"id\",id);ss.setAttribute(\"href\",_e);_2.getElementsByTagName(\"head\")[0].appendChild(ss);},refreshCache:function(){return this.getRules(true);},cacheStyleSheet:function(ss){if(!_1){_1={};}try{var _11=ss.cssRules||ss.rules;for(var j=_11.length-1;j>=0;--j){_1[_11[j].selectorText]=_11[j];}}catch(e){}},getRules:function(_13){if(_1==null||_13){_1={};var ds=_2.styleSheets;for(var i=0,len=ds.length;i<len;i++){try{this.cacheStyleSheet(ds[i]);}catch(e){}}}return _1;},getRule:function(_17,_18){var rs=this.getRules(_18);if(!(_17 instanceof Array)){return rs[_17];}for(var i=0;i<_17.length;i++){if(rs[_17[i]]){return rs[_17[i]];}}return null;},updateRule:function(_1b,_1c,_1d){if(!(_1b instanceof Array)){var _1e=this.getRule(_1b);if(_1e){_1e.style[_1c.replace(_3,_4)]=_1d;return true;}}else{for(var i=0;i<_1b.length;i++){if(this.updateRule(_1b[i],_1c,_1d)){return true;}}}return false;}};}();\r\n\r\n\r\n\r\nExt.util.ClickRepeater=function(el,_2){this.el=Ext.get(el);this.el.unselectable();Ext.apply(this,_2);this.addEvents({\"mousedown\":true,\"click\":true,\"mouseup\":true});this.el.on(\"mousedown\",this.handleMouseDown,this);if(this.preventDefault||this.stopDefault){this.el.on(\"click\",function(e){if(this.preventDefault){e.preventDefault();}if(this.stopDefault){e.stopEvent();}},this);}if(this.handler){this.on(\"click\",this.handler,this.scope||this);}Ext.util.ClickRepeater.superclass.constructor.call(this);};Ext.extend(Ext.util.ClickRepeater,Ext.util.Observable,{interval:20,delay:250,preventDefault:true,stopDefault:false,timer:0,docEl:Ext.get(document),handleMouseDown:function(){clearTimeout(this.timer);this.el.blur();if(this.pressClass){this.el.addClass(this.pressClass);}this.mousedownTime=new Date();this.docEl.on(\"mouseup\",this.handleMouseUp,this);this.el.on(\"mouseout\",this.handleMouseOut,this);this.fireEvent(\"mousedown\",this);this.fireEvent(\"click\",this);this.timer=this.click.defer(this.delay||this.interval,this);},click:function(){this.fireEvent(\"click\",this);this.timer=this.click.defer(this.getInterval(),this);},getInterval:function(){if(!this.accelerate){return this.interval;}var _4=this.mousedownTime.getElapsed();if(_4<500){return 400;}else{if(_4<1700){return 320;}else{if(_4<2600){return 250;}else{if(_4<3500){return 180;}else{if(_4<4400){return 140;}else{if(_4<5300){return 80;}else{if(_4<6200){return 50;}else{return 10;}}}}}}}},handleMouseOut:function(){clearTimeout(this.timer);if(this.pressClass){this.el.removeClass(this.pressClass);}this.el.on(\"mouseover\",this.handleMouseReturn,this);},handleMouseReturn:function(){this.el.un(\"mouseover\",this.handleMouseReturn);if(this.pressClass){this.el.addClass(this.pressClass);}this.click();},handleMouseUp:function(){clearTimeout(this.timer);this.el.un(\"mouseover\",this.handleMouseReturn);this.el.un(\"mouseout\",this.handleMouseOut);this.docEl.un(\"mouseup\",this.handleMouseUp);this.el.removeClass(this.pressClass);this.fireEvent(\"mouseup\",this);}});\r\n\r\n\r\n\r\nExt.KeyNav=function(el,_2){this.el=Ext.get(el);Ext.apply(this,_2);if(!this.disabled){this.disabled=true;this.enable();}};Ext.KeyNav.prototype={disabled:false,defaultEventAction:\"stopEvent\",prepareEvent:function(e){var k=e.getKey();var h=this.keyToHandler[k];if(Ext.isSafari&&h&&k>=37&&k<=40){e.stopEvent();}},relay:function(e){var k=e.getKey();var h=this.keyToHandler[k];if(h&&this[h]){if(this.doRelay(e,this[h],h)!==true){e[this.defaultEventAction]();}}},doRelay:function(e,h,_b){return h.call(this.scope||this,e);},enter:false,left:false,right:false,up:false,down:false,tab:false,esc:false,pageUp:false,pageDown:false,del:false,home:false,end:false,keyToHandler:{37:\"left\",39:\"right\",38:\"up\",40:\"down\",33:\"pageUp\",34:\"pageDown\",46:\"del\",36:\"home\",35:\"end\",13:\"enter\",27:\"esc\",9:\"tab\"},enable:function(){if(this.disabled){if(Ext.isIE){this.el.on(\"keydown\",this.relay,this);}else{this.el.on(\"keydown\",this.prepareEvent,this);this.el.on(\"keypress\",this.relay,this);}this.disabled=false;}},disable:function(){if(!this.disabled){if(Ext.isIE){this.el.un(\"keydown\",this.relay);}else{this.el.un(\"keydown\",this.prepareEvent);this.el.un(\"keypress\",this.relay);}this.disabled=true;}}};\r\n\r\n\r\n\r\nExt.KeyMap=function(el,_2,_3){this.el=Ext.get(el);this.eventName=_3||\"keydown\";this.bindings=[];if(_2 instanceof Array){for(var i=0,_5=_2.length;i<_5;i++){this.addBinding(_2[i]);}}else{this.addBinding(_2);}this.keyDownDelegate=Ext.EventManager.wrap(this.handleKeyDown,this,true);this.enable();};Ext.KeyMap.prototype={stopEvent:false,addBinding:function(_6){var _7=_6.key,_8=_6.shift,_9=_6.ctrl,_a=_6.alt,fn=_6.fn,_c=_6.scope;if(typeof _7==\"string\"){var ks=[];var _e=_7.toUpperCase();for(var j=0,len=_e.length;j<len;j++){ks.push(_e.charCodeAt(j));}_7=ks;}var _11=_7 instanceof Array;var _12=function(e){if((!_8||e.shiftKey)&&(!_9||e.ctrlKey)&&(!_a||e.altKey)){var k=e.getKey();if(_11){for(var i=0,len=_7.length;i<len;i++){if(_7[i]==k){if(this.stopEvent){e.stopEvent();}fn.call(_c||window,k,e);return;}}}else{if(k==_7){if(this.stopEvent){e.stopEvent();}fn.call(_c||window,k,e);}}}};this.bindings.push(_12);},handleKeyDown:function(e){if(this.enabled){var b=this.bindings;for(var i=0,len=b.length;i<len;i++){b[i].call(this,e);}}},isEnabled:function(){return this.enabled;},enable:function(){if(!this.enabled){this.el.on(this.eventName,this.keyDownDelegate);this.enabled=true;}},disable:function(){if(this.enabled){this.el.removeListener(this.eventName,this.keyDownDelegate);this.enabled=false;}}};\r\n\r\n\r\n\r\nExt.util.TextMetrics=function(){var _1;return {measure:function(el,_3,_4){if(!_1){_1=Ext.util.TextMetrics.Instance(el,_4);}_1.bind(el);_1.setFixedWidth(_4||\"auto\");return _1.getSize(_3);},createInstance:function(el,_6){return Ext.util.TextMetrics.Instance(el,_6);}};}();Ext.util.TextMetrics.Instance=function(_7,_8){var ml=new Ext.Element(document.createElement(\"div\"));document.body.appendChild(ml.dom);ml.position(\"absolute\");ml.setLeftTop(-1000,-1000);ml.hide();if(_8){mi.setWidth(_8);}var _a={getSize:function(_b){ml.update(_b);var s=ml.getSize();ml.update(\"\");return s;},bind:function(el){ml.setStyle(Ext.fly(el).getStyles(\"font-size\",\"font-style\",\"font-weight\",\"font-family\",\"line-height\"));},setFixedWidth:function(_e){ml.setWidth(_e);},getWidth:function(_f){ml.dom.style.width=\"auto\";return this.getSize(_f).width;},getHeight:function(_10){return this.getSize(_10).height;}};_a.bind(_7);return _a;};Ext.Element.measureText=Ext.util.TextMetrics.measure;\r\n\r\n\r\n\r\n(function(){var _1=Ext.EventManager;var _2=Ext.lib.Dom;Ext.dd.DragDrop=function(id,_4,_5){if(id){this.init(id,_4,_5);}};Ext.dd.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,hasOuterHandles:false,b4StartDrag:function(x,y){},startDrag:function(x,y){},b4Drag:function(e){},onDrag:function(e){},onDragEnter:function(e,id){},b4DragOver:function(e){},onDragOver:function(e,id){},b4DragOut:function(e){},onDragOut:function(e,id){},b4DragDrop:function(e){},onDragDrop:function(e,id){},onInvalidDrop:function(e){},b4EndDrag:function(e){},endDrag:function(e){},b4MouseDown:function(e){},onMouseDown:function(e){},onMouseUp:function(e){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(_1d,pad,_1f){if(typeof pad==\"number\"){pad={left:pad,right:pad,top:pad,bottom:pad};}pad=pad||this.defaultPadding;var b=Ext.get(this.getEl()).getBox();var ce=Ext.get(_1d);var s=ce.getScroll();var c,cd=ce.dom;if(cd==document.body){c={x:s.left,y:s.top,width:Ext.lib.Dom.getViewWidth(),height:Ext.lib.Dom.getViewHeight()};}else{xy=ce.getXY();c={x:xy[0]+s.left,y:xy[1]+s.top,width:cd.clientWidth,height:cd.clientHeight};}var _25=b.y-c.y;var _26=b.x-c.x;this.resetConstraints();this.setXConstraint(_26-(pad.left||0),c.width-_26-b.width-(pad.right||0));this.setYConstraint(_25-(pad.top||0),c.height-_25-b.height-(pad.bottom||0));},getEl:function(){if(!this._domRef){this._domRef=Ext.getDom(this.id);}return this._domRef;},getDragEl:function(){return Ext.getDom(this.dragElId);},init:function(id,_28,_29){this.initTarget(id,_28,_29);_1.on(this.id,\"mousedown\",this.handleMouseDown,this);},initTarget:function(id,_2b,_2c){this.config=_2c||{};this.DDM=Ext.dd.DDM;this.groups={};if(typeof id!==\"string\"){id=Ext.id(id);}this.id=id;this.addToGroup((_2b)?_2b:\"default\");this.handleElId=id;this.setDragElId(id);this.invalidHandleTypes={A:\"A\"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();this.handleOnAvailable();},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false);},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable();},setPadding:function(_2d,_2e,_2f,_30){if(!_2e&&0!==_2e){this.padding=[_2d,_2d,_2d,_2d];}else{if(!_2f&&0!==_2f){this.padding=[_2d,_2e,_2d,_2e];}else{this.padding=[_2d,_2e,_2f,_30];}}},setInitPosition:function(_31,_32){var el=this.getEl();if(!this.DDM.verifyEl(el)){return;}var dx=_31||0;var dy=_32||0;var p=_2.getXY(el);this.initPageX=p[0]-dx;this.initPageY=p[1]-dy;this.lastPageX=p[0];this.lastPageY=p[1];this.setStartPosition(p);},setStartPosition:function(pos){var p=pos||_2.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=p[0];this.startPageY=p[1];},addToGroup:function(_39){this.groups[_39]=true;this.DDM.regDragDrop(this,_39);},removeFromGroup:function(_3a){if(this.groups[_3a]){delete this.groups[_3a];}this.DDM.removeDDFromGroup(this,_3a);},setDragElId:function(id){this.dragElId=id;},setHandleElId:function(id){if(typeof id!==\"string\"){id=Ext.id(id);}this.handleElId=id;this.DDM.regHandle(this.id,id);},setOuterHandleElId:function(id){if(typeof id!==\"string\"){id=Ext.id(id);}_1.on(id,\"mousedown\",this.handleMouseDown,this);this.setHandleElId(id);this.hasOuterHandles=true;},unreg:function(){_1.un(this.id,\"mousedown\",this.handleMouseDown);this._domRef=null;this.DDM._remove(this);},isLocked:function(){return (this.DDM.isLocked()||this.locked);},handleMouseDown:function(e,oDD){if(this.primaryButtonOnly&&e.button!=0){return;}if(this.isLocked()){return;}this.DDM.refreshCache(this.groups);var pt=new Ext.lib.Point(Ext.lib.Event.getPageX(e),Ext.lib.Event.getPageY(e));if(!this.hasOuterHandles&&!this.DDM.isOverTarget(pt,this)){}else{if(this.clickValidator(e)){this.setStartPosition();this.b4MouseDown(e);this.onMouseDown(e);this.DDM.handleMouseDown(e,this);this.DDM.stopEvent(e);}else{}}},clickValidator:function(e){var _42=Ext.lib.Event.getTarget(e);return (this.isValidHandleChild(_42)&&(this.id==this.handleElId||this.DDM.handleWasClicked(_42,this.id)));},addInvalidHandleType:function(_43){var _44=_43.toUpperCase();this.invalidHandleTypes[_44]=_44;},addInvalidHandleId:function(id){if(typeof id!==\"string\"){id=Ext.id(id);}this.invalidHandleIds[id]=id;},addInvalidHandleClass:function(_46){this.invalidHandleClasses.push(_46);},removeInvalidHandleType:function(_47){var _48=_47.toUpperCase();delete this.invalidHandleTypes[_48];},removeInvalidHandleId:function(id){if(typeof id!==\"string\"){id=Ext.id(id);}delete this.invalidHandleIds[id];},removeInvalidHandleClass:function(_4a){for(var i=0,len=this.invalidHandleClasses.length;i<len;++i){if(this.invalidHandleClasses[i]==_4a){delete this.invalidHandleClasses[i];}}},isValidHandleChild:function(_4d){var _4e=true;var _4f;try{_4f=_4d.nodeName.toUpperCase();}catch(e){_4f=_4d.nodeName;}_4e=_4e&&!this.invalidHandleTypes[_4f];_4e=_4e&&!this.invalidHandleIds[_4d.id];for(var i=0,len=this.invalidHandleClasses.length;_4e&&i<len;++i){_4e=!_2.hasClass(_4d,this.invalidHandleClasses[i]);}return _4e;},setXTicks:function(_52,_53){this.xTicks=[];this.xTickSize=_53;var _54={};for(var i=this.initPageX;i>=this.minX;i=i-_53){if(!_54[i]){this.xTicks[this.xTicks.length]=i;_54[i]=true;}}for(i=this.initPageX;i<=this.maxX;i=i+_53){if(!_54[i]){this.xTicks[this.xTicks.length]=i;_54[i]=true;}}this.xTicks.sort(this.DDM.numericSort);},setYTicks:function(_56,_57){this.yTicks=[];this.yTickSize=_57;var _58={};for(var i=this.initPageY;i>=this.minY;i=i-_57){if(!_58[i]){this.yTicks[this.yTicks.length]=i;_58[i]=true;}}for(i=this.initPageY;i<=this.maxY;i=i+_57){if(!_58[i]){this.yTicks[this.yTicks.length]=i;_58[i]=true;}}this.yTicks.sort(this.DDM.numericSort);},setXConstraint:function(_5a,_5b,_5c){this.leftConstraint=_5a;this.rightConstraint=_5b;this.minX=this.initPageX-_5a;this.maxX=this.initPageX+_5b;if(_5c){this.setXTicks(this.initPageX,_5c);}this.constrainX=true;},clearConstraints:function(){this.constrainX=false;this.constrainY=false;this.clearTicks();},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0;},setYConstraint:function(iUp,_5e,_5f){this.topConstraint=iUp;this.bottomConstraint=_5e;this.minY=this.initPageY-iUp;this.maxY=this.initPageY+_5e;if(_5f){this.setYTicks(this.initPageY,_5f);}this.constrainY=true;},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var dx=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var dy=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(dx,dy);}else{this.setInitPosition();}if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize);}if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize);}},getTick:function(val,_63){if(!_63){return val;}else{if(_63[0]>=val){return _63[0];}else{for(var i=0,len=_63.length;i<len;++i){var _66=i+1;if(_63[_66]&&_63[_66]>=val){var _67=val-_63[i];var _68=_63[_66]-val;return (_68>_67)?_63[i]:_63[_66];}}return _63[_63.length-1];}}},toString:function(){return (\"DragDrop \"+this.id);}};})();if(!Ext.dd.DragDropMgr){Ext.dd.DragDropMgr=function(){var _69=Ext.EventManager;return {ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:true,stopPropagation:true,initalized:false,locked:false,init:function(){this.initialized=true;},POINT:0,INTERSECT:1,mode:0,_execOnAll:function(_6a,_6b){for(var i in this.ids){for(var j in this.ids[i]){var oDD=this.ids[i][j];if(!this.isTypeOfDD(oDD)){continue;}oDD[_6a].apply(oDD,_6b);}}},_onLoad:function(){this.init();_69.on(document,\"mouseup\",this.handleMouseUp,this,true);_69.on(window,\"unload\",this._onUnload,this,true);_69.on(window,\"resize\",this._onResize,this,true);},_onResize:function(e){this._execOnAll(\"resetConstraints\",[]);},lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isLocked:function(){return this.locked;},locationCache:{},useCache:true,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:false,clickTimeout:null,startX:0,startY:0,regDragDrop:function(oDD,_71){if(!this.initialized){this.init();}if(!this.ids[_71]){this.ids[_71]={};}this.ids[_71][oDD.id]=oDD;},removeDDFromGroup:function(oDD,_73){if(!this.ids[_73]){this.ids[_73]={};}var obj=this.ids[_73];if(obj&&obj[oDD.id]){delete obj[oDD.id];}},_remove:function(oDD){for(var g in oDD.groups){if(g&&this.ids[g][oDD.id]){delete this.ids[g][oDD.id];}}delete this.handleIds[oDD.id];},regHandle:function(_77,_78){if(!this.handleIds[_77]){this.handleIds[_77]={};}this.handleIds[_77][_78]=_78;},isDragDrop:function(id){return (this.getDDById(id))?true:false;},getRelated:function(_7a,_7b){var _7c=[];for(var i in _7a.groups){for(j in this.ids[i]){var dd=this.ids[i][j];if(!this.isTypeOfDD(dd)){continue;}if(!_7b||dd.isTarget){_7c[_7c.length]=dd;}}}return _7c;},isLegalTarget:function(oDD,_80){var _81=this.getRelated(oDD,true);for(var i=0,len=_81.length;i<len;++i){if(_81[i].id==_80.id){return true;}}return false;},isTypeOfDD:function(oDD){return (oDD&&oDD.__ygDragDrop);},isHandle:function(_85,_86){return (this.handleIds[_85]&&this.handleIds[_85][_86]);},getDDById:function(id){for(var i in this.ids){if(this.ids[i][id]){return this.ids[i][id];}}return null;},handleMouseDown:function(e,oDD){_69.on(document,\"mousemove\",this.handleMouseMove,this,true);this.currentTarget=Ext.lib.Event.getTarget(e);this.dragCurrent=oDD;var el=oDD.getEl();this.startX=Ext.lib.Event.getPageX(e);this.startY=Ext.lib.Event.getPageY(e);this.deltaX=this.startX-el.offsetLeft;this.deltaY=this.startY-el.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var DDM=Ext.dd.DDM;DDM.startDrag(DDM.startX,DDM.startY);},this.clickTimeThresh);},startDrag:function(x,y){clearTimeout(this.clickTimeout);if(this.dragCurrent){this.dragCurrent.b4StartDrag(x,y);this.dragCurrent.startDrag(x,y);}this.dragThreshMet=true;},handleMouseUp:function(e){_69.un(document,\"mousemove\",this.handleMouseMove,this,true);if(!this.dragCurrent){return true;}clearTimeout(this.clickTimeout);if(this.dragThreshMet){this.fireEvents(e,true);}else{}this.stopDrag(e);this.stopEvent(e);},stopEvent:function(e){if(this.stopPropagation){e.stopPropagation();}if(this.preventDefault){e.preventDefault();}},stopDrag:function(e){if(this.dragCurrent){if(this.dragThreshMet){this.dragCurrent.b4EndDrag(e);this.dragCurrent.endDrag(e);}this.dragCurrent.onMouseUp(e);}this.dragCurrent=null;this.dragOvers={};},handleMouseMove:function(e){if(!this.dragCurrent){return true;}if(Ext.isIE&&(e.button!==0&&e.button!==1&&e.button!==2)){this.stopEvent(e);return this.handleMouseUp(e);}if(!this.dragThreshMet){var _93=Math.abs(this.startX-Ext.lib.Event.getPageX(e));var _94=Math.abs(this.startY-Ext.lib.Event.getPageY(e));if(_93>this.clickPixelThresh||_94>this.clickPixelThresh){this.startDrag(this.startX,this.startY);}}if(this.dragThreshMet){this.dragCurrent.b4Drag(e);this.dragCurrent.onDrag(e);if(!this.dragCurrent.moveOnly){this.fireEvents(e,false);}}this.stopEvent(e);return true;},fireEvents:function(e,_96){var dc=this.dragCurrent;if(!dc||dc.isLocked()){return;}var x=Ext.lib.Event.getPageX(e);var y=Ext.lib.Event.getPageY(e);var pt=new Ext.lib.Point(x,y);var _9b=[];var _9c=[];var _9d=[];var _9e=[];var _9f=[];for(var i in this.dragOvers){var ddo=this.dragOvers[i];if(!this.isTypeOfDD(ddo)){continue;}if(!this.isOverTarget(pt,ddo,this.mode)){_9c.push(ddo);}_9b[i]=true;delete this.dragOvers[i];}for(var _a2 in dc.groups){if(\"string\"!=typeof _a2){continue;}for(i in this.ids[_a2]){var oDD=this.ids[_a2][i];if(!this.isTypeOfDD(oDD)){continue;}if(oDD.isTarget&&!oDD.isLocked()&&oDD!=dc){if(this.isOverTarget(pt,oDD,this.mode)){if(_96){_9e.push(oDD);}else{if(!_9b[oDD.id]){_9f.push(oDD);}else{_9d.push(oDD);}this.dragOvers[oDD.id]=oDD;}}}}}if(this.mode){if(_9c.length){dc.b4DragOut(e,_9c);dc.onDragOut(e,_9c);}if(_9f.length){dc.onDragEnter(e,_9f);}if(_9d.length){dc.b4DragOver(e,_9d);dc.onDragOver(e,_9d);}if(_9e.length){dc.b4DragDrop(e,_9e);dc.onDragDrop(e,_9e);}}else{var len=0;for(i=0,len=_9c.length;i<len;++i){dc.b4DragOut(e,_9c[i].id);dc.onDragOut(e,_9c[i].id);}for(i=0,len=_9f.length;i<len;++i){dc.onDragEnter(e,_9f[i].id);}for(i=0,len=_9d.length;i<len;++i){dc.b4DragOver(e,_9d[i].id);dc.onDragOver(e,_9d[i].id);}for(i=0,len=_9e.length;i<len;++i){dc.b4DragDrop(e,_9e[i].id);dc.onDragDrop(e,_9e[i].id);}}if(_96&&!_9e.length){dc.onInvalidDrop(e);}},getBestMatch:function(dds){var _a6=null;var len=dds.length;if(len==1){_a6=dds[0];}else{for(var i=0;i<len;++i){var dd=dds[i];if(dd.cursorIsOver){_a6=dd;break;}else{if(!_a6||_a6.overlap.getArea()<dd.overlap.getArea()){_a6=dd;}}}}return _a6;},refreshCache:function(_aa){for(var _ab in _aa){if(\"string\"!=typeof _ab){continue;}for(var i in this.ids[_ab]){var oDD=this.ids[_ab][i];if(this.isTypeOfDD(oDD)){var loc=this.getLocation(oDD);if(loc){this.locationCache[oDD.id]=loc;}else{delete this.locationCache[oDD.id];}}}}},verifyEl:function(el){try{if(el){var _b0=el.offsetParent;if(_b0){return true;}}}catch(e){}return false;},getLocation:function(oDD){if(!this.isTypeOfDD(oDD)){return null;}var el=oDD.getEl(),pos,x1,x2,y1,y2,t,r,b,l;try{pos=Ext.lib.Dom.getXY(el);}catch(e){}if(!pos){return null;}x1=pos[0];x2=x1+el.offsetWidth;y1=pos[1];y2=y1+el.offsetHeight;t=y1-oDD.padding[0];r=x2+oDD.padding[1];b=y2+oDD.padding[2];l=x1-oDD.padding[3];return new Ext.lib.Region(t,r,b,l);},isOverTarget:function(pt,_bd,_be){var loc=this.locationCache[_bd.id];if(!loc||!this.useCache){loc=this.getLocation(_bd);this.locationCache[_bd.id]=loc;}if(!loc){return false;}_bd.cursorIsOver=loc.contains(pt);var dc=this.dragCurrent;if(!dc||!dc.getTargetCoord||(!_be&&!dc.constrainX&&!dc.constrainY)){return _bd.cursorIsOver;}_bd.overlap=null;var pos=dc.getTargetCoord(pt.x,pt.y);var el=dc.getDragEl();var _c3=new Ext.lib.Region(pos.y,pos.x+el.offsetWidth,pos.y+el.offsetHeight,pos.x);var _c4=_c3.intersect(loc);if(_c4){_bd.overlap=_c4;return (_be)?true:_bd.cursorIsOver;}else{return false;}},_onUnload:function(e,me){Ext.dd.DragDropMgr.unregAll();},unregAll:function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null;}this._execOnAll(\"unreg\",[]);for(i in this.elementCache){delete this.elementCache[i];}this.elementCache={};this.ids={};},elementCache:{},getElWrapper:function(id){var _c8=this.elementCache[id];if(!_c8||!_c8.el){_c8=this.elementCache[id]=new this.ElementWrapper(Ext.getDom(id));}return _c8;},getElement:function(id){return Ext.getDom(id);},getCss:function(id){var el=Ext.getDom(id);return (el)?el.style:null;},ElementWrapper:function(el){this.el=el||null;this.id=this.el&&el.id;this.css=this.el&&el.style;},getPosX:function(el){return Ext.lib.Dom.getX(el);},getPosY:function(el){return Ext.lib.Dom.getY(el);},swapNode:function(n1,n2){if(n1.swapNode){n1.swapNode(n2);}else{var p=n2.parentNode;var s=n2.nextSibling;if(s==n1){p.insertBefore(n1,n2);}else{if(n2==n1.nextSibling){p.insertBefore(n2,n1);}else{n1.parentNode.replaceChild(n2,n1);p.insertBefore(n1,s);}}}},getScroll:function(){var t,l,dde=document.documentElement,db=document.body;if(dde&&(dde.scrollTop||dde.scrollLeft)){t=dde.scrollTop;l=dde.scrollLeft;}else{if(db){t=db.scrollTop;l=db.scrollLeft;}else{}}return {top:t,left:l};},getStyle:function(el,_d8){return Ext.fly(el).getStyle(_d8);},getScrollTop:function(){return this.getScroll().top;},getScrollLeft:function(){return this.getScroll().left;},moveToEl:function(_d9,_da){var _db=Ext.lib.Dom.getXY(_da);Ext.lib.Dom.setXY(_d9,_db);},numericSort:function(a,b){return (a-b);},_timeoutCount:0,_addListeners:function(){var DDM=Ext.dd.DDM;if(Ext.lib.Event&&document){DDM._onLoad();}else{if(DDM._timeoutCount>2000){}else{setTimeout(DDM._addListeners,10);if(document&&document.body){DDM._timeoutCount+=1;}}}},handleWasClicked:function(_df,id){if(this.isHandle(id,_df.id)){return true;}else{var p=_df.parentNode;while(p){if(this.isHandle(id,p.id)){return true;}else{p=p.parentNode;}}}return false;}};}();Ext.dd.DDM=Ext.dd.DragDropMgr;Ext.dd.DDM._addListeners();}Ext.dd.DD=function(id,_e3,_e4){if(id){this.init(id,_e3,_e4);}};Ext.extend(Ext.dd.DD,Ext.dd.DragDrop,{scroll:true,autoOffset:function(_e5,_e6){var x=_e5-this.startPageX;var y=_e6-this.startPageY;this.setDelta(x,y);},setDelta:function(_e9,_ea){this.deltaX=_e9;this.deltaY=_ea;},setDragElPos:function(_eb,_ec){var el=this.getDragEl();this.alignElWithMouse(el,_eb,_ec);},alignElWithMouse:function(el,_ef,_f0){var _f1=this.getTargetCoord(_ef,_f0);var fly=el.dom?el:Ext.fly(el);if(!this.deltaSetXY){var _f3=[_f1.x,_f1.y];fly.setXY(_f3);var _f4=fly.getLeft(true);var _f5=fly.getTop(true);this.deltaSetXY=[_f4-_f1.x,_f5-_f1.y];}else{fly.setLeftTop(_f1.x+this.deltaSetXY[0],_f1.y+this.deltaSetXY[1]);}this.cachePosition(_f1.x,_f1.y);this.autoScroll(_f1.x,_f1.y,el.offsetHeight,el.offsetWidth);return _f1;},cachePosition:function(_f6,_f7){if(_f6){this.lastPageX=_f6;this.lastPageY=_f7;}else{var _f8=Ext.lib.Dom.getXY(this.getEl());this.lastPageX=_f8[0];this.lastPageY=_f8[1];}},autoScroll:function(x,y,h,w){if(this.scroll){var _fd=Ext.lib.Dom.getViewWidth();var _fe=Ext.lib.Dom.getViewHeight();var st=this.DDM.getScrollTop();var sl=this.DDM.getScrollLeft();var bot=h+y;var _102=w+x;var _103=(_fd+st-y-this.deltaY);var _104=(_fe+sl-x-this.deltaX);var _105=40;var _106=(document.all)?80:30;if(bot>_fd&&_103<_105){window.scrollTo(sl,st+_106);}if(y<st&&st>0&&y-st<_105){window.scrollTo(sl,st-_106);}if(_102>_fe&&_104<_105){window.scrollTo(sl+_106,st);}if(x<sl&&sl>0&&x-sl<_105){window.scrollTo(sl-_106,st);}}},getTargetCoord:function(_107,_108){var x=_107-this.deltaX;var y=_108-this.deltaY;if(this.constrainX){if(x<this.minX){x=this.minX;}if(x>this.maxX){x=this.maxX;}}if(this.constrainY){if(y<this.minY){y=this.minY;}if(y>this.maxY){y=this.maxY;}}x=this.getTick(x,this.xTicks);y=this.getTick(y,this.yTicks);return {x:x,y:y};},applyConfig:function(){Ext.dd.DD.superclass.applyConfig.call(this);this.scroll=(this.config.scroll!==false);},b4MouseDown:function(e){this.autoOffset(Ext.lib.Event.getPageX(e),Ext.lib.Event.getPageY(e));},b4Drag:function(e){this.setDragElPos(Ext.lib.Event.getPageX(e),Ext.lib.Event.getPageY(e));},toString:function(){return (\"DD \"+this.id);}});Ext.dd.DDProxy=function(id,_10e,_10f){if(id){this.init(id,_10e,_10f);this.initFrame();}};Ext.dd.DDProxy.dragElId=\"ygddfdiv\";Ext.extend(Ext.dd.DDProxy,Ext.dd.DD,{resizeFrame:true,centerFrame:false,createFrame:function(){var self=this;var body=document.body;if(!body||!body.firstChild){setTimeout(function(){self.createFrame();},50);return;}var div=this.getDragEl();if(!div){div=document.createElement(\"div\");div.id=this.dragElId;var s=div.style;s.position=\"absolute\";s.visibility=\"hidden\";s.cursor=\"move\";s.border=\"2px solid #aaa\";s.zIndex=999;body.insertBefore(div,body.firstChild);}},initFrame:function(){this.createFrame();},applyConfig:function(){Ext.dd.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId);},showFrame:function(_114,_115){var el=this.getEl();var _117=this.getDragEl();var s=_117.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.height,10)/2));}this.setDragElPos(_114,_115);Ext.fly(_117).show();},_resizeProxy:function(){if(this.resizeFrame){var el=this.getEl();Ext.fly(this.getDragEl()).setSize(el.offsetWidth,el.offsetHeight);}},b4MouseDown:function(e){var x=Ext.lib.Event.getPageX(e);var y=Ext.lib.Event.getPageY(e);this.autoOffset(x,y);this.setDragElPos(x,y);},b4StartDrag:function(x,y){this.showFrame(x,y);},b4EndDrag:function(e){Ext.fly(this.getDragEl()).hide();},endDrag:function(e){var lel=this.getEl();var del=this.getDragEl();del.style.visibility=\"\";this.beforeMove();lel.style.visibility=\"hidden\";Ext.dd.DDM.moveToEl(lel,del);del.style.visibility=\"hidden\";lel.style.visibility=\"\";this.afterDrag();},beforeMove:function(){},afterDrag:function(){},toString:function(){return (\"DDProxy \"+this.id);}});Ext.dd.DDTarget=function(id,_124,_125){if(id){this.initTarget(id,_124,_125);}};Ext.extend(Ext.dd.DDTarget,Ext.dd.DragDrop,{toString:function(){return (\"DDTarget \"+this.id);}});\r\n\r\n\r\n\r\nExt.dd.ScrollManager=function(){var _1=Ext.dd.DragDropMgr;var _2={};var _3=null;var _4={};var _5=function(e){_3=null;_7();};var _8=function(){if(_1.dragCurrent){_1.refreshCache(_1.dragCurrent.groups);}};var _9=function(){if(_1.dragCurrent){var _a=Ext.dd.ScrollManager;if(!_a.animate){if(_4.el.scroll(_4.dir,_a.increment)){_8();}}else{_4.el.scroll(_4.dir,_a.increment,true,_a.animDuration,_8);}}};var _7=function(){if(_4.id){clearInterval(_4.id);}_4.id=0;_4.el=null;_4.dir=\"\";};var _b=function(el,_d){_7();_4.el=el;_4.dir=_d;_4.id=setInterval(_9,Ext.dd.ScrollManager.frequency);};var _e=function(e,_10){if(_10||!_1.dragCurrent){return;}var dds=Ext.dd.ScrollManager;if(!_3||_3!=_1.dragCurrent){_3=_1.dragCurrent;dds.refreshCache();}var xy=Ext.lib.Event.getXY(e);var pt=new Ext.lib.Point(xy[0],xy[1]);for(var id in _2){var el=_2[id],r=el._region;if(r.contains(pt)&&el.isScrollable()){if(r.bottom-pt.y<=dds.thresh){if(_4.el!=el){_b(el,\"down\");}return;}else{if(r.right-pt.x<=dds.thresh){if(_4.el!=el){_b(el,\"left\");}return;}else{if(pt.y-r.top<=dds.thresh){if(_4.el!=el){_b(el,\"up\");}return;}else{if(pt.x-r.left<=dds.thresh){if(_4.el!=el){_b(el,\"right\");}return;}}}}}}_7();};_1.fireEvents=_1.fireEvents.createSequence(_e,_1);_1.stopDrag=_1.stopDrag.createSequence(_5,_1);return {register:function(el){if(el instanceof Array){for(var i=0,len=el.length;i<len;i++){this.register(el[i]);}}else{el=Ext.get(el);_2[el.id]=el;}},unregister:function(el){if(el instanceof Array){for(var i=0,len=el.length;i<len;i++){this.unregister(el[i]);}}else{el=Ext.get(el);delete _2[el.id];}},thresh:25,increment:100,frequency:500,animate:true,animDuration:0.4,refreshCache:function(){for(var id in _2){if(typeof _2[id]==\"object\"){_2[id]._region=_2[id].getRegion();}}}};}();\r\n\r\n\r\n\r\nExt.dd.Registry=function(){var _1={};var _2={};var _3=0;var _4=function(el,_6){if(typeof el==\"string\"){return el;}var id=el.id;if(!id&&_6!==false){id=\"extdd-\"+(++_3);el.id=id;}return id;};return {register:function(el,_9){_9=_9||{};if(typeof el==\"string\"){el=document.getElementById(el);}_9.ddel=el;_1[_4(el)]=_9;if(_9.isHandle!==false){_2[_9.ddel.id]=_9;}if(_9.handles){var hs=_9.handles;for(var i=0,_c=hs.length;i<_c;i++){_2[_4(hs[i])]=_9;}}},unregister:function(el){var id=_4(el,false);var _f=_1[id];if(_f){delete _1[id];if(_f.handles){var hs=_f.handles;for(var i=0,len=hs.length;i<len;i++){delete _2[_4(hs[i],false)];}}}},getHandle:function(id){if(typeof id!=\"string\"){id=id.id;}return _2[id];},getHandleFromEvent:function(e){var t=Ext.lib.Event.getTarget(e);return t?_2[t.id]:null;},getTarget:function(id){if(typeof id!=\"string\"){id=id.id;}return _1[id];},getTargetFromEvent:function(e){var t=Ext.lib.Event.getTarget(e);return t?_1[t.id]||_2[t.id]:null;}};}();\r\n\r\n\r\n\r\nExt.dd.StatusProxy=function(_1){Ext.apply(this,_1);this.id=this.id||Ext.id();this.el=new Ext.Layer({dh:{id:this.id,tag:\"div\",cls:\"x-dd-drag-proxy \"+this.dropNotAllowed,children:[{tag:\"div\",cls:\"x-dd-drop-icon\"},{tag:\"div\",cls:\"x-dd-drag-ghost\"}]},shadow:!_1||_1.shadow!==false});this.ghost=Ext.get(this.el.dom.childNodes[1]);this.dropStatus=this.dropNotAllowed;};Ext.dd.StatusProxy.prototype={dropAllowed:\"x-dd-drop-ok\",dropNotAllowed:\"x-dd-drop-nodrop\",setStatus:function(_2){_2=_2||this.dropNotAllowed;if(this.dropStatus!=_2){this.el.replaceClass(this.dropStatus,_2);this.dropStatus=_2;}},reset:function(_3){this.el.dom.className=\"x-dd-drag-proxy \"+this.dropNotAllowed;this.dropStatus=this.dropNotAllowed;if(_3){this.ghost.update(\"\");}},update:function(_4){if(typeof _4==\"string\"){this.ghost.update(_4);}else{this.ghost.update(\"\");_4.style.margin=\"0\";this.ghost.dom.appendChild(_4);}},getEl:function(){return this.el;},getGhost:function(){return this.ghost;},hide:function(_5){this.el.hide();if(_5){this.reset(true);}},stop:function(){if(this.anim&&this.anim.isAnimated&&this.anim.isAnimated()){this.anim.stop();}},show:function(){this.el.show();},sync:function(){this.el.sync();},repair:function(xy,_7,_8){this.callback=_7;this.scope=_8;if(xy&&this.animRepair!==false){this.el.addClass(\"x-dd-drag-repair\");this.el.hideUnders(true);this.anim=this.el.shift({duration:this.repairDuration||0.5,easing:\"easeOut\",xy:xy,stopFx:true,callback:this.afterRepair,scope:this});}else{this.afterRepair();}},afterRepair:function(){this.hide(true);if(typeof this.callback==\"function\"){this.callback.call(this.scope||this);}this.callback==null;this.scope==null;}};\r\n\r\n\r\n\r\nExt.dd.DragSource=function(el,_2){this.el=Ext.get(el);this.dragData={};Ext.apply(this,_2);if(!this.proxy){this.proxy=new Ext.dd.StatusProxy();}this.el.on(\"mouseup\",this.handleMouseUp);Ext.dd.DragSource.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:false,isTarget:false,scroll:this.scroll===true});this.dragging=false;};Ext.extend(Ext.dd.DragSource,Ext.dd.DDProxy,{dropAllowed:\"x-dd-drop-ok\",dropNotAllowed:\"x-dd-drop-nodrop\",getDragData:function(e){return this.dragData;},onDragEnter:function(e,id){var _6=Ext.dd.DragDropMgr.getDDById(id);this.cachedTarget=_6;if(this.beforeDragEnter(_6,e,id)!==false){if(_6.isNotifyTarget){var _7=_6.notifyEnter(this,e,this.dragData);this.proxy.setStatus(_7);}else{this.proxy.setStatus(this.dropAllowed);}if(this.afterDragEnter){this.afterDragEnter(_6,e,id);}}},beforeDragEnter:function(_8,e,id){return true;},alignElWithMouse:function(){Ext.dd.DragSource.superclass.alignElWithMouse.apply(this,arguments);this.proxy.sync();},onDragOver:function(e,id){var _d=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(id);if(this.beforeDragOver(_d,e,id)!==false){if(_d.isNotifyTarget){var _e=_d.notifyOver(this,e,this.dragData);this.proxy.setStatus(_e);}if(this.afterDragOver){this.afterDragOver(_d,e,id);}}},beforeDragOver:function(_f,e,id){return true;},onDragOut:function(e,id){var _14=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(id);if(this.beforeDragOut(_14,e,id)!==false){if(_14.isNotifyTarget){_14.notifyOut(this,e,this.dragData);}this.proxy.reset();if(this.afterDragOut){this.afterDragOut(_14,e,id);}}this.cachedTarget=null;},beforeDragOut:function(_15,e,id){return true;},onDragDrop:function(e,id){var _1a=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(id);if(this.beforeDragDrop(_1a,e,id)!==false){if(_1a.isNotifyTarget){if(_1a.notifyDrop(this,e,this.dragData)){this.onValidDrop(_1a,e,id);}else{this.onInvalidDrop(_1a,e,id);}}else{this.onValidDrop(_1a,e,id);}if(this.afterDragDrop){this.afterDragDrop(_1a,e,id);}}},beforeDragDrop:function(_1b,e,id){return true;},onValidDrop:function(_1e,e,id){this.hideProxy();},getRepairXY:function(e,_22){return this.el.getXY();},onInvalidDrop:function(_23,e,id){this.beforeInvalidDrop(_23,e,id);if(this.cachedTarget){if(this.cachedTarget.isNotifyTarget){this.cachedTarget.notifyOut(this,e,this.dragData);}this.cacheTarget=null;}this.proxy.repair(this.getRepairXY(e,this.dragData),this.afterRepair,this);if(this.afterInvalidDrop){this.afterInvalidDrop(e,id);}},afterRepair:function(){if(Ext.enableFx){this.el.highlight(this.hlColor||\"c3daf9\");}this.dragging=false;},beforeInvalidDrop:function(_26,e,id){return true;},handleMouseDown:function(e){if(this.dragging){return;}if(Ext.QuickTips){Ext.QuickTips.disable();}var _2a=this.getDragData(e);if(_2a&&this.onBeforeDrag(_2a,e)!==false){this.dragData=_2a;this.proxy.stop();Ext.dd.DragSource.superclass.handleMouseDown.apply(this,arguments);}},handleMouseUp:function(e){if(Ext.QuickTips){Ext.QuickTips.enable();}},onBeforeDrag:function(_2c,e){return true;},onStartDrag:Ext.emptyFn,startDrag:function(x,y){this.proxy.reset();this.dragging=true;this.proxy.update(\"\");this.onInitDrag(x,y);this.proxy.show();},onInitDrag:function(x,y){var _32=this.el.dom.cloneNode(true);_32.id=Ext.id();this.proxy.update(_32);this.onStartDrag(x,y);return true;},getProxy:function(){return this.proxy;},hideProxy:function(){this.proxy.hide();this.proxy.reset(true);this.dragging=false;},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups);},b4EndDrag:function(e){},endDrag:function(e){this.onEndDrag(this.dragData,e);},onEndDrag:function(_35,e){},autoOffset:function(x,y){this.setDelta(-12,-20);}});\r\n\r\n\r\n\r\nExt.dd.DropTarget=function(el,_2){this.el=Ext.get(el);Ext.apply(this,_2);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el);}Ext.dd.DropTarget.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{isTarget:true});};Ext.extend(Ext.dd.DropTarget,Ext.dd.DDTarget,{dropAllowed:\"x-dd-drop-ok\",dropNotAllowed:\"x-dd-drop-nodrop\",isTarget:true,isNotifyTarget:true,notifyEnter:function(dd,e,_5){if(this.overClass){this.el.addClass(this.overClass);}return this.dropAllowed;},notifyOver:function(dd,e,_8){return this.dropAllowed;},notifyOut:function(dd,e,_b){if(this.overClass){this.el.removeClass(this.overClass);}},notifyDrop:function(dd,e,_e){return false;}});\r\n\r\n\r\n\r\nExt.dd.DragZone=function(el,_2){Ext.dd.DragZone.superclass.constructor.call(this,el,_2);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el);}};Ext.extend(Ext.dd.DragZone,Ext.dd.DragSource,{getDragData:function(e){return Ext.dd.Registry.getHandleFromEvent(e);},onInitDrag:function(x,y){this.proxy.update(this.dragData.ddel.cloneNode(true));this.onStartDrag(x,y);return true;},afterRepair:function(){if(Ext.enableFx){Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||\"c3daf9\");}this.dragging=false;},getRepairXY:function(e){return Ext.Element.fly(this.dragData.ddel).getXY();}});\r\n\r\n\r\n\r\nExt.dd.DropZone=function(el,_2){Ext.dd.DropZone.superclass.constructor.call(this,el,_2);};Ext.extend(Ext.dd.DropZone,Ext.dd.DropTarget,{getTargetFromEvent:function(e){return Ext.dd.Registry.getTargetFromEvent(e);},onNodeEnter:function(n,dd,e,_7){},onNodeOver:function(n,dd,e,_b){return this.dropAllowed;},onNodeOut:function(n,dd,e,_f){},onNodeDrop:function(n,dd,e,_13){return false;},onContainerOver:function(dd,e,_16){return this.dropNotAllowed;},onContainerDrop:function(dd,e,_19){return false;},notifyEnter:function(dd,e,_1c){return this.dropNotAllowed;},notifyOver:function(dd,e,_1f){var n=this.getTargetFromEvent(e);if(!n){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,_1f);this.lastOverNode=null;}return this.onContainerOver(dd,e,_1f);}if(this.lastOverNode!=n){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,_1f);}this.onNodeEnter(n,dd,e,_1f);this.lastOverNode=n;}return this.onNodeOver(n,dd,e,_1f);},notifyOut:function(dd,e,_23){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,_23);this.lastOverNode=null;}},notifyDrop:function(dd,e,_26){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,_26);this.lastOverNode=null;}var n=this.getTargetFromEvent(e);return n?this.onNodeDrop(n,dd,e,_26):this.onContainerDrop(dd,e,_26);},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups);}});\r\n\r\n\r\n\r\nExt.data.SortTypes={none:function(s){return s;},stripTagsRE:/<\\/?[^>]+>/gi,asText:function(s){return String(s).replace(this.stripTagsRE,\"\");},asUCText:function(s){return String(s).toUpperCase().replace(this.stripTagsRE,\"\");},asUCString:function(s){return String(s).toUpperCase();},asDate:function(s){if(!s){return 0;}if(s instanceof Date){return s.getTime();}return Date.parse(String(s));},asFloat:function(s){var _7=parseFloat(String(s).replace(/,/g,\"\"));if(isNaN(_7)){_7=0;}return _7;},asInt:function(s){var _9=parseInt(String(s).replace(/,/g,\"\"));if(isNaN(_9)){_9=0;}return _9;}};\r\n\r\n\r\n\r\nExt.data.Record=function(_1,id){this.id=(id||id===0)?id:++Ext.data.Record.AUTO_ID;this.data=_1;};Ext.data.Record.create=function(o){var f=function(){f.superclass.constructor.apply(this,arguments);};Ext.extend(f,Ext.data.Record);var p=f.prototype;p.fields=new Ext.util.MixedCollection(false,function(_6){return _6.name;});for(var i=0,_8=o.length;i<_8;i++){p.fields.add(new Ext.data.Field(o[i]));}f.getField=function(_9){return p.fields.get(_9);};return f;};Ext.data.Record.AUTO_ID=1000;Ext.data.Record.EDIT=\"edit\";Ext.data.Record.REJECT=\"reject\";Ext.data.Record.COMMIT=\"commit\";Ext.data.Record.prototype={dirty:false,editing:false,error:null,modified:null,join:function(_a){this.store=_a;},set:function(_b,_c){if(this.data[_b]==_c){return;}this.dirty=true;if(!this.modified){this.modified={};}if(typeof this.modified[_b]==\"undefined\"){this.modified[_b]=this.data[_b];}this.data[_b]=_c;if(!this.editing){this.store.afterEdit(this);}},get:function(_d){return this.data[_d];},beginEdit:function(){this.editing=true;this.modified={};},cancelEdit:function(){this.editing=false;delete this.modified;},endEdit:function(){this.editing=false;if(this.dirty&&this.store){this.store.afterEdit(this);}},reject:function(){var m=this.modified;for(var n in m){if(typeof m[n]!=\"function\"){this.data[n]=m[n];}}this.dirty=false;delete this.modified;this.editing=false;if(this.store){this.store.afterReject(this);}},commit:function(){this.dirty=false;delete this.modified;this.editing=false;if(this.store){this.store.afterCommit(this);}},hasError:function(){return this.error!=null;},clearError:function(){this.error=null;}};\r\n\r\n\r\n\r\nExt.data.Store=function(_1){this.data=new Ext.util.MixedCollection(false);this.data.getKey=function(o){return o.id;};this.baseParams={};this.paramNames={\"start\":\"start\",\"limit\":\"limit\",\"sort\":\"sort\",\"dir\":\"dir\"};Ext.apply(this,_1);if(this.reader&&!this.recordType){this.recordType=this.reader.recordType;}this.fields=this.recordType.prototype.fields;this.modified=[];this.addEvents({datachanged:true,add:true,remove:true,update:true,clear:true,beforeload:true,load:true,loadexception:true});if(this.proxy){this.relayEvents(this.proxy,[\"loadexception\"]);}this.sortToggle={};Ext.data.Store.superclass.constructor.call(this);};Ext.extend(Ext.data.Store,Ext.util.Observable,{remoteSort:false,lastOptions:null,add:function(_3){_3=[].concat(_3);for(var i=0,_5=_3.length;i<_5;i++){_3[i].join(this);}var _6=this.data.length;this.data.addAll(_3);this.fireEvent(\"add\",this,_3,_6);},remove:function(_7){var _8=this.data.indexOf(_7);this.data.removeAt(_8);this.fireEvent(\"remove\",this,_7,_8);},removeAll:function(){this.data.clear();this.fireEvent(\"clear\",this);},insert:function(_9,_a){_a=[].concat(_a);for(var i=0,_c=_a.length;i<_c;i++){this.data.insert(_9,_a[i]);_a[i].join(this);}this.fireEvent(\"add\",this,_a,_9);},indexOf:function(_d){return this.data.indexOf(_d);},indexOfId:function(id){return this.data.indexOfKey(id);},getById:function(id){return this.data.key(id);},getAt:function(_10){return this.data.itemAt(_10);},getRange:function(_11,end){return this.data.getRange(_11,end);},storeOptions:function(o){o=Ext.apply({},o);delete o.callback;delete o.scope;this.lastOptions=o;},load:function(_14){_14=_14||{};if(this.fireEvent(\"beforeload\",this,_14)!==false){this.storeOptions(_14);var p=Ext.apply(_14.params||{},this.baseParams);if(this.sortInfo&&this.remoteSort){var pn=this.paramNames;p[pn[\"sort\"]]=this.sortInfo.field;p[pn[\"dir\"]]=this.sortInfo.direction;}this.proxy.load(p,this.reader,this.loadRecords,this,_14);}},reload:function(_17){this.load(Ext.applyIf(_17||{},this.lastOptions));},loadRecords:function(o,_19,_1a){if(!o||_1a===false){if(_1a!==false){this.fireEvent(\"load\",this,[],_19);}if(_19.callback){_19.callback.call(_19.scope||this,[],_19,false);}return;}var r=o.records,t=o.totalRecords||r.length;for(var i=0,len=r.length;i<len;i++){r[i].join(this);}if(!_19||_19.add!==true){this.data.clear();this.data.addAll(r);this.totalLength=t;this.applySort();this.fireEvent(\"datachanged\",this);}else{this.totalLength=Math.max(t,this.data.length+r.length);this.data.addAll(r);}this.fireEvent(\"load\",this,r,_19);if(_19.callback){_19.callback.call(_19.scope||this,r,_19,true);}},loadData:function(o,_20){var r=this.reader.readRecords(o);this.loadRecords(r,{add:_20},true);},getCount:function(){return this.data.length||0;},getTotalCount:function(){return this.totalLength||0;},getSortState:function(){return this.sortInfo;},applySort:function(){if(this.sortInfo&&!this.remoteSort){var s=this.sortInfo,f=s.field;var st=this.fields.get(f).sortType;var fn=function(r1,r2){var v1=st(r1.data[f]),v2=st(r2.data[f]);return v1>v2?1:(v1<v2?-1:0);};this.data.sort(s.direction,fn);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(s.direction,fn);}}},setDefaultSort:function(_2a,dir){this.sortInfo={field:_2a,direction:dir?dir.toUpperCase():\"ASC\"};},sort:function(_2c,dir){var f=this.fields.get(_2c);if(!dir){if(this.sortInfo&&this.sortInfo.field==f.name){dir=(this.sortToggle[f.name]||\"ASC\").toggle(\"ASC\",\"DESC\");}else{dir=f.sortDir;}}this.sortToggle[f.name]=dir;this.sortInfo={field:f.name,direction:dir};if(!this.remoteSort){this.applySort();this.fireEvent(\"datachanged\",this);}else{this.load(this.lastOptions);}},each:function(fn,_30){this.data.each(fn,_30);},getModifiedRecords:function(){return this.modified;},filter:function(_31,_32){if(!_32.exec){_32=String(_32);if(_32.length==0){return this.clearFilter();}_32=new RegExp(\"^\"+Ext.escapeRe(_32),\"i\");}this.filterBy(function(r){return _32.test(r.data[_31]);});},filterBy:function(fn,_35){var _36=this.snapshot||this.data;this.snapshot=_36;this.data=_36.filterBy(fn,_35);this.fireEvent(\"datachanged\",this);},clearFilter:function(_37){if(this.snapshot&&this.snapshot!=this.data){this.data=this.snapshot;delete this.snapshot;if(_37!==true){this.fireEvent(\"datachanged\",this);}}},afterEdit:function(_38){if(this.modified.indexOf(_38)==-1){this.modified.push(_38);}this.fireEvent(\"update\",this,_38,Ext.data.Record.EDIT);},afterReject:function(_39){this.modified.remove(_39);this.fireEvent(\"update\",this,_39,Ext.data.Record.REJECT);},afterCommit:function(_3a){this.modified.remove(_3a);this.fireEvent(\"update\",this,_3a,Ext.data.Record.COMMIT);},commitChanges:function(){var m=this.modified.slice(0);this.modified=[];for(var i=0,len=m.length;i<len;i++){m[i].commit();}},rejectChanges:function(){var m=this.modified.slice(0);this.modified=[];for(var i=0,len=m.length;i<len;i++){m[i].reject();}}});\r\n\r\n\r\n\r\nExt.data.Connection=function(_1){Ext.apply(this,_1);this.addEvents({\"beforerequest\":true,\"requestcomplete\":true,\"requestexception\":true});Ext.data.Connection.superclass.constructor.call(this);};Ext.extend(Ext.data.Connection,Ext.util.Observable,{timeout:30000,request:function(_2){if(this.fireEvent(\"beforerequest\",this,_2)!==false){var p=_2.params;if(typeof p==\"object\"){p=Ext.urlEncode(Ext.apply(_2.params,this.extraParams));}var cb={success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{options:_2},timeout:this.timeout};var _5=_2.method||this.method||(p?\"POST\":\"GET\");var _6=_2.url||this.url;if(this.autoAbort!==false){this.abort();}if(_5==\"GET\"&&p){_6+=(_6.indexOf(\"?\")!=-1?\"&\":\"?\")+p;p=\"\";}this.transId=Ext.lib.Ajax.request(_5,_6,cb,p);}else{if(typeof _2.callback==\"function\"){_2.callback.call(_2.scope||window,_2,null,null);}}},isLoading:function(){return this.transId?true:false;},abort:function(){if(this.isLoading()){Ext.lib.Ajax.abort(this.transId);}},handleResponse:function(_7){this.transId=false;var _8=_7.argument.options;this.fireEvent(\"requestcomplete\",this,_7,_8);if(typeof _8.callback==\"function\"){_8.callback.call(_8.scope||window,_8,true,_7);}},handleFailure:function(_9,e){this.transId=false;var _b=_9.argument.options;this.fireEvent(\"requestexception\",this,_9,_b,e);if(typeof _b.callback==\"function\"){_b.callback.call(_b.scope||window,_b,false,_9);}}});\r\n\r\n\r\n\r\nExt.data.Field=function(_1){if(typeof _1==\"string\"){_1={name:_1};}Ext.apply(this,_1);if(!this.type){this.type=\"auto\";}var st=Ext.data.SortTypes;if(typeof this.sortType==\"string\"){this.sortType=st[this.sortType];}if(!this.sortType){switch(this.type){case \"string\":this.sortType=st.asUCString;break;case \"date\":this.sortType=st.asDate;break;default:this.sortType=st.none;}}var _3=/[\\$,%]/g;if(!this.convert){var cv,_5=this.dateFormat;switch(this.type){case \"\":case \"auto\":case undefined:cv=function(v){return v;};break;case \"string\":cv=function(v){return String(v);};break;case \"int\":cv=function(v){return v!==undefined&&v!==null&&v!==\"\"?parseInt(String(v).replace(_3,\"\"),10):\"\";};break;case \"float\":cv=function(v){return v!==undefined&&v!==null&&v!==\"\"?parseFloat(String(v).replace(_3,\"\"),10):\"\";};break;case \"bool\":case \"boolean\":cv=function(v){return v===true||v===\"true\"||v==1;};break;case \"date\":cv=function(v){if(!v){return \"\";}if(v instanceof Date){return v;}if(_5){if(_5==\"timestamp\"){return new Date(v*1000);}return Date.parseDate(v,_5);}var _c=Date.parse(v);return _c?new Date(_c):null;};break;}this.convert=cv;}};Ext.data.Field.prototype={dateFormat:null,defaultValue:\"\",mapping:null,sortType:null,sortDir:\"ASC\"};\r\n\r\n\r\n\r\nExt.data.DataReader=function(_1,_2){this.meta=_1;this.recordType=_2 instanceof Array?Ext.data.Record.create(_2):_2;};Ext.data.DataReader.prototype={};\r\n\r\n\r\n\r\nExt.data.DataProxy=function(){this.addEvents({beforeload:true,load:true,loadexception:true});Ext.data.DataProxy.superclass.constructor.call(this);};Ext.extend(Ext.data.DataProxy,Ext.util.Observable);\r\n\r\n\r\n\r\nExt.data.MemoryProxy=function(_1){Ext.data.MemoryProxy.superclass.constructor.call(this);this.data=_1;};Ext.extend(Ext.data.MemoryProxy,Ext.data.DataProxy,{load:function(_2,_3,_4,_5,_6){_2=_2||{};var _7;try{_7=_3.readRecords(this.data);}catch(e){this.fireEvent(\"loadexception\",this,_6,null,e);_4.call(_5,null,_6,false);return;}_4.call(_5,_7,_6,true);},update:function(_8,_9){}});\r\n\r\n\r\n\r\nExt.data.HttpProxy=function(_1){Ext.data.HttpProxy.superclass.constructor.call(this);this.conn=_1.events?_1:new Ext.data.Connection(_1);};Ext.extend(Ext.data.HttpProxy,Ext.data.DataProxy,{getConnection:function(){return this.conn;},load:function(_2,_3,_4,_5,_6){if(this.fireEvent(\"beforeload\",this,_2)!==false){this.conn.request({params:_2||{},request:{callback:_4,scope:_5,arg:_6},reader:_3,callback:this.loadResponse,scope:this});}else{_4.call(_5||this,null,_6,false);}},loadResponse:function(o,_8,_9){if(!_8){this.fireEvent(\"loadexception\",this,o,_9);o.request.callback.call(o.request.scope,null,o.request.arg,false);return;}var _a;try{_a=o.reader.read(_9);}catch(e){this.fireEvent(\"loadexception\",this,o,_9,e);o.request.callback.call(o.request.scope,null,o.request.arg,false);return;}this.fireEvent(\"load\",this,o,o.request.arg);o.request.callback.call(o.request.scope,_a,o.request.arg,true);},update:function(_b){},updateResponse:function(_c){}});\r\n\r\n\r\n\r\nExt.data.ScriptTagProxy=function(_1){Ext.data.ScriptTagProxy.superclass.constructor.call(this);Ext.apply(this,_1);this.head=document.getElementsByTagName(\"head\")[0];};Ext.data.ScriptTagProxy.TRANS_ID=1000;Ext.extend(Ext.data.ScriptTagProxy,Ext.data.DataProxy,{timeout:30000,callbackParam:\"callback\",nocache:true,load:function(_2,_3,_4,_5,_6){if(this.fireEvent(\"beforeload\",this,_2)!==false){var p=Ext.urlEncode(Ext.apply(_2,this.extraParams));var _8=this.url;_8+=(_8.indexOf(\"?\")!=-1?\"&\":\"?\")+p;if(this.nocache){_8+=\"&_dc=\"+(new Date().getTime());}var _9=++Ext.data.ScriptTagProxy.TRANS_ID;var _a={id:_9,cb:\"stcCallback\"+_9,scriptId:\"stcScript\"+_9,params:_2,arg:_6,url:_8,callback:_4,scope:_5,reader:_3};var _b=this;window[_a.cb]=function(o){_b.handleResponse(o,_a);};_8+=String.format(\"&{0}={1}\",this.callbackParam,_a.cb);if(this.autoAbort!==false){this.abort();}_a.timeoutId=this.handleFailure.defer(this.timeout,this,[_a]);var _d=document.createElement(\"script\");_d.setAttribute(\"src\",_8);_d.setAttribute(\"type\",\"text/javascript\");_d.setAttribute(\"id\",_a.scriptId);this.head.appendChild(_d);this.trans=_a;}else{_4.call(_5||this,null,_6,false);}},isLoading:function(){return this.trans?true:false;},abort:function(){if(this.isLoading()){this.destroyTrans(this.trans);}},destroyTrans:function(_e,_f){this.head.removeChild(document.getElementById(_e.scriptId));clearTimeout(_e.timeoutId);if(_f){window[_e.cb]=undefined;try{delete window[_e.cb];}catch(e){}}else{window[_e.cb]=function(){window[_e.cb]=undefined;try{delete window[_e.cb];}catch(e){}};}},handleResponse:function(o,_11){this.trans=false;this.destroyTrans(_11,true);var _12;try{_12=_11.reader.readRecords(o);}catch(e){this.fireEvent(\"loadexception\",this,o,_11.arg,e);_11.callback.call(_11.scope||window,null,_11.arg,false);return;}this.fireEvent(\"load\",this,o,_11.arg);_11.callback.call(_11.scope||window,_12,_11.arg,true);},handleFailure:function(_13){this.trans=false;this.destroyTrans(_13,false);this.fireEvent(\"loadexception\",this,null,_13.arg);_13.callback.call(_13.scope||window,null,_13.arg,false);}});\r\n\r\n\r\n\r\nExt.data.JsonReader=function(_1,_2){Ext.data.JsonReader.superclass.constructor.call(this,_1,_2);};Ext.extend(Ext.data.JsonReader,Ext.data.DataReader,{read:function(_3){var _4=_3.responseText;var o=eval(\"(\"+_4+\")\");if(!o){throw {message:\"JsonReader.read: Json object not found\"};}return this.readRecords(o);},simpleAccess:function(_6,_7){return _6[_7];},getJsonAccessor:function(){var re=/[\\[\\.]/;return function(_9){try{return (re.test(_9))?new Function(\"obj\",\"return obj.\"+_9):function(_a){return _a[_9];};}catch(e){}return Ext.emptyFn;};}(),readRecords:function(o){this.jsonData=o;var s=this.meta,_d=this.recordType,f=_d.prototype.fields,fi=f.items,fl=f.length;if(!this.ef){if(s.totalProperty){this.getTotal=this.getJsonAccessor(s.totalProperty);}if(s.successProperty){this.getSuccess=this.getJsonAccessor(s.successProperty);}this.getRoot=s.root?this.getJsonAccessor(s.root):function(p){return p;};if(s.id){var g=this.getJsonAccessor(s.id);this.getId=function(rec){var r=g(rec);return (r===undefined||r===\"\")?null:r;};}else{this.getId=function(){return null;};}this.ef=[];for(var i=0;i<fl;i++){f=fi[i];var map=(f.mapping!==undefined&&f.mapping!==null)?f.mapping:f.name;this.ef[i]=this.getJsonAccessor(map);}}var _17=this.getRoot(o),c=_17.length,_19=c,_1a=true;if(s.totalProperty){var v=parseInt(this.getTotal(o),10);if(!isNaN(v)){_19=v;}}if(s.successProperty){var v=this.getSuccess(o);if(v===false||v===\"false\"){_1a=false;}}var _1c=[];for(var i=0;i<c;i++){var n=_17[i];var _1e={};var id=this.getId(n);for(var j=0;j<fl;j++){f=fi[j];var v=this.ef[j](n);_1e[f.name]=f.convert((v!==undefined)?v:f.defaultValue);}var _21=new _d(_1e,id);_21.json=n;_1c[i]=_21;}return {success:_1a,records:_1c,totalRecords:_19};}});\r\n\r\n\r\n\r\nExt.data.ArrayReader=function(_1,_2){Ext.data.ArrayReader.superclass.constructor.call(this,_1,_2);};Ext.extend(Ext.data.ArrayReader,Ext.data.JsonReader,{readRecords:function(o){var _4=this.meta?this.meta.id:null;var _5=this.recordType,_6=_5.prototype.fields;var _7=[];var _8=o;for(var i=0;i<_8.length;i++){var n=_8[i];var _b={};var id=((_4||_4===0)&&n[_4]!==undefined&&n[_4]!==\"\"?n[_4]:null);for(var j=0,_e=_6.length;j<_e;j++){var f=_6.items[j];var k=f.mapping!==undefined&&f.mapping!==null?f.mapping:j;var v=n[k]!==undefined?n[k]:f.defaultValue;v=f.convert(v);_b[f.name]=v;}var _12=new _5(_b,id);_12.json=n;_7[_7.length]=_12;}return {records:_7,totalRecords:_7.length};}});\r\n\r\n\r\n\r\nExt.data.Tree=function(_1){this.nodeHash={};this.root=null;if(_1){this.setRootNode(_1);}this.addEvents({\"append\":true,\"remove\":true,\"move\":true,\"insert\":true,\"beforeappend\":true,\"beforeremove\":true,\"beforemove\":true,\"beforeinsert\":true});Ext.data.Tree.superclass.constructor.call(this);};Ext.extend(Ext.data.Tree,Ext.util.Observable,{pathSeparator:\"/\",getRootNode:function(){return this.root;},setRootNode:function(_2){this.root=_2;_2.ownerTree=this;_2.isRoot=true;this.registerNode(_2);return _2;},getNodeById:function(id){return this.nodeHash[id];},registerNode:function(_4){this.nodeHash[_4.id]=_4;},unregisterNode:function(_5){delete this.nodeHash[_5.id];},toString:function(){return \"[Tree\"+(this.id?\" \"+this.id:\"\")+\"]\";}});Ext.data.Node=function(_6){this.attributes=_6||{};this.leaf=this.attributes.leaf;this.id=this.attributes.id;if(!this.id){this.id=Ext.id(null,\"ynode-\");this.attributes.id=this.id;}this.childNodes=[];if(!this.childNodes.indexOf){this.childNodes.indexOf=function(o){for(var i=0,_9=this.length;i<_9;i++){if(this[i]==o){return i;}}return -1;};}this.parentNode=null;this.firstChild=null;this.lastChild=null;this.previousSibling=null;this.nextSibling=null;this.addEvents({\"append\":true,\"remove\":true,\"move\":true,\"insert\":true,\"beforeappend\":true,\"beforeremove\":true,\"beforemove\":true,\"beforeinsert\":true});this.listeners=this.attributes.listeners;Ext.data.Node.superclass.constructor.call(this);};Ext.extend(Ext.data.Node,Ext.util.Observable,{fireEvent:function(_a){if(Ext.data.Node.superclass.fireEvent.apply(this,arguments)===false){return false;}var ot=this.getOwnerTree();if(ot){if(ot.fireEvent.apply(this.ownerTree,arguments)===false){return false;}}return true;},isLeaf:function(){return this.leaf===true;},setFirstChild:function(_c){this.firstChild=_c;},setLastChild:function(_d){this.lastChild=_d;},isLast:function(){return (!this.parentNode?true:this.parentNode.lastChild==this);},isFirst:function(){return (!this.parentNode?true:this.parentNode.firstChild==this);},hasChildNodes:function(){return !this.isLeaf()&&this.childNodes.length>0;},appendChild:function(_e){var _f=false;if(_e instanceof Array){_f=_e;}else{if(arguments.length>1){_f=arguments;}}if(_f){for(var i=0,len=_f.length;i<len;i++){this.appendChild(_f[i]);}}else{if(this.fireEvent(\"beforeappend\",this.ownerTree,this,_e)===false){return false;}var _12=this.childNodes.length;var _13=_e.parentNode;if(_13){if(_e.fireEvent(\"beforemove\",_e.getOwnerTree(),_e,_13,this,_12)===false){return false;}_13.removeChild(_e);}_12=this.childNodes.length;if(_12==0){this.setFirstChild(_e);}this.childNodes.push(_e);_e.parentNode=this;var ps=this.childNodes[_12-1];if(ps){_e.previousSibling=ps;ps.nextSibling=_e;}else{_e.previousSibling=null;}_e.nextSibling=null;this.setLastChild(_e);_e.setOwnerTree(this.getOwnerTree());this.fireEvent(\"append\",this.ownerTree,this,_e,_12);if(_13){_e.fireEvent(\"move\",this.ownerTree,_e,_13,this,_12);}return _e;}},removeChild:function(_15){var _16=this.childNodes.indexOf(_15);if(_16==-1){return false;}if(this.fireEvent(\"beforeremove\",this.ownerTree,this,_15)===false){return false;}this.childNodes.splice(_16,1);if(_15.previousSibling){_15.previousSibling.nextSibling=_15.nextSibling;}if(_15.nextSibling){_15.nextSibling.previousSibling=_15.previousSibling;}if(this.firstChild==_15){this.setFirstChild(_15.nextSibling);}if(this.lastChild==_15){this.setLastChild(_15.previousSibling);}_15.setOwnerTree(null);_15.parentNode=null;_15.previousSibling=null;_15.nextSibling=null;this.fireEvent(\"remove\",this.ownerTree,this,_15);return _15;},insertBefore:function(_17,_18){if(!_18){return this.appendChild(_17);}if(_17==_18){return false;}if(this.fireEvent(\"beforeinsert\",this.ownerTree,this,_17,_18)===false){return false;}var _19=this.childNodes.indexOf(_18);var _1a=_17.parentNode;var _1b=_19;if(_1a==this&&this.childNodes.indexOf(_17)<_19){_1b--;}if(_1a){if(_17.fireEvent(\"beforemove\",_17.getOwnerTree(),_17,_1a,this,_19,_18)===false){return false;}_1a.removeChild(_17);}if(_1b==0){this.setFirstChild(_17);}this.childNodes.splice(_1b,0,_17);_17.parentNode=this;var ps=this.childNodes[_1b-1];if(ps){_17.previousSibling=ps;ps.nextSibling=_17;}else{_17.previousSibling=null;}_17.nextSibling=_18;_18.previousSibling=_17;_17.setOwnerTree(this.getOwnerTree());this.fireEvent(\"insert\",this.ownerTree,this,_17,_18);if(_1a){_17.fireEvent(\"move\",this.ownerTree,_17,_1a,this,_1b,_18);}return _17;},item:function(_1d){return this.childNodes[_1d];},replaceChild:function(_1e,_1f){this.insertBefore(_1e,_1f);this.removeChild(_1f);return _1f;},indexOf:function(_20){return this.childNodes.indexOf(_20);},getOwnerTree:function(){if(!this.ownerTree){var p=this;while(p){if(p.ownerTree){this.ownerTree=p.ownerTree;break;}p=p.parentNode;}}return this.ownerTree;},getDepth:function(){var _22=0;var p=this;while(p.parentNode){++_22;p=p.parentNode;}return _22;},setOwnerTree:function(_24){if(_24!=this.ownerTree){if(this.ownerTree){this.ownerTree.unregisterNode(this);}this.ownerTree=_24;var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].setOwnerTree(_24);}if(_24){_24.registerNode(this);}}},getPath:function(_28){_28=_28||\"id\";var p=this.parentNode;var b=[this.attributes[_28]];while(p){b.unshift(p.attributes[_28]);p=p.parentNode;}var sep=this.getOwnerTree().pathSeparator;return sep+b.join(sep);},bubble:function(fn,_2d,_2e){var p=this;while(p){if(fn.call(_2d||p,_2e||p)===false){break;}p=p.parentNode;}},cascade:function(fn,_31,_32){if(fn.call(_31||this,_32||this)!==false){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].cascade(fn,_31,_32);}}},eachChild:function(fn,_37,_38){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){if(fn.call(_37||this,_38||cs[i])===false){break;}}},findChild:function(_3c,_3d){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){if(cs[i].attributes[_3c]==_3d){return cs[i];}}return null;},findChildBy:function(fn,_42){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){if(fn.call(_42||cs[i],cs[i])===true){return cs[i];}}return null;},sort:function(fn,_47){var cs=this.childNodes;var len=cs.length;if(len>0){var _4a=_47?function(){fn.apply(_47,arguments);}:fn;cs.sort(_4a);for(var i=0;i<len;i++){var n=cs[i];n.previousSibling=cs[i-1];n.nextSibling=cs[i+1];if(i==0){this.setFirstChild(n);}if(i==len-1){this.setLastChild(n);}}}},contains:function(_4d){return _4d.isAncestor(this);},isAncestor:function(_4e){var p=this.parentNode;while(p){if(p==_4e){return true;}p=p.parentNode;}return false;},toString:function(){return \"[Node\"+(this.id?\" \"+this.id:\"\")+\"]\";}});\r\n\r\n\r\n\r\nExt.ComponentMgr=function(){var _1=new Ext.util.MixedCollection();return {register:function(c){_1.add(c);},unregister:function(c){_1.remove(c);},get:function(id){return _1.get(id);},onAvailable:function(id,fn,_7){_1.on(\"add\",function(_8,o){if(o.id==id){fn.call(_7||o,o);_1.un(\"add\",fn,_7);}});}};}();Ext.Component=function(_a){_a=_a||{};if(_a.tagName||_a.dom||typeof _a==\"string\"){_a={el:_a,id:_a.id||_a};}this.initialConfig=_a;Ext.apply(this,_a);this.addEvents({disable:true,enable:true,beforeshow:true,show:true,beforehide:true,hide:true,beforerender:true,render:true,beforedestroy:true,destroy:true});if(!this.id){this.id=\"ext-comp-\"+(++Ext.Component.AUTO_ID);}Ext.ComponentMgr.register(this);Ext.Component.superclass.constructor.call(this);this.initComponent();};Ext.Component.AUTO_ID=1000;Ext.extend(Ext.Component,Ext.util.Observable,{hidden:false,disabled:false,disabledClass:\"x-item-disabled\",rendered:false,allowDomMove:true,ctype:\"Ext.Component\",actionMode:\"el\",getActionEl:function(){return this[this.actionMode];},initComponent:Ext.emptyFn,render:function(_b,_c){if(!this.rendered&&this.fireEvent(\"beforerender\",this)!==false){if(!_b&&this.el){this.el=Ext.get(this.el);_b=this.el.dom.parentNode;this.allowDomMove=false;}this.container=Ext.get(_b);this.rendered=true;if(_c!==undefined){if(typeof _c==\"number\"){_c=this.container.dom.childNodes[_c];}else{_c=Ext.getDom(_c);}}this.onRender(this.container,_c||null);if(this.cls){this.el.addClass(this.cls);delete this.cls;}if(this.style){this.el.applyStyles(this.style);delete this.style;}this.fireEvent(\"render\",this);this.afterRender(this.container);if(this.hidden){this.hide();}if(this.disabled){this.disable();}}return this;},onRender:function(ct,_e){if(this.el){this.el=Ext.get(this.el);if(this.allowDomMove!==false){ct.dom.insertBefore(this.el.dom,_e);}}},getAutoCreate:function(){var _f=typeof this.autoCreate==\"object\"?this.autoCreate:Ext.apply({},this.defaultAutoCreate);if(this.id&&!_f.id){_f.id=this.id;}return _f;},afterRender:Ext.emptyFn,destroy:function(){if(this.fireEvent(\"beforedestroy\",this)!==false){this.purgeListeners();this.beforeDestroy();if(this.rendered){this.el.removeAllListeners();this.el.remove();if(this.actionMode==\"container\"){this.container.remove();}}this.onDestroy();Ext.ComponentMgr.unregister(this);this.fireEvent(\"destroy\",this);}},beforeDestroy:function(){},onDestroy:function(){},getEl:function(){return this.el;},getId:function(){return this.id;},focus:function(_10){if(this.rendered){this.el.focus();if(_10===true){this.el.dom.select();}}return this;},blur:function(){if(this.rendered){this.el.blur();}return this;},disable:function(){if(this.rendered){this.onDisable();}this.disabled=true;this.fireEvent(\"disable\",this);return this;},onDisable:function(){this.getActionEl().addClass(this.disabledClass);this.el.dom.disabled=true;},enable:function(){if(this.rendered){this.onEnable();}this.disabled=false;this.fireEvent(\"enable\",this);return this;},onEnable:function(){this.getActionEl().removeClass(this.disabledClass);this.el.dom.disabled=false;},setDisabled:function(_11){this[_11?\"disable\":\"enable\"]();},show:function(){if(this.fireEvent(\"beforeshow\",this)!==false){this.hidden=false;if(this.rendered){this.onShow();}this.fireEvent(\"show\",this);}return this;},onShow:function(){var st=this.getActionEl().dom.style;st.display=\"\";st.visibility=\"visible\";},hide:function(){if(this.fireEvent(\"beforehide\",this)!==false){this.hidden=true;if(this.rendered){this.onHide();}this.fireEvent(\"hide\",this);}return this;},onHide:function(){this.getActionEl().dom.style.display=\"none\";},setVisible:function(_13){if(_13){this.show();}else{this.hide();}return this;},isVisible:function(){return this.getActionEl().isVisible();},cloneConfig:function(_14){_14=_14||{};var id=_14.id||Ext.id();var cfg=Ext.applyIf(_14,this.initialConfig);cfg.id=id;return new this.__extcls(cfg);}});\r\n\r\n\r\n\r\n(function(){Ext.Layer=function(_1,_2){_1=_1||{};var dh=Ext.DomHelper;var cp=_1.parentEl,_5=cp?Ext.getDom(cp):document.body;if(_2){this.dom=Ext.getDom(_2);}if(!this.dom){var o=_1.dh||{tag:\"div\",cls:\"x-layer\"};this.dom=dh.append(_5,o);}if(_1.cls){this.addClass(_1.cls);}this.constrain=_1.constrain!==false;this.visibilityMode=Ext.Element.VISIBILITY;if(_1.id){this.id=this.dom.id=_1.id;}else{this.id=Ext.id(this.dom);}this.zindex=_1.zindex||this.getZIndex();this.position(\"absolute\",this.zindex);if(_1.shadow){this.shadowOffset=_1.shadowOffset||4;this.shadow=new Ext.Shadow({offset:this.shadowOffset,mode:_1.shadow});}else{this.shadowOffset=0;}this.useShim=_1.shim!==false&&Ext.useShims;this.useDisplay=_1.useDisplay;this.hide();};var _7=Ext.Element.prototype;var _8=[];Ext.extend(Ext.Layer,Ext.Element,{getZIndex:function(){return this.zindex||parseInt(this.getStyle(\"z-index\"),10)||11000;},getShim:function(){if(!this.useShim){return null;}if(this.shim){return this.shim;}var _9=_8.shift();if(!_9){_9=this.createShim();_9.enableDisplayMode(\"block\");_9.dom.style.display=\"none\";_9.dom.style.visibility=\"visible\";}var pn=this.dom.parentNode;if(_9.dom.parentNode!=pn){pn.insertBefore(_9.dom,this.dom);}_9.setStyle(\"z-index\",this.getZIndex()-2);this.shim=_9;return _9;},hideShim:function(){if(this.shim){this.shim.setDisplayed(false);_8.push(this.shim);delete this.shim;}},disableShadow:function(){if(this.shadow){this.shadowDisabled=true;this.shadow.hide();this.lastShadowOffset=this.shadowOffset;this.shadowOffset=0;}},enableShadow:function(_b){if(this.shadow){this.shadowDisabled=false;this.shadowOffset=this.lastShadowOffset;delete this.lastShadowOffset;if(_b){this.sync(true);}}},sync:function(_c){var sw=this.shadow;if(!this.updating&&this.isVisible()&&(sw||this.useShim)){var sh=this.getShim();var w=this.getWidth(),h=this.getHeight();var l=this.getLeft(true),t=this.getTop(true);if(sw&&!this.shadowDisabled){if(_c&&!sw.isVisible()){sw.show(this);}else{sw.realign(l,t,w,h);}if(sh){if(_c){sh.show();}var a=sw.adjusts,s=sh.dom.style;s.left=(Math.min(l,l+a.l))+\"px\";s.top=(Math.min(t,t+a.t))+\"px\";s.width=(w+a.w)+\"px\";s.height=(h+a.h)+\"px\";}}else{if(sh){if(_c){sh.show();}sh.setSize(w,h);sh.setLeftTop(l,t);}}}},destroy:function(){this.hideShim();if(this.shadow){this.shadow.hide();}this.removeAllListeners();var pn=this.dom.parentNode;if(pn){pn.removeChild(this.dom);}Ext.Element.uncache(this.id);},remove:function(){this.destroy();},beginUpdate:function(){this.updating=true;},endUpdate:function(){this.updating=false;this.sync(true);},hideUnders:function(_16){if(this.shadow){this.shadow.hide();}this.hideShim();},constrainXY:function(){if(this.constrain){var vw=Ext.lib.Dom.getViewWidth(),vh=Ext.lib.Dom.getViewHeight();var s=Ext.get(document).getScroll();var xy=this.getXY();var x=xy[0],y=xy[1];var w=this.dom.offsetWidth+this.shadowOffset,h=this.dom.offsetHeight+this.shadowOffset;var _1f=false;if((x+w)>vw+s.left){x=vw-w-this.shadowOffset;_1f=true;}if((y+h)>vh+s.top){y=vh-h-this.shadowOffset;_1f=true;}if(x<s.left){x=s.left;_1f=true;}if(y<s.top){y=s.top;_1f=true;}if(_1f){if(this.avoidY){var ay=this.avoidY;if(y<=ay&&(y+h)>=ay){y=ay-h-5;}}xy=[x,y];this.storeXY(xy);_7.setXY.call(this,xy);this.sync();}}},isVisible:function(){return this.visible;},showAction:function(){this.visible=true;if(this.useDisplay===true){this.setDisplayed(\"\");}else{if(this.lastXY){_7.setXY.call(this,this.lastXY);}else{if(this.lastLT){_7.setLeftTop.call(this,this.lastLT[0],this.lastLT[1]);}}}},hideAction:function(){this.visible=false;if(this.useDisplay===true){this.setDisplayed(false);}else{this.setLeftTop(-10000,-10000);}},setVisible:function(v,a,d,c,e){if(v){this.showAction();}if(a&&v){var cb=function(){this.sync(true);if(c){c();}}.createDelegate(this);_7.setVisible.call(this,true,true,d,cb,e);}else{if(!v){this.hideUnders(true);}var cb=c;if(a){cb=function(){this.hideAction();if(c){c();}}.createDelegate(this);}_7.setVisible.call(this,v,a,d,cb,e);if(v){this.sync(true);}else{if(!a){this.hideAction();}}}},storeXY:function(xy){delete this.lastLT;this.lastXY=xy;},storeLeftTop:function(_28,top){delete this.lastXY;this.lastLT=[_28,top];},beforeFx:function(){this.beforeAction();return Ext.Layer.superclass.beforeFx.apply(this,arguments);},afterFx:function(){Ext.Layer.superclass.afterFx.apply(this,arguments);this.sync(this.isVisible());},beforeAction:function(){if(!this.updating&&this.shadow){this.shadow.hide();}},setLeft:function(_2a){this.storeLeftTop(_2a,this.getTop(true));_7.setLeft.apply(this,arguments);this.sync();},setTop:function(top){this.storeLeftTop(this.getLeft(true),top);_7.setTop.apply(this,arguments);this.sync();},setLeftTop:function(_2c,top){this.storeLeftTop(_2c,top);_7.setLeftTop.apply(this,arguments);this.sync();},setXY:function(xy,a,d,c,e){this.fixDisplay();this.beforeAction();this.storeXY(xy);var cb=this.createCB(c);_7.setXY.call(this,xy,a,d,cb,e);if(!a){cb();}},createCB:function(c){var el=this;return function(){el.constrainXY();el.sync(true);if(c){c();}};},setX:function(x,a,d,c,e){this.setXY([x,this.getY()],a,d,c,e);},setY:function(y,a,d,c,e){this.setXY([this.getX(),y],a,d,c,e);},setSize:function(w,h,a,d,c,e){this.beforeAction();var cb=this.createCB(c);_7.setSize.call(this,w,h,a,d,cb,e);if(!a){cb();}},setWidth:function(w,a,d,c,e){this.beforeAction();var cb=this.createCB(c);_7.setWidth.call(this,w,a,d,cb,e);if(!a){cb();}},setHeight:function(h,a,d,c,e){this.beforeAction();var cb=this.createCB(c);_7.setHeight.call(this,h,a,d,cb,e);if(!a){cb();}},setBounds:function(x,y,w,h,a,d,c,e){this.beforeAction();var cb=this.createCB(c);if(!a){this.storeXY([x,y]);_7.setXY.call(this,[x,y]);_7.setSize.call(this,w,h,a,d,cb,e);cb();}else{_7.setBounds.call(this,x,y,w,h,a,d,cb,e);}return this;},setZIndex:function(_5c){this.zindex=_5c;this.setStyle(\"z-index\",_5c+2);if(this.shadow){this.shadow.setZIndex(_5c+1);}if(this.shim){this.shim.setStyle(\"z-index\",_5c);}}});})();\r\n\r\n\r\n\r\nExt.Shadow=function(_1){Ext.apply(this,_1);if(typeof this.mode!=\"string\"){this.mode=this.defaultMode;}var o=this.offset,a={h:0};switch(this.mode.toLowerCase()){case \"drop\":a.w=0;a.l=a.t=o;break;case \"sides\":a.w=(o*2);a.l=-o;a.t=o;break;case \"frame\":a.w=a.h=(o*2);a.l=a.t=-o;break;}this.adjusts=a;};Ext.Shadow.prototype={offset:4,defaultMode:\"drop\",show:function(_4){_4=Ext.get(_4);if(!this.el){this.el=Ext.Shadow.Pool.pull();if(this.el.dom.nextSibling!=_4.dom){this.el.insertBefore(_4);}}this.el.setStyle(\"z-index\",this.zIndex||parseInt(_4.getStyle(\"z-index\"),10)-1);if(Ext.isIE){this.el.dom.style.filter=\"progid:DXImageTransform.Microsoft.alpha(opacity=50) progid:DXImageTransform.Microsoft.Blur(pixelradius=\"+this.offset+\")\";}this.realign(_4.getLeft(true),_4.getTop(true),_4.getWidth(),_4.getHeight());this.el.dom.style.display=\"block\";},isVisible:function(){return this.el?true:false;},realign:function(l,t,w,h){if(!this.el){return;}var a=this.adjusts,d=this.el.dom,s=d.style;var _c=0;if(Ext.isIE){_c=-(this.offset);}s.left=(l+a.l+_c)+\"px\";s.top=(t+a.t+_c)+\"px\";var sw=(w+a.w),sh=(h+a.h),_f=sw+\"px\",shs=sh+\"px\";if(s.width!=_f||s.height!=shs){s.width=_f;s.height=shs;if(!Ext.isIE){var cn=d.childNodes;var sww=Math.max(0,(sw-12))+\"px\";cn[0].childNodes[1].style.width=sww;cn[1].childNodes[1].style.width=sww;cn[2].childNodes[1].style.width=sww;cn[1].style.height=Math.max(0,(sh-12))+\"px\";}}},hide:function(){if(this.el){this.el.dom.style.display=\"none\";Ext.Shadow.Pool.push(this.el);delete this.el;}},setZIndex:function(z){this.zIndex=z;if(this.el){this.el.setStyle(\"z-index\",z);}}};Ext.Shadow.Pool=function(){var p=[];var _15=Ext.isIE?\"<div class=\\\"x-ie-shadow\\\"></div>\":\"<div class=\\\"x-shadow\\\"><div class=\\\"xst\\\"><div class=\\\"xstl\\\"></div><div class=\\\"xstc\\\"></div><div class=\\\"xstr\\\"></div></div><div class=\\\"xsc\\\"><div class=\\\"xsml\\\"></div><div class=\\\"xsmc\\\"></div><div class=\\\"xsmr\\\"></div></div><div class=\\\"xsb\\\"><div class=\\\"xsbl\\\"></div><div class=\\\"xsbc\\\"></div><div class=\\\"xsbr\\\"></div></div></div>\";return {pull:function(){var sh=p.shift();if(!sh){sh=Ext.get(Ext.DomHelper.insertHtml(\"beforeBegin\",document.body.firstChild,_15));sh.autoBoxAdjust=false;}return sh;},push:function(sh){p.push(sh);}};}();\r\n\r\n\r\n\r\nExt.Editor=function(_1,_2){Ext.Editor.superclass.constructor.call(this,_2);this.field=_1;this.addEvents({\"beforestartedit\":true,\"startedit\":true,\"beforecomplete\":true,\"complete\":true,\"specialkey\":true});};Ext.extend(Ext.Editor,Ext.Component,{value:\"\",alignment:\"c-c?\",shadow:\"frame\",updateEl:false,onRender:function(ct,_4){this.el=new Ext.Layer({shadow:this.shadow,cls:\"x-editor\",parentEl:ct,shim:this.shim,shadowOffset:3,id:this.id});this.el.setStyle(\"overflow\",Ext.isGecko?\"auto\":\"hidden\");this.field.render(this.el);if(Ext.isGecko){this.field.el.dom.setAttribute(\"autocomplete\",\"off\");}this.field.show();this.field.on(\"blur\",this.onBlur,this);this.relayEvents(this.field,[\"specialkey\"]);if(this.field.grow){this.field.on(\"autosize\",this.el.sync,this.el,{delay:1});}},startEdit:function(el,_6){if(this.editing){this.completeEdit();}this.boundEl=Ext.get(el);var v=_6!==undefined?_6:this.boundEl.dom.innerHTML;if(!this.rendered){this.render(this.parentEl||document.body);}if(this.fireEvent(\"beforestartedit\",this,this.boundEl,v)===false){return;}this.startValue=v;this.field.setValue(v);if(this.autoSize){var sz=this.boundEl.getSize();switch(this.autoSize){case \"width\":this.setSize(sz.width,\"\");break;case \"height\":this.setSize(\"\",sz.height);break;default:this.setSize(sz.width,sz.height);}}this.el.alignTo(this.boundEl,this.alignment);this.editing=true;if(Ext.QuickTips){Ext.QuickTips.disable();}this.show();},setSize:function(w,h){this.field.setSize(w,h);if(this.el){this.el.sync();}},realign:function(){this.el.alignTo(this.boundEl,this.alignment);},completeEdit:function(_b){if(!this.editing){return;}var v=this.getValue();if(this.revertInvalid!==false&&!this.field.isValid()){v=this.startValue;this.cancelEdit(true);}if(String(v)==String(this.startValue)&&this.ignoreNoChange){this.editing=false;this.hide();return;}if(this.fireEvent(\"beforecomplete\",this,v,this.startValue)!==false){this.editing=false;if(this.updateEl&&this.boundEl){this.boundEl.update(v);}if(_b!==true){this.hide();}this.fireEvent(\"complete\",this,v,this.startValue);}},onShow:function(){this.el.show();if(this.hideEl!==false){this.boundEl.hide();}this.field.show();this.field.focus();this.fireEvent(\"startedit\",this.boundEl,this.startValue);},cancelEdit:function(_d){if(this.editing){this.setValue(this.startValue);if(_d!==true){this.hide();}}},onBlur:function(){if(this.allowBlur!==true&&this.editing){this.completeEdit();}},onHide:function(){if(this.editing){this.completeEdit();return;}this.field.blur();if(this.field.collapse){this.field.collapse();}this.el.hide();if(this.hideEl!==false){this.boundEl.show();}if(Ext.QuickTips){Ext.QuickTips.enable();}},setValue:function(v){this.field.setValue(v);},getValue:function(){return this.field.getValue();}});\r\n\r\n\r\n\r\nExt.tree.TreePanel=function(el,_2){Ext.tree.TreePanel.superclass.constructor.call(this);this.el=Ext.get(el);this.el.addClass(\"x-tree\");this.id=this.el.id;Ext.apply(this,_2);this.addEvents({\"beforeload\":true,\"load\":true,\"textchange\":true,\"beforeexpand\":true,\"beforecollapse\":true,\"expand\":true,\"disabledchange\":true,\"collapse\":true,\"beforeclick\":true,\"click\":true,\"dblclick\":true,\"contextmenu\":true,\"beforechildrenrendered\":true,\"startdrag\":true,\"enddrag\":true,\"dragdrop\":true,\"beforenodedrop\":true,\"nodedrop\":true,\"nodedragover\":true});if(this.singleExpand){this.on(\"beforeexpand\",this.restrictExpand,this);}};Ext.extend(Ext.tree.TreePanel,Ext.data.Tree,{rootVisible:true,animate:Ext.enableFx,lines:true,enableDD:false,hlDrop:Ext.enableFx,restrictExpand:function(_3){var p=_3.parentNode;if(p){if(p.expandedChild&&p.expandedChild.parentNode==p){p.expandedChild.collapse();}p.expandedChild=_3;}},setRootNode:function(_5){Ext.tree.TreePanel.superclass.setRootNode.call(this,_5);if(!this.rootVisible){_5.ui=new Ext.tree.RootTreeNodeUI(_5);}return _5;},getEl:function(){return this.el;},getLoader:function(){return this.loader;},expandAll:function(){this.root.expand(true);},collapseAll:function(){this.root.collapse(true);},getSelectionModel:function(){if(!this.selModel){this.selModel=new Ext.tree.DefaultSelectionModel();}return this.selModel;},expandPath:function(_6,_7,_8){_7=_7||\"id\";var _9=_6.split(this.pathSeparator);var _a=this.root;if(_a.attributes[_7]!=_9[1]){if(_8){_8(false,null);}return;}var _b=1;var f=function(){if(++_b==_9.length){if(_8){_8(true,_a);}return;}var c=_a.findChild(_7,_9[_b]);if(!c){if(_8){_8(false,_a);}return;}_a=c;c.expand(false,false,f);};_a.expand(false,false,f);},selectPath:function(_e,_f,_10){_f=_f||\"id\";var _11=_e.split(this.pathSeparator);var v=_11.pop();if(_11.length>0){var f=function(_14,_15){if(_14&&_15){var n=_15.findChild(_f,v);if(n){n.select();if(_10){_10(true,n);}}}else{if(_10){_10(false,n);}}};this.expandPath(_11.join(this.pathSeparator),_f,f);}else{this.root.select();if(_10){_10(true,this.root);}}},render:function(){this.container=this.el.createChild({tag:\"ul\",cls:\"x-tree-root-ct \"+(this.lines?\"x-tree-lines\":\"x-tree-no-lines\")});if(this.containerScroll){Ext.dd.ScrollManager.register(this.el);}if((this.enableDD||this.enableDrop)&&!this.dropZone){this.dropZone=new Ext.tree.TreeDropZone(this,this.dropConfig||{ddGroup:this.ddGroup||\"TreeDD\",appendOnly:this.ddAppendOnly===true});}if((this.enableDD||this.enableDrag)&&!this.dragZone){this.dragZone=new Ext.tree.TreeDragZone(this,this.dragConfig||{ddGroup:this.ddGroup||\"TreeDD\",scroll:this.ddScroll});}this.getSelectionModel().init(this);this.root.render();if(!this.rootVisible){this.root.renderChildren();}return this;}});\r\n\r\n\r\n\r\nExt.tree.DefaultSelectionModel=function(){this.selNode=null;this.addEvents({\"selectionchange\":true,\"beforeselect\":true});};Ext.extend(Ext.tree.DefaultSelectionModel,Ext.util.Observable,{init:function(_1){this.tree=_1;_1.el.on(\"keydown\",this.onKeyDown,this);_1.on(\"click\",this.onNodeClick,this);},onNodeClick:function(_2,e){this.select(_2);},select:function(_4){var _5=this.selNode;if(_5!=_4&&this.fireEvent(\"beforeselect\",this,_4,_5)!==false){if(_5){_5.ui.onSelectedChange(false);}this.selNode=_4;_4.ui.onSelectedChange(true);this.fireEvent(\"selectionchange\",this,_4,_5);}return _4;},unselect:function(_6){if(this.selNode==_6){this.clearSelections();}},clearSelections:function(){var n=this.selNode;if(n){n.ui.onSelectedChange(false);this.selNode=null;this.fireEvent(\"selectionchange\",this,null);}return n;},getSelectedNode:function(){return this.selNode;},isSelected:function(_8){return this.selNode==_8;},selectPrevious:function(){var s=this.selNode||this.lastSelNode;if(!s){return null;}var ps=s.previousSibling;if(ps){if(!ps.isExpanded()||ps.childNodes.length<1){return this.select(ps);}else{var lc=ps.lastChild;while(lc&&lc.isExpanded()&&lc.childNodes.length>0){lc=lc.lastChild;}return this.select(lc);}}else{if(s.parentNode&&(this.tree.rootVisible||!s.parentNode.isRoot)){return this.select(s.parentNode);}}return null;},selectNext:function(){var s=this.selNode||this.lastSelNode;if(!s){return null;}if(s.firstChild&&s.isExpanded()){return this.select(s.firstChild);}else{if(s.nextSibling){return this.select(s.nextSibling);}else{if(s.parentNode){var _d=null;s.parentNode.bubble(function(){if(this.nextSibling){_d=this.getOwnerTree().selModel.select(this.nextSibling);return false;}});return _d;}}}return null;},onKeyDown:function(e){var s=this.selNode||this.lastSelNode;var sm=this;if(!s){return;}var k=e.getKey();switch(k){case e.DOWN:e.stopEvent();this.selectNext();break;case e.UP:e.stopEvent();this.selectPrevious();break;case e.RIGHT:e.preventDefault();if(s.hasChildNodes()){if(!s.isExpanded()){s.expand();}else{if(s.firstChild){this.select(s.firstChild,e);}}}break;case e.LEFT:e.preventDefault();if(s.hasChildNodes()&&s.isExpanded()){s.collapse();}else{if(s.parentNode&&(this.tree.rootVisible||s.parentNode!=this.tree.getRootNode())){this.select(s.parentNode,e);}}break;}}});Ext.tree.MultiSelectionModel=function(){this.selNodes=[];this.selMap={};this.addEvents({\"selectionchange\":true});};Ext.extend(Ext.tree.MultiSelectionModel,Ext.util.Observable,{init:function(_12){this.tree=_12;_12.el.on(\"keydown\",this.onKeyDown,this);_12.on(\"click\",this.onNodeClick,this);},onNodeClick:function(_13,e){this.select(_13,e,e.ctrlKey);},select:function(_15,e,_17){if(_17!==true){this.clearSelections(true);}if(this.isSelected(_15)){this.lastSelNode=_15;return _15;}this.selNodes.push(_15);this.selMap[_15.id]=_15;this.lastSelNode=_15;_15.ui.onSelectedChange(true);this.fireEvent(\"selectionchange\",this,this.selNodes);return _15;},unselect:function(_18){if(this.selMap[_18.id]){_18.ui.onSelectedChange(false);var sn=this.selNodes;var _1a=-1;if(sn.indexOf){_1a=sn.indexOf(_18);}else{for(var i=0,len=sn.length;i<len;i++){if(sn[i]==_18){_1a=i;break;}}}if(_1a!=-1){this.selNodes.splice(_1a,1);}delete this.selMap[_18.id];this.fireEvent(\"selectionchange\",this,this.selNodes);}},clearSelections:function(_1d){var sn=this.selNodes;if(sn.length>0){for(var i=0,len=sn.length;i<len;i++){sn[i].ui.onSelectedChange(false);}this.selNodes=[];this.selMap={};if(_1d!==true){this.fireEvent(\"selectionchange\",this,this.selNodes);}}},isSelected:function(_21){return this.selMap[_21.id]?true:false;},getSelectedNodes:function(){return this.selNodes;},onKeyDown:Ext.tree.DefaultSelectionModel.prototype.onKeyDown,selectNext:Ext.tree.DefaultSelectionModel.prototype.selectNext,selectPrevious:Ext.tree.DefaultSelectionModel.prototype.selectPrevious});\r\n\r\n\r\n\r\nExt.tree.TreeNode=function(_1){_1=_1||{};if(typeof _1==\"string\"){_1={text:_1};}this.childrenRendered=false;this.rendered=false;Ext.tree.TreeNode.superclass.constructor.call(this,_1);this.expanded=_1.expanded===true;this.isTarget=_1.isTarget!==false;this.draggable=_1.draggable!==false&&_1.allowDrag!==false;this.allowChildren=_1.allowChildren!==false&&_1.allowDrop!==false;this.text=_1.text;this.disabled=_1.disabled===true;this.addEvents({\"textchange\":true,\"beforeexpand\":true,\"beforecollapse\":true,\"expand\":true,\"disabledchange\":true,\"collapse\":true,\"beforeclick\":true,\"click\":true,\"dblclick\":true,\"contextmenu\":true,\"beforechildrenrendered\":true});var _2=this.attributes.uiProvider||Ext.tree.TreeNodeUI;this.ui=new _2(this);};Ext.extend(Ext.tree.TreeNode,Ext.data.Node,{preventHScroll:true,isExpanded:function(){return this.expanded;},getUI:function(){return this.ui;},setFirstChild:function(_3){var of=this.firstChild;Ext.tree.TreeNode.superclass.setFirstChild.call(this,_3);if(this.childrenRendered&&of&&_3!=of){of.renderIndent(true,true);}if(this.rendered){this.renderIndent(true,true);}},setLastChild:function(_5){var ol=this.lastChild;Ext.tree.TreeNode.superclass.setLastChild.call(this,_5);if(this.childrenRendered&&ol&&_5!=ol){ol.renderIndent(true,true);}if(this.rendered){this.renderIndent(true,true);}},appendChild:function(){var _7=Ext.tree.TreeNode.superclass.appendChild.apply(this,arguments);if(_7&&this.childrenRendered){_7.render();}this.ui.updateExpandIcon();return _7;},removeChild:function(_8){this.ownerTree.getSelectionModel().unselect(_8);Ext.tree.TreeNode.superclass.removeChild.apply(this,arguments);if(this.childrenRendered){_8.ui.remove();}if(this.childNodes.length<1){this.collapse(false,false);}else{this.ui.updateExpandIcon();}return _8;},insertBefore:function(_9,_a){var _b=Ext.tree.TreeNode.superclass.insertBefore.apply(this,arguments);if(_b&&_a&&this.childrenRendered){_9.render();}this.ui.updateExpandIcon();return _b;},setText:function(_c){var _d=this.text;this.text=_c;this.attributes.text=_c;if(this.rendered){this.ui.onTextChange(this,_c,_d);}this.fireEvent(\"textchange\",this,_c,_d);},select:function(){this.getOwnerTree().getSelectionModel().select(this);},unselect:function(){this.getOwnerTree().getSelectionModel().unselect(this);},isSelected:function(){return this.getOwnerTree().getSelectionModel().isSelected(this);},expand:function(_e,_f,_10){if(!this.expanded){if(this.fireEvent(\"beforeexpand\",this,_e,_f)===false){return;}if(!this.childrenRendered){this.renderChildren();}this.expanded=true;if(!this.isHiddenRoot()&&(this.getOwnerTree().animate&&_f!==false)||_f){this.ui.animExpand(function(){this.fireEvent(\"expand\",this);if(typeof _10==\"function\"){_10(this);}if(_e===true){this.expandChildNodes(true);}}.createDelegate(this));return;}else{this.ui.expand();this.fireEvent(\"expand\",this);if(typeof _10==\"function\"){_10(this);}}}else{if(typeof _10==\"function\"){_10(this);}}if(_e===true){this.expandChildNodes(true);}},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible;},collapse:function(_11,_12){if(this.expanded&&!this.isHiddenRoot()){if(this.fireEvent(\"beforecollapse\",this,_11,_12)===false){return;}this.expanded=false;if((this.getOwnerTree().animate&&_12!==false)||_12){this.ui.animCollapse(function(){this.fireEvent(\"collapse\",this);if(_11===true){this.collapseChildNodes(true);}}.createDelegate(this));return;}else{this.ui.collapse();this.fireEvent(\"collapse\",this);}}if(_11===true){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].collapse(true);}}},delayedExpand:function(_16){if(!this.expandProcId){this.expandProcId=this.expand.defer(_16,this);}},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId);}this.expandProcId=false;},toggle:function(){if(this.expanded){this.collapse();}else{this.expand();}},ensureVisible:function(_17){var _18=this.getOwnerTree();_18.expandPath(this.getPath(),false,function(){_18.getEl().scrollChildIntoView(this.ui.anchor);Ext.callback(_17);}.createDelegate(this));},expandChildNodes:function(_19){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].expand(_19);}},collapseChildNodes:function(_1d){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].collapse(_1d);}},disable:function(){this.disabled=true;this.unselect();if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,true);}this.fireEvent(\"disabledchange\",this,true);},enable:function(){this.disabled=false;if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,false);}this.fireEvent(\"disabledchange\",this,false);},renderChildren:function(_21){if(_21!==false){this.fireEvent(\"beforechildrenrendered\",this);}var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].render(true);}this.childrenRendered=true;},sort:function(fn,_26){Ext.tree.TreeNode.superclass.sort.apply(this,arguments);if(this.childrenRendered){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].render(true);}}},render:function(_2a){this.ui.render(_2a);if(!this.rendered){this.rendered=true;if(this.expanded){this.expanded=false;this.expand(false,false);}}},renderIndent:function(_2b,_2c){if(_2c){this.ui.childIndent=null;}this.ui.renderIndent();if(_2b===true&&this.childrenRendered){var cs=this.childNodes;for(var i=0,len=cs.length;i<len;i++){cs[i].renderIndent(true,_2c);}}}});\r\n\r\n\r\n\r\nExt.tree.AsyncTreeNode=function(_1){this.loaded=false;this.loading=false;Ext.tree.AsyncTreeNode.superclass.constructor.apply(this,arguments);this.addEvents({\"beforeload\":true,\"load\":true});};Ext.extend(Ext.tree.AsyncTreeNode,Ext.tree.TreeNode,{expand:function(_2,_3,_4){if(this.loading){var _5;var f=function(){if(!this.loading){clearInterval(_5);this.expand(_2,_3,_4);}}.createDelegate(this);_5=setInterval(f,200);return;}if(!this.loaded){if(this.fireEvent(\"beforeload\",this)===false){return;}this.loading=true;this.ui.beforeLoad(this);var _7=this.loader||this.attributes.loader||this.getOwnerTree().getLoader();if(_7){_7.load(this,this.loadComplete.createDelegate(this,[_2,_3,_4]));return;}}Ext.tree.AsyncTreeNode.superclass.expand.call(this,_2,_3,_4);},isLoading:function(){return this.loading;},loadComplete:function(_8,_9,_a){this.loading=false;this.loaded=true;this.ui.afterLoad(this);this.fireEvent(\"load\",this);this.expand(_8,_9,_a);},isLoaded:function(){return this.loaded;},hasChildNodes:function(){if(!this.isLeaf()&&!this.loaded){return true;}else{return Ext.tree.AsyncTreeNode.superclass.hasChildNodes.call(this);}},reload:function(_b){this.collapse(false,false);while(this.firstChild){this.removeChild(this.firstChild);}this.childrenRendered=false;this.loaded=false;if(this.isHiddenRoot()){this.expanded=false;}this.expand(false,false,_b);}});\r\n\r\n\r\n\r\nExt.tree.TreeNodeUI=function(_1){this.node=_1;this.rendered=false;this.animating=false;this.emptyIcon=Ext.BLANK_IMAGE_URL;};Ext.tree.TreeNodeUI.prototype={removeChild:function(_2){if(this.rendered){this.ctNode.removeChild(_2.ui.getEl());}},beforeLoad:function(){this.addClass(\"x-tree-node-loading\");},afterLoad:function(){this.removeClass(\"x-tree-node-loading\");},onTextChange:function(_3,_4,_5){if(this.rendered){this.textNode.innerHTML=_4;}},onDisableChange:function(_6,_7){this.disabled=_7;if(_7){this.addClass(\"x-tree-node-disabled\");}else{this.removeClass(\"x-tree-node-disabled\");}},onSelectedChange:function(_8){if(_8){this.focus();this.addClass(\"x-tree-selected\");}else{this.removeClass(\"x-tree-selected\");}},onMove:function(_9,_a,_b,_c,_d,_e){this.childIndent=null;if(this.rendered){var _f=_c.ui.getContainer();if(!_f){this.holder=document.createElement(\"div\");this.holder.appendChild(this.wrap);return;}var _10=_e?_e.ui.getEl():null;if(_10){_f.insertBefore(this.wrap,_10);}else{_f.appendChild(this.wrap);}this.node.renderIndent(true);}},addClass:function(cls){if(this.elNode){Ext.fly(this.elNode).addClass(cls);}},removeClass:function(cls){if(this.elNode){Ext.fly(this.elNode).removeClass(cls);}},remove:function(){if(this.rendered){this.holder=document.createElement(\"div\");this.holder.appendChild(this.wrap);}},fireEvent:function(){return this.node.fireEvent.apply(this.node,arguments);},initEvents:function(){this.node.on(\"move\",this.onMove,this);var E=Ext.EventManager;var a=this.anchor;var el=Ext.fly(a);if(Ext.isOpera){el.setStyle(\"text-decoration\",\"none\");}el.on(\"click\",this.onClick,this);el.on(\"dblclick\",this.onDblClick,this);el.on(\"contextmenu\",this.onContextMenu,this);var _16=Ext.fly(this.iconNode);_16.on(\"click\",this.onClick,this);_16.on(\"dblclick\",this.onDblClick,this);_16.on(\"contextmenu\",this.onContextMenu,this);E.on(this.ecNode,\"click\",this.ecClick,this,true);if(this.node.disabled){this.addClass(\"x-tree-node-disabled\");}if(this.node.hidden){this.addClass(\"x-tree-node-disabled\");}var ot=this.node.getOwnerTree();var dd=ot.enableDD||ot.enableDrag||ot.enableDrop;if(dd&&(!this.node.isRoot||ot.rootVisible)){Ext.dd.Registry.register(this.elNode,{node:this.node,handles:[this.iconNode,this.textNode],isHandle:false});}},hide:function(){if(this.rendered){this.wrap.style.display=\"none\";}},show:function(){if(this.rendered){this.wrap.style.display=\"\";}},onContextMenu:function(e){e.preventDefault();this.focus();this.fireEvent(\"contextmenu\",this.node,e);},onClick:function(e){if(this.dropping){return;}if(this.fireEvent(\"beforeclick\",this.node,e)!==false){if(!this.disabled&&this.node.attributes.href){this.fireEvent(\"click\",this.node,e);return;}e.preventDefault();if(this.disabled){return;}if(this.node.attributes.singleClickExpand&&!this.animating&&this.node.hasChildNodes()){this.node.toggle();}this.fireEvent(\"click\",this.node,e);}else{e.stopEvent();}},onDblClick:function(e){e.preventDefault();if(this.disabled){return;}if(!this.animating&&this.node.hasChildNodes()){this.node.toggle();}this.fireEvent(\"dblclick\",this.node,e);},ecClick:function(e){if(!this.animating&&this.node.hasChildNodes()){this.node.toggle();}},startDrop:function(){this.dropping=true;},endDrop:function(){setTimeout(function(){this.dropping=false;}.createDelegate(this),50);},expand:function(){this.updateExpandIcon();this.ctNode.style.display=\"\";},focus:function(){if(!this.node.preventHScroll){try{this.anchor.focus();}catch(e){}}else{if(!Ext.isIE){try{var _1d=this.node.getOwnerTree().el.dom;var l=_1d.scrollLeft;this.anchor.focus();_1d.scrollLeft=l;}catch(e){}}}},blur:function(){try{this.anchor.blur();}catch(e){}},animExpand:function(_1f){var ct=Ext.get(this.ctNode);ct.stopFx();if(!this.node.hasChildNodes()){this.updateExpandIcon();this.ctNode.style.display=\"\";Ext.callback(_1f);return;}this.animating=true;this.updateExpandIcon();ct.slideIn(\"t\",{callback:function(){this.animating=false;Ext.callback(_1f);},scope:this,duration:this.node.ownerTree.duration||0.25});},highlight:function(){var _21=this.node.getOwnerTree();Ext.fly(this.wrap).highlight(_21.hlColor||\"C3DAF9\",{endColor:_21.hlBaseColor});},collapse:function(){this.updateExpandIcon();this.ctNode.style.display=\"none\";},animCollapse:function(_22){var ct=Ext.get(this.ctNode);ct.enableDisplayMode(\"block\");ct.stopFx();this.animating=true;this.updateExpandIcon();ct.slideOut(\"t\",{callback:function(){this.animating=false;Ext.callback(_22);},scope:this,duration:this.node.ownerTree.duration||0.25});},getContainer:function(){return this.ctNode;},getEl:function(){return this.wrap;},appendDDGhost:function(_24){_24.appendChild(this.elNode.cloneNode(true));},getDDRepairXY:function(){return Ext.lib.Dom.getXY(this.iconNode);},onRender:function(){this.render();},render:function(_25){var n=this.node;var _27=n.parentNode?n.parentNode.ui.getContainer():n.ownerTree.container.dom;if(!this.rendered){this.rendered=true;var a=n.attributes;this.indentMarkup=\"\";if(n.parentNode){this.indentMarkup=n.parentNode.ui.getChildIndent();}var buf=[\"<li class=\\\"x-tree-node\\\"><div class=\\\"x-tree-node-el \",n.attributes.cls,\"\\\">\",\"<span class=\\\"x-tree-node-indent\\\">\",this.indentMarkup,\"</span>\",\"<img src=\\\"\",this.emptyIcon,\"\\\" class=\\\"x-tree-ec-icon\\\">\",\"<img src=\\\"\",a.icon||this.emptyIcon,\"\\\" class=\\\"x-tree-node-icon\",(a.icon?\" x-tree-node-inline-icon\":\"\"),(a.iconCls?\" \"+a.iconCls:\"\"),\"\\\" unselectable=\\\"on\\\">\",\"<a hidefocus=\\\"on\\\" href=\\\"\",a.href?a.href:\"#\",\"\\\" tabIndex=\\\"1\\\" \",a.hrefTarget?\" target=\\\"\"+a.hrefTarget+\"\\\"\":\"\",\"><span unselectable=\\\"on\\\">\",n.text,\"</span></a></div>\",\"<ul class=\\\"x-tree-node-ct\\\" style=\\\"display:none;\\\"></ul>\",\"</li>\"];if(_25!==true&&n.nextSibling&&n.nextSibling.ui.getEl()){this.wrap=Ext.DomHelper.insertHtml(\"beforeBegin\",n.nextSibling.ui.getEl(),buf.join(\"\"));}else{this.wrap=Ext.DomHelper.insertHtml(\"beforeEnd\",_27,buf.join(\"\"));}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var cs=this.elNode.childNodes;this.indentNode=cs[0];this.ecNode=cs[1];this.iconNode=cs[2];this.anchor=cs[3];this.textNode=cs[3].firstChild;if(a.qtip){if(this.textNode.setAttributeNS){this.textNode.setAttributeNS(\"ext\",\"qtip\",a.qtip);if(a.qtipTitle){this.textNode.setAttributeNS(\"ext\",\"qtitle\",a.qtipTitle);}}else{this.textNode.setAttribute(\"ext:qtip\",a.qtip);if(a.qtipTitle){this.textNode.setAttribute(\"ext:qtitle\",a.qtipTitle);}}}this.initEvents();if(!this.node.expanded){this.updateExpandIcon();}}else{if(_25===true){_27.appendChild(this.wrap);}}},getAnchor:function(){return this.anchor;},getTextEl:function(){return this.textNode;},getIconEl:function(){return this.iconNode;},updateExpandIcon:function(){if(this.rendered){var n=this.node,c1,c2;var cls=n.isLast()?\"x-tree-elbow-end\":\"x-tree-elbow\";var _2f=n.hasChildNodes();if(_2f){if(n.expanded){cls+=\"-minus\";c1=\"x-tree-node-collapsed\";c2=\"x-tree-node-expanded\";}else{cls+=\"-plus\";c1=\"x-tree-node-expanded\";c2=\"x-tree-node-collapsed\";}if(this.wasLeaf){this.removeClass(\"x-tree-node-leaf\");this.wasLeaf=false;}if(this.c1!=c1||this.c2!=c2){Ext.fly(this.elNode).replaceClass(c1,c2);this.c1=c1;this.c2=c2;}}else{if(!this.wasLeaf){Ext.fly(this.elNode).replaceClass(\"x-tree-node-expanded\",\"x-tree-node-leaf\");this.wasLeaf=true;}}var ecc=\"x-tree-ec-icon \"+cls;if(this.ecc!=ecc){this.ecNode.className=ecc;this.ecc=ecc;}}},getChildIndent:function(){if(!this.childIndent){var buf=[];var p=this.node;while(p){if(!p.isRoot||(p.isRoot&&p.ownerTree.rootVisible)){if(!p.isLast()){buf.unshift(\"<img src=\\\"\"+this.emptyIcon+\"\\\" class=\\\"x-tree-elbow-line\\\">\");}else{buf.unshift(\"<img src=\\\"\"+this.emptyIcon+\"\\\" class=\\\"x-tree-icon\\\">\");}}p=p.parentNode;}this.childIndent=buf.join(\"\");}return this.childIndent;},renderIndent:function(){if(this.rendered){var _33=\"\";var p=this.node.parentNode;if(p){_33=p.ui.getChildIndent();}if(this.indentMarkup!=_33){this.indentNode.innerHTML=_33;this.indentMarkup=_33;}this.updateExpandIcon();}}};Ext.tree.RootTreeNodeUI=function(){Ext.tree.RootTreeNodeUI.superclass.constructor.apply(this,arguments);};Ext.extend(Ext.tree.RootTreeNodeUI,Ext.tree.TreeNodeUI,{render:function(){if(!this.rendered){var _35=this.node.ownerTree.container.dom;this.node.expanded=true;_35.innerHTML=\"<div class=\\\"x-tree-root-node\\\"></div>\";this.wrap=this.ctNode=_35.firstChild;}},collapse:function(){},expand:function(){}});\r\n\r\n\r\n\r\nExt.tree.TreeLoader=function(_1){this.baseParams={};this.requestMethod=\"POST\";Ext.apply(this,_1);this.addEvents({\"beforeload\":true,\"load\":true,\"loadexception\":true});};Ext.extend(Ext.tree.TreeLoader,Ext.util.Observable,{uiProviders:{},clearOnLoad:true,load:function(_2,_3){if(this.clearOnLoad){while(_2.firstChild){_2.removeChild(_2.firstChild);}}if(_2.attributes.children){var cs=_2.attributes.children;for(var i=0,_6=cs.length;i<_6;i++){_2.appendChild(this.createNode(cs[i]));}if(typeof _3==\"function\"){_3();}}else{if(this.dataUrl){this.requestData(_2,_3);}}},getParams:function(_7){var _8=[],bp=this.baseParams;for(var _a in bp){if(typeof bp[_a]!=\"function\"){_8.push(encodeURIComponent(_a),\"=\",encodeURIComponent(bp[_a]),\"&\");}}_8.push(\"node=\",encodeURIComponent(_7.id));return _8.join(\"\");},requestData:function(_b,_c){if(this.fireEvent(\"beforeload\",this,_b,_c)!==false){var _d=this.getParams(_b);var cb={success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:_c,node:_b}};this.transId=Ext.lib.Ajax.request(this.requestMethod,this.dataUrl,cb,_d);}else{if(typeof _c==\"function\"){_c();}}},isLoading:function(){return this.transId?true:false;},abort:function(){if(this.isLoading()){Ext.lib.Ajax.abort(this.transId);}},createNode:function(_f){if(this.applyLoader!==false){_f.loader=this;}if(typeof _f.uiProvider==\"string\"){_f.uiProvider=this.uiProviders[_f.uiProvider]||eval(_f.uiProvider);}return (_f.leaf?new Ext.tree.TreeNode(_f):new Ext.tree.AsyncTreeNode(_f));},processResponse:function(_10,_11,_12){var _13=_10.responseText;try{var o=eval(\"(\"+_13+\")\");for(var i=0,len=o.length;i<len;i++){var n=this.createNode(o[i]);if(n){_11.appendChild(n);}}if(typeof _12==\"function\"){_12(this,_11);}}catch(e){this.handleFailure(_10);}},handleResponse:function(_18){this.transId=false;var a=_18.argument;this.processResponse(_18,a.node,a.callback);this.fireEvent(\"load\",this,a.node,_18);},handleFailure:function(_1a){this.transId=false;var a=_1a.argument;this.fireEvent(\"loadexception\",this,a.node,_1a);if(typeof a.callback==\"function\"){a.callback(this,a.node);}}});\r\n\r\n\r\n\r\nExt.tree.TreeFilter=function(_1,_2){this.tree=_1;this.filtered={};Ext.apply(this,_2,{clearBlank:false,reverse:false,autoClear:false,remove:false});};Ext.tree.TreeFilter.prototype={filter:function(_3,_4,_5){_4=_4||\"text\";var f;if(typeof _3==\"string\"){var _7=_3.length;if(_7==0&&this.clearBlank){this.clearFilter();return;}_3=_3.toLowerCase();f=function(n){return n.attributes[_4].substr(0,_7).toLowerCase()==_3;};}else{if(_3.exec){f=function(n){return _3.test(n.attributes[_4]);};}else{throw \"Illegal filter type, must be string or regex\";}}this.filterBy(f,null,_5);},filterBy:function(fn,_b,_c){_c=_c||this.tree.root;if(this.autoClear){this.clearFilter();}var af=this.filtered,rv=this.reverse;var f=function(n){if(n==_c){return true;}if(af[n.id]){return false;}var m=fn.call(_b||n,n);if(!m||rv){af[n.id]=n;n.ui.hide();return false;}return true;};_c.cascade(f);if(this.remove){for(var id in af){if(typeof id!=\"function\"){var n=af[id];if(n&&n.parentNode){n.parentNode.removeChild(n);}}}}},clear:function(){var t=this.tree;var af=this.filtered;for(var id in af){if(typeof id!=\"function\"){var n=af[id];if(n){n.ui.show();}}}this.filtered={};}};\r\n\r\n\r\n\r\nExt.tree.TreeSorter=function(_1,_2){Ext.apply(this,_2);_1.on(\"beforechildrenrendered\",this.doSort,this);_1.on(\"append\",this.updateSort,this);_1.on(\"insert\",this.updateSort,this);var _3=this.dir&&this.dir.toLowerCase()==\"desc\";var p=this.property||\"text\";var _5=this.sortType;var fs=this.folderSort;var cs=this.caseSensitive===true;var _8=this.leafAttr||\"leaf\";this.sortFn=function(n1,n2){if(fs){if(n1.attributes[_8]&&!n2.attributes[_8]){return 1;}if(!n1.attributes[_8]&&n2.attributes[_8]){return -1;}}var v1=_5?_5(n1):(cs?n1[p]:n1[p].toUpperCase());var v2=_5?_5(n2):(cs?n2[p]:n2[p].toUpperCase());if(v1<v2){return _3?+1:-1;}else{if(v1>v2){return _3?-1:+1;}else{return 0;}}};};Ext.tree.TreeSorter.prototype={doSort:function(_d){_d.sort(this.sortFn);},compareNodes:function(n1,n2){return (n1.text.toUpperCase()>n2.text.toUpperCase()?1:-1);},updateSort:function(_10,_11){if(_11.childrenRendered){this.doSort.defer(1,this,[_11]);}}};\r\n\r\n\r\n\r\nif(Ext.dd.DropZone){Ext.tree.TreeDropZone=function(_1,_2){this.allowParentInsert=false;this.allowContainerDrop=false;this.appendOnly=false;Ext.tree.TreeDropZone.superclass.constructor.call(this,_1.container,_2);this.tree=_1;this.lastInsertClass=\"x-tree-no-status\";this.dragOverData={};};Ext.extend(Ext.tree.TreeDropZone,Ext.dd.DropZone,{ddGroup:\"TreeDD\",expandDelay:1000,expandNode:function(_3){if(_3.hasChildNodes()&&!_3.isExpanded()){_3.expand(false,null,this.triggerCacheRefresh.createDelegate(this));}},queueExpand:function(_4){this.expandProcId=this.expandNode.defer(this.expandDelay,this,[_4]);},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId);this.expandProcId=false;}},isValidDropPoint:function(n,pt,dd,e,_9){if(!n||!_9){return false;}var _a=n.node;var _b=_9.node;if(!(_a&&_a.isTarget&&pt)){return false;}if(pt==\"append\"&&_a.allowChildren===false){return false;}if((pt==\"above\"||pt==\"below\")&&(_a.parentNode&&_a.parentNode.allowChildren===false)){return false;}if(_b&&(_a==_b||_b.contains(_a))){return false;}var _c=this.dragOverData;_c.tree=this.tree;_c.target=_a;_c.data=_9;_c.point=pt;_c.source=dd;_c.rawEvent=e;_c.dropNode=_b;_c.cancel=false;var _d=this.tree.fireEvent(\"nodedragover\",_c);return _c.cancel===false&&_d!==false;},getDropPoint:function(e,n,dd){var tn=n.node;if(tn.isRoot){return tn.allowChildren!==false?\"append\":false;}var _12=n.ddel;var t=Ext.lib.Dom.getY(_12),b=t+_12.offsetHeight;var y=Ext.lib.Event.getPageY(e);var _16=tn.allowChildren===false||tn.isLeaf();if(this.appendOnly||tn.parentNode.allowChildren===false){return _16?false:\"append\";}var _17=false;if(!this.allowParentInsert){_17=tn.hasChildNodes()&&tn.isExpanded();}var q=(b-t)/(_16?2:3);if(y>=t&&y<(t+q)){return \"above\";}else{if(!_17&&(_16||y>=b-q&&y<=b)){return \"below\";}else{return \"append\";}}},onNodeEnter:function(n,dd,e,_1c){this.cancelExpand();},onNodeOver:function(n,dd,e,_20){var pt=this.getDropPoint(e,n,dd);var _22=n.node;if(!this.expandProcId&&pt==\"append\"&&_22.hasChildNodes()&&!n.node.isExpanded()){this.queueExpand(_22);}else{if(pt!=\"append\"){this.cancelExpand();}}var _23=this.dropNotAllowed;if(this.isValidDropPoint(n,pt,dd,e,_20)){if(pt){var el=n.ddel;var cls;if(pt==\"above\"){_23=n.node.isFirst()?\"x-tree-drop-ok-above\":\"x-tree-drop-ok-between\";cls=\"x-tree-drag-insert-above\";}else{if(pt==\"below\"){_23=n.node.isLast()?\"x-tree-drop-ok-below\":\"x-tree-drop-ok-between\";cls=\"x-tree-drag-insert-below\";}else{_23=\"x-tree-drop-ok-append\";cls=\"x-tree-drag-append\";}}if(this.lastInsertClass!=cls){Ext.fly(el).replaceClass(this.lastInsertClass,cls);this.lastInsertClass=cls;}}}return _23;},onNodeOut:function(n,dd,e,_29){this.cancelExpand();this.removeDropIndicators(n);},onNodeDrop:function(n,dd,e,_2d){var _2e=this.getDropPoint(e,n,dd);var _2f=n.node;_2f.ui.startDrop();if(!this.isValidDropPoint(n,_2e,dd,e,_2d)){_2f.ui.endDrop();return false;}var _30=_2d.node||(dd.getTreeNode?dd.getTreeNode(_2d,_2f,_2e,e):null);var _31={tree:this.tree,target:_2f,data:_2d,point:_2e,source:dd,rawEvent:e,dropNode:_30,cancel:!_30};var _32=this.tree.fireEvent(\"beforenodedrop\",_31);if(_32===false||_31.cancel===true||!_31.dropNode){_2f.ui.endDrop();return false;}_2f=_31.target;if(_2e==\"append\"&&!_2f.isExpanded()){_2f.expand(false,null,function(){this.completeDrop(_31);}.createDelegate(this));}else{this.completeDrop(_31);}return true;},completeDrop:function(de){var ns=de.dropNode,p=de.point,t=de.target;if(!(ns instanceof Array)){ns=[ns];}var n;for(var i=0,len=ns.length;i<len;i++){n=ns[i];if(p==\"above\"){t.parentNode.insertBefore(n,t);}else{if(p==\"below\"){t.parentNode.insertBefore(n,t.nextSibling);}else{t.appendChild(n);}}}n.ui.focus();if(this.tree.hlDrop){n.ui.highlight();}t.ui.endDrop();this.tree.fireEvent(\"nodedrop\",de);},afterNodeMoved:function(dd,_3b,e,_3d,_3e){if(this.tree.hlDrop){_3e.ui.focus();_3e.ui.highlight();}this.tree.fireEvent(\"nodedrop\",this.tree,_3d,_3b,dd,e);},getTree:function(){return this.tree;},removeDropIndicators:function(n){if(n&&n.ddel){var el=n.ddel;Ext.fly(el).removeClass([\"x-tree-drag-insert-above\",\"x-tree-drag-insert-below\",\"x-tree-drag-append\"]);this.lastInsertClass=\"_noclass\";}},beforeDragDrop:function(_41,e,id){this.cancelExpand();return true;},afterRepair:function(_44){if(_44&&Ext.enableFx){_44.node.ui.highlight();}this.hideProxy();}});}\r\n\r\n\r\n\r\nif(Ext.dd.DragZone){Ext.tree.TreeDragZone=function(_1,_2){Ext.tree.TreeDragZone.superclass.constructor.call(this,_1.getEl(),_2);this.tree=_1;};Ext.extend(Ext.tree.TreeDragZone,Ext.dd.DragZone,{ddGroup:\"TreeDD\",onBeforeDrag:function(_3,e){var n=_3.node;return n&&n.draggable&&!n.disabled;},onInitDrag:function(e){var _7=this.dragData;this.tree.getSelectionModel().select(_7.node);this.proxy.update(\"\");_7.node.ui.appendDDGhost(this.proxy.ghost.dom);this.tree.fireEvent(\"startdrag\",this.tree,_7.node,e);},getRepairXY:function(e,_9){return _9.node.ui.getDDRepairXY();},onEndDrag:function(_a,e){this.tree.fireEvent(\"enddrag\",this.tree,_a.node,e);},onValidDrop:function(dd,e,id){this.tree.fireEvent(\"dragdrop\",this.tree,this.dragData.node,dd,e);this.hideProxy();},beforeInvalidDrop:function(e,id){var sm=this.tree.getSelectionModel();sm.clearSelections();sm.select(this.dragData.node);}});}\r\n\r\n\r\n\r\nExt.tree.TreeEditor=function(_1,_2){_2=_2||{};var _3=_2.events?_2:new Ext.form.TextField(_2);Ext.tree.TreeEditor.superclass.constructor.call(this,_3);this.tree=_1;_1.on(\"beforeclick\",this.beforeNodeClick,this);_1.el.on(\"mousedown\",this.hide,this);this.on(\"complete\",this.updateNode,this);this.on(\"beforestartedit\",this.fitToTree,this);this.on(\"startedit\",this.bindScroll,this,{delay:10});this.on(\"specialkey\",this.onSpecialKey,this);};Ext.extend(Ext.tree.TreeEditor,Ext.Editor,{alignment:\"l-l\",autoSize:false,hideEl:false,cls:\"x-small-editor x-tree-editor\",shim:false,shadow:\"frame\",maxWidth:250,fitToTree:function(ed,el){var td=this.tree.el.dom,nd=el.dom;if(td.scrollLeft>nd.offsetLeft){td.scrollLeft=nd.offsetLeft;}var w=Math.min(this.maxWidth,(td.clientWidth>20?td.clientWidth:td.offsetWidth)-Math.max(0,nd.offsetLeft-td.scrollLeft)-5);this.setSize(w,\"\");},triggerEdit:function(_9){this.completeEdit();this.editNode=_9;this.startEdit(_9.ui.textNode,_9.text);},bindScroll:function(){this.tree.el.on(\"scroll\",this.cancelEdit,this);},beforeNodeClick:function(_a){if(this.tree.getSelectionModel().isSelected(_a)){this.triggerEdit(_a);return false;}},updateNode:function(ed,_c){this.tree.el.un(\"scroll\",this.cancelEdit,this);this.editNode.setText(_c);},onSpecialKey:function(_d,e){var k=e.getKey();if(k==e.ESC){this.cancelEdit();e.stopEvent();}else{if(k==e.ENTER&&!e.hasModifier()){this.completeEdit();e.stopEvent();}}}});\r\n\r\n\r\n\r\nExt.form.Field=function(_1){Ext.form.Field.superclass.constructor.call(this,_1);this.addEvents({focus:true,blur:true,specialkey:true,change:true,invalid:true,valid:true});};Ext.extend(Ext.form.Field,Ext.Component,{invalidClass:\"x-form-invalid\",invalidText:\"The value in this field is invalid\",focusClass:\"x-form-focus\",validationEvent:\"keyup\",validateOnBlur:true,validationDelay:250,defaultAutoCreate:{tag:\"input\",type:\"text\",size:\"20\",autocomplete:\"off\"},fieldClass:\"x-form-field\",msgTarget:\"qtip\",msgFx:\"normal\",inputType:undefined,isFormField:true,hasFocus:false,value:undefined,getName:function(){return this.rendered&&this.el.dom.name?this.el.dom.name:(this.hiddenName||\"\");},applyTo:function(_2){this.target=_2;this.el=Ext.get(_2);this.render(this.el.dom.parentNode);return this;},onRender:function(ct,_4){if(this.el){this.el=Ext.get(this.el);if(!this.target){ct.dom.appendChild(this.el.dom);}}else{var _5=this.getAutoCreate();if(!_5.name){_5.name=this.name||this.id;}if(this.inputType){_5.type=this.inputType;}if(this.tabIndex!==undefined){_5.tabIndex=this.tabIndex;}this.el=ct.createChild(_5,_4);}var _6=this.el.dom.type;if(_6){if(_6==\"password\"){_6=\"text\";}this.el.addClass(\"x-form-\"+_6);}if(!this.customSize&&(this.width||this.height)){this.setSize(this.width||\"\",this.height||\"\");}if(this.readOnly){this.el.dom.readOnly=true;}this.el.addClass([this.fieldClass,this.cls]);this.initValue();},initValue:function(){if(this.value!==undefined){this.setValue(this.value);}else{if(this.el.dom.value.length>0){this.setValue(this.el.dom.value);}}},afterRender:function(){Ext.form.Field.superclass.afterRender.call(this);this.initEvents();},fireKey:function(e){if(e.isNavKeyPress()){this.fireEvent(\"specialkey\",this,e);}},reset:function(){this.setValue(this.originalValue);this.clearInvalid();},initEvents:function(){this.el.on(Ext.isIE?\"keydown\":\"keypress\",this.fireKey,this);this.el.on(\"focus\",this.onFocus,this);this.el.on(\"blur\",this.onBlur,this);this.originalValue=this.getValue();},onFocus:function(){if(!Ext.isOpera){this.el.addClass(this.focusClass);}this.hasFocus=true;this.startValue=this.getValue();this.fireEvent(\"focus\",this);},onBlur:function(){this.el.removeClass(this.focusClass);this.hasFocus=false;if(this.validationEvent!==false&&this.validateOnBlur&&this.validationEvent!=\"blur\"){this.validate();}var v=this.getValue();if(v!=this.startValue){this.fireEvent(\"change\",this,v,this.startValue);}this.fireEvent(\"blur\",this);},setSize:function(w,h){if(!this.rendered||!this.el){this.width=w;this.height=h;return;}if(w){w=this.adjustWidth(this.el.dom.tagName,w);this.el.setWidth(w);}if(h){this.el.setHeight(h);}var h=this.el.dom.offsetHeight;},isValid:function(_b){if(this.disabled){return true;}var _c=this.preventMark;this.preventMark=_b===true;var v=this.validateValue(this.getRawValue());this.preventMark=_c;return v;},validate:function(){if(this.disabled||this.validateValue(this.getRawValue())){this.clearInvalid();return true;}return false;},validateValue:function(_e){return true;},markInvalid:function(_f){if(!this.rendered||this.preventMark){return;}this.el.addClass(this.invalidClass);_f=_f||this.invalidText;switch(this.msgTarget){case \"qtip\":this.el.dom.qtip=_f;this.el.dom.qclass=\"x-form-invalid-tip\";break;case \"title\":this.el.dom.title=_f;break;case \"under\":if(!this.errorEl){var elp=this.el.findParent(\".x-form-element\",5,true);this.errorEl=elp.createChild({cls:\"x-form-invalid-msg\"});this.errorEl.setWidth(elp.getWidth(true)-20);}this.errorEl.update(_f);Ext.form.Field.msgFx[this.msgFx].show(this.errorEl,this);break;case \"side\":if(!this.errorIcon){var elp=this.el.findParent(\".x-form-element\",5,true);this.errorIcon=elp.createChild({cls:\"x-form-invalid-icon\"});}this.alignErrorIcon();this.errorIcon.dom.qtip=_f;this.errorIcon.dom.qclass=\"x-form-invalid-tip\";this.errorIcon.show();break;default:var t=Ext.getDom(this.msgTarget);t.innerHTML=_f;t.style.display=this.msgDisplay;break;}this.fireEvent(\"invalid\",this,_f);},alignErrorIcon:function(){this.errorIcon.alignTo(this.el,\"tl-tr\",[2,0]);},clearInvalid:function(){if(!this.rendered||this.preventMark){return;}this.el.removeClass(this.invalidClass);switch(this.msgTarget){case \"qtip\":this.el.dom.qtip=\"\";break;case \"title\":this.el.dom.title=\"\";break;case \"under\":if(this.errorEl){Ext.form.Field.msgFx[this.msgFx].hide(this.errorEl,this);}break;case \"side\":if(this.errorIcon){this.errorIcon.dom.qtip=\"\";this.errorIcon.hide();}break;default:var t=Ext.getDom(this.msgTarget);t.innerHTML=\"\";t.style.display=\"none\";break;}this.fireEvent(\"valid\",this);},getRawValue:function(){return this.el.getValue();},getValue:function(){var v=this.el.getValue();if(v==this.emptyText||v===undefined){v=\"\";}return v;},setRawValue:function(v){return this.el.dom.value=v;},setValue:function(v){this.value=v;if(this.rendered){this.el.dom.value=v;this.validate();}},adjustWidth:function(tag,w){tag=tag.toLowerCase();if(typeof w==\"number\"&&Ext.isStrict&&!Ext.isSafari){if(Ext.isIE&&(tag==\"input\"||tag==\"textarea\")){if(tag==\"input\"){return w+2;}if(tag=\"textarea\"){return w-2;}}else{if(Ext.isGecko&&tag==\"textarea\"){return w-6;}else{if(Ext.isOpera){if(tag==\"input\"){return w+2;}if(tag=\"textarea\"){return w-2;}}}}}return w;}});Ext.form.Field.msgFx={normal:{show:function(_18,f){_18.setDisplayed(\"block\");},hide:function(_1a,f){_1a.setDisplayed(false).update(\"\");}},slide:{show:function(_1c,f){_1c.slideIn(\"t\",{stopFx:true});},hide:function(_1e,f){_1e.slideOut(\"t\",{stopFx:true,useDisplay:true});}},slideRight:{show:function(_20,f){_20.fixDisplay();_20.alignTo(f.el,\"tl-tr\");_20.slideIn(\"l\",{stopFx:true});},hide:function(_22,f){_22.slideOut(\"l\",{stopFx:true,useDisplay:true});}}};\r\n\r\n\r\n\r\nExt.form.TextField=function(_1){Ext.form.TextField.superclass.constructor.call(this,_1);this.addEvents({autosize:true});};Ext.extend(Ext.form.TextField,Ext.form.Field,{grow:false,growMin:30,growMax:800,vtype:null,maskRe:null,disableKeyFilter:false,allowBlank:true,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:\"The minimum length for this field is {0}\",maxLengthText:\"The maximum length for this field is {0}\",selectOnFocus:false,blankText:\"This field is required\",validator:null,regex:null,regexText:\"\",emptyText:null,emptyClass:\"x-form-empty-field\",initEvents:function(){Ext.form.TextField.superclass.initEvents.call(this);if(this.validationEvent==\"keyup\"){this.validationTask=new Ext.util.DelayedTask(this.validate,this);this.el.on(\"keyup\",this.filterValidation,this);}else{if(this.validationEvent!==false){this.el.on(this.validationEvent,this.validate,this,{buffer:this.validationDelay});}}if(this.selectOnFocus||this.emptyText){this.on(\"focus\",this.preFocus,this);if(this.emptyText){this.on(\"blur\",this.postBlur,this);this.applyEmptyText();}}if(this.maskRe||(this.vtype&&this.disableKeyFilter!==true&&(this.maskRe=Ext.form.VTypes[this.vtype+\"Mask\"]))){this.el.on(\"keypress\",this.filterKeys,this);}if(this.grow){this.el.on(\"keyup\",this.onKeyUp,this,{buffer:50});this.el.on(\"click\",this.autoSize,this);}},filterValidation:function(e){if(!e.isNavKeyPress()){this.validationTask.delay(this.validationDelay);}},onKeyUp:function(e){if(!e.isNavKeyPress()){this.autoSize();}},reset:function(){Ext.form.TextField.superclass.reset.call(this);this.applyEmptyText();},applyEmptyText:function(){if(this.rendered&&this.emptyText&&this.getRawValue().length<1){this.setRawValue(this.emptyText);this.el.addClass(this.emptyClass);}},preFocus:function(){if(this.emptyText){if(this.getRawValue()==this.emptyText){this.setRawValue(\"\");}this.el.removeClass(this.emptyClass);}if(this.selectOnFocus){this.el.dom.select();}},postBlur:function(){this.applyEmptyText();},filterKeys:function(e){var k=e.getKey();if(!Ext.isIE&&(e.isNavKeyPress()||k==e.BACKSPACE||(k==e.DELETE&&e.button==-1))){return;}var c=e.getCharCode();if(!this.maskRe.test(String.fromCharCode(c)||\"\")){e.stopEvent();}},setValue:function(v){if(this.emptyText&&v!==undefined&&v!==null&&v!==\"\"){this.el.removeClass(this.emptyClass);}Ext.form.TextField.superclass.setValue.apply(this,arguments);},validateValue:function(_8){if(_8.length<1||_8===this.emptyText){if(this.allowBlank){this.clearInvalid();return true;}else{this.markInvalid(this.blankText);return false;}}if(_8.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false;}if(_8.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false;}if(this.vtype){var vt=Ext.form.VTypes;if(!vt[this.vtype](_8)){this.markInvalid(this.vtypeText||vt[this.vtype+\"Text\"]);return false;}}if(typeof this.validator==\"function\"){var _a=this.validator(_8);if(_a!==true){this.markInvalid(_a);return false;}}if(this.regex&&!this.regex.test(_8)){this.markInvalid(this.regexText);return false;}return true;},selectText:function(_b,_c){var v=this.getRawValue();if(v.length>0){_b=_b===undefined?0:_b;_c=_c===undefined?v.length:_c;var d=this.el.dom;if(d.setSelectionRange){d.setSelectionRange(_b,_c);}else{if(d.createTextRange){var _f=d.createTextRange();_f.moveStart(\"character\",_b);_f.moveEnd(\"character\",v.length-_c);_f.select();}}}},autoSize:function(){if(!this.grow||!this.rendered){return;}if(!this.metrics){this.metrics=Ext.util.TextMetrics.createInstance(this.el);}var el=this.el;var v=el.dom.value+\"&#160;\";var w=Math.min(this.growMax,Math.max(this.metrics.getWidth(v)+10,this.growMin));this.el.setWidth(w);this.fireEvent(\"autosize\",this,w);}});\r\n\r\n","fotorama/fotorama.js":"/*!\r\n * Fotorama 4.6.4 | http://fotorama.io/license/\r\n */\r\nfotoramaVersion = '4.6.4';\r\n(function (window, document, location, $, undefined) {\r\n    \"use strict\";\r\n    var _fotoramaClass = 'fotorama',\r\n        _fullscreenClass = 'fotorama__fullscreen',\r\n\r\n        wrapClass = _fotoramaClass + '__wrap',\r\n        wrapCss2Class = wrapClass + '--css2',\r\n        wrapCss3Class = wrapClass + '--css3',\r\n        wrapVideoClass = wrapClass + '--video',\r\n        wrapFadeClass = wrapClass + '--fade',\r\n        wrapSlideClass = wrapClass + '--slide',\r\n        wrapNoControlsClass = wrapClass + '--no-controls',\r\n        wrapNoShadowsClass = wrapClass + '--no-shadows',\r\n        wrapPanYClass = wrapClass + '--pan-y',\r\n        wrapRtlClass = wrapClass + '--rtl',\r\n        wrapOnlyActiveClass = wrapClass + '--only-active',\r\n        wrapNoCaptionsClass = wrapClass + '--no-captions',\r\n        wrapToggleArrowsClass = wrapClass + '--toggle-arrows',\r\n\r\n        stageClass = _fotoramaClass + '__stage',\r\n        stageFrameClass = stageClass + '__frame',\r\n        stageFrameVideoClass = stageFrameClass + '--video',\r\n        stageShaftClass = stageClass + '__shaft',\r\n\r\n        grabClass = _fotoramaClass + '__grab',\r\n        pointerClass = _fotoramaClass + '__pointer',\r\n\r\n        arrClass = _fotoramaClass + '__arr',\r\n        arrDisabledClass = arrClass + '--disabled',\r\n        arrPrevClass = arrClass + '--prev',\r\n        arrNextClass = arrClass + '--next',\r\n\r\n        navClass = _fotoramaClass + '__nav',\r\n        navWrapClass = navClass + '-wrap',\r\n        navShaftClass = navClass + '__shaft',\r\n        navShaftVerticalClass = navWrapClass + '--vertical',\r\n        navShaftListClass = navWrapClass + '--list',\r\n        navShafthorizontalClass = navWrapClass + '--horizontal',\r\n        navDotsClass = navClass + '--dots',\r\n        navThumbsClass = navClass + '--thumbs',\r\n        navFrameClass = navClass + '__frame',\r\n\r\n        fadeClass = _fotoramaClass + '__fade',\r\n        fadeFrontClass = fadeClass + '-front',\r\n        fadeRearClass = fadeClass + '-rear',\r\n\r\n        shadowClass = _fotoramaClass + '__shadow',\r\n        shadowsClass = shadowClass + 's',\r\n        shadowsLeftClass = shadowsClass + '--left',\r\n        shadowsRightClass = shadowsClass + '--right',\r\n        shadowsTopClass = shadowsClass + '--top',\r\n        shadowsBottomClass = shadowsClass + '--bottom',\r\n\r\n        activeClass = _fotoramaClass + '__active',\r\n        selectClass = _fotoramaClass + '__select',\r\n\r\n        hiddenClass = _fotoramaClass + '--hidden',\r\n\r\n        fullscreenClass = _fotoramaClass + '--fullscreen',\r\n        fullscreenIconClass = _fotoramaClass + '__fullscreen-icon',\r\n\r\n        errorClass = _fotoramaClass + '__error',\r\n        loadingClass = _fotoramaClass + '__loading',\r\n        loadedClass = _fotoramaClass + '__loaded',\r\n        loadedFullClass = loadedClass + '--full',\r\n        loadedImgClass = loadedClass + '--img',\r\n\r\n        grabbingClass = _fotoramaClass + '__grabbing',\r\n\r\n        imgClass = _fotoramaClass + '__img',\r\n        imgFullClass = imgClass + '--full',\r\n\r\n        thumbClass = _fotoramaClass + '__thumb',\r\n        thumbArrLeft = thumbClass + '__arr--left',\r\n        thumbArrRight = thumbClass + '__arr--right',\r\n        thumbBorderClass = thumbClass + '-border',\r\n\r\n        htmlClass = _fotoramaClass + '__html',\r\n\r\n        videoContainerClass = _fotoramaClass + '-video-container',\r\n        videoClass = _fotoramaClass + '__video',\r\n        videoPlayClass = videoClass + '-play',\r\n        videoCloseClass = videoClass + '-close',\r\n\r\n\r\n        horizontalImageClass = _fotoramaClass + '_horizontal_ratio',\r\n        verticalImageClass = _fotoramaClass + '_vertical_ratio',\r\n        fotoramaSpinnerClass = _fotoramaClass + '__spinner',\r\n        spinnerShowClass = fotoramaSpinnerClass + '--show';\r\n    var JQUERY_VERSION = $ && $.fn.jquery.split('.');\r\n\r\n    if (!JQUERY_VERSION\r\n        || JQUERY_VERSION[0] < 1\r\n        || (JQUERY_VERSION[0] == 1 && JQUERY_VERSION[1] < 8)) {\r\n        throw 'Fotorama requires jQuery 1.8 or later and will not run without it.';\r\n    }\r\n\r\n    var _ = {};\r\n    /* Modernizr 2.8.3 (Custom Build) | MIT & BSD\r\n     * Build: http://modernizr.com/download/#-csstransforms3d-csstransitions-touch-prefixed\r\n     */\r\n\r\n    var Modernizr = (function (window, document, undefined) {\r\n        var version = '2.8.3',\r\n            Modernizr = {},\r\n\r\n\r\n            docElement = document.documentElement,\r\n\r\n            mod = 'modernizr',\r\n            modElem = document.createElement(mod),\r\n            mStyle = modElem.style,\r\n            inputElem,\r\n\r\n\r\n            toString = {}.toString,\r\n\r\n            prefixes = ' -webkit- -moz- -o- -ms- '.split(' '),\r\n\r\n\r\n            omPrefixes = 'Webkit Moz O ms',\r\n\r\n            cssomPrefixes = omPrefixes.split(' '),\r\n\r\n            domPrefixes = omPrefixes.toLowerCase().split(' '),\r\n\r\n\r\n            tests = {},\r\n            inputs = {},\r\n            attrs = {},\r\n\r\n            classes = [],\r\n\r\n            slice = classes.slice,\r\n\r\n            featureName,\r\n\r\n\r\n            injectElementWithStyles = function (rule, callback, nodes, testnames) {\r\n\r\n                var style, ret, node, docOverflow,\r\n                    div = document.createElement('div'),\r\n                    body = document.body,\r\n                    fakeBody = body || document.createElement('body');\r\n\r\n                if (parseInt(nodes, 10)) {\r\n                    while (nodes--) {\r\n                        node = document.createElement('div');\r\n                        node.id = testnames ? testnames[nodes] : mod + (nodes + 1);\r\n                        div.appendChild(node);\r\n                    }\r\n                }\r\n\r\n                style = ['&#173;', '<style id=\"s', mod, '\">', rule, '</style>'].join('');\r\n                div.id = mod;\r\n                (body ? div : fakeBody).innerHTML += style;\r\n                fakeBody.appendChild(div);\r\n                if (!body) {\r\n                    fakeBody.style.background = '';\r\n                    fakeBody.style.overflow = 'hidden';\r\n                    docOverflow = docElement.style.overflow;\r\n                    docElement.style.overflow = 'hidden';\r\n                    docElement.appendChild(fakeBody);\r\n                }\r\n\r\n                ret = callback(div, rule);\r\n                if (!body) {\r\n                    fakeBody.parentNode.removeChild(fakeBody);\r\n                    docElement.style.overflow = docOverflow;\r\n                } else {\r\n                    div.parentNode.removeChild(div);\r\n                }\r\n\r\n                return !!ret;\r\n\r\n            },\r\n            _hasOwnProperty = ({}).hasOwnProperty, hasOwnProp;\r\n\r\n        if (!is(_hasOwnProperty, 'undefined') && !is(_hasOwnProperty.call, 'undefined')) {\r\n            hasOwnProp = function (object, property) {\r\n                return _hasOwnProperty.call(object, property);\r\n            };\r\n        }\r\n        else {\r\n            hasOwnProp = function (object, property) {\r\n                return ((property in object) && is(object.constructor.prototype[property], 'undefined'));\r\n            };\r\n        }\r\n\r\n\r\n        if (!Function.prototype.bind) {\r\n            Function.prototype.bind = function bind(that) {\r\n\r\n                var target = this;\r\n\r\n                if (typeof target != \"function\") {\r\n                    throw new TypeError();\r\n                }\r\n\r\n                var args = slice.call(arguments, 1),\r\n                    bound = function () {\r\n\r\n                        if (this instanceof bound) {\r\n\r\n                            var F = function () {\r\n                            };\r\n                            F.prototype = target.prototype;\r\n                            var self = new F();\r\n\r\n                            var result = target.apply(\r\n                                self,\r\n                                args.concat(slice.call(arguments))\r\n                            );\r\n                            if (Object(result) === result) {\r\n                                return result;\r\n                            }\r\n                            return self;\r\n\r\n                        } else {\r\n\r\n                            return target.apply(\r\n                                that,\r\n                                args.concat(slice.call(arguments))\r\n                            );\r\n\r\n                        }\r\n\r\n                    };\r\n\r\n                return bound;\r\n            };\r\n        }\r\n\r\n        function setCss(str) {\r\n            mStyle.cssText = str;\r\n        }\r\n\r\n        function setCssAll(str1, str2) {\r\n            return setCss(prefixes.join(str1 + ';') + ( str2 || '' ));\r\n        }\r\n\r\n        function is(obj, type) {\r\n            return typeof obj === type;\r\n        }\r\n\r\n        function contains(str, substr) {\r\n            return !!~('' + str).indexOf(substr);\r\n        }\r\n\r\n        function testProps(props, prefixed) {\r\n            for (var i in props) {\r\n                var prop = props[i];\r\n                if (!contains(prop, \"-\") && mStyle[prop] !== undefined) {\r\n                    return prefixed == 'pfx' ? prop : true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        function testDOMProps(props, obj, elem) {\r\n            for (var i in props) {\r\n                var item = obj[props[i]];\r\n                if (item !== undefined) {\r\n\r\n                    if (elem === false) return props[i];\r\n\r\n                    if (is(item, 'function')) {\r\n                        return item.bind(elem || obj);\r\n                    }\r\n\r\n                    return item;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        function testPropsAll(prop, prefixed, elem) {\r\n\r\n            var ucProp = prop.charAt(0).toUpperCase() + prop.slice(1),\r\n                props = (prop + ' ' + cssomPrefixes.join(ucProp + ' ') + ucProp).split(' ');\r\n\r\n            if (is(prefixed, \"string\") || is(prefixed, \"undefined\")) {\r\n                return testProps(props, prefixed);\r\n\r\n            } else {\r\n                props = (prop + ' ' + (domPrefixes).join(ucProp + ' ') + ucProp).split(' ');\r\n                return testDOMProps(props, prefixed, elem);\r\n            }\r\n        }\r\n\r\n        tests['touch'] = function () {\r\n            var bool;\r\n\r\n            if (('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) {\r\n                bool = true;\r\n            } else {\r\n                injectElementWithStyles(['@media (', prefixes.join('touch-enabled),('), mod, ')', '{#modernizr{top:9px;position:absolute}}'].join(''), function (node) {\r\n                    bool = node.offsetTop === 9;\r\n                });\r\n            }\r\n\r\n            return bool;\r\n        };\r\n        tests['csstransforms3d'] = function () {\r\n\r\n            var ret = !!testPropsAll('perspective');\r\n\r\n            if (ret && 'webkitPerspective' in docElement.style) {\r\n\r\n                injectElementWithStyles('@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}', function (node, rule) {\r\n                    ret = node.offsetLeft === 9 && node.offsetHeight === 3;\r\n                });\r\n            }\r\n            return ret;\r\n        };\r\n\r\n\r\n        tests['csstransitions'] = function () {\r\n            return testPropsAll('transition');\r\n        };\r\n\r\n\r\n        for (var feature in tests) {\r\n            if (hasOwnProp(tests, feature)) {\r\n                featureName = feature.toLowerCase();\r\n                Modernizr[featureName] = tests[feature]();\r\n\r\n                classes.push((Modernizr[featureName] ? '' : 'no-') + featureName);\r\n            }\r\n        }\r\n\r\n\r\n        Modernizr.addTest = function (feature, test) {\r\n            if (typeof feature == 'object') {\r\n                for (var key in feature) {\r\n                    if (hasOwnProp(feature, key)) {\r\n                        Modernizr.addTest(key, feature[key]);\r\n                    }\r\n                }\r\n            } else {\r\n\r\n                feature = feature.toLowerCase();\r\n\r\n                if (Modernizr[feature] !== undefined) {\r\n                    return Modernizr;\r\n                }\r\n\r\n                test = typeof test == 'function' ? test() : test;\r\n\r\n                if (typeof enableClasses !== \"undefined\" && enableClasses) {\r\n                    docElement.className += ' ' + (test ? '' : 'no-') + feature;\r\n                }\r\n                Modernizr[feature] = test;\r\n\r\n            }\r\n\r\n            return Modernizr;\r\n        };\r\n\r\n\r\n        setCss('');\r\n        modElem = inputElem = null;\r\n\r\n\r\n        Modernizr._version = version;\r\n\r\n        Modernizr._prefixes = prefixes;\r\n        Modernizr._domPrefixes = domPrefixes;\r\n        Modernizr._cssomPrefixes = cssomPrefixes;\r\n\r\n\r\n        Modernizr.testProp = function (prop) {\r\n            return testProps([prop]);\r\n        };\r\n\r\n        Modernizr.testAllProps = testPropsAll;\r\n        Modernizr.testStyles = injectElementWithStyles;\r\n        Modernizr.prefixed = function (prop, obj, elem) {\r\n            if (!obj) {\r\n                return testPropsAll(prop, 'pfx');\r\n            } else {\r\n                return testPropsAll(prop, obj, elem);\r\n            }\r\n        };\r\n        return Modernizr;\r\n    })(window, document);\r\n\r\n    var fullScreenApi = {\r\n            ok: false,\r\n            is: function () {\r\n                return false;\r\n            },\r\n            request: function () {\r\n            },\r\n            cancel: function () {\r\n            },\r\n            event: '',\r\n            prefix: ''\r\n        },\r\n        browserPrefixes = 'webkit moz o ms khtml'.split(' ');\r\n\r\n// check for native support\r\n    if (typeof document.cancelFullScreen != 'undefined') {\r\n        fullScreenApi.ok = true;\r\n    } else {\r\n        // check for fullscreen support by vendor prefix\r\n        for (var i = 0, il = browserPrefixes.length; i < il; i++) {\r\n            fullScreenApi.prefix = browserPrefixes[i];\r\n            if (typeof document[fullScreenApi.prefix + 'CancelFullScreen'] != 'undefined') {\r\n                fullScreenApi.ok = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n// update methods to do something useful\r\n    if (fullScreenApi.ok) {\r\n        fullScreenApi.event = fullScreenApi.prefix + 'fullscreenchange';\r\n        fullScreenApi.is = function () {\r\n            switch (this.prefix) {\r\n                case '':\r\n                    return document.fullScreen;\r\n                case 'webkit':\r\n                    return document.webkitIsFullScreen;\r\n                default:\r\n                    return document[this.prefix + 'FullScreen'];\r\n            }\r\n        };\r\n        fullScreenApi.request = function (el) {\r\n            return (this.prefix === '') ? el.requestFullScreen() : el[this.prefix + 'RequestFullScreen']();\r\n        };\r\n        fullScreenApi.cancel = function (el) {\r\n            return (this.prefix === '') ? document.cancelFullScreen() : document[this.prefix + 'CancelFullScreen']();\r\n        };\r\n    }\r\n    /* Bez v1.0.10-g5ae0136\r\n     * http://github.com/rdallasgray/bez\r\n     *\r\n     * A plugin to convert CSS3 cubic-bezier co-ordinates to jQuery-compatible easing functions\r\n     *\r\n     * With thanks to Nikolay Nemshilov for clarification on the cubic-bezier maths\r\n     * See http://st-on-it.blogspot.com/2011/05/calculating-cubic-bezier-function.html\r\n     *\r\n     * Copyright 2011 Robert Dallas Gray. All rights reserved.\r\n     * Provided under the FreeBSD license: https://github.com/rdallasgray/bez/blob/master/LICENSE.txt\r\n     */\r\n    function bez(coOrdArray) {\r\n        var encodedFuncName = \"bez_\" + $.makeArray(arguments).join(\"_\").replace(\".\", \"p\");\r\n        if (typeof $['easing'][encodedFuncName] !== \"function\") {\r\n            var polyBez = function (p1, p2) {\r\n                var A = [null, null],\r\n                    B = [null, null],\r\n                    C = [null, null],\r\n                    bezCoOrd = function (t, ax) {\r\n                        C[ax] = 3 * p1[ax];\r\n                        B[ax] = 3 * (p2[ax] - p1[ax]) - C[ax];\r\n                        A[ax] = 1 - C[ax] - B[ax];\r\n                        return t * (C[ax] + t * (B[ax] + t * A[ax]));\r\n                    },\r\n                    xDeriv = function (t) {\r\n                        return C[0] + t * (2 * B[0] + 3 * A[0] * t);\r\n                    },\r\n                    xForT = function (t) {\r\n                        var x = t, i = 0, z;\r\n                        while (++i < 14) {\r\n                            z = bezCoOrd(x, 0) - t;\r\n                            if (Math.abs(z) < 1e-3) break;\r\n                            x -= z / xDeriv(x);\r\n                        }\r\n                        return x;\r\n                    };\r\n                return function (t) {\r\n                    return bezCoOrd(xForT(t), 1);\r\n                }\r\n            };\r\n            $['easing'][encodedFuncName] = function (x, t, b, c, d) {\r\n                return c * polyBez([coOrdArray[0], coOrdArray[1]], [coOrdArray[2], coOrdArray[3]])(t / d) + b;\r\n            }\r\n        }\r\n        return encodedFuncName;\r\n    }\r\n\r\n    var $WINDOW = $(window),\r\n        $DOCUMENT = $(document),\r\n        $HTML,\r\n        $BODY,\r\n\r\n        QUIRKS_FORCE = location.hash.replace('#', '') === 'quirks',\r\n        TRANSFORMS3D = Modernizr.csstransforms3d,\r\n        CSS3 = TRANSFORMS3D && !QUIRKS_FORCE,\r\n        COMPAT = TRANSFORMS3D || document.compatMode === 'CSS1Compat',\r\n        FULLSCREEN = fullScreenApi.ok,\r\n\r\n        MOBILE = navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),\r\n        SLOW = !CSS3 || MOBILE,\r\n\r\n        MS_POINTER = navigator.msPointerEnabled,\r\n\r\n        WHEEL = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : document.onmousewheel !== undefined ? \"mousewheel\" : \"DOMMouseScroll\",\r\n\r\n        TOUCH_TIMEOUT = 250,\r\n        TRANSITION_DURATION = 300,\r\n\r\n        SCROLL_LOCK_TIMEOUT = 1400,\r\n\r\n        AUTOPLAY_INTERVAL = 5000,\r\n        MARGIN = 2,\r\n        THUMB_SIZE = 64,\r\n\r\n        WIDTH = 500,\r\n        HEIGHT = 333,\r\n\r\n        STAGE_FRAME_KEY = '$stageFrame',\r\n        NAV_DOT_FRAME_KEY = '$navDotFrame',\r\n        NAV_THUMB_FRAME_KEY = '$navThumbFrame',\r\n\r\n        AUTO = 'auto',\r\n\r\n        BEZIER = bez([.1, 0, .25, 1]),\r\n\r\n        MAX_WIDTH = 1200,\r\n\r\n        /**\r\n         * Number of thumbnails in slide. Calculated only on setOptions and resize.\r\n         * @type {number}\r\n         */\r\n        thumbsPerSlide = 1,\r\n\r\n        OPTIONS = {\r\n\r\n            /**\r\n             * Set width for gallery.\r\n             * Default value - width of first image\r\n             * Number - set value in px\r\n             * String - set value in quotes\r\n             *\r\n             */\r\n            width: null,\r\n\r\n            /**\r\n             * Set min-width for gallery\r\n             *\r\n             */\r\n            minwidth: null,\r\n\r\n            /**\r\n             * Set max-width for gallery\r\n             *\r\n             */\r\n            maxwidth: '100%',\r\n\r\n            /**\r\n             * Set height for gallery\r\n             * Default value - height of first image\r\n             * Number - set value in px\r\n             * String - set value in quotes\r\n             *\r\n             */\r\n            height: null,\r\n\r\n            /**\r\n             * Set min-height for gallery\r\n             *\r\n             */\r\n            minheight: null,\r\n\r\n            /**\r\n             * Set max-height for gallery\r\n             *\r\n             */\r\n            maxheight: null,\r\n\r\n            /**\r\n             * Set proportion ratio for gallery depends of image\r\n             *\r\n             */\r\n            ratio: null, // '16/9' || 500/333 || 1.5\r\n\r\n            margin: MARGIN,\r\n\r\n            nav: 'dots', // 'thumbs' || false\r\n            navposition: 'bottom', // 'top'\r\n            navwidth: null,\r\n            thumbwidth: THUMB_SIZE,\r\n            thumbheight: THUMB_SIZE,\r\n            thumbmargin: MARGIN,\r\n            thumbborderwidth: MARGIN,\r\n\r\n            allowfullscreen: false, // true || 'native'\r\n\r\n            transition: 'slide', // 'crossfade' || 'dissolve'\r\n            clicktransition: null,\r\n            transitionduration: TRANSITION_DURATION,\r\n\r\n            captions: true,\r\n\r\n            startindex: 0,\r\n\r\n            loop: false,\r\n\r\n            autoplay: false,\r\n            stopautoplayontouch: true,\r\n\r\n            keyboard: false,\r\n\r\n            arrows: true,\r\n            click: true,\r\n            swipe: false,\r\n            trackpad: false,\r\n\r\n            shuffle: false,\r\n\r\n            direction: 'ltr', // 'rtl'\r\n\r\n            shadows: true,\r\n\r\n            showcaption: true,\r\n\r\n            /**\r\n             * Set type of thumbnail navigation\r\n             */\r\n            navdir: 'horizontal',\r\n\r\n            /**\r\n             * Set configuration to show or hide arrows in thumb navigation\r\n             */\r\n            navarrows: true,\r\n\r\n            /**\r\n             * Set type of navigation. Can be thumbs or slides\r\n             */\r\n            navtype: 'thumbs'\r\n\r\n        },\r\n\r\n        KEYBOARD_OPTIONS = {\r\n            left: true,\r\n            right: true,\r\n            down: true,\r\n            up: true,\r\n            space: false,\r\n            home: false,\r\n            end: false\r\n        };\r\n\r\n    function noop() {\r\n    }\r\n\r\n    function minMaxLimit(value, min, max) {\r\n        return Math.max(isNaN(min) ? -Infinity : min, Math.min(isNaN(max) ? Infinity : max, value));\r\n    }\r\n\r\n    function readTransform(css, dir) {\r\n        return css.match(/ma/) && css.match(/-?\\d+(?!d)/g)[css.match(/3d/) ?\r\n                (dir === 'vertical' ? 13 : 12) : (dir === 'vertical' ? 5 : 4)\r\n                ]\r\n    }\r\n\r\n    function readPosition($el, dir) {\r\n        if (CSS3) {\r\n            return +readTransform($el.css('transform'), dir);\r\n        } else {\r\n            return +$el.css(dir === 'vertical' ? 'top' : 'left').replace('px', '');\r\n        }\r\n    }\r\n\r\n    function getTranslate(pos, direction) {\r\n        var obj = {};\r\n\r\n        if (CSS3) {\r\n\r\n            switch (direction) {\r\n                case 'vertical':\r\n                    obj.transform = 'translate3d(0, ' + (pos) + 'px,0)';\r\n                    break;\r\n                case 'list':\r\n                    break;\r\n                default :\r\n                    obj.transform = 'translate3d(' + (pos) + 'px,0,0)';\r\n                    break;\r\n            }\r\n        } else {\r\n            direction === 'vertical' ?\r\n                obj.top = pos :\r\n                obj.left = pos;\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    function getDuration(time) {\r\n        return {'transition-duration': time + 'ms'};\r\n    }\r\n\r\n    function unlessNaN(value, alternative) {\r\n        return isNaN(value) ? alternative : value;\r\n    }\r\n\r\n    function numberFromMeasure(value, measure) {\r\n        return unlessNaN(+String(value).replace(measure || 'px', ''));\r\n    }\r\n\r\n    function numberFromPercent(value) {\r\n        return /%$/.test(value) ? numberFromMeasure(value, '%') : undefined;\r\n    }\r\n\r\n    function numberFromWhatever(value, whole) {\r\n        return unlessNaN(numberFromPercent(value) / 100 * whole, numberFromMeasure(value));\r\n    }\r\n\r\n    function measureIsValid(value) {\r\n        return (!isNaN(numberFromMeasure(value)) || !isNaN(numberFromMeasure(value, '%'))) && value;\r\n    }\r\n\r\n    function getPosByIndex(index, side, margin, baseIndex) {\r\n\r\n        return (index - (baseIndex || 0)) * (side + (margin || 0));\r\n    }\r\n\r\n    function getIndexByPos(pos, side, margin, baseIndex) {\r\n        return -Math.round(pos / (side + (margin || 0)) - (baseIndex || 0));\r\n    }\r\n\r\n    function bindTransitionEnd($el) {\r\n        var elData = $el.data();\r\n\r\n        if (elData.tEnd) return;\r\n\r\n        var el = $el[0],\r\n            transitionEndEvent = {\r\n                WebkitTransition: 'webkitTransitionEnd',\r\n                MozTransition: 'transitionend',\r\n                OTransition: 'oTransitionEnd otransitionend',\r\n                msTransition: 'MSTransitionEnd',\r\n                transition: 'transitionend'\r\n            };\r\n        addEvent(el, transitionEndEvent[Modernizr.prefixed('transition')], function (e) {\r\n            elData.tProp && e.propertyName.match(elData.tProp) && elData.onEndFn();\r\n        });\r\n        elData.tEnd = true;\r\n    }\r\n\r\n    function afterTransition($el, property, fn, time) {\r\n        var ok,\r\n            elData = $el.data();\r\n\r\n        if (elData) {\r\n            elData.onEndFn = function () {\r\n                if (ok) return;\r\n                ok = true;\r\n                clearTimeout(elData.tT);\r\n                fn();\r\n            };\r\n            elData.tProp = property;\r\n\r\n            // Passive call, just in case of fail of native transition-end event\r\n            clearTimeout(elData.tT);\r\n            elData.tT = setTimeout(function () {\r\n                elData.onEndFn();\r\n            }, time * 1.5);\r\n\r\n            bindTransitionEnd($el);\r\n        }\r\n    }\r\n\r\n\r\n    function stop($el, pos/*, _001*/) {\r\n        var dir = $el.navdir || 'horizontal';\r\n        if ($el.length) {\r\n            var elData = $el.data();\r\n            if (CSS3) {\r\n                $el.css(getDuration(0));\r\n                elData.onEndFn = noop;\r\n                clearTimeout(elData.tT);\r\n            } else {\r\n                $el.stop();\r\n            }\r\n            var lockedPos = getNumber(pos, function () {\r\n                return readPosition($el, dir);\r\n            });\r\n\r\n            $el.css(getTranslate(lockedPos, dir/*, _001*/));//.width(); // `.width()` for reflow\r\n            return lockedPos;\r\n        }\r\n    }\r\n\r\n    function getNumber() {\r\n        var number;\r\n        for (var _i = 0, _l = arguments.length; _i < _l; _i++) {\r\n            number = _i ? arguments[_i]() : arguments[_i];\r\n            if (typeof number === 'number') {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return number;\r\n    }\r\n\r\n    function edgeResistance(pos, edge) {\r\n        return Math.round(pos + ((edge - pos) / 1.5));\r\n    }\r\n\r\n    function getProtocol() {\r\n        getProtocol.p = getProtocol.p || (location.protocol === 'https:' ? 'https://' : 'http://');\r\n        return getProtocol.p;\r\n    }\r\n\r\n    function parseHref(href) {\r\n        var a = document.createElement('a');\r\n        a.href = href;\r\n        return a;\r\n    }\r\n\r\n    function findVideoId(href, forceVideo) {\r\n        if (typeof href !== 'string') return href;\r\n        href = parseHref(href);\r\n\r\n        var id,\r\n            type;\r\n\r\n        if (href.host.match(/youtube\\.com/) && href.search) {\r\n            //.log();\r\n            id = href.search.split('v=')[1];\r\n            if (id) {\r\n                var ampersandPosition = id.indexOf('&');\r\n                if (ampersandPosition !== -1) {\r\n                    id = id.substring(0, ampersandPosition);\r\n                }\r\n                type = 'youtube';\r\n            }\r\n        } else if (href.host.match(/youtube\\.com|youtu\\.be/)) {\r\n            id = href.pathname.replace(/^\\/(embed\\/|v\\/)?/, '').replace(/\\/.*/, '');\r\n            type = 'youtube';\r\n        } else if (href.host.match(/vimeo\\.com/)) {\r\n            type = 'vimeo';\r\n            id = href.pathname.replace(/^\\/(video\\/)?/, '').replace(/\\/.*/, '');\r\n        }\r\n\r\n        if ((!id || !type) && forceVideo) {\r\n            id = href.href;\r\n            type = 'custom';\r\n        }\r\n\r\n        return id ? {id: id, type: type, s: href.search.replace(/^\\?/, ''), p: getProtocol()} : false;\r\n    }\r\n\r\n    function getVideoThumbs(dataFrame, data, fotorama) {\r\n        var img, thumb, video = dataFrame.video;\r\n        if (video.type === 'youtube') {\r\n            thumb = getProtocol() + 'img.youtube.com/vi/' + video.id + '/default.jpg';\r\n            img = thumb.replace(/\\/default.jpg$/, '/hqdefault.jpg');\r\n            dataFrame.thumbsReady = true;\r\n        } else if (video.type === 'vimeo') {\r\n            $.ajax({\r\n                url: getProtocol() + 'vimeo.com/api/v2/video/' + video.id + '.json',\r\n                dataType: 'jsonp',\r\n                success: function (json) {\r\n                    dataFrame.thumbsReady = true;\r\n                    updateData(data, {\r\n                        img: json[0].thumbnail_large,\r\n                        thumb: json[0].thumbnail_small\r\n                    }, dataFrame.i, fotorama);\r\n                }\r\n            });\r\n        } else {\r\n            dataFrame.thumbsReady = true;\r\n        }\r\n\r\n        return {\r\n            img: img,\r\n            thumb: thumb\r\n        }\r\n    }\r\n\r\n    function updateData(data, _dataFrame, i, fotorama) {\r\n        for (var _i = 0, _l = data.length; _i < _l; _i++) {\r\n            var dataFrame = data[_i];\r\n\r\n            if (dataFrame.i === i && dataFrame.thumbsReady) {\r\n                var clear = {videoReady: true};\r\n                clear[STAGE_FRAME_KEY] = clear[NAV_THUMB_FRAME_KEY] = clear[NAV_DOT_FRAME_KEY] = false;\r\n\r\n                fotorama.splice(_i, 1, $.extend(\r\n                    {},\r\n                    dataFrame,\r\n                    clear,\r\n                    _dataFrame\r\n                ));\r\n\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    function getDataFromHtml($el) {\r\n        var data = [];\r\n\r\n        function getDataFromImg($img, imgData, checkVideo) {\r\n            var $child = $img.children('img').eq(0),\r\n                _imgHref = $img.attr('href'),\r\n                _imgSrc = $img.attr('src'),\r\n                _thumbSrc = $child.attr('src'),\r\n                _video = imgData.video,\r\n                video = checkVideo ? findVideoId(_imgHref, _video === true) : false;\r\n\r\n            if (video) {\r\n                _imgHref = false;\r\n            } else {\r\n                video = _video;\r\n            }\r\n\r\n            getDimensions($img, $child, $.extend(imgData, {\r\n                video: video,\r\n                img: imgData.img || _imgHref || _imgSrc || _thumbSrc,\r\n                thumb: imgData.thumb || _thumbSrc || _imgSrc || _imgHref\r\n            }));\r\n        }\r\n\r\n        function getDimensions($img, $child, imgData) {\r\n            var separateThumbFLAG = imgData.thumb && imgData.img !== imgData.thumb,\r\n                width = numberFromMeasure(imgData.width || $img.attr('width')),\r\n                height = numberFromMeasure(imgData.height || $img.attr('height'));\r\n\r\n            $.extend(imgData, {\r\n                width: width,\r\n                height: height,\r\n                thumbratio: getRatio(imgData.thumbratio || (numberFromMeasure(imgData.thumbwidth || ($child && $child.attr('width')) || separateThumbFLAG || width) / numberFromMeasure(imgData.thumbheight || ($child && $child.attr('height')) || separateThumbFLAG || height)))\r\n            });\r\n        }\r\n\r\n        $el.children().each(function () {\r\n            var $this = $(this),\r\n                dataFrame = optionsToLowerCase($.extend($this.data(), {id: $this.attr('id')}));\r\n            if ($this.is('a, img')) {\r\n                getDataFromImg($this, dataFrame, true);\r\n            } else if (!$this.is(':empty')) {\r\n                getDimensions($this, null, $.extend(dataFrame, {\r\n                    html: this,\r\n                    _html: $this.html() // Because of IE\r\n                }));\r\n            } else return;\r\n\r\n            data.push(dataFrame);\r\n        });\r\n\r\n        return data;\r\n    }\r\n\r\n    function isHidden(el) {\r\n        return el.offsetWidth === 0 && el.offsetHeight === 0;\r\n    }\r\n\r\n    function isDetached(el) {\r\n        return !$.contains(document.documentElement, el);\r\n    }\r\n\r\n    function waitFor(test, fn, timeout, i) {\r\n        if (!waitFor.i) {\r\n            waitFor.i = 1;\r\n            waitFor.ii = [true];\r\n        }\r\n\r\n        i = i || waitFor.i;\r\n\r\n        if (typeof waitFor.ii[i] === 'undefined') {\r\n            waitFor.ii[i] = true;\r\n        }\r\n\r\n        if (test()) {\r\n            fn();\r\n        } else {\r\n            waitFor.ii[i] && setTimeout(function () {\r\n                waitFor.ii[i] && waitFor(test, fn, timeout, i);\r\n            }, timeout || 100);\r\n        }\r\n\r\n        return waitFor.i++;\r\n    }\r\n\r\n    waitFor.stop = function (i) {\r\n        waitFor.ii[i] = false;\r\n    };\r\n\r\n    function fit($el, measuresToFit) {\r\n        var elData = $el.data(),\r\n            measures = elData.measures;\r\n\r\n        if (measures && (!elData.l ||\r\n            elData.l.W !== measures.width ||\r\n            elData.l.H !== measures.height ||\r\n            elData.l.r !== measures.ratio ||\r\n            elData.l.w !== measuresToFit.w ||\r\n            elData.l.h !== measuresToFit.h)) {\r\n\r\n            var height = minMaxLimit(measuresToFit.h, 0, measures.height),\r\n                width = height * measures.ratio;\r\n\r\n            UTIL.setRatio($el, width, height);\r\n\r\n            elData.l = {\r\n                W: measures.width,\r\n                H: measures.height,\r\n                r: measures.ratio,\r\n                w: measuresToFit.w,\r\n                h: measuresToFit.h\r\n            };\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    function setStyle($el, style) {\r\n        var el = $el[0];\r\n        if (el.styleSheet) {\r\n            el.styleSheet.cssText = style;\r\n        } else {\r\n            $el.html(style);\r\n        }\r\n    }\r\n\r\n    function findShadowEdge(pos, min, max, dir) {\r\n        return min === max ? false :\r\n            dir === 'vertical' ?\r\n                (pos <= min ? 'top' : pos >= max ? 'bottom' : 'top bottom') :\r\n                (pos <= min ? 'left' : pos >= max ? 'right' : 'left right');\r\n    }\r\n\r\n    function smartClick($el, fn, _options) {\r\n        _options = _options || {};\r\n\r\n        $el.each(function () {\r\n            var $this = $(this),\r\n                thisData = $this.data(),\r\n                startEvent;\r\n\r\n            if (thisData.clickOn) return;\r\n\r\n            thisData.clickOn = true;\r\n\r\n            $.extend(touch($this, {\r\n                onStart: function (e) {\r\n                    startEvent = e;\r\n                    (_options.onStart || noop).call(this, e);\r\n                },\r\n                onMove: _options.onMove || noop,\r\n                onTouchEnd: _options.onTouchEnd || noop,\r\n                onEnd: function (result) {\r\n                    if (result.moved) return;\r\n                    fn.call(this, startEvent);\r\n                }\r\n            }), {noMove: true});\r\n        });\r\n    }\r\n\r\n    function div(classes, child) {\r\n        return '<div class=\"' + classes + '\">' + (child || '') + '</div>';\r\n    }\r\n\r\n\r\n    /**\r\n     * Function transforming into valid classname\r\n     * @param className - name of the class\r\n     * @returns {string} - dom format of class name\r\n     */\r\n    function cls(className) {\r\n        return \".\" + className;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {json-object} videoItem Parsed object from data.video item or href from link a in input dates\r\n     * @returns {string} DOM view of video iframe\r\n     */\r\n    function createVideoFrame(videoItem) {\r\n        var frame = '<iframe src=\"' + videoItem.p + videoItem.type + '.com/embed/' + videoItem.id + '\" frameborder=\"0\" allowfullscreen></iframe>';\r\n        return frame;\r\n    }\r\n\r\n// Fisher\u00e2\u0080\u0093Yates Shuffle\r\n// http://bost.ocks.org/mike/shuffle/\r\n    function shuffle(array) {\r\n        // While there remain elements to shuffle\r\n        var l = array.length;\r\n        while (l) {\r\n            // Pick a remaining element\r\n            var i = Math.floor(Math.random() * l--);\r\n\r\n            // And swap it with the current element\r\n            var t = array[l];\r\n            array[l] = array[i];\r\n            array[i] = t;\r\n        }\r\n\r\n        return array;\r\n    }\r\n\r\n    function clone(array) {\r\n        return Object.prototype.toString.call(array) == '[object Array]'\r\n            && $.map(array, function (frame) {\r\n                return $.extend({}, frame);\r\n            });\r\n    }\r\n\r\n    function lockScroll($el, left, top) {\r\n        $el\r\n            .scrollLeft(left || 0)\r\n            .scrollTop(top || 0);\r\n    }\r\n\r\n    function optionsToLowerCase(options) {\r\n        if (options) {\r\n            var opts = {};\r\n            $.each(options, function (key, value) {\r\n                opts[key.toLowerCase()] = value;\r\n            });\r\n\r\n            return opts;\r\n        }\r\n    }\r\n\r\n    function getRatio(_ratio) {\r\n        if (!_ratio) return;\r\n        var ratio = +_ratio;\r\n        if (!isNaN(ratio)) {\r\n            return ratio;\r\n        } else {\r\n            ratio = _ratio.split('/');\r\n            return +ratio[0] / +ratio[1] || undefined;\r\n        }\r\n    }\r\n\r\n    function addEvent(el, e, fn, bool) {\r\n        if (!e) return;\r\n        el.addEventListener ? el.addEventListener(e, fn, !!bool) : el.attachEvent('on' + e, fn);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param position guess position for navShaft\r\n     * @param restriction object contains min and max values for position\r\n     * @returns {*} filtered value of position\r\n     */\r\n    function validateRestrictions(position, restriction) {\r\n        if (position > restriction.max) {\r\n            position = restriction.max;\r\n        } else {\r\n            if (position < restriction.min) {\r\n                position = restriction.min;\r\n            }\r\n        }\r\n        return position;\r\n    }\r\n\r\n    function validateSlidePos(opt, navShaftTouchTail, guessIndex, offsetNav, $guessNavFrame, $navWrap, dir) {\r\n        var position,\r\n            size,\r\n            wrapSize;\r\n        if (dir === 'horizontal') {\r\n            size = opt.thumbwidth;\r\n            wrapSize = $navWrap.width();\r\n        } else {\r\n            size = opt.thumbheight;\r\n            wrapSize = $navWrap.height();\r\n        }\r\n        if ( (size + opt.margin) * (guessIndex + 1) >= (wrapSize - offsetNav) ) {\r\n            if (dir === 'horizontal') {\r\n                position = -$guessNavFrame.position().left;\r\n            } else {\r\n                position = -$guessNavFrame.position().top;\r\n            }\r\n        } else {\r\n            if ((size + opt.margin) * (guessIndex) <= Math.abs(offsetNav)) {\r\n                if (dir === 'horizontal') {\r\n                    position = -$guessNavFrame.position().left + wrapSize - (size + opt.margin);\r\n                } else {\r\n                    position = -$guessNavFrame.position().top + wrapSize - (size + opt.margin);\r\n                }\r\n            } else {\r\n                position = offsetNav;\r\n            }\r\n        }\r\n        position = validateRestrictions(position, navShaftTouchTail);\r\n\r\n        return position || 0;\r\n    }\r\n\r\n    function elIsDisabled(el) {\r\n        return !!el.getAttribute('disabled');\r\n    }\r\n\r\n    function disableAttr(FLAG, disable) {\r\n        if (disable) {\r\n            return {disabled: FLAG};\r\n        } else {\r\n            return {tabindex: FLAG * -1 + '', disabled: FLAG};\r\n\r\n        }\r\n    }\r\n\r\n    function addEnterUp(el, fn) {\r\n        addEvent(el, 'keyup', function (e) {\r\n            elIsDisabled(el) || e.keyCode == 13 && fn.call(el, e);\r\n        });\r\n    }\r\n\r\n    function addFocus(el, fn) {\r\n        addEvent(el, 'focus', el.onfocusin = function (e) {\r\n            fn.call(el, e);\r\n        }, true);\r\n    }\r\n\r\n    function stopEvent(e, stopPropagation) {\r\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\r\n        stopPropagation && e.stopPropagation && e.stopPropagation();\r\n    }\r\n\r\n    function getDirectionSign(forward) {\r\n        return forward ? '>' : '<';\r\n    }\r\n\r\n    var UTIL = (function () {\r\n\r\n        function setRatioClass($el, wh, ht) {\r\n            var rateImg = wh / ht;\r\n\r\n            if (rateImg <= 1) {\r\n                $el.parent().removeClass(horizontalImageClass);\r\n                $el.parent().addClass(verticalImageClass);\r\n            } else {\r\n                $el.parent().removeClass(verticalImageClass);\r\n                $el.parent().addClass(horizontalImageClass);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set specific attribute in thumbnail template\r\n         * @param $frame DOM item of specific thumbnail\r\n         * @param value Value which must be setted into specific attribute\r\n         * @param searchAttr Name of attribute where value must be included\r\n         */\r\n        function setThumbAttr($frame, value, searchAttr) {\r\n            var attr = searchAttr;\r\n\r\n            if (!$frame.attr(attr) && $frame.attr(attr) !== undefined) {\r\n                $frame.attr(attr, value);\r\n            }\r\n\r\n            if ($frame.find(\"[\" + attr + \"]\").length) {\r\n                $frame.find(\"[\" + attr + \"]\")\r\n                    .each(function () {\r\n                        $(this).attr(attr, value);\r\n                    });\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Method describe behavior need to render caption on preview or not\r\n         * @param frameItem specific item from data\r\n         * @param isExpected {bool} if items with caption need render them or not\r\n         * @returns {boolean} if true then caption should be rendered\r\n         */\r\n        function isExpectedCaption(frameItem, isExpected, undefined) {\r\n            var expected = false,\r\n                frameExpected;\r\n\r\n            frameItem.showCaption === undefined || frameItem.showCaption === true ? frameExpected = true : frameExpected = false;\r\n\r\n            if (!isExpected) {\r\n                return false;\r\n            }\r\n\r\n            if (frameItem.caption && frameExpected) {\r\n                expected = true;\r\n            }\r\n\r\n            return expected;\r\n        }\r\n\r\n        return {\r\n            setRatio: setRatioClass,\r\n            setThumbAttr: setThumbAttr,\r\n            isExpectedCaption: isExpectedCaption\r\n        };\r\n\r\n    }(UTIL || {}, jQuery));\r\n\r\n    function slide($el, options) {\r\n        var elData = $el.data(),\r\n            elPos = Math.round(options.pos),\r\n            onEndFn = function () {\r\n                if (elData && elData.sliding) {\r\n                    elData.sliding = false;\r\n                }\r\n                (options.onEnd || noop)();\r\n            };\r\n\r\n        if (typeof options.overPos !== 'undefined' && options.overPos !== options.pos) {\r\n            elPos = options.overPos;\r\n        }\r\n\r\n        var translate = $.extend(getTranslate(elPos, options.direction), options.width && {width: options.width}, options.height && {height: options.height});\r\n        if (elData && elData.sliding) {\r\n            elData.sliding = true;\r\n        }\r\n\r\n        if (CSS3) {\r\n            $el.css($.extend(getDuration(options.time), translate));\r\n\r\n            if (options.time > 10) {\r\n                afterTransition($el, 'transform', onEndFn, options.time);\r\n            } else {\r\n                onEndFn();\r\n            }\r\n        } else {\r\n            $el.stop().animate(translate, options.time, BEZIER, onEndFn);\r\n        }\r\n    }\r\n\r\n    function fade($el1, $el2, $frames, options, fadeStack, chain) {\r\n        var chainedFLAG = typeof chain !== 'undefined';\r\n        if (!chainedFLAG) {\r\n            fadeStack.push(arguments);\r\n            Array.prototype.push.call(arguments, fadeStack.length);\r\n            if (fadeStack.length > 1) return;\r\n        }\r\n\r\n        $el1 = $el1 || $($el1);\r\n        $el2 = $el2 || $($el2);\r\n\r\n        var _$el1 = $el1[0],\r\n            _$el2 = $el2[0],\r\n            crossfadeFLAG = options.method === 'crossfade',\r\n            onEndFn = function () {\r\n                if (!onEndFn.done) {\r\n                    onEndFn.done = true;\r\n                    var args = (chainedFLAG || fadeStack.shift()) && fadeStack.shift();\r\n                    args && fade.apply(this, args);\r\n                    (options.onEnd || noop)(!!args);\r\n                }\r\n            },\r\n            time = options.time / (chain || 1);\r\n\r\n        $frames.removeClass(fadeRearClass + ' ' + fadeFrontClass);\r\n\r\n        $el1\r\n            .stop()\r\n            .addClass(fadeRearClass);\r\n        $el2\r\n            .stop()\r\n            .addClass(fadeFrontClass);\r\n\r\n        crossfadeFLAG && _$el2 && $el1.fadeTo(0, 0);\r\n\r\n        $el1.fadeTo(crossfadeFLAG ? time : 0, 1, crossfadeFLAG && onEndFn);\r\n        $el2.fadeTo(time, 0, onEndFn);\r\n\r\n        (_$el1 && crossfadeFLAG) || _$el2 || onEndFn();\r\n    }\r\n\r\n    var lastEvent,\r\n        moveEventType,\r\n        preventEvent,\r\n        preventEventTimeout,\r\n        dragDomEl;\r\n\r\n    function extendEvent(e) {\r\n        var touch = (e.touches || [])[0] || e;\r\n        e._x = touch.pageX || touch.originalEvent.pageX;\r\n        e._y = touch.clientY || touch.originalEvent.clientY;\r\n        e._now = $.now();\r\n    }\r\n\r\n    function touch($el, options) {\r\n        var el = $el[0],\r\n            tail = {},\r\n            touchEnabledFLAG,\r\n            startEvent,\r\n            $target,\r\n            controlTouch,\r\n            touchFLAG,\r\n            targetIsSelectFLAG,\r\n            targetIsLinkFlag,\r\n            tolerance,\r\n            moved;\r\n\r\n        function onStart(e) {\r\n            $target = $(e.target);\r\n            tail.checked = targetIsSelectFLAG = targetIsLinkFlag = moved = false;\r\n\r\n            if (touchEnabledFLAG\r\n                || tail.flow\r\n                || (e.touches && e.touches.length > 1)\r\n                || e.which > 1\r\n                || (lastEvent && lastEvent.type !== e.type && preventEvent)\r\n                || (targetIsSelectFLAG = options.select && $target.is(options.select, el))) return targetIsSelectFLAG;\r\n\r\n            touchFLAG = e.type === 'touchstart';\r\n            targetIsLinkFlag = $target.is('a, a *', el);\r\n            controlTouch = tail.control;\r\n\r\n            tolerance = (tail.noMove || tail.noSwipe || controlTouch) ? 16 : !tail.snap ? 4 : 0;\r\n\r\n            extendEvent(e);\r\n\r\n            startEvent = lastEvent = e;\r\n            moveEventType = e.type.replace(/down|start/, 'move').replace(/Down/, 'Move');\r\n\r\n            (options.onStart || noop).call(el, e, {control: controlTouch, $target: $target});\r\n\r\n            touchEnabledFLAG = tail.flow = true;\r\n\r\n            if (!touchFLAG || tail.go) stopEvent(e);\r\n        }\r\n\r\n        function onMove(e) {\r\n            if ((e.touches && e.touches.length > 1)\r\n                || (MS_POINTER && !e.isPrimary)\r\n                || moveEventType !== e.type\r\n                || !touchEnabledFLAG) {\r\n                touchEnabledFLAG && onEnd();\r\n                (options.onTouchEnd || noop)();\r\n                return;\r\n            }\r\n\r\n            extendEvent(e);\r\n\r\n            var xDiff = Math.abs(e._x - startEvent._x), // opt _x \u00e2\u0086\u0092 _pageX\r\n                yDiff = Math.abs(e._y - startEvent._y),\r\n                xyDiff = xDiff - yDiff,\r\n                xWin = (tail.go || tail.x || xyDiff >= 0) && !tail.noSwipe,\r\n                yWin = xyDiff < 0;\r\n\r\n            stopEvent(e);\r\n            (options.onMove || noop).call(el, e, {touch: touchFLAG});\r\n\r\n            if (!moved && Math.sqrt(Math.pow(xDiff, 2) + Math.pow(yDiff, 2)) > tolerance) {\r\n                moved = true;\r\n            }\r\n\r\n            tail.checked = tail.checked || xWin || yWin;\r\n        }\r\n\r\n        function onEnd(e) {\r\n            (options.onTouchEnd || noop)();\r\n\r\n            var _touchEnabledFLAG = touchEnabledFLAG;\r\n            tail.control = touchEnabledFLAG = false;\r\n\r\n            if (_touchEnabledFLAG) {\r\n                tail.flow = false;\r\n            }\r\n\r\n            if (!_touchEnabledFLAG || (targetIsLinkFlag && !tail.checked)) return;\r\n\r\n            e && stopEvent(e);\r\n\r\n            preventEvent = true;\r\n            clearTimeout(preventEventTimeout);\r\n            preventEventTimeout = setTimeout(function () {\r\n                preventEvent = false;\r\n            }, 1000);\r\n\r\n            (options.onEnd || noop).call(el, {\r\n                moved: moved,\r\n                $target: $target,\r\n                control: controlTouch,\r\n                touch: touchFLAG,\r\n                startEvent: startEvent,\r\n                aborted: !e || e.type === 'MSPointerCancel'\r\n            });\r\n        }\r\n\r\n        function onOtherStart() {\r\n            if (tail.flow) return;\r\n            tail.flow = true;\r\n        }\r\n\r\n        function onOtherEnd() {\r\n            if (!tail.flow) return;\r\n            tail.flow = false;\r\n        }\r\n\r\n        if (MS_POINTER) {\r\n            addEvent(el, 'MSPointerDown', onStart);\r\n            addEvent(document, 'MSPointerMove', onMove);\r\n            addEvent(document, 'MSPointerCancel', onEnd);\r\n            addEvent(document, 'MSPointerUp', onEnd);\r\n        } else {\r\n            addEvent(el, 'touchstart', onStart);\r\n            addEvent(el, 'touchmove', onMove);\r\n            addEvent(el, 'touchend', onEnd);\r\n\r\n            addEvent(document, 'touchstart', onOtherStart);\r\n            addEvent(document, 'touchend', onOtherEnd);\r\n            addEvent(document, 'touchcancel', onOtherEnd);\r\n\r\n            $WINDOW.on('scroll', onOtherEnd);\r\n\r\n            $el.on('mousedown pointerdown', onStart);\r\n            $DOCUMENT\r\n                .on('mousemove pointermove', onMove)\r\n                .on('mouseup pointerup', onEnd);\r\n        }\r\n        if (Modernizr.touch) {\r\n            dragDomEl = 'a';\r\n        } else {\r\n            dragDomEl = 'div';\r\n        }\r\n        $el.on('click', dragDomEl, function (e) {\r\n            tail.checked && stopEvent(e);\r\n        });\r\n\r\n        return tail;\r\n    }\r\n\r\n    function moveOnTouch($el, options) {\r\n        var el = $el[0],\r\n            elData = $el.data(),\r\n            tail = {},\r\n            startCoo,\r\n            coo,\r\n            startElPos,\r\n            moveElPos,\r\n            edge,\r\n            moveTrack,\r\n            startTime,\r\n            endTime,\r\n            min,\r\n            max,\r\n            snap,\r\n            dir,\r\n            slowFLAG,\r\n            controlFLAG,\r\n            moved,\r\n            tracked;\r\n\r\n        function startTracking(e, noStop) {\r\n            tracked = true;\r\n            startCoo = coo = (dir === 'vertical') ? e._y : e._x;\r\n            startTime = e._now;\r\n\r\n            moveTrack = [\r\n                [startTime, startCoo]\r\n            ];\r\n\r\n            startElPos = moveElPos = tail.noMove || noStop ? 0 : stop($el, (options.getPos || noop)()/*, options._001*/);\r\n\r\n            (options.onStart || noop).call(el, e);\r\n        }\r\n\r\n        function onStart(e, result) {\r\n            min = tail.min;\r\n            max = tail.max;\r\n            snap = tail.snap,\r\n                dir = tail.direction || 'horizontal',\r\n                $el.navdir = dir;\r\n\r\n            slowFLAG = e.altKey;\r\n            tracked = moved = false;\r\n\r\n            controlFLAG = result.control;\r\n\r\n            if (!controlFLAG && !elData.sliding) {\r\n                startTracking(e);\r\n            }\r\n        }\r\n\r\n        function onMove(e, result) {\r\n            if (!tail.noSwipe) {\r\n                if (!tracked) {\r\n                    startTracking(e);\r\n                }\r\n                coo = (dir === 'vertical') ? e._y : e._x;\r\n\r\n                moveTrack.push([e._now, coo]);\r\n\r\n                moveElPos = startElPos - (startCoo - coo);\r\n\r\n                edge = findShadowEdge(moveElPos, min, max, dir);\r\n\r\n                if (moveElPos <= min) {\r\n                    moveElPos = edgeResistance(moveElPos, min);\r\n                } else if (moveElPos >= max) {\r\n                    moveElPos = edgeResistance(moveElPos, max);\r\n                }\r\n\r\n                if (!tail.noMove) {\r\n                    $el.css(getTranslate(moveElPos, dir));\r\n                    if (!moved) {\r\n                        moved = true;\r\n                        // only for mouse\r\n                        result.touch || MS_POINTER || $el.addClass(grabbingClass);\r\n                    }\r\n\r\n                    (options.onMove || noop).call(el, e, {pos: moveElPos, edge: edge});\r\n                }\r\n            }\r\n        }\r\n\r\n        function onEnd(result) {\r\n            if (tail.noSwipe && result.moved) return;\r\n\r\n            if (!tracked) {\r\n                startTracking(result.startEvent, true);\r\n            }\r\n\r\n            result.touch || MS_POINTER || $el.removeClass(grabbingClass);\r\n\r\n            endTime = $.now();\r\n\r\n            var _backTimeIdeal = endTime - TOUCH_TIMEOUT,\r\n                _backTime,\r\n                _timeDiff,\r\n                _timeDiffLast,\r\n                backTime = null,\r\n                backCoo,\r\n                virtualPos,\r\n                limitPos,\r\n                newPos,\r\n                overPos,\r\n                time = TRANSITION_DURATION,\r\n                speed,\r\n                friction = options.friction;\r\n\r\n            for (var _i = moveTrack.length - 1; _i >= 0; _i--) {\r\n                _backTime = moveTrack[_i][0];\r\n                _timeDiff = Math.abs(_backTime - _backTimeIdeal);\r\n                if (backTime === null || _timeDiff < _timeDiffLast) {\r\n                    backTime = _backTime;\r\n                    backCoo = moveTrack[_i][1];\r\n                } else if (backTime === _backTimeIdeal || _timeDiff > _timeDiffLast) {\r\n                    break;\r\n                }\r\n                _timeDiffLast = _timeDiff;\r\n            }\r\n\r\n            newPos = minMaxLimit(moveElPos, min, max);\r\n\r\n            var cooDiff = backCoo - coo,\r\n                forwardFLAG = cooDiff >= 0,\r\n                timeDiff = endTime - backTime,\r\n                longTouchFLAG = timeDiff > TOUCH_TIMEOUT,\r\n                swipeFLAG = !longTouchFLAG && moveElPos !== startElPos && newPos === moveElPos;\r\n\r\n            if (snap) {\r\n                newPos = minMaxLimit(Math[swipeFLAG ? (forwardFLAG ? 'floor' : 'ceil') : 'round'](moveElPos / snap) * snap, min, max);\r\n                min = max = newPos;\r\n            }\r\n\r\n            if (swipeFLAG && (snap || newPos === moveElPos)) {\r\n                speed = -(cooDiff / timeDiff);\r\n                time *= minMaxLimit(Math.abs(speed), options.timeLow, options.timeHigh);\r\n                virtualPos = Math.round(moveElPos + speed * time / friction);\r\n\r\n                if (!snap) {\r\n                    newPos = virtualPos;\r\n                }\r\n\r\n                if (!forwardFLAG && virtualPos > max || forwardFLAG && virtualPos < min) {\r\n                    limitPos = forwardFLAG ? min : max;\r\n                    overPos = virtualPos - limitPos;\r\n                    if (!snap) {\r\n                        newPos = limitPos;\r\n                    }\r\n                    overPos = minMaxLimit(newPos + overPos * .03, limitPos - 50, limitPos + 50);\r\n                    time = Math.abs((moveElPos - overPos) / (speed / friction));\r\n                }\r\n            }\r\n\r\n            time *= slowFLAG ? 10 : 1;\r\n\r\n            (options.onEnd || noop).call(el, $.extend(result, {\r\n                moved: result.moved || longTouchFLAG && snap,\r\n                pos: moveElPos,\r\n                newPos: newPos,\r\n                overPos: overPos,\r\n                time: time,\r\n                dir: dir\r\n            }));\r\n        }\r\n\r\n        tail = $.extend(touch(options.$wrap, $.extend({}, options, {\r\n            onStart: onStart,\r\n            onMove: onMove,\r\n            onEnd: onEnd\r\n        })), tail);\r\n\r\n        return tail;\r\n    }\r\n\r\n    function wheel($el, options) {\r\n        var el = $el[0],\r\n            lockFLAG,\r\n            lastDirection,\r\n            lastNow,\r\n            tail = {\r\n                prevent: {}\r\n            };\r\n\r\n        addEvent(el, WHEEL, function (e) {\r\n            var yDelta = e.wheelDeltaY || -1 * e.deltaY || 0,\r\n                xDelta = e.wheelDeltaX || -1 * e.deltaX || 0,\r\n                xWin = Math.abs(xDelta) && !Math.abs(yDelta),\r\n                direction = getDirectionSign(xDelta < 0),\r\n                sameDirection = lastDirection === direction,\r\n                now = $.now(),\r\n                tooFast = now - lastNow < TOUCH_TIMEOUT;\r\n\r\n            lastDirection = direction;\r\n            lastNow = now;\r\n\r\n            if (!xWin || !tail.ok || tail.prevent[direction] && !lockFLAG) {\r\n                return;\r\n            } else {\r\n                stopEvent(e, true);\r\n                if (lockFLAG && sameDirection && tooFast) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (options.shift) {\r\n                lockFLAG = true;\r\n                clearTimeout(tail.t);\r\n                tail.t = setTimeout(function () {\r\n                    lockFLAG = false;\r\n                }, SCROLL_LOCK_TIMEOUT);\r\n            }\r\n\r\n            (options.onEnd || noop)(e, options.shift ? direction : xDelta);\r\n\r\n        });\r\n\r\n        return tail;\r\n    }\r\n\r\n    jQuery.Fotorama = function ($fotorama, opts) {\r\n        $HTML = $('html');\r\n        $BODY = $('body');\r\n\r\n        var that = this,\r\n            stamp = $.now(),\r\n            stampClass = _fotoramaClass + stamp,\r\n            fotorama = $fotorama[0],\r\n            data,\r\n            dataFrameCount = 1,\r\n            fotoramaData = $fotorama.data(),\r\n            size,\r\n\r\n            $style = $('<style></style>'),\r\n\r\n            $anchor = $(div(hiddenClass)),\r\n            $wrap = $fotorama.find(cls(wrapClass)),\r\n            $stage = $wrap.find(cls(stageClass)),\r\n            stage = $stage[0],\r\n\r\n            $stageShaft = $fotorama.find(cls(stageShaftClass)),\r\n            $stageFrame = $(),\r\n            $arrPrev = $fotorama.find(cls(arrPrevClass)),\r\n            $arrNext = $fotorama.find(cls(arrNextClass)),\r\n            $arrs = $fotorama.find(cls(arrClass)),\r\n            $navWrap = $fotorama.find(cls(navWrapClass)),\r\n            $nav = $navWrap.find(cls(navClass)),\r\n            $navShaft = $nav.find(cls(navShaftClass)),\r\n            $navFrame,\r\n            $navDotFrame = $(),\r\n            $navThumbFrame = $(),\r\n\r\n            stageShaftData = $stageShaft.data(),\r\n            navShaftData = $navShaft.data(),\r\n\r\n            $thumbBorder = $fotorama.find(cls(thumbBorderClass)),\r\n            $thumbArrLeft = $fotorama.find(cls(thumbArrLeft)),\r\n            $thumbArrRight = $fotorama.find(cls(thumbArrRight)),\r\n\r\n            $fullscreenIcon = $fotorama.find(cls(fullscreenIconClass)),\r\n            fullscreenIcon = $fullscreenIcon[0],\r\n            $videoPlay = $(div(videoPlayClass)),\r\n            $videoClose = $fotorama.find(cls(videoCloseClass)),\r\n            videoClose = $videoClose[0],\r\n\r\n            $spinner = $fotorama.find(cls(fotoramaSpinnerClass)),\r\n\r\n            $videoPlaying,\r\n\r\n            activeIndex = false,\r\n            activeFrame,\r\n            activeIndexes,\r\n            repositionIndex,\r\n            dirtyIndex,\r\n            lastActiveIndex,\r\n            prevIndex,\r\n            nextIndex,\r\n            nextAutoplayIndex,\r\n            startIndex,\r\n\r\n            o_loop,\r\n            o_nav,\r\n            o_navThumbs,\r\n            o_navTop,\r\n            o_allowFullScreen,\r\n            o_nativeFullScreen,\r\n            o_fade,\r\n            o_thumbSide,\r\n            o_thumbSide2,\r\n            o_transitionDuration,\r\n            o_transition,\r\n            o_shadows,\r\n            o_rtl,\r\n            o_keyboard,\r\n            lastOptions = {},\r\n\r\n            measures = {},\r\n            measuresSetFLAG,\r\n\r\n            stageShaftTouchTail = {},\r\n            stageWheelTail = {},\r\n            navShaftTouchTail = {},\r\n            navWheelTail = {},\r\n\r\n            scrollTop,\r\n            scrollLeft,\r\n\r\n            showedFLAG,\r\n            pausedAutoplayFLAG,\r\n            stoppedAutoplayFLAG,\r\n\r\n            toDeactivate = {},\r\n            toDetach = {},\r\n\r\n            measuresStash,\r\n\r\n            touchedFLAG,\r\n\r\n            hoverFLAG,\r\n\r\n            navFrameKey,\r\n            stageLeft = 0,\r\n\r\n            fadeStack = [];\r\n\r\n        $wrap[STAGE_FRAME_KEY] = $('<div class=\"' + stageFrameClass + '\"></div>');\r\n        $wrap[NAV_THUMB_FRAME_KEY] = $($.Fotorama.jst.thumb());\r\n        $wrap[NAV_DOT_FRAME_KEY] = $($.Fotorama.jst.dots());\r\n\r\n        toDeactivate[STAGE_FRAME_KEY] = [];\r\n        toDeactivate[NAV_THUMB_FRAME_KEY] = [];\r\n        toDeactivate[NAV_DOT_FRAME_KEY] = [];\r\n        toDetach[STAGE_FRAME_KEY] = {};\r\n\r\n        $wrap.addClass(CSS3 ? wrapCss3Class : wrapCss2Class);\r\n\r\n        fotoramaData.fotorama = this;\r\n\r\n        /**\r\n         * Search video items in incomming data and transform object for video layout.\r\n         *\r\n         */\r\n        function checkForVideo() {\r\n            $.each(data, function (i, dataFrame) {\r\n                if (!dataFrame.i) {\r\n                    dataFrame.i = dataFrameCount++;\r\n                    var video = findVideoId(dataFrame.video, true);\r\n                    if (video) {\r\n                        var thumbs = {};\r\n                        dataFrame.video = video;\r\n                        if (!dataFrame.img && !dataFrame.thumb) {\r\n                            thumbs = getVideoThumbs(dataFrame, data, that);\r\n                        } else {\r\n                            dataFrame.thumbsReady = true;\r\n                        }\r\n                        updateData(data, {img: thumbs.img, thumb: thumbs.thumb}, dataFrame.i, that);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        function allowKey(key) {\r\n            return o_keyboard[key];\r\n        }\r\n\r\n        function setStagePosition() {\r\n            if ($stage !== undefined) {\r\n\r\n                if (opts.navdir == 'vertical') {\r\n                    var padding = opts.thumbwidth + opts.thumbmargin;\r\n\r\n                    $stage.css('left', padding);\r\n                    $arrNext.css('right', padding);\r\n                    $fullscreenIcon.css('right', padding);\r\n                    $wrap.css('width', $wrap.css('width') + padding);\r\n                    $stageShaft.css('max-width', $wrap.width() - padding);\r\n                } else {\r\n                    $stage.css('left', '');\r\n                    $arrNext.css('right', '');\r\n                    $fullscreenIcon.css('right', '');\r\n                    $wrap.css('width', $wrap.css('width') + padding);\r\n                    $stageShaft.css('max-width', '');\r\n                }\r\n            }\r\n        }\r\n\r\n        function bindGlobalEvents(FLAG) {\r\n            var keydownCommon = 'keydown.' + _fotoramaClass,\r\n                localStamp = _fotoramaClass + stamp,\r\n                keydownLocal = 'keydown.' + localStamp,\r\n                keyupLocal = 'keyup.' + localStamp,\r\n                resizeLocal = 'resize.' + localStamp + ' ' + 'orientationchange.' + localStamp,\r\n                showParams;\r\n\r\n            if (FLAG) {\r\n                $DOCUMENT\r\n                    .on(keydownLocal, function (e) {\r\n                        var catched,\r\n                            index;\r\n\r\n                        if ($videoPlaying && e.keyCode === 27) {\r\n                            catched = true;\r\n                            unloadVideo($videoPlaying, true, true);\r\n                        } else if (that.fullScreen || (opts.keyboard && !that.index)) {\r\n                            if (e.keyCode === 27) {\r\n                                catched = true;\r\n                                that.cancelFullScreen();\r\n                            } else if ((e.shiftKey && e.keyCode === 32 && allowKey('space')) || (e.keyCode === 37 && allowKey('left')) || (e.keyCode === 38 && allowKey('up') && $(':focus').attr('data-gallery-role'))) {\r\n                                that.longPress.progress();\r\n                                index = '<';\r\n                            } else if ((e.keyCode === 32 && allowKey('space')) || (e.keyCode === 39 && allowKey('right')) || (e.keyCode === 40 && allowKey('down') && $(':focus').attr('data-gallery-role'))) {\r\n                                that.longPress.progress();\r\n                                index = '>';\r\n                            } else if (e.keyCode === 36 && allowKey('home')) {\r\n                                that.longPress.progress();\r\n                                index = '<<';\r\n                            } else if (e.keyCode === 35 && allowKey('end')) {\r\n                                that.longPress.progress();\r\n                                index = '>>';\r\n                            }\r\n                        }\r\n\r\n                        (catched || index) && stopEvent(e);\r\n                        showParams = {index: index, slow: e.altKey, user: true};\r\n                        index && (that.longPress.inProgress ?\r\n                            that.showWhileLongPress(showParams) :\r\n                            that.show(showParams));\r\n                    });\r\n\r\n                if (FLAG) {\r\n                    $DOCUMENT\r\n                        .on(keyupLocal, function (e) {\r\n                            if (that.longPress.inProgress) {\r\n                                that.showEndLongPress({user: true});\r\n                            }\r\n                            that.longPress.reset();\r\n                        });\r\n                }\r\n\r\n                if (!that.index) {\r\n                    $DOCUMENT\r\n                        .off(keydownCommon)\r\n                        .on(keydownCommon, 'textarea, input, select', function (e) {\r\n                            !$BODY.hasClass(_fullscreenClass) && e.stopPropagation();\r\n                        });\r\n                }\r\n\r\n                $WINDOW.on(resizeLocal, that.resize);\r\n            } else {\r\n                $DOCUMENT.off(keydownLocal);\r\n                $WINDOW.off(resizeLocal);\r\n            }\r\n        }\r\n\r\n        function appendElements(FLAG) {\r\n            if (FLAG === appendElements.f) return;\r\n\r\n            if (FLAG) {\r\n                $fotorama\r\n                    .addClass(_fotoramaClass + ' ' + stampClass)\r\n                    .before($anchor)\r\n                    .before($style);\r\n                addInstance(that);\r\n            } else {\r\n                $anchor.detach();\r\n                $style.detach();\r\n                $fotorama\r\n                    .html(fotoramaData.urtext)\r\n                    .removeClass(stampClass);\r\n\r\n                hideInstance(that);\r\n            }\r\n\r\n            bindGlobalEvents(FLAG);\r\n            appendElements.f = FLAG;\r\n        }\r\n\r\n        /**\r\n         * Set and install data from incomming @param {JSON} options or takes data attr from data-\"name\"=... values.\r\n         */\r\n        function setData() {\r\n            data = that.data = data || clone(opts.data) || getDataFromHtml($fotorama);\r\n            size = that.size = data.length;\r\n\r\n            ready.ok && opts.shuffle && shuffle(data);\r\n\r\n            checkForVideo();\r\n\r\n            activeIndex = limitIndex(activeIndex);\r\n\r\n            size && appendElements(true);\r\n        }\r\n\r\n        function stageNoMove() {\r\n            var _noMove = size < 2 || $videoPlaying;\r\n            stageShaftTouchTail.noMove = _noMove || o_fade;\r\n            stageShaftTouchTail.noSwipe = _noMove || !opts.swipe;\r\n\r\n            !o_transition && $stageShaft.toggleClass(grabClass, !opts.click && !stageShaftTouchTail.noMove && !stageShaftTouchTail.noSwipe);\r\n            MS_POINTER && $wrap.toggleClass(wrapPanYClass, !stageShaftTouchTail.noSwipe);\r\n        }\r\n\r\n        function setAutoplayInterval(interval) {\r\n            if (interval === true) interval = '';\r\n            opts.autoplay = Math.max(+interval || AUTOPLAY_INTERVAL, o_transitionDuration * 1.5);\r\n        }\r\n\r\n        function updateThumbArrow(opt) {\r\n            if (opt.navarrows && opt.nav === 'thumbs') {\r\n                $thumbArrLeft.show();\r\n                $thumbArrRight.show();\r\n            } else {\r\n                $thumbArrLeft.hide();\r\n                $thumbArrRight.hide();\r\n            }\r\n\r\n        }\r\n\r\n        function getThumbsInSlide($el, opts) {\r\n            return Math.floor($wrap.width() / (opts.thumbwidth + opts.thumbmargin));\r\n        }\r\n\r\n        /**\r\n         * Options on the fly\r\n         * */\r\n        function setOptions() {\r\n            if (!opts.nav || opts.nav === 'dots') {\r\n                opts.navdir = 'horizontal'\r\n            }\r\n\r\n            that.options = opts = optionsToLowerCase(opts);\r\n            thumbsPerSlide = getThumbsInSlide($wrap, opts);\r\n\r\n            o_fade = (opts.transition === 'crossfade' || opts.transition === 'dissolve');\r\n\r\n            o_loop = opts.loop && (size > 2 || (o_fade && (!o_transition || o_transition !== 'slide')));\r\n\r\n            o_transitionDuration = +opts.transitionduration || TRANSITION_DURATION;\r\n\r\n            o_rtl = opts.direction === 'rtl';\r\n\r\n            o_keyboard = $.extend({}, opts.keyboard && KEYBOARD_OPTIONS, opts.keyboard);\r\n            updateThumbArrow(opts);\r\n            var classes = {add: [], remove: []};\r\n\r\n            function addOrRemoveClass(FLAG, value) {\r\n                classes[FLAG ? 'add' : 'remove'].push(value);\r\n            }\r\n\r\n            if (size > 1) {\r\n                o_nav = opts.nav;\r\n                o_navTop = opts.navposition === 'top';\r\n                classes.remove.push(selectClass);\r\n\r\n                $arrs.toggle(opts.arrows);\r\n            } else {\r\n                o_nav = false;\r\n                $arrs.hide();\r\n            }\r\n\r\n            arrsUpdate();\r\n            stageWheelUpdate();\r\n            thumbArrUpdate();\r\n            if (opts.autoplay) setAutoplayInterval(opts.autoplay);\r\n\r\n            o_thumbSide = numberFromMeasure(opts.thumbwidth) || THUMB_SIZE;\r\n            o_thumbSide2 = numberFromMeasure(opts.thumbheight) || THUMB_SIZE;\r\n\r\n            stageWheelTail.ok = navWheelTail.ok = opts.trackpad && !SLOW;\r\n\r\n            stageNoMove();\r\n\r\n            extendMeasures(opts, [measures]);\r\n\r\n            o_navThumbs = o_nav === 'thumbs';\r\n\r\n            if ($navWrap.filter(':hidden') && !!o_nav) {\r\n                $navWrap.show();\r\n            }\r\n            if (o_navThumbs) {\r\n                frameDraw(size, 'navThumb');\r\n\r\n                $navFrame = $navThumbFrame;\r\n                navFrameKey = NAV_THUMB_FRAME_KEY;\r\n\r\n                setStyle($style, $.Fotorama.jst.style({\r\n                    w: o_thumbSide,\r\n                    h: o_thumbSide2,\r\n                    b: opts.thumbborderwidth,\r\n                    m: opts.thumbmargin,\r\n                    s: stamp,\r\n                    q: !COMPAT\r\n                }));\r\n\r\n                $nav\r\n                    .addClass(navThumbsClass)\r\n                    .removeClass(navDotsClass);\r\n            } else if (o_nav === 'dots') {\r\n                frameDraw(size, 'navDot');\r\n\r\n                $navFrame = $navDotFrame;\r\n                navFrameKey = NAV_DOT_FRAME_KEY;\r\n\r\n                $nav\r\n                    .addClass(navDotsClass)\r\n                    .removeClass(navThumbsClass);\r\n            } else {\r\n                $navWrap.hide();\r\n                o_nav = false;\r\n                $nav.removeClass(navThumbsClass + ' ' + navDotsClass);\r\n            }\r\n\r\n            if (o_nav) {\r\n                if (o_navTop) {\r\n                    $navWrap.insertBefore($stage);\r\n                } else {\r\n                    $navWrap.insertAfter($stage);\r\n                }\r\n                frameAppend.nav = false;\r\n\r\n                frameAppend($navFrame, $navShaft, 'nav');\r\n            }\r\n\r\n            o_allowFullScreen = opts.allowfullscreen;\r\n\r\n            if (o_allowFullScreen) {\r\n                $fullscreenIcon.prependTo($stage);\r\n                o_nativeFullScreen = FULLSCREEN && o_allowFullScreen === 'native';\r\n            } else {\r\n                $fullscreenIcon.detach();\r\n                o_nativeFullScreen = false;\r\n            }\r\n\r\n            addOrRemoveClass(o_fade, wrapFadeClass);\r\n            addOrRemoveClass(!o_fade, wrapSlideClass);\r\n            addOrRemoveClass(!opts.captions, wrapNoCaptionsClass);\r\n            addOrRemoveClass(o_rtl, wrapRtlClass);\r\n            addOrRemoveClass(opts.arrows, wrapToggleArrowsClass);\r\n\r\n            o_shadows = opts.shadows && !SLOW;\r\n            addOrRemoveClass(!o_shadows, wrapNoShadowsClass);\r\n\r\n            $wrap\r\n                .addClass(classes.add.join(' '))\r\n                .removeClass(classes.remove.join(' '));\r\n\r\n            lastOptions = $.extend({}, opts);\r\n            setStagePosition();\r\n        }\r\n\r\n        function normalizeIndex(index) {\r\n            return index < 0 ? (size + (index % size)) % size : index >= size ? index % size : index;\r\n        }\r\n\r\n        function limitIndex(index) {\r\n            return minMaxLimit(index, 0, size - 1);\r\n        }\r\n\r\n        function edgeIndex(index) {\r\n            return o_loop ? normalizeIndex(index) : limitIndex(index);\r\n        }\r\n\r\n        function getPrevIndex(index) {\r\n            return index > 0 || o_loop ? index - 1 : false;\r\n        }\r\n\r\n        function getNextIndex(index) {\r\n            return index < size - 1 || o_loop ? index + 1 : false;\r\n        }\r\n\r\n        function setStageShaftMinmaxAndSnap() {\r\n            stageShaftTouchTail.min = o_loop ? -Infinity : -getPosByIndex(size - 1, measures.w, opts.margin, repositionIndex);\r\n            stageShaftTouchTail.max = o_loop ? Infinity : -getPosByIndex(0, measures.w, opts.margin, repositionIndex);\r\n            stageShaftTouchTail.snap = measures.w + opts.margin;\r\n        }\r\n\r\n        function setNavShaftMinMax() {\r\n\r\n            var isVerticalDir = (opts.navdir === 'vertical');\r\n            var param = isVerticalDir ? $navShaft.height() : $navShaft.width();\r\n            var mainParam = isVerticalDir ? measures.h : measures.nw;\r\n            navShaftTouchTail.min = Math.min(0, mainParam - param);\r\n            navShaftTouchTail.max = 0;\r\n            navShaftTouchTail.direction = opts.navdir;\r\n            $navShaft.toggleClass(grabClass, !(navShaftTouchTail.noMove = navShaftTouchTail.min === navShaftTouchTail.max));\r\n        }\r\n\r\n        function eachIndex(indexes, type, fn) {\r\n            if (typeof indexes === 'number') {\r\n                indexes = new Array(indexes);\r\n                var rangeFLAG = true;\r\n            }\r\n            return $.each(indexes, function (i, index) {\r\n                if (rangeFLAG) index = i;\r\n                if (typeof index === 'number') {\r\n                    var dataFrame = data[normalizeIndex(index)];\r\n\r\n                    if (dataFrame) {\r\n                        var key = '$' + type + 'Frame',\r\n                            $frame = dataFrame[key];\r\n\r\n                        fn.call(this, i, index, dataFrame, $frame, key, $frame && $frame.data());\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        function setMeasures(width, height, ratio, index) {\r\n            if (!measuresSetFLAG || (measuresSetFLAG === '*' && index === startIndex)) {\r\n\r\n                width = measureIsValid(opts.width) || measureIsValid(width) || WIDTH;\r\n                height = measureIsValid(opts.height) || measureIsValid(height) || HEIGHT;\r\n                that.resize({\r\n                    width: width,\r\n                    ratio: opts.ratio || ratio || width / height\r\n                }, 0, index !== startIndex && '*');\r\n            }\r\n        }\r\n\r\n        function loadImg(indexes, type, specialMeasures, again) {\r\n\r\n            eachIndex(indexes, type, function (i, index, dataFrame, $frame, key, frameData) {\r\n\r\n                if (!$frame) return;\r\n\r\n                var fullFLAG = that.fullScreen && !frameData.$full && type === 'stage';\r\n\r\n                if (frameData.$img && !again && !fullFLAG) return;\r\n\r\n                var img = new Image(),\r\n                    $img = $(img),\r\n                    imgData = $img.data();\r\n\r\n                frameData[fullFLAG ? '$full' : '$img'] = $img;\r\n\r\n                var srcKey = type === 'stage' ? (fullFLAG ? 'full' : 'img') : 'thumb',\r\n                    src = dataFrame[srcKey],\r\n                    dummy = fullFLAG ? dataFrame['img'] : dataFrame[type === 'stage' ? 'thumb' : 'img'];\r\n\r\n                if (type === 'navThumb') $frame = frameData.$wrap;\r\n\r\n                function triggerTriggerEvent(event) {\r\n                    var _index = normalizeIndex(index);\r\n                    triggerEvent(event, {\r\n                        index: _index,\r\n                        src: src,\r\n                        frame: data[_index]\r\n                    });\r\n                }\r\n\r\n                function error() {\r\n                    $img.remove();\r\n\r\n                    $.Fotorama.cache[src] = 'error';\r\n\r\n                    if ((!dataFrame.html || type !== 'stage') && dummy && dummy !== src) {\r\n                        dataFrame[srcKey] = src = dummy;\r\n                        frameData.$full = null;\r\n                        loadImg([index], type, specialMeasures, true);\r\n                    } else {\r\n                        if (src && !dataFrame.html && !fullFLAG) {\r\n                            $frame\r\n                                .trigger('f:error')\r\n                                .removeClass(loadingClass)\r\n                                .addClass(errorClass);\r\n\r\n                            triggerTriggerEvent('error');\r\n                        } else if (type === 'stage') {\r\n                            $frame\r\n                                .trigger('f:load')\r\n                                .removeClass(loadingClass + ' ' + errorClass)\r\n                                .addClass(loadedClass);\r\n\r\n                            triggerTriggerEvent('load');\r\n                            setMeasures();\r\n                        }\r\n\r\n                        frameData.state = 'error';\r\n\r\n                        if (size > 1 && data[index] === dataFrame && !dataFrame.html && !dataFrame.deleted && !dataFrame.video && !fullFLAG) {\r\n                            dataFrame.deleted = true;\r\n                            that.splice(index, 1);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                function loaded() {\r\n                    $.Fotorama.measures[src] = imgData.measures = $.Fotorama.measures[src] || {\r\n                            width: img.width,\r\n                            height: img.height,\r\n                            ratio: img.width / img.height\r\n                        };\r\n\r\n                    setMeasures(imgData.measures.width, imgData.measures.height, imgData.measures.ratio, index);\r\n\r\n                    $img\r\n                        .off('load error')\r\n                        .addClass('' + (fullFLAG ? imgFullClass: imgClass))\r\n                        .attr('aria-hidden', 'false')\r\n                        .prependTo($frame);\r\n\r\n                    if ($frame.hasClass(stageFrameClass) && !$frame.hasClass(videoContainerClass)) {\r\n                        $frame.attr(\"href\", $img.attr(\"src\"));\r\n                    }\r\n\r\n                    fit($img, (\r\n                            $.isFunction(specialMeasures) ? specialMeasures() : specialMeasures) || measures);\r\n\r\n                    $.Fotorama.cache[src] = frameData.state = 'loaded';\r\n\r\n                    setTimeout(function () {\r\n                        $frame\r\n                            .trigger('f:load')\r\n                            .removeClass(loadingClass + ' ' + errorClass)\r\n                            .addClass(loadedClass + ' ' + (fullFLAG ? loadedFullClass : loadedImgClass));\r\n\r\n                        if (type === 'stage') {\r\n                            triggerTriggerEvent('load');\r\n                        } else if (dataFrame.thumbratio === AUTO || !dataFrame.thumbratio && opts.thumbratio === AUTO) {\r\n                            // danger! reflow for all thumbnails\r\n                            dataFrame.thumbratio = imgData.measures.ratio;\r\n                            reset();\r\n                        }\r\n                    }, 0);\r\n                }\r\n\r\n                if (!src) {\r\n                    error();\r\n                    return;\r\n                }\r\n\r\n                function waitAndLoad() {\r\n                    var _i = 10;\r\n                    waitFor(function () {\r\n                        return !touchedFLAG || !_i-- && !SLOW;\r\n                    }, function () {\r\n                        loaded();\r\n                    });\r\n                }\r\n\r\n                if (!$.Fotorama.cache[src]) {\r\n                    $.Fotorama.cache[src] = '*';\r\n\r\n                    $img\r\n                        .on('load', waitAndLoad)\r\n                        .on('error', error);\r\n                } else {\r\n                    (function justWait() {\r\n                        if ($.Fotorama.cache[src] === 'error') {\r\n                            error();\r\n                        } else if ($.Fotorama.cache[src] === 'loaded') {\r\n                            setTimeout(waitAndLoad, 0);\r\n                        } else {\r\n                            setTimeout(justWait, 100);\r\n                        }\r\n                    })();\r\n                }\r\n\r\n                frameData.state = '';\r\n                img.src = src;\r\n\r\n                if (frameData.data.caption) {\r\n                    img.alt = frameData.data.caption || \"\";\r\n                }\r\n\r\n                if (frameData.data.full) {\r\n                    $(img).data('original', frameData.data.full);\r\n                }\r\n\r\n                if (UTIL.isExpectedCaption(dataFrame, opts.showcaption)) {\r\n                    $(img).attr('aria-labelledby', dataFrame.labelledby);\r\n                }\r\n            });\r\n        }\r\n\r\n        function updateFotoramaState() {\r\n            var $frame = activeFrame[STAGE_FRAME_KEY];\r\n\r\n            if ($frame && !$frame.data().state) {\r\n                $spinner.addClass(spinnerShowClass);\r\n                $frame.on('f:load f:error', function () {\r\n                    $frame.off('f:load f:error');\r\n                    $spinner.removeClass(spinnerShowClass);\r\n                });\r\n            }\r\n        }\r\n\r\n        function addNavFrameEvents(frame) {\r\n            addEnterUp(frame, onNavFrameClick);\r\n            addFocus(frame, function () {\r\n\r\n                setTimeout(function () {\r\n                    lockScroll($nav);\r\n                }, 0);\r\n                slideNavShaft({time: o_transitionDuration, guessIndex: $(this).data().eq, minMax: navShaftTouchTail});\r\n            });\r\n        }\r\n\r\n        function frameDraw(indexes, type) {\r\n            eachIndex(indexes, type, function (i, index, dataFrame, $frame, key, frameData) {\r\n                if ($frame) return;\r\n\r\n                $frame = dataFrame[key] = $wrap[key].clone();\r\n                frameData = $frame.data();\r\n                frameData.data = dataFrame;\r\n                var frame = $frame[0],\r\n                    labelledbyValue = \"labelledby\" + $.now();\r\n\r\n                if (type === 'stage') {\r\n\r\n                    if (dataFrame.html) {\r\n                        $('<div class=\"' + htmlClass + '\"></div>')\r\n                            .append(\r\n                            dataFrame._html ? $(dataFrame.html)\r\n                                .removeAttr('id')\r\n                                .html(dataFrame._html) // Because of IE\r\n                                : dataFrame.html\r\n                        )\r\n                            .appendTo($frame);\r\n                    }\r\n\r\n                    if (dataFrame.id) {\r\n                        labelledbyValue = dataFrame.id || labelledbyValue;\r\n                    }\r\n                    dataFrame.labelledby = labelledbyValue;\r\n\r\n                    if (UTIL.isExpectedCaption(dataFrame, opts.showcaption)) {\r\n                        $($.Fotorama.jst.frameCaption({\r\n                            caption: dataFrame.caption,\r\n                            labelledby: labelledbyValue\r\n                        })).appendTo($frame);\r\n                    }\r\n\r\n                    dataFrame.video && $frame\r\n                        .addClass(stageFrameVideoClass)\r\n                        .append($videoPlay.clone());\r\n\r\n                    // This solves tabbing problems\r\n                    addFocus(frame, function () {\r\n                        setTimeout(function () {\r\n                            lockScroll($stage);\r\n                        }, 0);\r\n                        clickToShow({index: frameData.eq, user: true});\r\n                    });\r\n\r\n                    $stageFrame = $stageFrame.add($frame);\r\n                } else if (type === 'navDot') {\r\n                    addNavFrameEvents(frame);\r\n                    $navDotFrame = $navDotFrame.add($frame);\r\n                } else if (type === 'navThumb') {\r\n                    addNavFrameEvents(frame);\r\n                    frameData.$wrap = $frame.children(':first');\r\n\r\n                    $navThumbFrame = $navThumbFrame.add($frame);\r\n                    if (dataFrame.video) {\r\n                        frameData.$wrap.append($videoPlay.clone());\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        function callFit($img, measuresToFit) {\r\n            return $img && $img.length && fit($img, measuresToFit);\r\n        }\r\n\r\n        function stageFramePosition(indexes) {\r\n            eachIndex(indexes, 'stage', function (i, index, dataFrame, $frame, key, frameData) {\r\n                if (!$frame) return;\r\n\r\n                var normalizedIndex = normalizeIndex(index);\r\n                frameData.eq = normalizedIndex;\r\n\r\n                toDetach[STAGE_FRAME_KEY][normalizedIndex] = $frame.css($.extend({left: o_fade ? 0 : getPosByIndex(index, measures.w, opts.margin, repositionIndex)}, o_fade && getDuration(0)));\r\n\r\n                if (isDetached($frame[0])) {\r\n                    $frame.appendTo($stageShaft);\r\n                    unloadVideo(dataFrame.$video);\r\n                }\r\n\r\n                callFit(frameData.$img, measures);\r\n                callFit(frameData.$full, measures);\r\n\r\n                if ($frame.hasClass(stageFrameClass) && !($frame.attr('aria-hidden') === \"false\" && $frame.hasClass(activeClass))) {\r\n                    $frame.attr('aria-hidden', 'true');\r\n                }\r\n            });\r\n        }\r\n\r\n        function thumbsDraw(pos, loadFLAG) {\r\n            var leftLimit,\r\n                rightLimit,\r\n                exceedLimit;\r\n\r\n\r\n            if (o_nav !== 'thumbs' || isNaN(pos)) return;\r\n\r\n            leftLimit = -pos;\r\n            rightLimit = -pos + measures.nw;\r\n\r\n            if (opts.navdir === 'vertical') {\r\n                pos = pos - opts.thumbheight;\r\n                rightLimit = -pos + measures.h;\r\n            }\r\n\r\n            $navThumbFrame.each(function () {\r\n                var $this = $(this),\r\n                    thisData = $this.data(),\r\n                    eq = thisData.eq,\r\n                    getSpecialMeasures = function () {\r\n                        return {\r\n                            h: o_thumbSide2,\r\n                            w: thisData.w\r\n                        }\r\n                    },\r\n                    specialMeasures = getSpecialMeasures(),\r\n                    exceedLimit = opts.navdir === 'vertical' ?\r\n                    thisData.t > rightLimit : thisData.l > rightLimit;\r\n                specialMeasures.w = thisData.w;\r\n\r\n                if (thisData.l + thisData.w < leftLimit\r\n                    || exceedLimit\r\n                    || callFit(thisData.$img, specialMeasures)) return;\r\n\r\n                loadFLAG && loadImg([eq], 'navThumb', getSpecialMeasures);\r\n            });\r\n        }\r\n\r\n        function frameAppend($frames, $shaft, type) {\r\n            if (!frameAppend[type]) {\r\n\r\n                var thumbsFLAG = type === 'nav' && o_navThumbs,\r\n                    left = 0,\r\n                    top = 0;\r\n\r\n                $shaft.append(\r\n                    $frames\r\n                        .filter(function () {\r\n                            var actual,\r\n                                $this = $(this),\r\n                                frameData = $this.data();\r\n                            for (var _i = 0, _l = data.length; _i < _l; _i++) {\r\n                                if (frameData.data === data[_i]) {\r\n                                    actual = true;\r\n                                    frameData.eq = _i;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            return actual || $this.remove() && false;\r\n                        })\r\n                        .sort(function (a, b) {\r\n                            return $(a).data().eq - $(b).data().eq;\r\n                        })\r\n                        .each(function () {\r\n                            var $this = $(this),\r\n                                frameData = $this.data();\r\n                            UTIL.setThumbAttr($this, frameData.data.caption, \"aria-label\");\r\n                        })\r\n                        .each(function () {\r\n\r\n                            if (!thumbsFLAG) return;\r\n\r\n                            var $this = $(this),\r\n                                frameData = $this.data(),\r\n                                thumbwidth = Math.round(o_thumbSide2 * frameData.data.thumbratio) || o_thumbSide,\r\n                                thumbheight = Math.round(o_thumbSide / frameData.data.thumbratio) || o_thumbSide2;\r\n                            frameData.t = top;\r\n                            frameData.h = thumbheight;\r\n                            frameData.l = left;\r\n                            frameData.w = thumbwidth;\r\n\r\n                            $this.css({width: thumbwidth});\r\n\r\n                            top += thumbheight + opts.thumbmargin;\r\n                            left += thumbwidth + opts.thumbmargin;\r\n                        })\r\n                );\r\n\r\n                frameAppend[type] = true;\r\n            }\r\n        }\r\n\r\n        function getDirection(x) {\r\n            return x - stageLeft > measures.w / 3;\r\n        }\r\n\r\n        function disableDirrection(i) {\r\n            return !o_loop && (!(activeIndex + i) || !(activeIndex - size + i)) && !$videoPlaying;\r\n        }\r\n\r\n        function arrsUpdate() {\r\n            var disablePrev = disableDirrection(0),\r\n                disableNext = disableDirrection(1);\r\n            $arrPrev\r\n                .toggleClass(arrDisabledClass, disablePrev)\r\n                .attr(disableAttr(disablePrev, false));\r\n            $arrNext\r\n                .toggleClass(arrDisabledClass, disableNext)\r\n                .attr(disableAttr(disableNext, false));\r\n        }\r\n\r\n        function thumbArrUpdate() {\r\n            var isLeftDisable = false,\r\n                isRightDisable = false;\r\n            if (opts.navtype === 'thumbs' && !opts.loop) {\r\n                (activeIndex == 0) ? isLeftDisable = true : isLeftDisable = false;\r\n                (activeIndex == opts.data.length - 1) ? isRightDisable = true : isRightDisable = false;\r\n            }\r\n            if (opts.navtype === 'slides') {\r\n                var pos = readPosition($navShaft, opts.navdir);\r\n                pos >= navShaftTouchTail.max ? isLeftDisable = true : isLeftDisable = false;\r\n                pos <= navShaftTouchTail.min ? isRightDisable = true : isRightDisable = false;\r\n            }\r\n            $thumbArrLeft\r\n                .toggleClass(arrDisabledClass, isLeftDisable)\r\n                .attr(disableAttr(isLeftDisable, true));\r\n            $thumbArrRight\r\n                .toggleClass(arrDisabledClass, isRightDisable)\r\n                .attr(disableAttr(isRightDisable, true));\r\n        }\r\n\r\n        function stageWheelUpdate() {\r\n            if (stageWheelTail.ok) {\r\n                stageWheelTail.prevent = {'<': disableDirrection(0), '>': disableDirrection(1)};\r\n            }\r\n        }\r\n\r\n        function getNavFrameBounds($navFrame) {\r\n            var navFrameData = $navFrame.data(),\r\n                left,\r\n                top,\r\n                width,\r\n                height;\r\n\r\n            if (o_navThumbs) {\r\n                left = navFrameData.l;\r\n                top = navFrameData.t;\r\n                width = navFrameData.w;\r\n                height = navFrameData.h;\r\n            } else {\r\n                left = $navFrame.position().left;\r\n                width = $navFrame.width();\r\n            }\r\n\r\n            var horizontalBounds = {\r\n                c: left + width / 2,\r\n                min: -left + opts.thumbmargin * 10,\r\n                max: -left + measures.w - width - opts.thumbmargin * 10\r\n            };\r\n\r\n            var verticalBounds = {\r\n                c: top + height / 2,\r\n                min: -top + opts.thumbmargin * 10,\r\n                max: -top + measures.h - height - opts.thumbmargin * 10\r\n            };\r\n\r\n            return opts.navdir === 'vertical' ? verticalBounds : horizontalBounds;\r\n        }\r\n\r\n        function slideThumbBorder(time) {\r\n            var navFrameData = activeFrame[navFrameKey].data();\r\n            slide($thumbBorder, {\r\n                time: time * 1.2,\r\n                pos: (opts.navdir === 'vertical' ? navFrameData.t : navFrameData.l),\r\n                width: navFrameData.w,\r\n                height: navFrameData.h,\r\n                direction: opts.navdir\r\n            });\r\n        }\r\n\r\n        function slideNavShaft(options) {\r\n            var $guessNavFrame = data[options.guessIndex][navFrameKey],\r\n                typeOfAnimation = opts.navtype;\r\n\r\n            var overflowFLAG,\r\n                time,\r\n                minMax,\r\n                boundTop,\r\n                boundLeft,\r\n                l,\r\n                pos,\r\n                x;\r\n\r\n            if ($guessNavFrame) {\r\n                if (typeOfAnimation === 'thumbs') {\r\n                    overflowFLAG = navShaftTouchTail.min !== navShaftTouchTail.max;\r\n                    minMax = options.minMax || overflowFLAG && getNavFrameBounds(activeFrame[navFrameKey]);\r\n                    boundTop = overflowFLAG && (options.keep && slideNavShaft.t ? slideNavShaft.l : minMaxLimit((options.coo || measures.nw / 2) - getNavFrameBounds($guessNavFrame).c, minMax.min, minMax.max));\r\n                    boundLeft = overflowFLAG && (options.keep && slideNavShaft.l ? slideNavShaft.l : minMaxLimit((options.coo || measures.nw / 2) - getNavFrameBounds($guessNavFrame).c, minMax.min, minMax.max));\r\n                    l = (opts.navdir === 'vertical' ? boundTop : boundLeft);\r\n                    pos = overflowFLAG && minMaxLimit(l, navShaftTouchTail.min, navShaftTouchTail.max) || 0;\r\n                    time = options.time * 1.1;\r\n                    slide($navShaft, {\r\n                        time: time,\r\n                        pos: pos,\r\n                        direction: opts.navdir,\r\n                        onEnd: function () {\r\n                            thumbsDraw(pos, true);\r\n                            thumbArrUpdate();\r\n                        }\r\n                    });\r\n\r\n                    setShadow($nav, findShadowEdge(pos, navShaftTouchTail.min, navShaftTouchTail.max, opts.navdir));\r\n                    slideNavShaft.l = l;\r\n                } else {\r\n                    x = readPosition($navShaft, opts.navdir);\r\n                    time = options.time * 1.11;\r\n\r\n                    pos = validateSlidePos(opts, navShaftTouchTail, options.guessIndex, x, $guessNavFrame, $navWrap, opts.navdir);\r\n\r\n                    slide($navShaft, {\r\n                        time: time,\r\n                        pos: pos,\r\n                        direction: opts.navdir,\r\n                        onEnd: function () {\r\n                            thumbsDraw(pos, true);\r\n                            thumbArrUpdate();\r\n                        }\r\n                    });\r\n                    setShadow($nav, findShadowEdge(pos, navShaftTouchTail.min, navShaftTouchTail.max, opts.navdir));\r\n                }\r\n            }\r\n        }\r\n\r\n        function navUpdate() {\r\n            deactivateFrames(navFrameKey);\r\n            toDeactivate[navFrameKey].push(activeFrame[navFrameKey].addClass(activeClass).attr('data-active', true));\r\n        }\r\n\r\n        function deactivateFrames(key) {\r\n            var _toDeactivate = toDeactivate[key];\r\n\r\n            while (_toDeactivate.length) {\r\n                _toDeactivate.shift().removeClass(activeClass).attr('data-active', false);\r\n            }\r\n        }\r\n\r\n        function detachFrames(key) {\r\n            var _toDetach = toDetach[key];\r\n\r\n            $.each(activeIndexes, function (i, index) {\r\n                delete _toDetach[normalizeIndex(index)];\r\n            });\r\n\r\n            $.each(_toDetach, function (index, $frame) {\r\n                delete _toDetach[index];\r\n                $frame.detach();\r\n            });\r\n        }\r\n\r\n        function stageShaftReposition(skipOnEnd) {\r\n\r\n            repositionIndex = dirtyIndex = activeIndex;\r\n\r\n            var $frame = activeFrame[STAGE_FRAME_KEY];\r\n\r\n            if ($frame) {\r\n                deactivateFrames(STAGE_FRAME_KEY);\r\n                toDeactivate[STAGE_FRAME_KEY].push($frame.addClass(activeClass).attr('data-active', true));\r\n\r\n                if ($frame.hasClass(stageFrameClass)) {\r\n                    $frame.attr('aria-hidden', 'false');\r\n                }\r\n\r\n                skipOnEnd || that.showStage.onEnd(true);\r\n                stop($stageShaft, 0, true);\r\n\r\n                detachFrames(STAGE_FRAME_KEY);\r\n                stageFramePosition(activeIndexes);\r\n                setStageShaftMinmaxAndSnap();\r\n                setNavShaftMinMax();\r\n                addEnterUp($stageShaft[0], function () {\r\n                    if (!$fotorama.hasClass(fullscreenClass)) {\r\n                        that.requestFullScreen();\r\n                        $fullscreenIcon.focus();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function extendMeasures(options, measuresArray) {\r\n            if (!options) return;\r\n\r\n            $.each(measuresArray, function (i, measures) {\r\n                if (!measures) return;\r\n\r\n                $.extend(measures, {\r\n                    width: options.width || measures.width,\r\n                    height: options.height,\r\n                    minwidth: options.minwidth,\r\n                    maxwidth: options.maxwidth,\r\n                    minheight: options.minheight,\r\n                    maxheight: options.maxheight,\r\n                    ratio: getRatio(options.ratio)\r\n                })\r\n            });\r\n        }\r\n\r\n        function triggerEvent(event, extra) {\r\n            $fotorama.trigger(_fotoramaClass + ':' + event, [that, extra]);\r\n        }\r\n\r\n        function onTouchStart() {\r\n            clearTimeout(onTouchEnd.t);\r\n            touchedFLAG = 1;\r\n\r\n            if (opts.stopautoplayontouch) {\r\n                that.stopAutoplay();\r\n            } else {\r\n                pausedAutoplayFLAG = true;\r\n            }\r\n        }\r\n\r\n        function onTouchEnd() {\r\n            if (!touchedFLAG) return;\r\n            if (!opts.stopautoplayontouch) {\r\n                releaseAutoplay();\r\n                changeAutoplay();\r\n            }\r\n\r\n            onTouchEnd.t = setTimeout(function () {\r\n                touchedFLAG = 0;\r\n            }, TRANSITION_DURATION + TOUCH_TIMEOUT);\r\n        }\r\n\r\n        function releaseAutoplay() {\r\n            pausedAutoplayFLAG = !!($videoPlaying || stoppedAutoplayFLAG);\r\n        }\r\n\r\n        function changeAutoplay() {\r\n\r\n            clearTimeout(changeAutoplay.t);\r\n            waitFor.stop(changeAutoplay.w);\r\n\r\n            if (!opts.autoplay || pausedAutoplayFLAG) {\r\n                if (that.autoplay) {\r\n                    that.autoplay = false;\r\n                    triggerEvent('stopautoplay');\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            if (!that.autoplay) {\r\n                that.autoplay = true;\r\n                triggerEvent('startautoplay');\r\n            }\r\n\r\n            var _activeIndex = activeIndex;\r\n\r\n\r\n            var frameData = activeFrame[STAGE_FRAME_KEY].data();\r\n            changeAutoplay.w = waitFor(function () {\r\n                return frameData.state || _activeIndex !== activeIndex;\r\n            }, function () {\r\n                changeAutoplay.t = setTimeout(function () {\r\n\r\n                    if (pausedAutoplayFLAG || _activeIndex !== activeIndex) return;\r\n\r\n                    var _nextAutoplayIndex = nextAutoplayIndex,\r\n                        nextFrameData = data[_nextAutoplayIndex][STAGE_FRAME_KEY].data();\r\n\r\n                    changeAutoplay.w = waitFor(function () {\r\n\r\n                        return nextFrameData.state || _nextAutoplayIndex !== nextAutoplayIndex;\r\n                    }, function () {\r\n                        if (pausedAutoplayFLAG || _nextAutoplayIndex !== nextAutoplayIndex) return;\r\n                        that.show(o_loop ? getDirectionSign(!o_rtl) : nextAutoplayIndex);\r\n                    });\r\n                }, opts.autoplay);\r\n            });\r\n\r\n        }\r\n\r\n        that.startAutoplay = function (interval) {\r\n            if (that.autoplay) return this;\r\n            pausedAutoplayFLAG = stoppedAutoplayFLAG = false;\r\n            setAutoplayInterval(interval || opts.autoplay);\r\n            changeAutoplay();\r\n\r\n            return this;\r\n        };\r\n\r\n        that.stopAutoplay = function () {\r\n            if (that.autoplay) {\r\n                pausedAutoplayFLAG = stoppedAutoplayFLAG = true;\r\n                changeAutoplay();\r\n            }\r\n            return this;\r\n        };\r\n\r\n        that.showSlide = function (slideDir) {\r\n            var currentPosition = readPosition($navShaft, opts.navdir),\r\n                pos,\r\n                time = 500 * 1.1,\r\n                size = opts.navdir === 'horizontal' ? opts.thumbwidth : opts.thumbheight,\r\n                onEnd = function () {\r\n                    thumbArrUpdate();\r\n                };\r\n            if (slideDir === 'next') {\r\n                pos = currentPosition - (size + opts.margin) * thumbsPerSlide;\r\n            }\r\n            if (slideDir === 'prev') {\r\n                pos = currentPosition + (size + opts.margin) * thumbsPerSlide;\r\n            }\r\n            pos = validateRestrictions(pos, navShaftTouchTail);\r\n            thumbsDraw(pos, true);\r\n            slide($navShaft, {\r\n                time: time,\r\n                pos: pos,\r\n                direction: opts.navdir,\r\n                onEnd: onEnd\r\n            });\r\n        };\r\n\r\n        that.showWhileLongPress = function (options) {\r\n            if (that.longPress.singlePressInProgress) {\r\n                return;\r\n            }\r\n\r\n            var index = calcActiveIndex(options);\r\n            calcGlobalIndexes(index);\r\n            var time = calcTime(options) / 50;\r\n            var _activeFrame = activeFrame;\r\n            that.activeFrame = activeFrame = data[activeIndex];\r\n            var silent = _activeFrame === activeFrame && !options.user;\r\n\r\n            that.showNav(silent, options, time);\r\n\r\n            return this;\r\n        };\r\n\r\n        that.showEndLongPress = function (options) {\r\n            if (that.longPress.singlePressInProgress) {\r\n                return;\r\n            }\r\n\r\n            var index = calcActiveIndex(options);\r\n            calcGlobalIndexes(index);\r\n            var time = calcTime(options) / 50;\r\n            var _activeFrame = activeFrame;\r\n            that.activeFrame = activeFrame = data[activeIndex];\r\n\r\n            var silent = _activeFrame === activeFrame && !options.user;\r\n\r\n            that.showStage(silent, options, time);\r\n\r\n            showedFLAG = typeof lastActiveIndex !== 'undefined' && lastActiveIndex !== activeIndex;\r\n            lastActiveIndex = activeIndex;\r\n            return this;\r\n        };\r\n\r\n        function calcActiveIndex (options) {\r\n            var index;\r\n\r\n            if (typeof options !== 'object') {\r\n                index = options;\r\n                options = {};\r\n            } else {\r\n                index = options.index;\r\n            }\r\n\r\n            index = index === '>' ? dirtyIndex + 1 : index === '<' ? dirtyIndex - 1 : index === '<<' ? 0 : index === '>>' ? size - 1 : index;\r\n            index = isNaN(index) ? undefined : index;\r\n            index = typeof index === 'undefined' ? activeIndex || 0 : index;\r\n\r\n            return index;\r\n        }\r\n\r\n        function calcGlobalIndexes (index) {\r\n            that.activeIndex = activeIndex = edgeIndex(index);\r\n            prevIndex = getPrevIndex(activeIndex);\r\n            nextIndex = getNextIndex(activeIndex);\r\n            nextAutoplayIndex = normalizeIndex(activeIndex + (o_rtl ? -1 : 1));\r\n            activeIndexes = [activeIndex, prevIndex, nextIndex];\r\n\r\n            dirtyIndex = o_loop ? index : activeIndex;\r\n        }\r\n\r\n        function calcTime (options) {\r\n            var diffIndex = Math.abs(lastActiveIndex - dirtyIndex),\r\n                time = getNumber(options.time, function () {\r\n                    return Math.min(o_transitionDuration * (1 + (diffIndex - 1) / 12), o_transitionDuration * 2);\r\n                });\r\n\r\n            if (options.slow) {\r\n                time *= 10;\r\n            }\r\n\r\n            return time;\r\n        }\r\n\r\n        that.showStage = function (silent, options, time) {\r\n            unloadVideo($videoPlaying, activeFrame.i !== data[normalizeIndex(repositionIndex)].i);\r\n            frameDraw(activeIndexes, 'stage');\r\n            stageFramePosition(SLOW ? [dirtyIndex] : [dirtyIndex, getPrevIndex(dirtyIndex), getNextIndex(dirtyIndex)]);\r\n            updateTouchTails('go', true);\r\n\r\n            silent || triggerEvent('show', {\r\n                user: options.user,\r\n                time: time\r\n            });\r\n\r\n            pausedAutoplayFLAG = true;\r\n\r\n            var overPos = options.overPos;\r\n            var onEnd = that.showStage.onEnd = function (skipReposition) {\r\n                if (onEnd.ok) return;\r\n                onEnd.ok = true;\r\n\r\n                skipReposition || stageShaftReposition(true);\r\n\r\n                if (!silent) {\r\n                    triggerEvent('showend', {\r\n                        user: options.user\r\n                    });\r\n                }\r\n\r\n                if (!skipReposition && o_transition && o_transition !== opts.transition) {\r\n                    that.setOptions({transition: o_transition});\r\n                    o_transition = false;\r\n                    return;\r\n                }\r\n\r\n                updateFotoramaState();\r\n                loadImg(activeIndexes, 'stage');\r\n\r\n                updateTouchTails('go', false);\r\n                stageWheelUpdate();\r\n\r\n                stageCursor();\r\n                releaseAutoplay();\r\n                changeAutoplay();\r\n\r\n                if (that.fullScreen) {\r\n                    activeFrame[STAGE_FRAME_KEY].find('.' + imgFullClass).attr('aria-hidden', false);\r\n                    activeFrame[STAGE_FRAME_KEY].find('.' + imgClass).attr('aria-hidden', true)\r\n                } else {\r\n                    activeFrame[STAGE_FRAME_KEY].find('.' + imgFullClass).attr('aria-hidden', true);\r\n                    activeFrame[STAGE_FRAME_KEY].find('.' + imgClass).attr('aria-hidden', false)\r\n                }\r\n            };\r\n\r\n            if (!o_fade) {\r\n                slide($stageShaft, {\r\n                    pos: -getPosByIndex(dirtyIndex, measures.w, opts.margin, repositionIndex),\r\n                    overPos: overPos,\r\n                    time: time,\r\n                    onEnd: onEnd\r\n                });\r\n            } else {\r\n                var $activeFrame = activeFrame[STAGE_FRAME_KEY],\r\n                    $prevActiveFrame = data[lastActiveIndex] && activeIndex !== lastActiveIndex ? data[lastActiveIndex][STAGE_FRAME_KEY] : null;\r\n\r\n                fade($activeFrame, $prevActiveFrame, $stageFrame, {\r\n                    time: time,\r\n                    method: opts.transition,\r\n                    onEnd: onEnd\r\n                }, fadeStack);\r\n            }\r\n\r\n            arrsUpdate();\r\n        };\r\n\r\n        that.showNav = function(silent, options, time){\r\n            thumbArrUpdate();\r\n            if (o_nav) {\r\n                navUpdate();\r\n\r\n                var guessIndex = limitIndex(activeIndex + minMaxLimit(dirtyIndex - lastActiveIndex, -1, 1));\r\n                slideNavShaft({\r\n                    time: time,\r\n                    coo: guessIndex !== activeIndex && options.coo,\r\n                    guessIndex: typeof options.coo !== 'undefined' ? guessIndex : activeIndex,\r\n                    keep: silent\r\n                });\r\n                if (o_navThumbs) slideThumbBorder(time);\r\n            }\r\n        };\r\n\r\n        that.show = function (options) {\r\n            that.longPress.singlePressInProgress = true;\r\n\r\n            var index = calcActiveIndex(options);\r\n            calcGlobalIndexes(index);\r\n            var time = calcTime(options);\r\n            var _activeFrame = activeFrame;\r\n            that.activeFrame = activeFrame = data[activeIndex];\r\n\r\n            var silent = _activeFrame === activeFrame && !options.user;\r\n\r\n            that.showStage(silent, options, time);\r\n            that.showNav(silent, options, time);\r\n\r\n            showedFLAG = typeof lastActiveIndex !== 'undefined' && lastActiveIndex !== activeIndex;\r\n            lastActiveIndex = activeIndex;\r\n            that.longPress.singlePressInProgress = false;\r\n\r\n            return this;\r\n        };\r\n\r\n        that.requestFullScreen = function () {\r\n            if (o_allowFullScreen && !that.fullScreen) {\r\n\r\n                //check that this is not video\r\n                var isVideo = $((that.activeFrame || {}).$stageFrame || {}).hasClass('fotorama-video-container');\r\n                if(isVideo) {\r\n                    return;\r\n                }\r\n\r\n                scrollTop = $WINDOW.scrollTop();\r\n                scrollLeft = $WINDOW.scrollLeft();\r\n\r\n                lockScroll($WINDOW);\r\n\r\n                updateTouchTails('x', true);\r\n\r\n                measuresStash = $.extend({}, measures);\r\n\r\n                $fotorama\r\n                    .addClass(fullscreenClass)\r\n                    .appendTo($BODY.addClass(_fullscreenClass));\r\n\r\n                $HTML.addClass(_fullscreenClass);\r\n\r\n                unloadVideo($videoPlaying, true, true);\r\n\r\n                that.fullScreen = true;\r\n\r\n                if (o_nativeFullScreen) {\r\n                    fullScreenApi.request(fotorama);\r\n                }\r\n\r\n                that.resize();\r\n                loadImg(activeIndexes, 'stage');\r\n                updateFotoramaState();\r\n                triggerEvent('fullscreenenter');\r\n\r\n                if (!('ontouchstart' in window)) {\r\n                    $fullscreenIcon.focus();\r\n                }\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        function cancelFullScreen() {\r\n            if (that.fullScreen) {\r\n                that.fullScreen = false;\r\n\r\n                if (FULLSCREEN) {\r\n                    fullScreenApi.cancel(fotorama);\r\n                }\r\n\r\n                $BODY.removeClass(_fullscreenClass);\r\n                $HTML.removeClass(_fullscreenClass);\r\n\r\n                $fotorama\r\n                    .removeClass(fullscreenClass)\r\n                    .insertAfter($anchor);\r\n\r\n                measures = $.extend({}, measuresStash);\r\n\r\n                unloadVideo($videoPlaying, true, true);\r\n\r\n                updateTouchTails('x', false);\r\n\r\n                that.resize();\r\n                loadImg(activeIndexes, 'stage');\r\n\r\n                lockScroll($WINDOW, scrollLeft, scrollTop);\r\n\r\n                triggerEvent('fullscreenexit');\r\n            }\r\n        }\r\n\r\n        that.cancelFullScreen = function () {\r\n            if (o_nativeFullScreen && fullScreenApi.is()) {\r\n                fullScreenApi.cancel(document);\r\n            } else {\r\n                cancelFullScreen();\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        that.toggleFullScreen = function () {\r\n            return that[(that.fullScreen ? 'cancel' : 'request') + 'FullScreen']();\r\n        };\r\n\r\n        that.resize = function (options) {\r\n            if (!data) return this;\r\n\r\n            var time = arguments[1] || 0,\r\n                setFLAG = arguments[2];\r\n\r\n            thumbsPerSlide = getThumbsInSlide($wrap, opts);\r\n            extendMeasures(!that.fullScreen ? optionsToLowerCase(options) : {\r\n                width: $(window).width(),\r\n                maxwidth: null,\r\n                minwidth: null,\r\n                height: $(window).height(),\r\n                maxheight: null,\r\n                minheight: null\r\n            }, [measures, setFLAG || that.fullScreen || opts]);\r\n\r\n            var width = measures.width,\r\n                height = measures.height,\r\n                ratio = measures.ratio,\r\n                windowHeight = $WINDOW.height() - (o_nav ? $nav.height() : 0);\r\n\r\n            if (measureIsValid(width)) {\r\n                $wrap.css({width: ''});\r\n                $wrap.css({height: ''});\r\n                $stage.css({width: ''});\r\n                $stage.css({height: ''});\r\n                $stageShaft.css({width: ''});\r\n                $stageShaft.css({height: ''});\r\n                $nav.css({width: ''});\r\n                $nav.css({height: ''});\r\n                $wrap.css({minWidth: measures.minwidth || 0, maxWidth: measures.maxwidth || MAX_WIDTH});\r\n\r\n                if (o_nav === 'dots') {\r\n                    $navWrap.hide();\r\n                }\r\n                width = measures.W = measures.w = $wrap.width();\r\n                measures.nw = o_nav && numberFromWhatever(opts.navwidth, width) || width;\r\n\r\n                $stageShaft.css({width: measures.w, marginLeft: (measures.W - measures.w) / 2});\r\n\r\n                height = numberFromWhatever(height, windowHeight);\r\n\r\n                height = height || (ratio && width / ratio);\r\n\r\n                if (height) {\r\n                    width = Math.round(width);\r\n                    height = measures.h = Math.round(minMaxLimit(height, numberFromWhatever(measures.minheight, windowHeight), numberFromWhatever(measures.maxheight, windowHeight)));\r\n                    $stage.css({'width': width, 'height': height});\r\n\r\n                    if (opts.navdir === 'vertical' && !that.fullscreen) {\r\n                        $nav.width(opts.thumbwidth + opts.thumbmargin * 2);\r\n                    }\r\n\r\n                    if (opts.navdir === 'horizontal' && !that.fullscreen) {\r\n                        $nav.height(opts.thumbheight + opts.thumbmargin * 2);\r\n                    }\r\n\r\n                    if (o_nav === 'dots') {\r\n                        $nav.width(width)\r\n                            .height('auto');\r\n                        $navWrap.show();\r\n                    }\r\n\r\n                    if (opts.navdir === 'vertical' && that.fullScreen) {\r\n                        $stage.css('height', $WINDOW.height());\r\n                    }\r\n\r\n                    if (opts.navdir === 'horizontal' && that.fullScreen) {\r\n                        $stage.css('height', $WINDOW.height() - $nav.height());\r\n                    }\r\n\r\n                    if (o_nav) {\r\n                        switch (opts.navdir) {\r\n                            case 'vertical':\r\n                                $navWrap.removeClass(navShafthorizontalClass);\r\n                                $navWrap.removeClass(navShaftListClass);\r\n                                $navWrap.addClass(navShaftVerticalClass);\r\n                                $nav\r\n                                    .stop()\r\n                                    .animate({height: measures.h, width: opts.thumbwidth}, time);\r\n                                break;\r\n                            case 'list':\r\n                                $navWrap.removeClass(navShaftVerticalClass);\r\n                                $navWrap.removeClass(navShafthorizontalClass);\r\n                                $navWrap.addClass(navShaftListClass);\r\n                                break;\r\n                            default:\r\n                                $navWrap.removeClass(navShaftVerticalClass);\r\n                                $navWrap.removeClass(navShaftListClass);\r\n                                $navWrap.addClass(navShafthorizontalClass);\r\n                                $nav\r\n                                    .stop()\r\n                                    .animate({width: measures.nw}, time);\r\n                                break;\r\n                        }\r\n\r\n                        stageShaftReposition();\r\n                        slideNavShaft({guessIndex: activeIndex, time: time, keep: true});\r\n                        if (o_navThumbs && frameAppend.nav) slideThumbBorder(time);\r\n                    }\r\n\r\n                    measuresSetFLAG = setFLAG || true;\r\n\r\n                    ready.ok = true;\r\n                    ready();\r\n                }\r\n            }\r\n\r\n            stageLeft = $stage.offset().left;\r\n            setStagePosition();\r\n\r\n            return this;\r\n        };\r\n\r\n        that.setOptions = function (options) {\r\n            $.extend(opts, options);\r\n            reset();\r\n            return this;\r\n        };\r\n\r\n        that.shuffle = function () {\r\n            data && shuffle(data) && reset();\r\n            return this;\r\n        };\r\n\r\n        function setShadow($el, edge) {\r\n            if (o_shadows) {\r\n                $el.removeClass(shadowsLeftClass + ' ' + shadowsRightClass);\r\n                $el.removeClass(shadowsTopClass + ' ' + shadowsBottomClass);\r\n                edge && !$videoPlaying && $el.addClass(edge.replace(/^|\\s/g, ' ' + shadowsClass + '--'));\r\n            }\r\n        }\r\n\r\n        that.longPress = {\r\n            threshold: 1,\r\n            count: 0,\r\n            thumbSlideTime: 20,\r\n            progress: function(){\r\n                if (!this.inProgress) {\r\n                    this.count++;\r\n                    this.inProgress = this.count > this.threshold;\r\n                }\r\n            },\r\n            end: function(){\r\n                if(this.inProgress) {\r\n                    this.isEnded = true\r\n                }\r\n            },\r\n            reset: function(){\r\n                this.count = 0;\r\n                this.inProgress = false;\r\n                this.isEnded = false;\r\n            }\r\n        };\r\n\r\n        that.destroy = function () {\r\n            that.cancelFullScreen();\r\n            that.stopAutoplay();\r\n\r\n            data = that.data = null;\r\n\r\n            appendElements();\r\n\r\n            activeIndexes = [];\r\n            detachFrames(STAGE_FRAME_KEY);\r\n\r\n            reset.ok = false;\r\n\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         *\r\n         * @returns {jQuery.Fotorama}\r\n         */\r\n        that.playVideo = function () {\r\n            var dataFrame = activeFrame,\r\n                video = dataFrame.video,\r\n                _activeIndex = activeIndex;\r\n\r\n            if (typeof video === 'object' && dataFrame.videoReady) {\r\n                o_nativeFullScreen && that.fullScreen && that.cancelFullScreen();\r\n\r\n                waitFor(function () {\r\n                    return !fullScreenApi.is() || _activeIndex !== activeIndex;\r\n                }, function () {\r\n                    if (_activeIndex === activeIndex) {\r\n                        dataFrame.$video = dataFrame.$video || $(div(videoClass)).append(createVideoFrame(video));\r\n                        dataFrame.$video.appendTo(dataFrame[STAGE_FRAME_KEY]);\r\n\r\n                        $wrap.addClass(wrapVideoClass);\r\n                        $videoPlaying = dataFrame.$video;\r\n\r\n                        stageNoMove();\r\n\r\n                        $arrs.blur();\r\n                        $fullscreenIcon.blur();\r\n\r\n                        triggerEvent('loadvideo');\r\n                    }\r\n                });\r\n            }\r\n\r\n            return this;\r\n        };\r\n\r\n        that.stopVideo = function () {\r\n            unloadVideo($videoPlaying, true, true);\r\n            return this;\r\n        };\r\n\r\n        that.spliceByIndex = function (index, newImgObj) {\r\n            newImgObj.i = index + 1;\r\n            newImgObj.img && $.ajax({\r\n                url: newImgObj.img,\r\n                type: 'HEAD',\r\n                success: function () {\r\n                    data.splice(index, 1, newImgObj);\r\n                    reset();\r\n                }\r\n            });\r\n        };\r\n\r\n        function unloadVideo($video, unloadActiveFLAG, releaseAutoplayFLAG) {\r\n            if (unloadActiveFLAG) {\r\n                $wrap.removeClass(wrapVideoClass);\r\n                $videoPlaying = false;\r\n\r\n                stageNoMove();\r\n            }\r\n\r\n            if ($video && $video !== $videoPlaying) {\r\n                $video.remove();\r\n                triggerEvent('unloadvideo');\r\n            }\r\n\r\n            if (releaseAutoplayFLAG) {\r\n                releaseAutoplay();\r\n                changeAutoplay();\r\n            }\r\n        }\r\n\r\n        function toggleControlsClass(FLAG) {\r\n            $wrap.toggleClass(wrapNoControlsClass, FLAG);\r\n        }\r\n\r\n        function stageCursor(e) {\r\n            if (stageShaftTouchTail.flow) return;\r\n\r\n            var x = e ? e.pageX : stageCursor.x,\r\n                pointerFLAG = x && !disableDirrection(getDirection(x)) && opts.click;\r\n\r\n            if (stageCursor.p !== pointerFLAG\r\n                && $stage.toggleClass(pointerClass, pointerFLAG)) {\r\n                stageCursor.p = pointerFLAG;\r\n                stageCursor.x = x;\r\n            }\r\n        }\r\n\r\n        $stage.on('mousemove', stageCursor);\r\n\r\n        function clickToShow(showOptions) {\r\n            clearTimeout(clickToShow.t);\r\n\r\n            if (opts.clicktransition && opts.clicktransition !== opts.transition) {\r\n                setTimeout(function () {\r\n                    var _o_transition = opts.transition;\r\n\r\n                    that.setOptions({transition: opts.clicktransition});\r\n\r\n                    // now safe to pass base transition to o_transition, so that.show will restor it\r\n                    o_transition = _o_transition;\r\n                    // this timeout is here to prevent jerking in some browsers\r\n                    clickToShow.t = setTimeout(function () {\r\n                        that.show(showOptions);\r\n                    }, 10);\r\n                }, 0);\r\n            } else {\r\n                that.show(showOptions);\r\n            }\r\n        }\r\n\r\n        function onStageTap(e, toggleControlsFLAG) {\r\n            var target = e.target,\r\n                $target = $(target);\r\n            if ($target.hasClass(videoPlayClass)) {\r\n                that.playVideo();\r\n            } else if (target === fullscreenIcon) {\r\n                that.toggleFullScreen();\r\n            } else if ($videoPlaying) {\r\n                target === videoClose && unloadVideo($videoPlaying, true, true);\r\n            } else if (!$fotorama.hasClass(fullscreenClass)) {\r\n                that.requestFullScreen();\r\n            }\r\n        }\r\n\r\n        function updateTouchTails(key, value) {\r\n            stageShaftTouchTail[key] = navShaftTouchTail[key] = value;\r\n        }\r\n\r\n        stageShaftTouchTail = moveOnTouch($stageShaft, {\r\n            onStart: onTouchStart,\r\n            onMove: function (e, result) {\r\n                setShadow($stage, result.edge);\r\n            },\r\n            onTouchEnd: onTouchEnd,\r\n            onEnd: function (result) {\r\n                var toggleControlsFLAG;\r\n\r\n                setShadow($stage);\r\n                toggleControlsFLAG = (MS_POINTER && !hoverFLAG || result.touch) &&\r\n                    opts.arrows;\r\n\r\n                if ((result.moved || (toggleControlsFLAG && result.pos !== result.newPos && !result.control)) && result.$target[0] !== $fullscreenIcon[0]) {\r\n                    var index = getIndexByPos(result.newPos, measures.w, opts.margin, repositionIndex);\r\n                    \r\n                    that.show({\r\n                        index: index,\r\n                        time: o_fade ? o_transitionDuration : result.time,\r\n                        overPos: result.overPos,\r\n                        user: true\r\n                    });\r\n                } else if (!result.aborted && !result.control) {\r\n                    onStageTap(result.startEvent, toggleControlsFLAG);\r\n                }\r\n            },\r\n            timeLow: 1,\r\n            timeHigh: 1,\r\n            friction: 2,\r\n            select: '.' + selectClass + ', .' + selectClass + ' *',\r\n            $wrap: $stage,\r\n            direction: 'horizontal'\r\n\r\n        });\r\n\r\n        navShaftTouchTail = moveOnTouch($navShaft, {\r\n            onStart: onTouchStart,\r\n            onMove: function (e, result) {\r\n                setShadow($nav, result.edge);\r\n            },\r\n            onTouchEnd: onTouchEnd,\r\n            onEnd: function (result) {\r\n\r\n                function onEnd() {\r\n                    slideNavShaft.l = result.newPos;\r\n                    releaseAutoplay();\r\n                    changeAutoplay();\r\n                    thumbsDraw(result.newPos, true);\r\n                    thumbArrUpdate();\r\n                }\r\n\r\n                if (!result.moved) {\r\n                    var target = result.$target.closest('.' + navFrameClass, $navShaft)[0];\r\n                    target && onNavFrameClick.call(target, result.startEvent);\r\n                } else if (result.pos !== result.newPos) {\r\n                    pausedAutoplayFLAG = true;\r\n                    slide($navShaft, {\r\n                        time: result.time,\r\n                        pos: result.newPos,\r\n                        overPos: result.overPos,\r\n                        direction: opts.navdir,\r\n                        onEnd: onEnd\r\n                    });\r\n                    thumbsDraw(result.newPos);\r\n                    o_shadows && setShadow($nav, findShadowEdge(result.newPos, navShaftTouchTail.min, navShaftTouchTail.max, result.dir));\r\n                } else {\r\n                    onEnd();\r\n                }\r\n            },\r\n            timeLow: .5,\r\n            timeHigh: 2,\r\n            friction: 5,\r\n            $wrap: $nav,\r\n            direction: opts.navdir\r\n        });\r\n\r\n        stageWheelTail = wheel($stage, {\r\n            shift: true,\r\n            onEnd: function (e, direction) {\r\n                onTouchStart();\r\n                onTouchEnd();\r\n                that.show({index: direction, slow: e.altKey})\r\n            }\r\n        });\r\n\r\n        navWheelTail = wheel($nav, {\r\n            onEnd: function (e, direction) {\r\n                onTouchStart();\r\n                onTouchEnd();\r\n                var newPos = stop($navShaft) + direction * .25;\r\n                $navShaft.css(getTranslate(minMaxLimit(newPos, navShaftTouchTail.min, navShaftTouchTail.max), opts.navdir));\r\n                o_shadows && setShadow($nav, findShadowEdge(newPos, navShaftTouchTail.min, navShaftTouchTail.max, opts.navdir));\r\n                navWheelTail.prevent = {'<': newPos >= navShaftTouchTail.max, '>': newPos <= navShaftTouchTail.min};\r\n                clearTimeout(navWheelTail.t);\r\n                navWheelTail.t = setTimeout(function () {\r\n                    slideNavShaft.l = newPos;\r\n                    thumbsDraw(newPos, true)\r\n                }, TOUCH_TIMEOUT);\r\n                thumbsDraw(newPos);\r\n            }\r\n        });\r\n\r\n        $wrap.hover(\r\n            function () {\r\n                setTimeout(function () {\r\n                    if (touchedFLAG) return;\r\n                    toggleControlsClass(!(hoverFLAG = true));\r\n                }, 0);\r\n            },\r\n            function () {\r\n                if (!hoverFLAG) return;\r\n                toggleControlsClass(!(hoverFLAG = false));\r\n            }\r\n        );\r\n\r\n        function onNavFrameClick(e) {\r\n            var index = $(this).data().eq;\r\n\r\n            if (opts.navtype === 'thumbs') {\r\n                clickToShow({index: index, slow: e.altKey, user: true, coo: e._x - $nav.offset().left});\r\n            } else {\r\n                clickToShow({index: index, slow: e.altKey, user: true});\r\n            }\r\n        }\r\n\r\n        function onArrClick(e) {\r\n            clickToShow({index: $arrs.index(this) ? '>' : '<', slow: e.altKey, user: true});\r\n        }\r\n\r\n        smartClick($arrs, function (e) {\r\n            stopEvent(e);\r\n            onArrClick.call(this, e);\r\n        }, {\r\n            onStart: function () {\r\n                onTouchStart();\r\n                stageShaftTouchTail.control = true;\r\n            },\r\n            onTouchEnd: onTouchEnd\r\n        });\r\n\r\n        smartClick($thumbArrLeft, function (e) {\r\n            stopEvent(e);\r\n            if (opts.navtype === 'thumbs') {\r\n\r\n                that.show('<');\r\n            } else {\r\n                that.showSlide('prev')\r\n            }\r\n        });\r\n\r\n        smartClick($thumbArrRight, function (e) {\r\n            stopEvent(e);\r\n            if (opts.navtype === 'thumbs') {\r\n                that.show('>');\r\n            } else {\r\n                that.showSlide('next')\r\n            }\r\n\r\n        });\r\n\r\n\r\n        function addFocusOnControls(el) {\r\n            addFocus(el, function () {\r\n                setTimeout(function () {\r\n                    lockScroll($stage);\r\n                }, 0);\r\n                toggleControlsClass(false);\r\n            });\r\n        }\r\n\r\n        $arrs.each(function () {\r\n            addEnterUp(this, function (e) {\r\n                onArrClick.call(this, e);\r\n            });\r\n            addFocusOnControls(this);\r\n        });\r\n\r\n        addEnterUp(fullscreenIcon, function () {\r\n            if ($fotorama.hasClass(fullscreenClass)) {\r\n                that.cancelFullScreen();\r\n                $stageShaft.focus();\r\n            } else {\r\n                that.requestFullScreen();\r\n                $fullscreenIcon.focus();\r\n            }\r\n\r\n        });\r\n        addFocusOnControls(fullscreenIcon);\r\n\r\n        function reset() {\r\n            setData();\r\n            setOptions();\r\n\r\n            if (!reset.i) {\r\n                reset.i = true;\r\n                // Only once\r\n                var _startindex = opts.startindex;\r\n                activeIndex = repositionIndex = dirtyIndex = lastActiveIndex = startIndex = edgeIndex(_startindex) || 0;\r\n                /*(o_rtl ? size - 1 : 0)*///;\r\n            }\r\n\r\n            if (size) {\r\n                if (changeToRtl()) return;\r\n\r\n                if ($videoPlaying) {\r\n                    unloadVideo($videoPlaying, true);\r\n                }\r\n\r\n                activeIndexes = [];\r\n                detachFrames(STAGE_FRAME_KEY);\r\n\r\n                reset.ok = true;\r\n\r\n                that.show({index: activeIndex, time: 0});\r\n                that.resize();\r\n            } else {\r\n                that.destroy();\r\n            }\r\n        }\r\n\r\n        function changeToRtl() {\r\n\r\n            if (!changeToRtl.f === o_rtl) {\r\n                changeToRtl.f = o_rtl;\r\n                activeIndex = size - 1 - activeIndex;\r\n                that.reverse();\r\n\r\n                return true;\r\n            }\r\n        }\r\n\r\n        $.each('load push pop shift unshift reverse sort splice'.split(' '), function (i, method) {\r\n            that[method] = function () {\r\n                data = data || [];\r\n                if (method !== 'load') {\r\n                    Array.prototype[method].apply(data, arguments);\r\n                } else if (arguments[0] && typeof arguments[0] === 'object' && arguments[0].length) {\r\n                    data = clone(arguments[0]);\r\n                }\r\n                reset();\r\n                return that;\r\n            }\r\n        });\r\n\r\n        function ready() {\r\n            if (ready.ok) {\r\n                ready.ok = false;\r\n                triggerEvent('ready');\r\n            }\r\n        }\r\n\r\n        reset();\r\n    };\r\n    $.fn.fotorama = function (opts) {\r\n        return this.each(function () {\r\n            var that = this,\r\n                $fotorama = $(this),\r\n                fotoramaData = $fotorama.data(),\r\n                fotorama = fotoramaData.fotorama;\r\n\r\n            if (!fotorama) {\r\n                waitFor(function () {\r\n                    return !isHidden(that);\r\n                }, function () {\r\n                    fotoramaData.urtext = $fotorama.html();\r\n                    new $.Fotorama($fotorama,\r\n                        $.extend(\r\n                            {},\r\n                            OPTIONS,\r\n                            window.fotoramaDefaults,\r\n                            opts,\r\n                            fotoramaData\r\n                        )\r\n                    );\r\n                });\r\n            } else {\r\n                fotorama.setOptions(opts, true);\r\n            }\r\n        });\r\n    };\r\n    $.Fotorama.instances = [];\r\n\r\n    function calculateIndexes() {\r\n        $.each($.Fotorama.instances, function (index, instance) {\r\n            instance.index = index;\r\n        });\r\n    }\r\n\r\n    function addInstance(instance) {\r\n        $.Fotorama.instances.push(instance);\r\n        calculateIndexes();\r\n    }\r\n\r\n    function hideInstance(instance) {\r\n        $.Fotorama.instances.splice(instance.index, 1);\r\n        calculateIndexes();\r\n    }\r\n\r\n    $.Fotorama.cache = {};\r\n    $.Fotorama.measures = {};\r\n    $ = $ || {};\r\n    $.Fotorama = $.Fotorama || {};\r\n    $.Fotorama.jst = $.Fotorama.jst || {};\r\n\r\n    $.Fotorama.jst.dots = function (v) {\r\n        var __t, __p = '', __e = _.escape;\r\n        __p += '<div class=\"fotorama__nav__frame fotorama__nav__frame--dot\" tabindex=\"0\" role=\"button\" data-gallery-role=\"nav-frame\" data-nav-type=\"thumb\" aria-label>\\r\\n    <div class=\"fotorama__dot\"></div>\\r\\n</div>';\r\n        return __p\r\n    };\r\n\r\n    $.Fotorama.jst.frameCaption = function (v) {\r\n        var __t, __p = '', __e = _.escape;\r\n        __p += '<div class=\"fotorama__caption\" aria-hidden=\"true\">\\r\\n    <div class=\"fotorama__caption__wrap\" id=\"' +\r\n            ((__t = ( v.labelledby )) == null ? '' : __t) +\r\n            '\">' +\r\n            ((__t = ( v.caption )) == null ? '' : __t) +\r\n            '</div>\\r\\n</div>\\r\\n';\r\n        return __p\r\n    };\r\n\r\n    $.Fotorama.jst.style = function (v) {\r\n        var __t, __p = '', __e = _.escape;\r\n        __p += '.fotorama' +\r\n            ((__t = ( v.s )) == null ? '' : __t) +\r\n            ' .fotorama__nav--thumbs .fotorama__nav__frame{\\r\\npadding:' +\r\n            ((__t = ( v.m )) == null ? '' : __t) +\r\n            'px;\\r\\nheight:' +\r\n            ((__t = ( v.h )) == null ? '' : __t) +\r\n            'px}\\r\\n.fotorama' +\r\n            ((__t = ( v.s )) == null ? '' : __t) +\r\n            ' .fotorama__thumb-border{\\r\\nheight:' +\r\n            ((__t = ( v.h )) == null ? '' : __t) +\r\n            'px;\\r\\nborder-width:' +\r\n            ((__t = ( v.b )) == null ? '' : __t) +\r\n            'px;\\r\\nmargin-top:' +\r\n            ((__t = ( v.m )) == null ? '' : __t) +\r\n            'px}';\r\n        return __p\r\n    };\r\n\r\n    $.Fotorama.jst.thumb = function (v) {\r\n        var __t, __p = '', __e = _.escape;\r\n        __p += '<div class=\"fotorama__nav__frame fotorama__nav__frame--thumb\" tabindex=\"0\" role=\"button\" data-gallery-role=\"nav-frame\" data-nav-type=\"thumb\" aria-label>\\r\\n    <div class=\"fotorama__thumb\">\\r\\n    </div>\\r\\n</div>';\r\n        return __p\r\n    };\r\n})(window, document, location, typeof jQuery !== 'undefined' && jQuery);\r\n\r\n","fotorama/fotorama.min.js":"/*!\r\n * Fotorama 4.6.4 | http://fotorama.io/license/\r\n */\r\nfotoramaVersion=\"4.6.4\",function(t,n,e,o,i){\"use strict\";function a(t){var n=\"bez_\"+o.makeArray(arguments).join(\"_\").replace(\".\",\"p\");if(\"function\"!=typeof o.easing[n]){var e=function(t,n){var e=[null,null],o=[null,null],i=[null,null],a=function(a,r){return i[r]=3*t[r],o[r]=3*(n[r]-t[r])-i[r],e[r]=1-i[r]-o[r],a*(i[r]+a*(o[r]+a*e[r]))},r=function(t){return i[0]+t*(2*o[0]+3*e[0]*t)},s=function(t){for(var n,e=t,o=0;++o<14&&(n=a(e,0)-t,!(Math.abs(n)<.001));)e-=n/r(e);return e};return function(t){return a(s(t),1)}};o.easing[n]=function(n,o,i,a,r){return a*e([t[0],t[1]],[t[2],t[3]])(o/r)+i}}return n}function r(){}function s(t,n,e){return Math.max(isNaN(n)?-(1/0):n,Math.min(isNaN(e)?1/0:e,t))}function u(t,n){return t.match(/ma/)&&t.match(/-?\\d+(?!d)/g)[t.match(/3d/)?\"vertical\"===n?13:12:\"vertical\"===n?5:4]}function c(t,n){return Ln?+u(t.css(\"transform\"),n):+t.css(\"vertical\"===n?\"top\":\"left\").replace(\"px\",\"\")}function l(t,n){var e={};if(Ln)switch(n){case\"vertical\":e.transform=\"translate3d(0, \"+t+\"px,0)\";break;case\"list\":break;default:e.transform=\"translate3d(\"+t+\"px,0,0)\"}else\"vertical\"===n?e.top=t:e.left=t;return e}function d(t){return{\"transition-duration\":t+\"ms\"}}function h(t,n){return isNaN(t)?n:t}function f(t,n){return h(+String(t).replace(n||\"px\",\"\"))}function m(t){return/%$/.test(t)?f(t,\"%\"):i}function v(t,n){return h(m(t)/100*n,f(t))}function p(t){return(!isNaN(f(t))||!isNaN(f(t,\"%\")))&&t}function g(t,n,e,o){return(t-(o||0))*(n+(e||0))}function w(t,n,e,o){return-Math.round(t/(n+(e||0))-(o||0))}function b(t){var n=t.data();if(!n.tEnd){var e=t[0],o={WebkitTransition:\"webkitTransitionEnd\",MozTransition:\"transitionend\",OTransition:\"oTransitionEnd otransitionend\",msTransition:\"MSTransitionEnd\",transition:\"transitionend\"};Q(e,o[Pn.prefixed(\"transition\")],function(t){n.tProp&&t.propertyName.match(n.tProp)&&n.onEndFn()}),n.tEnd=!0}}function y(t,n,e,o){var i,a=t.data();a&&(a.onEndFn=function(){i||(i=!0,clearTimeout(a.tT),e())},a.tProp=n,clearTimeout(a.tT),a.tT=setTimeout(function(){a.onEndFn()},1.5*o),b(t))}function x(t,n){var e=t.navdir||\"horizontal\";if(t.length){var o=t.data();Ln?(t.css(d(0)),o.onEndFn=r,clearTimeout(o.tT)):t.stop();var i=_(n,function(){return c(t,e)});return t.css(l(i,e)),i}}function _(){for(var t,n=0,e=arguments.length;e>n&&(t=n?arguments[n]():arguments[n],\"number\"!=typeof t);n++);return t}function C(t,n){return Math.round(t+(n-t)/1.5)}function k(){return k.p=k.p||(\"https:\"===e.protocol?\"https://\":\"http://\"),k.p}function S(t){var e=n.createElement(\"a\");return e.href=t,e}function P(t,n){if(\"string\"!=typeof t)return t;t=S(t);var e,o;if(t.host.match(/youtube\\.com/)&&t.search){if(e=t.search.split(\"v=\")[1]){var i=e.indexOf(\"&\");-1!==i&&(e=e.substring(0,i)),o=\"youtube\"}}else t.host.match(/youtube\\.com|youtu\\.be/)?(e=t.pathname.replace(/^\\/(embed\\/|v\\/)?/,\"\").replace(/\\/.*/,\"\"),o=\"youtube\"):t.host.match(/vimeo\\.com/)&&(o=\"vimeo\",e=t.pathname.replace(/^\\/(video\\/)?/,\"\").replace(/\\/.*/,\"\"));return e&&o||!n||(e=t.href,o=\"custom\"),e?{id:e,type:o,s:t.search.replace(/^\\?/,\"\"),p:k()}:!1}function T(t,n,e){var i,a,r=t.video;return\"youtube\"===r.type?(a=k()+\"img.youtube.com/vi/\"+r.id+\"/default.jpg\",i=a.replace(/\\/default.jpg$/,\"/hqdefault.jpg\"),t.thumbsReady=!0):\"vimeo\"===r.type?o.ajax({url:k()+\"vimeo.com/api/v2/video/\"+r.id+\".json\",dataType:\"jsonp\",success:function(o){t.thumbsReady=!0,F(n,{img:o[0].thumbnail_large,thumb:o[0].thumbnail_small},t.i,e)}}):t.thumbsReady=!0,{img:i,thumb:a}}function F(t,n,e,i){for(var a=0,r=t.length;r>a;a++){var s=t[a];if(s.i===e&&s.thumbsReady){var u={videoReady:!0};u[Jn]=u[te]=u[Zn]=!1,i.splice(a,1,o.extend({},s,u,n));break}}}function E(t){function n(t,n,i){var a=t.children(\"img\").eq(0),r=t.attr(\"href\"),s=t.attr(\"src\"),u=a.attr(\"src\"),c=n.video,l=i?P(r,c===!0):!1;l?r=!1:l=c,e(t,a,o.extend(n,{video:l,img:n.img||r||s||u,thumb:n.thumb||u||s||r}))}function e(t,n,e){var i=e.thumb&&e.img!==e.thumb,a=f(e.width||t.attr(\"width\")),r=f(e.height||t.attr(\"height\"));o.extend(e,{width:a,height:r,thumbratio:K(e.thumbratio||f(e.thumbwidth||n&&n.attr(\"width\")||i||a)/f(e.thumbheight||n&&n.attr(\"height\")||i||r))})}var i=[];return t.children().each(function(){var t=o(this),a=H(o.extend(t.data(),{id:t.attr(\"id\")}));if(t.is(\"a, img\"))n(t,a,!0);else{if(t.is(\":empty\"))return;e(t,null,o.extend(a,{html:this,_html:t.html()}))}i.push(a)}),i}function M(t){return 0===t.offsetWidth&&0===t.offsetHeight}function j(t){return!o.contains(n.documentElement,t)}function $(t,n,e,o){return $.i||($.i=1,$.ii=[!0]),o=o||$.i,\"undefined\"==typeof $.ii[o]&&($.ii[o]=!0),t()?n():$.ii[o]&&setTimeout(function(){$.ii[o]&&$(t,n,e,o)},e||100),$.i++}function z(t,n){var e=t.data(),o=e.measures;if(o&&(!e.l||e.l.W!==o.width||e.l.H!==o.height||e.l.r!==o.ratio||e.l.w!==n.w||e.l.h!==n.h)){var i=s(n.h,0,o.height),a=i*o.ratio;he.setRatio(t,a,i),e.l={W:o.width,H:o.height,r:o.ratio,w:n.w,h:n.h}}return!0}function q(t,n){var e=t[0];e.styleSheet?e.styleSheet.cssText=n:t.html(n)}function N(t,n,e,o){return n===e?!1:\"vertical\"===o?n>=t?\"top\":t>=e?\"bottom\":\"top bottom\":n>=t?\"left\":t>=e?\"right\":\"left right\"}function A(t,n,e){e=e||{},t.each(function(){var t,i=o(this),a=i.data();a.clickOn||(a.clickOn=!0,o.extend(ot(i,{onStart:function(n){t=n,(e.onStart||r).call(this,n)},onMove:e.onMove||r,onTouchEnd:e.onTouchEnd||r,onEnd:function(e){e.moved||n.call(this,t)}}),{noMove:!0}))})}function L(t,n){return'<div class=\"'+t+'\">'+(n||\"\")+\"</div>\"}function O(t){return\".\"+t}function D(t){var n='<iframe src=\"'+t.p+t.type+\".com/embed/\"+t.id+'\" frameborder=\"0\" allowfullscreen></iframe>';return n}function I(t){for(var n=t.length;n;){var e=Math.floor(Math.random()*n--),o=t[n];t[n]=t[e],t[e]=o}return t}function W(t){return\"[object Array]\"==Object.prototype.toString.call(t)&&o.map(t,function(t){return o.extend({},t)})}function R(t,n,e){t.scrollLeft(n||0).scrollTop(e||0)}function H(t){if(t){var n={};return o.each(t,function(t,e){n[t.toLowerCase()]=e}),n}}function K(t){if(t){var n=+t;return isNaN(n)?(n=t.split(\"/\"),+n[0]/+n[1]||i):n}}function Q(t,n,e,o){n&&(t.addEventListener?t.addEventListener(n,e,!!o):t.attachEvent(\"on\"+n,e))}function V(t,n){return t>n.max?t=n.max:t<n.min&&(t=n.min),t}function X(t,n,e,o,i,a,r){var s,u,c;return\"horizontal\"===r?(u=t.thumbwidth,c=a.width()):(u=t.thumbheight,c=a.height()),s=(u+t.margin)*(e+1)>=c-o?\"horizontal\"===r?-i.position().left:-i.position().top:(u+t.margin)*e<=Math.abs(o)?\"horizontal\"===r?-i.position().left+c-(u+t.margin):-i.position().top+c-(u+t.margin):o,s=V(s,n),s||0}function B(t){return!!t.getAttribute(\"disabled\")}function Y(t,n){return n?{disabled:t}:{tabindex:-1*t+\"\",disabled:t}}function U(t,n){Q(t,\"keyup\",function(e){B(t)||13==e.keyCode&&n.call(t,e)})}function G(t,n){Q(t,\"focus\",t.onfocusin=function(e){n.call(t,e)},!0)}function J(t,n){t.preventDefault?t.preventDefault():t.returnValue=!1,n&&t.stopPropagation&&t.stopPropagation()}function Z(t){return t?\">\":\"<\"}function tt(t,n){var e=t.data(),i=Math.round(n.pos),a=function(){e&&e.sliding&&(e.sliding=!1),(n.onEnd||r)()};\"undefined\"!=typeof n.overPos&&n.overPos!==n.pos&&(i=n.overPos);var s=o.extend(l(i,n.direction),n.width&&{width:n.width},n.height&&{height:n.height});e&&e.sliding&&(e.sliding=!0),Ln?(t.css(o.extend(d(n.time),s)),n.time>10?y(t,\"transform\",a,n.time):a()):t.stop().animate(s,n.time,ee,a)}function nt(t,n,e,i,a,s){var u=\"undefined\"!=typeof s;if(u||(a.push(arguments),Array.prototype.push.call(arguments,a.length),!(a.length>1))){t=t||o(t),n=n||o(n);var c=t[0],l=n[0],d=\"crossfade\"===i.method,h=function(){if(!h.done){h.done=!0;var t=(u||a.shift())&&a.shift();t&&nt.apply(this,t),(i.onEnd||r)(!!t)}},f=i.time/(s||1);e.removeClass(Kt+\" \"+Ht),t.stop().addClass(Kt),n.stop().addClass(Ht),d&&l&&t.fadeTo(0,0),t.fadeTo(d?f:0,1,d&&h),n.fadeTo(f,0,h),c&&d||l||h()}}function et(t){var n=(t.touches||[])[0]||t;t._x=n.pageX||n.originalEvent.pageX,t._y=n.clientY||n.originalEvent.clientY,t._now=o.now()}function ot(t,e){function i(t){return h=o(t.target),y.checked=v=p=w=!1,l||y.flow||t.touches&&t.touches.length>1||t.which>1||se&&se.type!==t.type&&ce||(v=e.select&&h.is(e.select,b))?v:(m=\"touchstart\"===t.type,p=h.is(\"a, a *\",b),f=y.control,g=y.noMove||y.noSwipe||f?16:y.snap?0:4,et(t),d=se=t,ue=t.type.replace(/down|start/,\"move\").replace(/Down/,\"Move\"),(e.onStart||r).call(b,t,{control:f,$target:h}),l=y.flow=!0,void((!m||y.go)&&J(t)))}function a(t){if(t.touches&&t.touches.length>1||Rn&&!t.isPrimary||ue!==t.type||!l)return l&&s(),void(e.onTouchEnd||r)();et(t);var n=Math.abs(t._x-d._x),o=Math.abs(t._y-d._y),i=n-o,a=(y.go||y.x||i>=0)&&!y.noSwipe,u=0>i;J(t),(e.onMove||r).call(b,t,{touch:m}),!w&&Math.sqrt(Math.pow(n,2)+Math.pow(o,2))>g&&(w=!0),y.checked=y.checked||a||u}function s(t){(e.onTouchEnd||r)();var n=l;y.control=l=!1,n&&(y.flow=!1),!n||p&&!y.checked||(t&&J(t),ce=!0,clearTimeout(le),le=setTimeout(function(){ce=!1},1e3),(e.onEnd||r).call(b,{moved:w,$target:h,control:f,touch:m,startEvent:d,aborted:!t||\"MSPointerCancel\"===t.type}))}function u(){y.flow||(y.flow=!0)}function c(){y.flow&&(y.flow=!1)}var l,d,h,f,m,v,p,g,w,b=t[0],y={};return Rn?(Q(b,\"MSPointerDown\",i),Q(n,\"MSPointerMove\",a),Q(n,\"MSPointerCancel\",s),Q(n,\"MSPointerUp\",s)):(Q(b,\"touchstart\",i),Q(b,\"touchmove\",a),Q(b,\"touchend\",s),Q(n,\"touchstart\",u),Q(n,\"touchend\",c),Q(n,\"touchcancel\",c),zn.on(\"scroll\",c),t.on(\"mousedown pointerdown\",i),qn.on(\"mousemove pointermove\",a).on(\"mouseup pointerup\",s)),de=Pn.touch?\"a\":\"div\",t.on(\"click\",de,function(t){y.checked&&J(t)}),y}function it(t,n){function e(e,o){T=!0,c=d=\"vertical\"===_?e._y:e._x,p=e._now,v=[[p,c]],h=f=M.noMove||o?0:x(t,(n.getPos||r)()),(n.onStart||r).call(F,e)}function i(n,o){w=M.min,b=M.max,y=M.snap,_=M.direction||\"horizontal\",t.navdir=_,k=n.altKey,T=P=!1,S=o.control,S||E.sliding||e(n)}function a(o,i){M.noSwipe||(T||e(o),d=\"vertical\"===_?o._y:o._x,v.push([o._now,d]),f=h-(c-d),m=N(f,w,b,_),w>=f?f=C(f,w):f>=b&&(f=C(f,b)),M.noMove||(t.css(l(f,_)),P||(P=!0,i.touch||Rn||t.addClass(un)),(n.onMove||r).call(F,o,{pos:f,edge:m})))}function u(i){if(!M.noSwipe||!i.moved){T||e(i.startEvent,!0),i.touch||Rn||t.removeClass(un),g=o.now();for(var a,u,c,l,m,p,x,C,S,P=g-Kn,E=null,j=Qn,$=n.friction,z=v.length-1;z>=0;z--){if(a=v[z][0],u=Math.abs(a-P),null===E||c>u)E=a,l=v[z][1];else if(E===P||u>c)break;c=u}x=s(f,w,b);var q=l-d,N=q>=0,A=g-E,L=A>Kn,O=!L&&f!==h&&x===f;y&&(x=s(Math[O?N?\"floor\":\"ceil\":\"round\"](f/y)*y,w,b),w=b=x),O&&(y||x===f)&&(S=-(q/A),j*=s(Math.abs(S),n.timeLow,n.timeHigh),m=Math.round(f+S*j/$),y||(x=m),(!N&&m>b||N&&w>m)&&(p=N?w:b,C=m-p,y||(x=p),C=s(x+.03*C,p-50,p+50),j=Math.abs((f-C)/(S/$)))),j*=k?10:1,(n.onEnd||r).call(F,o.extend(i,{moved:i.moved||L&&y,pos:f,newPos:x,overPos:C,time:j,dir:_}))}}var c,d,h,f,m,v,p,g,w,b,y,_,k,S,P,T,F=t[0],E=t.data(),M={};return M=o.extend(ot(n.$wrap,o.extend({},n,{onStart:i,onMove:a,onEnd:u})),M)}function at(t,n){var e,i,a,s=t[0],u={prevent:{}};return Q(s,Hn,function(t){var s=t.wheelDeltaY||-1*t.deltaY||0,c=t.wheelDeltaX||-1*t.deltaX||0,l=Math.abs(c)&&!Math.abs(s),d=Z(0>c),h=i===d,f=o.now(),m=Kn>f-a;i=d,a=f,l&&u.ok&&(!u.prevent[d]||e)&&(J(t,!0),e&&h&&m||(n.shift&&(e=!0,clearTimeout(u.t),u.t=setTimeout(function(){e=!1},Vn)),(n.onEnd||r)(t,n.shift?d:c)))}),u}function rt(){o.each(o.Fotorama.instances,function(t,n){n.index=t})}function st(t){o.Fotorama.instances.push(t),rt()}function ut(t){o.Fotorama.instances.splice(t.index,1),rt()}var ct=\"fotorama\",lt=\"fotorama__fullscreen\",dt=ct+\"__wrap\",ht=dt+\"--css2\",ft=dt+\"--css3\",mt=dt+\"--video\",vt=dt+\"--fade\",pt=dt+\"--slide\",gt=dt+\"--no-controls\",wt=dt+\"--no-shadows\",bt=dt+\"--pan-y\",yt=dt+\"--rtl\",xt=dt+\"--no-captions\",_t=dt+\"--toggle-arrows\",Ct=ct+\"__stage\",kt=Ct+\"__frame\",St=kt+\"--video\",Pt=Ct+\"__shaft\",Tt=ct+\"__grab\",Ft=ct+\"__pointer\",Et=ct+\"__arr\",Mt=Et+\"--disabled\",jt=Et+\"--prev\",$t=Et+\"--next\",zt=ct+\"__nav\",qt=zt+\"-wrap\",Nt=zt+\"__shaft\",At=qt+\"--vertical\",Lt=qt+\"--list\",Ot=qt+\"--horizontal\",Dt=zt+\"--dots\",It=zt+\"--thumbs\",Wt=zt+\"__frame\",Rt=ct+\"__fade\",Ht=Rt+\"-front\",Kt=Rt+\"-rear\",Qt=ct+\"__shadow\",Vt=Qt+\"s\",Xt=Vt+\"--left\",Bt=Vt+\"--right\",Yt=Vt+\"--top\",Ut=Vt+\"--bottom\",Gt=ct+\"__active\",Jt=ct+\"__select\",Zt=ct+\"--hidden\",tn=ct+\"--fullscreen\",nn=ct+\"__fullscreen-icon\",en=ct+\"__error\",on=ct+\"__loading\",an=ct+\"__loaded\",rn=an+\"--full\",sn=an+\"--img\",un=ct+\"__grabbing\",cn=ct+\"__img\",ln=cn+\"--full\",dn=ct+\"__thumb\",hn=dn+\"__arr--left\",fn=dn+\"__arr--right\",mn=dn+\"-border\",vn=ct+\"__html\",pn=ct+\"-video-container\",gn=ct+\"__video\",wn=gn+\"-play\",bn=gn+\"-close\",yn=ct+\"_horizontal_ratio\",xn=ct+\"_vertical_ratio\",_n=ct+\"__spinner\",Cn=_n+\"--show\",kn=o&&o.fn.jquery.split(\".\");if(!kn||kn[0]<1||1==kn[0]&&kn[1]<8)throw\"Fotorama requires jQuery 1.8 or later and will not run without it.\";var Sn={},Pn=function(t,n,e){function o(t){g.cssText=t}function i(t,n){return typeof t===n}function a(t,n){return!!~(\"\"+t).indexOf(n)}function r(t,n){for(var o in t){var i=t[o];if(!a(i,\"-\")&&g[i]!==e)return\"pfx\"==n?i:!0}return!1}function s(t,n,o){for(var a in t){var r=n[t[a]];if(r!==e)return o===!1?t[a]:i(r,\"function\")?r.bind(o||n):r}return!1}function u(t,n,e){var o=t.charAt(0).toUpperCase()+t.slice(1),a=(t+\" \"+y.join(o+\" \")+o).split(\" \");return i(n,\"string\")||i(n,\"undefined\")?r(a,n):(a=(t+\" \"+x.join(o+\" \")+o).split(\" \"),s(a,n,e))}var c,l,d,h=\"2.8.3\",f={},m=n.documentElement,v=\"modernizr\",p=n.createElement(v),g=p.style,w=({}.toString,\" -webkit- -moz- -o- -ms- \".split(\" \")),b=\"Webkit Moz O ms\",y=b.split(\" \"),x=b.toLowerCase().split(\" \"),_={},C=[],k=C.slice,S=function(t,e,o,i){var a,r,s,u,c=n.createElement(\"div\"),l=n.body,d=l||n.createElement(\"body\");if(parseInt(o,10))for(;o--;)s=n.createElement(\"div\"),s.id=i?i[o]:v+(o+1),c.appendChild(s);return a=[\"&#173;\",'<style id=\"s',v,'\">',t,\"</style>\"].join(\"\"),c.id=v,(l?c:d).innerHTML+=a,d.appendChild(c),l||(d.style.background=\"\",d.style.overflow=\"hidden\",u=m.style.overflow,m.style.overflow=\"hidden\",m.appendChild(d)),r=e(c,t),l?c.parentNode.removeChild(c):(d.parentNode.removeChild(d),m.style.overflow=u),!!r},P={}.hasOwnProperty;d=i(P,\"undefined\")||i(P.call,\"undefined\")?function(t,n){return n in t&&i(t.constructor.prototype[n],\"undefined\")}:function(t,n){return P.call(t,n)},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(\"function\"!=typeof n)throw new TypeError;var e=k.call(arguments,1),o=function(){if(this instanceof o){var i=function(){};i.prototype=n.prototype;var a=new i,r=n.apply(a,e.concat(k.call(arguments)));return Object(r)===r?r:a}return n.apply(t,e.concat(k.call(arguments)))};return o}),_.touch=function(){var e;return\"ontouchstart\"in t||t.DocumentTouch&&n instanceof DocumentTouch?e=!0:S([\"@media (\",w.join(\"touch-enabled),(\"),v,\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\"),function(t){e=9===t.offsetTop}),e},_.csstransforms3d=function(){var t=!!u(\"perspective\");return t&&\"webkitPerspective\"in m.style&&S(\"@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}\",function(n,e){t=9===n.offsetLeft&&3===n.offsetHeight}),t},_.csstransitions=function(){return u(\"transition\")};for(var T in _)d(_,T)&&(l=T.toLowerCase(),f[l]=_[T](),C.push((f[l]?\"\":\"no-\")+l));return f.addTest=function(t,n){if(\"object\"==typeof t)for(var o in t)d(t,o)&&f.addTest(o,t[o]);else{if(t=t.toLowerCase(),f[t]!==e)return f;n=\"function\"==typeof n?n():n,\"undefined\"!=typeof enableClasses&&enableClasses&&(m.className+=\" \"+(n?\"\":\"no-\")+t),f[t]=n}return f},o(\"\"),p=c=null,f._version=h,f._prefixes=w,f._domPrefixes=x,f._cssomPrefixes=y,f.testProp=function(t){return r([t])},f.testAllProps=u,f.testStyles=S,f.prefixed=function(t,n,e){return n?u(t,n,e):u(t,\"pfx\")},f}(t,n),Tn={ok:!1,is:function(){return!1},request:function(){},cancel:function(){},event:\"\",prefix:\"\"},Fn=\"webkit moz o ms khtml\".split(\" \");if(\"undefined\"!=typeof n.cancelFullScreen)Tn.ok=!0;else for(var En=0,Mn=Fn.length;Mn>En;En++)if(Tn.prefix=Fn[En],\"undefined\"!=typeof n[Tn.prefix+\"CancelFullScreen\"]){Tn.ok=!0;break}Tn.ok&&(Tn.event=Tn.prefix+\"fullscreenchange\",Tn.is=function(){switch(this.prefix){case\"\":return n.fullScreen;case\"webkit\":return n.webkitIsFullScreen;default:return n[this.prefix+\"FullScreen\"]}},Tn.request=function(t){return\"\"===this.prefix?t.requestFullScreen():t[this.prefix+\"RequestFullScreen\"]()},Tn.cancel=function(t){return\"\"===this.prefix?n.cancelFullScreen():n[this.prefix+\"CancelFullScreen\"]()});var jn,$n,zn=o(t),qn=o(n),Nn=\"quirks\"===e.hash.replace(\"#\",\"\"),An=Pn.csstransforms3d,Ln=An&&!Nn,On=An||\"CSS1Compat\"===n.compatMode,Dn=Tn.ok,In=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),Wn=!Ln||In,Rn=navigator.msPointerEnabled,Hn=\"onwheel\"in n.createElement(\"div\")?\"wheel\":n.onmousewheel!==i?\"mousewheel\":\"DOMMouseScroll\",Kn=250,Qn=300,Vn=1400,Xn=5e3,Bn=2,Yn=64,Un=500,Gn=333,Jn=\"$stageFrame\",Zn=\"$navDotFrame\",te=\"$navThumbFrame\",ne=\"auto\",ee=a([.1,0,.25,1]),oe=1200,ie=1,ae={width:null,minwidth:null,maxwidth:\"100%\",height:null,minheight:null,maxheight:null,ratio:null,margin:Bn,nav:\"dots\",navposition:\"bottom\",navwidth:null,thumbwidth:Yn,thumbheight:Yn,thumbmargin:Bn,thumbborderwidth:Bn,allowfullscreen:!1,transition:\"slide\",clicktransition:null,transitionduration:Qn,captions:!0,startindex:0,loop:!1,autoplay:!1,stopautoplayontouch:!0,keyboard:!1,arrows:!0,click:!0,swipe:!1,trackpad:!1,shuffle:!1,direction:\"ltr\",shadows:!0,showcaption:!0,navdir:\"horizontal\",navarrows:!0,navtype:\"thumbs\"},re={left:!0,right:!0,down:!0,up:!0,space:!1,home:!1,end:!1};$.stop=function(t){$.ii[t]=!1};var se,ue,ce,le,de,he=function(){function t(t,n,e){var o=n/e;1>=o?(t.parent().removeClass(yn),t.parent().addClass(xn)):(t.parent().removeClass(xn),t.parent().addClass(yn))}function n(t,n,e){var a=e;t.attr(a)||t.attr(a)===i||t.attr(a,n),t.find(\"[\"+a+\"]\").length&&t.find(\"[\"+a+\"]\").each(function(){o(this).attr(a,n)})}function e(t,n,e){var o,i=!1;return o=t.showCaption===e||t.showCaption===!0?!0:!1,n?(t.caption&&o&&(i=!0),i):!1}return{setRatio:t,setThumbAttr:n,isExpectedCaption:e}}(he||{},jQuery);jQuery.Fotorama=function(e,a){function r(){o.each(qe,function(t,n){if(!n.i){n.i=_o++;var e=P(n.video,!0);if(e){var o={};n.video=e,n.img||n.thumb?n.thumbsReady=!0:o=T(n,qe,wo),F(qe,{img:o.img,thumb:o.thumb},n.i,wo)}}})}function u(t){return ro[t]}function h(){if(To!==i)if(\"vertical\"==a.navdir){var t=a.thumbwidth+a.thumbmargin;To.css(\"left\",t),jo.css(\"right\",t),Wo.css(\"right\",t),Po.css(\"width\",Po.css(\"width\")+t),Fo.css(\"max-width\",Po.width()-t)}else To.css(\"left\",\"\"),jo.css(\"right\",\"\"),Wo.css(\"right\",\"\"),Po.css(\"width\",Po.css(\"width\")+t),Fo.css(\"max-width\",\"\")}function m(t){var n,e=\"keydown.\"+ct,i=ct+bo,r=\"keydown.\"+i,s=\"keyup.\"+i,c=\"resize.\"+i+\" orientationchange.\"+i;t?(qn.on(r,function(t){var e,i;Le&&27===t.keyCode?(e=!0,_e(Le,!0,!0)):(wo.fullScreen||a.keyboard&&!wo.index)&&(27===t.keyCode?(e=!0,wo.cancelFullScreen()):t.shiftKey&&32===t.keyCode&&u(\"space\")||37===t.keyCode&&u(\"left\")||38===t.keyCode&&u(\"up\")&&o(\":focus\").attr(\"data-gallery-role\")?(wo.longPress.progress(),i=\"<\"):32===t.keyCode&&u(\"space\")||39===t.keyCode&&u(\"right\")||40===t.keyCode&&u(\"down\")&&o(\":focus\").attr(\"data-gallery-role\")?(wo.longPress.progress(),i=\">\"):36===t.keyCode&&u(\"home\")?(wo.longPress.progress(),i=\"<<\"):35===t.keyCode&&u(\"end\")&&(wo.longPress.progress(),i=\">>\")),(e||i)&&J(t),n={index:i,slow:t.altKey,user:!0},i&&(wo.longPress.inProgress?wo.showWhileLongPress(n):wo.show(n))}),t&&qn.on(s,function(t){wo.longPress.inProgress&&wo.showEndLongPress({user:!0}),wo.longPress.reset()}),wo.index||qn.off(e).on(e,\"textarea, input, select\",function(t){!$n.hasClass(lt)&&t.stopPropagation()}),zn.on(c,wo.resize)):(qn.off(r),zn.off(c))}function b(t){t!==b.f&&(t?(e.addClass(ct+\" \"+yo).before(So).before(ko),st(wo)):(So.detach(),ko.detach(),e.html(Co.urtext).removeClass(yo),ut(wo)),m(t),b.f=t)}function y(){qe=wo.data=qe||W(a.data)||E(e),Ne=wo.size=qe.length,ze.ok&&a.shuffle&&I(qe),r(),Xo=et(Xo),Ne&&b(!0)}function C(){var t=2>Ne||Le;Uo.noMove=t||Ze,Uo.noSwipe=t||!a.swipe,!oo&&Fo.toggleClass(Tt,!a.click&&!Uo.noMove&&!Uo.noSwipe),Rn&&Po.toggleClass(bt,!Uo.noSwipe)}function k(t){t===!0&&(t=\"\"),a.autoplay=Math.max(+t||Xn,1.5*eo)}function S(t){t.navarrows&&\"thumbs\"===t.nav?(Do.show(),Io.show()):(Do.hide(),Io.hide())}function M(t,n){return Math.floor(Po.width()/(n.thumbwidth+n.thumbmargin))}function Q(){function t(t,e){n[t?\"add\":\"remove\"].push(e)}a.nav&&\"dots\"!==a.nav||(a.navdir=\"horizontal\"),wo.options=a=H(a),ie=M(Po,a),Ze=\"crossfade\"===a.transition||\"dissolve\"===a.transition,Xe=a.loop&&(Ne>2||Ze&&(!oo||\"slide\"!==oo)),eo=+a.transitionduration||Qn,ao=\"rtl\"===a.direction,ro=o.extend({},a.keyboard&&re,a.keyboard),S(a);var n={add:[],remove:[]};Ne>1?(Be=a.nav,Ue=\"top\"===a.navposition,n.remove.push(Jt),$o.toggle(a.arrows)):(Be=!1,$o.hide()),An(),Hn(),In(),a.autoplay&&k(a.autoplay),to=f(a.thumbwidth)||Yn,no=f(a.thumbheight)||Yn,Go.ok=Zo.ok=a.trackpad&&!Wn,C(),le(a,[Yo]),Ye=\"thumbs\"===Be,zo.filter(\":hidden\")&&Be&&zo.show(),Ye?(kn(Ne,\"navThumb\"),Ae=Lo,go=te,q(ko,o.Fotorama.jst.style({w:to,h:no,b:a.thumbborderwidth,m:a.thumbmargin,s:bo,q:!On})),qo.addClass(It).removeClass(Dt)):\"dots\"===Be?(kn(Ne,\"navDot\"),Ae=Ao,go=Zn,qo.addClass(Dt).removeClass(It)):(zo.hide(),Be=!1,qo.removeClass(It+\" \"+Dt)),Be&&(Ue?zo.insertBefore(To):zo.insertAfter(To),En.nav=!1,En(Ae,No,\"nav\")),Ge=a.allowfullscreen,Ge?(Wo.prependTo(To),Je=Dn&&\"native\"===Ge):(Wo.detach(),Je=!1),t(Ze,vt),t(!Ze,pt),t(!a.captions,xt),t(ao,yt),t(a.arrows,_t),io=a.shadows&&!Wn,t(!io,wt),Po.addClass(n.add.join(\" \")).removeClass(n.remove.join(\" \")),Bo=o.extend({},a),h()}function B(t){return 0>t?(Ne+t%Ne)%Ne:t>=Ne?t%Ne:t}function et(t){return s(t,0,Ne-1)}function ot(t){return Xe?B(t):et(t)}function rt(t){return t>0||Xe?t-1:!1}function Rt(t){return Ne-1>t||Xe?t+1:!1}function Ht(){Uo.min=Xe?-(1/0):-g(Ne-1,Yo.w,a.margin,Ie),Uo.max=Xe?1/0:-g(0,Yo.w,a.margin,Ie),Uo.snap=Yo.w+a.margin}function Kt(){var t=\"vertical\"===a.navdir,n=t?No.height():No.width(),e=t?Yo.h:Yo.nw;Jo.min=Math.min(0,e-n),Jo.max=0,Jo.direction=a.navdir,No.toggleClass(Tt,!(Jo.noMove=Jo.min===Jo.max))}function Qt(t,n,e){if(\"number\"==typeof t){t=new Array(t);var i=!0}return o.each(t,function(t,o){if(i&&(o=t),\"number\"==typeof o){var a=qe[B(o)];if(a){var r=\"$\"+n+\"Frame\",s=a[r];e.call(this,t,o,a,s,r,s&&s.data())}}})}function un(t,n,e,o){(!so||\"*\"===so&&o===Ve)&&(t=p(a.width)||p(t)||Un,n=p(a.height)||p(n)||Gn,wo.resize({width:t,ratio:a.ratio||e||t/n},0,o!==Ve&&\"*\"))}function dn(t,n,e,i){Qt(t,n,function(t,r,s,u,c,l){function d(t){var n=B(r);de(t,{index:n,src:y,frame:qe[n]})}function h(){g.remove(),o.Fotorama.cache[y]=\"error\",s.html&&\"stage\"===n||!x||x===y?(!y||s.html||v?\"stage\"===n&&(u.trigger(\"f:load\").removeClass(on+\" \"+en).addClass(an),d(\"load\"),un()):(u.trigger(\"f:error\").removeClass(on).addClass(en),d(\"error\")),l.state=\"error\",!(Ne>1&&qe[r]===s)||s.html||s.deleted||s.video||v||(s.deleted=!0,wo.splice(r,1))):(s[b]=y=x,l.$full=null,dn([r],n,e,!0))}function f(){o.Fotorama.measures[y]=w.measures=o.Fotorama.measures[y]||{width:p.width,height:p.height,ratio:p.width/p.height},un(w.measures.width,w.measures.height,w.measures.ratio,r),g.off(\"load error\").addClass(\"\"+(v?ln:cn)).attr(\"aria-hidden\",\"false\").prependTo(u),u.hasClass(kt)&&!u.hasClass(pn)&&u.attr(\"href\",g.attr(\"src\")),z(g,(o.isFunction(e)?e():e)||Yo),o.Fotorama.cache[y]=l.state=\"loaded\",setTimeout(function(){u.trigger(\"f:load\").removeClass(on+\" \"+en).addClass(an+\" \"+(v?rn:sn)),\"stage\"===n?d(\"load\"):(s.thumbratio===ne||!s.thumbratio&&a.thumbratio===ne)&&(s.thumbratio=w.measures.ratio,je())},0)}function m(){var t=10;$(function(){return!vo||!t--&&!Wn},function(){f()})}if(u){var v=wo.fullScreen&&!l.$full&&\"stage\"===n;if(!l.$img||i||v){var p=new Image,g=o(p),w=g.data();l[v?\"$full\":\"$img\"]=g;var b=\"stage\"===n?v?\"full\":\"img\":\"thumb\",y=s[b],x=v?s.img:s[\"stage\"===n?\"thumb\":\"img\"];if(\"navThumb\"===n&&(u=l.$wrap),!y)return void h();o.Fotorama.cache[y]?!function _(){\"error\"===o.Fotorama.cache[y]?h():\"loaded\"===o.Fotorama.cache[y]?setTimeout(m,0):setTimeout(_,100)}():(o.Fotorama.cache[y]=\"*\",g.on(\"load\",m).on(\"error\",h)),l.state=\"\",p.src=y,l.data.caption&&(p.alt=l.data.caption||\"\"),l.data.full&&o(p).data(\"original\",l.data.full),he.isExpectedCaption(s,a.showcaption)&&o(p).attr(\"aria-labelledby\",s.labelledby)}}})}function yn(){var t=Oe[Jn];t&&!t.data().state&&(Vo.addClass(Cn),t.on(\"f:load f:error\",function(){t.off(\"f:load f:error\"),Vo.removeClass(Cn)}))}function xn(t){U(t,Fe),G(t,function(){setTimeout(function(){R(qo)},0),ee({time:eo,guessIndex:o(this).data().eq,minMax:Jo})})}function kn(t,n){Qt(t,n,function(t,e,i,r,s,u){if(!r){r=i[s]=Po[s].clone(),u=r.data(),u.data=i;var c=r[0],l=\"labelledby\"+o.now();\"stage\"===n?(i.html&&o('<div class=\"'+vn+'\"></div>').append(i._html?o(i.html).removeAttr(\"id\").html(i._html):i.html).appendTo(r),i.id&&(l=i.id||l),i.labelledby=l,he.isExpectedCaption(i,a.showcaption)&&o(o.Fotorama.jst.frameCaption({caption:i.caption,labelledby:l})).appendTo(r),i.video&&r.addClass(St).append(Ho.clone()),G(c,function(){setTimeout(function(){R(To)},0),Se({index:u.eq,user:!0})}),Eo=Eo.add(r)):\"navDot\"===n?(xn(c),Ao=Ao.add(r)):\"navThumb\"===n&&(xn(c),u.$wrap=r.children(\":first\"),Lo=Lo.add(r),i.video&&u.$wrap.append(Ho.clone()))}})}function Sn(t,n){return t&&t.length&&z(t,n)}function Pn(t){Qt(t,\"stage\",function(t,n,e,i,r,s){if(i){var u=B(n);s.eq=u,ni[Jn][u]=i.css(o.extend({left:Ze?0:g(n,Yo.w,a.margin,Ie)},Ze&&d(0))),j(i[0])&&(i.appendTo(Fo),_e(e.$video)),Sn(s.$img,Yo),Sn(s.$full,Yo),!i.hasClass(kt)||\"false\"===i.attr(\"aria-hidden\")&&i.hasClass(Gt)||i.attr(\"aria-hidden\",\"true\")}})}function Fn(t,n){var e,i;\"thumbs\"!==Be||isNaN(t)||(e=-t,i=-t+Yo.nw,\"vertical\"===a.navdir&&(t-=a.thumbheight,i=-t+Yo.h),Lo.each(function(){var t=o(this),r=t.data(),s=r.eq,u=function(){return{h:no,w:r.w}},c=u(),l=\"vertical\"===a.navdir?r.t>i:r.l>i;c.w=r.w,r.l+r.w<e||l||Sn(r.$img,c)||n&&dn([s],\"navThumb\",u)}))}function En(t,n,e){if(!En[e]){var i=\"nav\"===e&&Ye,r=0,s=0;n.append(t.filter(function(){for(var t,n=o(this),e=n.data(),i=0,a=qe.length;a>i;i++)if(e.data===qe[i]){t=!0,e.eq=i;break}return t||n.remove()&&!1}).sort(function(t,n){return o(t).data().eq-o(n).data().eq}).each(function(){var t=o(this),n=t.data();he.setThumbAttr(t,n.data.caption,\"aria-label\")}).each(function(){if(i){var t=o(this),n=t.data(),e=Math.round(no*n.data.thumbratio)||to,u=Math.round(to/n.data.thumbratio)||no;n.t=s,n.h=u,n.l=r,n.w=e,t.css({width:e}),s+=u+a.thumbmargin,r+=e+a.thumbmargin}})),En[e]=!0}}function Mn(t){return t-ei>Yo.w/3}function Nn(t){return!(Xe||Xo+t&&Xo-Ne+t||Le)}function An(){var t=Nn(0),n=Nn(1);Mo.toggleClass(Mt,t).attr(Y(t,!1)),jo.toggleClass(Mt,n).attr(Y(n,!1))}function In(){var t=!1,n=!1;if(\"thumbs\"!==a.navtype||a.loop||(t=0==Xo?!0:!1,n=Xo==a.data.length-1?!0:!1),\"slides\"===a.navtype){var e=c(No,a.navdir);t=e>=Jo.max?!0:!1,n=e<=Jo.min?!0:!1}Do.toggleClass(Mt,t).attr(Y(t,!0)),Io.toggleClass(Mt,n).attr(Y(n,!0))}function Hn(){Go.ok&&(Go.prevent={\"<\":Nn(0),\">\":Nn(1)})}function Vn(t){var n,e,o,i,r=t.data();Ye?(n=r.l,e=r.t,o=r.w,i=r.h):(n=t.position().left,o=t.width());var s={c:n+o/2,min:-n+10*a.thumbmargin,max:-n+Yo.w-o-10*a.thumbmargin},u={c:e+i/2,min:-e+10*a.thumbmargin,max:-e+Yo.h-i-10*a.thumbmargin};return\"vertical\"===a.navdir?u:s}function Bn(t){var n=Oe[go].data();tt(Oo,{time:1.2*t,pos:\"vertical\"===a.navdir?n.t:n.l,width:n.w,height:n.h,direction:a.navdir})}function ee(t){var n,e,o,i,r,u,l,d,h=qe[t.guessIndex][go],f=a.navtype;h&&(\"thumbs\"===f?(n=Jo.min!==Jo.max,o=t.minMax||n&&Vn(Oe[go]),i=n&&(t.keep&&ee.t?ee.l:s((t.coo||Yo.nw/2)-Vn(h).c,o.min,o.max)),r=n&&(t.keep&&ee.l?ee.l:s((t.coo||Yo.nw/2)-Vn(h).c,o.min,o.max)),u=\"vertical\"===a.navdir?i:r,l=n&&s(u,Jo.min,Jo.max)||0,e=1.1*t.time,tt(No,{time:e,pos:l,direction:a.navdir,onEnd:function(){Fn(l,!0),In()}}),xe(qo,N(l,Jo.min,Jo.max,a.navdir)),ee.l=u):(d=c(No,a.navdir),e=1.11*t.time,l=X(a,Jo,t.guessIndex,d,h,zo,a.navdir),tt(No,{time:e,pos:l,direction:a.navdir,onEnd:function(){Fn(l,!0),In()}}),xe(qo,N(l,Jo.min,Jo.max,a.navdir))))}function ae(){se(go),ti[go].push(Oe[go].addClass(Gt).attr(\"data-active\",!0))}function se(t){for(var n=ti[t];n.length;)n.shift().removeClass(Gt).attr(\"data-active\",!1)}function ue(t){var n=ni[t];o.each(De,function(t,e){delete n[B(e)]}),o.each(n,function(t,e){delete n[t],e.detach()})}function ce(t){Ie=We=Xo;var n=Oe[Jn];n&&(se(Jn),ti[Jn].push(n.addClass(Gt).attr(\"data-active\",!0)),n.hasClass(kt)&&n.attr(\"aria-hidden\",\"false\"),t||wo.showStage.onEnd(!0),x(Fo,0,!0),ue(Jn),Pn(De),Ht(),Kt(),U(Fo[0],function(){e.hasClass(tn)||(wo.requestFullScreen(),Wo.focus())}))}function le(t,n){t&&o.each(n,function(n,e){e&&o.extend(e,{width:t.width||e.width,height:t.height,minwidth:t.minwidth,maxwidth:t.maxwidth,minheight:t.minheight,maxheight:t.maxheight,ratio:K(t.ratio)})})}function de(t,n){e.trigger(ct+\":\"+t,[wo,n])}function fe(){clearTimeout(me.t),vo=1,a.stopautoplayontouch?wo.stopAutoplay():ho=!0}function me(){vo&&(a.stopautoplayontouch||(ve(),pe()),me.t=setTimeout(function(){vo=0},Qn+Kn))}function ve(){ho=!(!Le&&!fo)}function pe(){if(clearTimeout(pe.t),$.stop(pe.w),!a.autoplay||ho)return void(wo.autoplay&&(wo.autoplay=!1,de(\"stopautoplay\")));wo.autoplay||(wo.autoplay=!0,de(\"startautoplay\"));var t=Xo,n=Oe[Jn].data();pe.w=$(function(){return n.state||t!==Xo},function(){pe.t=setTimeout(function(){if(!ho&&t===Xo){var n=Qe,e=qe[n][Jn].data();pe.w=$(function(){return e.state||n!==Qe},function(){ho||n!==Qe||wo.show(Xe?Z(!ao):Qe)})}},a.autoplay)})}function ge(t){var n;return\"object\"!=typeof t?(n=t,t={}):n=t.index,n=\">\"===n?We+1:\"<\"===n?We-1:\"<<\"===n?0:\">>\"===n?Ne-1:n,n=isNaN(n)?i:n,n=\"undefined\"==typeof n?Xo||0:n}function we(t){wo.activeIndex=Xo=ot(t),He=rt(Xo),Ke=Rt(Xo),Qe=B(Xo+(ao?-1:1)),De=[Xo,He,Ke],We=Xe?t:Xo}function be(t){var n=Math.abs(Re-We),e=_(t.time,function(){return Math.min(eo*(1+(n-1)/12),2*eo)});return t.slow&&(e*=10),e}function ye(){wo.fullScreen&&(wo.fullScreen=!1,Dn&&Tn.cancel(xo),$n.removeClass(lt),jn.removeClass(lt),e.removeClass(tn).insertAfter(So),Yo=o.extend({},mo),_e(Le,!0,!0),Te(\"x\",!1),wo.resize(),dn(De,\"stage\"),R(zn,co,uo),de(\"fullscreenexit\"))}function xe(t,n){io&&(t.removeClass(Xt+\" \"+Bt),t.removeClass(Yt+\" \"+Ut),n&&!Le&&t.addClass(n.replace(/^|\\s/g,\" \"+Vt+\"--\")))}function _e(t,n,e){n&&(Po.removeClass(mt),Le=!1,C()),t&&t!==Le&&(t.remove(),de(\"unloadvideo\")),e&&(ve(),pe())}function Ce(t){Po.toggleClass(gt,t)}function ke(t){if(!Uo.flow){var n=t?t.pageX:ke.x,e=n&&!Nn(Mn(n))&&a.click;ke.p!==e&&To.toggleClass(Ft,e)&&(ke.p=e,ke.x=n)}}function Se(t){clearTimeout(Se.t),a.clicktransition&&a.clicktransition!==a.transition?setTimeout(function(){var n=a.transition;wo.setOptions({transition:a.clicktransition}),oo=n,Se.t=setTimeout(function(){wo.show(t)},10)},0):wo.show(t)}function Pe(t,n){var i=t.target,a=o(i);a.hasClass(wn)?wo.playVideo():i===Ro?wo.toggleFullScreen():Le?i===Qo&&_e(Le,!0,!0):e.hasClass(tn)||wo.requestFullScreen()}function Te(t,n){Uo[t]=Jo[t]=n}function Fe(t){var n=o(this).data().eq;Se(\"thumbs\"===a.navtype?{index:n,slow:t.altKey,user:!0,coo:t._x-qo.offset().left}:{index:n,slow:t.altKey,user:!0})}function Ee(t){Se({index:$o.index(this)?\">\":\"<\",slow:t.altKey,user:!0})}function Me(t){G(t,function(){setTimeout(function(){R(To)},0),Ce(!1)})}function je(){if(y(),Q(),!je.i){je.i=!0;var t=a.startindex;Xo=Ie=We=Re=Ve=ot(t)||0}if(Ne){if($e())return;Le&&_e(Le,!0),De=[],ue(Jn),je.ok=!0,wo.show({index:Xo,time:0}),wo.resize()}else wo.destroy()}function $e(){return!$e.f===ao?($e.f=ao,Xo=Ne-1-Xo,wo.reverse(),!0):void 0}function ze(){ze.ok&&(ze.ok=!1,de(\"ready\"))}jn=o(\"html\"),$n=o(\"body\");var qe,Ne,Ae,Le,Oe,De,Ie,We,Re,He,Ke,Qe,Ve,Xe,Be,Ye,Ue,Ge,Je,Ze,to,no,eo,oo,io,ao,ro,so,uo,co,lo,ho,fo,mo,vo,po,go,wo=this,bo=o.now(),yo=ct+bo,xo=e[0],_o=1,Co=e.data(),ko=o(\"<style></style>\"),So=o(L(Zt)),Po=e.find(O(dt)),To=Po.find(O(Ct)),Fo=(To[0],e.find(O(Pt))),Eo=o(),Mo=e.find(O(jt)),jo=e.find(O($t)),$o=e.find(O(Et)),zo=e.find(O(qt)),qo=zo.find(O(zt)),No=qo.find(O(Nt)),Ao=o(),Lo=o(),Oo=(Fo.data(),No.data(),e.find(O(mn))),Do=e.find(O(hn)),Io=e.find(O(fn)),Wo=e.find(O(nn)),Ro=Wo[0],Ho=o(L(wn)),Ko=e.find(O(bn)),Qo=Ko[0],Vo=e.find(O(_n)),Xo=!1,Bo={},Yo={},Uo={},Go={},Jo={},Zo={},ti={},ni={},ei=0,oi=[];Po[Jn]=o('<div class=\"'+kt+'\"></div>'),Po[te]=o(o.Fotorama.jst.thumb()),Po[Zn]=o(o.Fotorama.jst.dots()),ti[Jn]=[],ti[te]=[],\r\n    ti[Zn]=[],ni[Jn]={},Po.addClass(Ln?ft:ht),Co.fotorama=this,wo.startAutoplay=function(t){return wo.autoplay?this:(ho=fo=!1,k(t||a.autoplay),pe(),this)},wo.stopAutoplay=function(){return wo.autoplay&&(ho=fo=!0,pe()),this},wo.showSlide=function(t){var n,e=c(No,a.navdir),o=550,i=\"horizontal\"===a.navdir?a.thumbwidth:a.thumbheight,r=function(){In()};\"next\"===t&&(n=e-(i+a.margin)*ie),\"prev\"===t&&(n=e+(i+a.margin)*ie),n=V(n,Jo),Fn(n,!0),tt(No,{time:o,pos:n,direction:a.navdir,onEnd:r})},wo.showWhileLongPress=function(t){if(!wo.longPress.singlePressInProgress){var n=ge(t);we(n);var e=be(t)/50,o=Oe;wo.activeFrame=Oe=qe[Xo];var i=o===Oe&&!t.user;return wo.showNav(i,t,e),this}},wo.showEndLongPress=function(t){if(!wo.longPress.singlePressInProgress){var n=ge(t);we(n);var e=be(t)/50,o=Oe;wo.activeFrame=Oe=qe[Xo];var i=o===Oe&&!t.user;return wo.showStage(i,t,e),lo=\"undefined\"!=typeof Re&&Re!==Xo,Re=Xo,this}},wo.showStage=function(t,n,e){_e(Le,Oe.i!==qe[B(Ie)].i),kn(De,\"stage\"),Pn(Wn?[We]:[We,rt(We),Rt(We)]),Te(\"go\",!0),t||de(\"show\",{user:n.user,time:e}),ho=!0;var o=n.overPos,i=wo.showStage.onEnd=function(e){if(!i.ok){if(i.ok=!0,e||ce(!0),t||de(\"showend\",{user:n.user}),!e&&oo&&oo!==a.transition)return wo.setOptions({transition:oo}),void(oo=!1);yn(),dn(De,\"stage\"),Te(\"go\",!1),Hn(),ke(),ve(),pe(),wo.fullScreen?(Oe[Jn].find(\".\"+ln).attr(\"aria-hidden\",!1),Oe[Jn].find(\".\"+cn).attr(\"aria-hidden\",!0)):(Oe[Jn].find(\".\"+ln).attr(\"aria-hidden\",!0),Oe[Jn].find(\".\"+cn).attr(\"aria-hidden\",!1))}};if(Ze){var r=Oe[Jn],s=qe[Re]&&Xo!==Re?qe[Re][Jn]:null;nt(r,s,Eo,{time:e,method:a.transition,onEnd:i},oi)}else tt(Fo,{pos:-g(We,Yo.w,a.margin,Ie),overPos:o,time:e,onEnd:i});An()},wo.showNav=function(t,n,e){if(In(),Be){ae();var o=et(Xo+s(We-Re,-1,1));ee({time:e,coo:o!==Xo&&n.coo,guessIndex:\"undefined\"!=typeof n.coo?o:Xo,keep:t}),Ye&&Bn(e)}},wo.show=function(t){wo.longPress.singlePressInProgress=!0;var n=ge(t);we(n);var e=be(t),o=Oe;wo.activeFrame=Oe=qe[Xo];var i=o===Oe&&!t.user;return wo.showStage(i,t,e),wo.showNav(i,t,e),lo=\"undefined\"!=typeof Re&&Re!==Xo,Re=Xo,wo.longPress.singlePressInProgress=!1,this},wo.requestFullScreen=function(){if(Ge&&!wo.fullScreen){var n=o((wo.activeFrame||{}).$stageFrame||{}).hasClass(\"fotorama-video-container\");if(n)return;uo=zn.scrollTop(),co=zn.scrollLeft(),R(zn),Te(\"x\",!0),mo=o.extend({},Yo),e.addClass(tn).appendTo($n.addClass(lt)),jn.addClass(lt),_e(Le,!0,!0),wo.fullScreen=!0,Je&&Tn.request(xo),wo.resize(),dn(De,\"stage\"),yn(),de(\"fullscreenenter\"),\"ontouchstart\"in t||Wo.focus()}return this},wo.cancelFullScreen=function(){return Je&&Tn.is()?Tn.cancel(n):ye(),this},wo.toggleFullScreen=function(){return wo[(wo.fullScreen?\"cancel\":\"request\")+\"FullScreen\"]()},wo.resize=function(n){if(!qe)return this;var e=arguments[1]||0,i=arguments[2];ie=M(Po,a),le(wo.fullScreen?{width:o(t).width(),maxwidth:null,minwidth:null,height:o(t).height(),maxheight:null,minheight:null}:H(n),[Yo,i||wo.fullScreen||a]);var r=Yo.width,u=Yo.height,c=Yo.ratio,l=zn.height()-(Be?qo.height():0);if(p(r)&&(Po.css({width:\"\"}),Po.css({height:\"\"}),To.css({width:\"\"}),To.css({height:\"\"}),Fo.css({width:\"\"}),Fo.css({height:\"\"}),qo.css({width:\"\"}),qo.css({height:\"\"}),Po.css({minWidth:Yo.minwidth||0,maxWidth:Yo.maxwidth||oe}),\"dots\"===Be&&zo.hide(),r=Yo.W=Yo.w=Po.width(),Yo.nw=Be&&v(a.navwidth,r)||r,Fo.css({width:Yo.w,marginLeft:(Yo.W-Yo.w)/2}),u=v(u,l),u=u||c&&r/c)){if(r=Math.round(r),u=Yo.h=Math.round(s(u,v(Yo.minheight,l),v(Yo.maxheight,l))),To.css({width:r,height:u}),\"vertical\"!==a.navdir||wo.fullscreen||qo.width(a.thumbwidth+2*a.thumbmargin),\"horizontal\"!==a.navdir||wo.fullscreen||qo.height(a.thumbheight+2*a.thumbmargin),\"dots\"===Be&&(qo.width(r).height(\"auto\"),zo.show()),\"vertical\"===a.navdir&&wo.fullScreen&&To.css(\"height\",zn.height()),\"horizontal\"===a.navdir&&wo.fullScreen&&To.css(\"height\",zn.height()-qo.height()),Be){switch(a.navdir){case\"vertical\":zo.removeClass(Ot),zo.removeClass(Lt),zo.addClass(At),qo.stop().animate({height:Yo.h,width:a.thumbwidth},e);break;case\"list\":zo.removeClass(At),zo.removeClass(Ot),zo.addClass(Lt);break;default:zo.removeClass(At),zo.removeClass(Lt),zo.addClass(Ot),qo.stop().animate({width:Yo.nw},e)}ce(),ee({guessIndex:Xo,time:e,keep:!0}),Ye&&En.nav&&Bn(e)}so=i||!0,ze.ok=!0,ze()}return ei=To.offset().left,h(),this},wo.setOptions=function(t){return o.extend(a,t),je(),this},wo.shuffle=function(){return qe&&I(qe)&&je(),this},wo.longPress={threshold:1,count:0,thumbSlideTime:20,progress:function(){this.inProgress||(this.count++,this.inProgress=this.count>this.threshold)},end:function(){this.inProgress&&(this.isEnded=!0)},reset:function(){this.count=0,this.inProgress=!1,this.isEnded=!1}},wo.destroy=function(){return wo.cancelFullScreen(),wo.stopAutoplay(),qe=wo.data=null,b(),De=[],ue(Jn),je.ok=!1,this},wo.playVideo=function(){var t=Oe,n=t.video,e=Xo;return\"object\"==typeof n&&t.videoReady&&(Je&&wo.fullScreen&&wo.cancelFullScreen(),$(function(){return!Tn.is()||e!==Xo},function(){e===Xo&&(t.$video=t.$video||o(L(gn)).append(D(n)),t.$video.appendTo(t[Jn]),Po.addClass(mt),Le=t.$video,C(),$o.blur(),Wo.blur(),de(\"loadvideo\"))})),this},wo.stopVideo=function(){return _e(Le,!0,!0),this},wo.spliceByIndex=function(t,n){n.i=t+1,n.img&&o.ajax({url:n.img,type:\"HEAD\",success:function(){qe.splice(t,1,n),je()}})},To.on(\"mousemove\",ke),Uo=it(Fo,{onStart:fe,onMove:function(t,n){xe(To,n.edge)},onTouchEnd:me,onEnd:function(t){var n;if(xe(To),n=(Rn&&!po||t.touch)&&a.arrows,(t.moved||n&&t.pos!==t.newPos&&!t.control)&&t.$target[0]!==Wo[0]){var e=w(t.newPos,Yo.w,a.margin,Ie);wo.show({index:e,time:Ze?eo:t.time,overPos:t.overPos,user:!0})}else t.aborted||t.control||Pe(t.startEvent,n)},timeLow:1,timeHigh:1,friction:2,select:\".\"+Jt+\", .\"+Jt+\" *\",$wrap:To,direction:\"horizontal\"}),Jo=it(No,{onStart:fe,onMove:function(t,n){xe(qo,n.edge)},onTouchEnd:me,onEnd:function(t){function n(){ee.l=t.newPos,ve(),pe(),Fn(t.newPos,!0),In()}if(t.moved)t.pos!==t.newPos?(ho=!0,tt(No,{time:t.time,pos:t.newPos,overPos:t.overPos,direction:a.navdir,onEnd:n}),Fn(t.newPos),io&&xe(qo,N(t.newPos,Jo.min,Jo.max,t.dir))):n();else{var e=t.$target.closest(\".\"+Wt,No)[0];e&&Fe.call(e,t.startEvent)}},timeLow:.5,timeHigh:2,friction:5,$wrap:qo,direction:a.navdir}),Go=at(To,{shift:!0,onEnd:function(t,n){fe(),me(),wo.show({index:n,slow:t.altKey})}}),Zo=at(qo,{onEnd:function(t,n){fe(),me();var e=x(No)+.25*n;No.css(l(s(e,Jo.min,Jo.max),a.navdir)),io&&xe(qo,N(e,Jo.min,Jo.max,a.navdir)),Zo.prevent={\"<\":e>=Jo.max,\">\":e<=Jo.min},clearTimeout(Zo.t),Zo.t=setTimeout(function(){ee.l=e,Fn(e,!0)},Kn),Fn(e)}}),Po.hover(function(){setTimeout(function(){vo||Ce(!(po=!0))},0)},function(){po&&Ce(!(po=!1))}),A($o,function(t){J(t),Ee.call(this,t)},{onStart:function(){fe(),Uo.control=!0},onTouchEnd:me}),A(Do,function(t){J(t),\"thumbs\"===a.navtype?wo.show(\"<\"):wo.showSlide(\"prev\")}),A(Io,function(t){J(t),\"thumbs\"===a.navtype?wo.show(\">\"):wo.showSlide(\"next\")}),$o.each(function(){U(this,function(t){Ee.call(this,t)}),Me(this)}),U(Ro,function(){e.hasClass(tn)?(wo.cancelFullScreen(),Fo.focus()):(wo.requestFullScreen(),Wo.focus())}),Me(Ro),o.each(\"load push pop shift unshift reverse sort splice\".split(\" \"),function(t,n){wo[n]=function(){return qe=qe||[],\"load\"!==n?Array.prototype[n].apply(qe,arguments):arguments[0]&&\"object\"==typeof arguments[0]&&arguments[0].length&&(qe=W(arguments[0])),je(),wo}}),je()},o.fn.fotorama=function(n){return this.each(function(){var e=this,i=o(this),a=i.data(),r=a.fotorama;r?r.setOptions(n,!0):$(function(){return!M(e)},function(){a.urtext=i.html(),new o.Fotorama(i,o.extend({},ae,t.fotoramaDefaults,n,a))})})},o.Fotorama.instances=[],o.Fotorama.cache={},o.Fotorama.measures={},o=o||{},o.Fotorama=o.Fotorama||{},o.Fotorama.jst=o.Fotorama.jst||{},o.Fotorama.jst.dots=function(t){var n=\"\";Sn.escape;return n+='<div class=\"fotorama__nav__frame fotorama__nav__frame--dot\" tabindex=\"0\" role=\"button\" data-gallery-role=\"nav-frame\" data-nav-type=\"thumb\" aria-label>\\r\\n    <div class=\"fotorama__dot\"></div>\\r\\n</div>'},o.Fotorama.jst.frameCaption=function(t){var n,e=\"\";Sn.escape;return e+='<div class=\"fotorama__caption\" aria-hidden=\"true\">\\r\\n    <div class=\"fotorama__caption__wrap\" id=\"'+(null==(n=t.labelledby)?\"\":n)+'\">'+(null==(n=t.caption)?\"\":n)+\"</div>\\r\\n</div>\\r\\n\"},o.Fotorama.jst.style=function(t){var n,e=\"\";Sn.escape;return e+=\".fotorama\"+(null==(n=t.s)?\"\":n)+\" .fotorama__nav--thumbs .fotorama__nav__frame{\\r\\npadding:\"+(null==(n=t.m)?\"\":n)+\"px;\\r\\nheight:\"+(null==(n=t.h)?\"\":n)+\"px}\\r\\n.fotorama\"+(null==(n=t.s)?\"\":n)+\" .fotorama__thumb-border{\\r\\nheight:\"+(null==(n=t.h)?\"\":n)+\"px;\\r\\nborder-width:\"+(null==(n=t.b)?\"\":n)+\"px;\\r\\nmargin-top:\"+(null==(n=t.m)?\"\":n)+\"px}\"},o.Fotorama.jst.thumb=function(t){var n=\"\";Sn.escape;return n+='<div class=\"fotorama__nav__frame fotorama__nav__frame--thumb\" tabindex=\"0\" role=\"button\" data-gallery-role=\"nav-frame\" data-nav-type=\"thumb\" aria-label>\\r\\n    <div class=\"fotorama__thumb\">\\r\\n    </div>\\r\\n</div>'}}(window,document,location,\"undefined\"!=typeof jQuery&&jQuery);","jquery/jquery-migrate.js":"/*!\r\n * jQuery Migrate - v1.2.1 - 2013-05-08\r\n * https://github.com/jquery/jquery-migrate\r\n * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT\r\n */\r\n(function( jQuery, window, undefined ) {\r\n// See http://bugs.jquery.com/ticket/13335\r\n// \"use strict\";\r\n\r\n\r\nvar warnedAbout = {};\r\n\r\n// List of warnings already given; public read only\r\njQuery.migrateWarnings = [];\r\n\r\n// Set to true to prevent console output; migrateWarnings still maintained\r\n// jQuery.migrateMute = false;\r\n\r\n// Show a message on the console so devs know we're active\r\nif ( !jQuery.migrateMute && window.console && window.console.log ) {\r\n\twindow.console.log(\"JQMIGRATE: Logging is active\");\r\n}\r\n\r\n// Set to false to disable traces that appear with warnings\r\nif ( jQuery.migrateTrace === undefined ) {\r\n\tjQuery.migrateTrace = true;\r\n}\r\n\r\n// Forget any warnings we've already given; public\r\njQuery.migrateReset = function() {\r\n\twarnedAbout = {};\r\n\tjQuery.migrateWarnings.length = 0;\r\n};\r\n\r\nfunction migrateWarn( msg) {\r\n\tvar console = window.console;\r\n\tif ( !warnedAbout[ msg ] ) {\r\n\t\twarnedAbout[ msg ] = true;\r\n\t\tjQuery.migrateWarnings.push( msg );\r\n\t\tif ( console && console.warn && !jQuery.migrateMute ) {\r\n\t\t\tconsole.warn( \"JQMIGRATE: \" + msg );\r\n\t\t\tif ( jQuery.migrateTrace && console.trace ) {\r\n\t\t\t\tconsole.trace();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction migrateWarnProp( obj, prop, value, msg ) {\r\n\tif ( Object.defineProperty ) {\r\n\t\t// On ES5 browsers (non-oldIE), warn if the code tries to get prop;\r\n\t\t// allow property to be overwritten in case some other plugin wants it\r\n\t\ttry {\r\n\t\t\tObject.defineProperty( obj, prop, {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tget: function() {\r\n\t\t\t\t\tmigrateWarn( msg );\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t},\r\n\t\t\t\tset: function( newValue ) {\r\n\t\t\t\t\tmigrateWarn( msg );\r\n\t\t\t\t\tvalue = newValue;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t} catch( err ) {\r\n\t\t\t// IE8 is a dope about Object.defineProperty, can't warn there\r\n\t\t}\r\n\t}\r\n\r\n\t// Non-ES5 (or broken) browser; just set the property\r\n\tjQuery._definePropertyBroken = true;\r\n\tobj[ prop ] = value;\r\n}\r\n\r\nif ( document.compatMode === \"BackCompat\" ) {\r\n\t// jQuery has never supported or tested Quirks Mode\r\n\tmigrateWarn( \"jQuery is not compatible with Quirks Mode\" );\r\n}\r\n\r\n\r\nvar attrFn = jQuery( \"<input/>\", { size: 1 } ).attr(\"size\") && jQuery.attrFn,\r\n\toldAttr = jQuery.attr,\r\n\tvalueAttrGet = jQuery.attrHooks.value && jQuery.attrHooks.value.get ||\r\n\t\tfunction() { return null; },\r\n\tvalueAttrSet = jQuery.attrHooks.value && jQuery.attrHooks.value.set ||\r\n\t\tfunction() { return undefined; },\r\n\trnoType = /^(?:input|button)$/i,\r\n\trnoAttrNodeType = /^[238]$/,\r\n\trboolean = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,\r\n\truseDefault = /^(?:checked|selected)$/i;\r\n\r\n// jQuery.attrFn\r\nmigrateWarnProp( jQuery, \"attrFn\", attrFn || {}, \"jQuery.attrFn is deprecated\" );\r\n\r\njQuery.attr = function( elem, name, value, pass ) {\r\n\tvar lowerName = name.toLowerCase(),\r\n\t\tnType = elem && elem.nodeType;\r\n\r\n\tif ( pass ) {\r\n\t\t// Since pass is used internally, we only warn for new jQuery\r\n\t\t// versions where there isn't a pass arg in the formal params\r\n\t\tif ( oldAttr.length < 4 ) {\r\n\t\t\tmigrateWarn(\"jQuery.fn.attr( props, pass ) is deprecated\");\r\n\t\t}\r\n\t\tif ( elem && !rnoAttrNodeType.test( nType ) &&\r\n\t\t\t(attrFn ? name in attrFn : jQuery.isFunction(jQuery.fn[name])) ) {\r\n\t\t\treturn jQuery( elem )[ name ]( value );\r\n\t\t}\r\n\t}\r\n\r\n\t// Warn if user tries to set `type`, since it breaks on IE 6/7/8; by checking\r\n\t// for disconnected elements we don't warn on $( \"<button>\", { type: \"button\" } ).\r\n\tif ( name === \"type\" && value !== undefined && rnoType.test( elem.nodeName ) && elem.parentNode ) {\r\n\t\tmigrateWarn(\"Can't change the 'type' of an input or button in IE 6/7/8\");\r\n\t}\r\n\r\n\t// Restore boolHook for boolean property/attribute synchronization\r\n\tif ( !jQuery.attrHooks[ lowerName ] && rboolean.test( lowerName ) ) {\r\n\t\tjQuery.attrHooks[ lowerName ] = {\r\n\t\t\tget: function( elem, name ) {\r\n\t\t\t\t// Align boolean attributes with corresponding properties\r\n\t\t\t\t// Fall back to attribute presence where some booleans are not supported\r\n\t\t\t\tvar attrNode,\r\n\t\t\t\t\tproperty = jQuery.prop( elem, name );\r\n\t\t\t\treturn property === true || typeof property !== \"boolean\" &&\r\n\t\t\t\t\t( attrNode = elem.getAttributeNode(name) ) && attrNode.nodeValue !== false ?\r\n\r\n\t\t\t\t\tname.toLowerCase() :\r\n\t\t\t\t\tundefined;\r\n\t\t\t},\r\n\t\t\tset: function( elem, value, name ) {\r\n\t\t\t\tvar propName;\r\n\t\t\t\tif ( value === false ) {\r\n\t\t\t\t\t// Remove boolean attributes when set to false\r\n\t\t\t\t\tjQuery.removeAttr( elem, name );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// value is true since we know at this point it's type boolean and not false\r\n\t\t\t\t\t// Set boolean attributes to the same name and set the DOM property\r\n\t\t\t\t\tpropName = jQuery.propFix[ name ] || name;\r\n\t\t\t\t\tif ( propName in elem ) {\r\n\t\t\t\t\t\t// Only set the IDL specifically if it already exists on the element\r\n\t\t\t\t\t\telem[ propName ] = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telem.setAttribute( name, name.toLowerCase() );\r\n\t\t\t\t}\r\n\t\t\t\treturn name;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Warn only for attributes that can remain distinct from their properties post-1.9\r\n\t\tif ( ruseDefault.test( lowerName ) ) {\r\n\t\t\tmigrateWarn( \"jQuery.fn.attr('\" + lowerName + \"') may use property instead of attribute\" );\r\n\t\t}\r\n\t}\r\n\r\n\treturn oldAttr.call( jQuery, elem, name, value );\r\n};\r\n\r\n// attrHooks: value\r\njQuery.attrHooks.value = {\r\n\tget: function( elem, name ) {\r\n\t\tvar nodeName = ( elem.nodeName || \"\" ).toLowerCase();\r\n\t\tif ( nodeName === \"button\" ) {\r\n\t\t\treturn valueAttrGet.apply( this, arguments );\r\n\t\t}\r\n\t\tif ( nodeName !== \"input\" && nodeName !== \"option\" ) {\r\n\t\t\tmigrateWarn(\"jQuery.fn.attr('value') no longer gets properties\");\r\n\t\t}\r\n\t\treturn name in elem ?\r\n\t\t\telem.value :\r\n\t\t\tnull;\r\n\t},\r\n\tset: function( elem, value ) {\r\n\t\tvar nodeName = ( elem.nodeName || \"\" ).toLowerCase();\r\n\t\tif ( nodeName === \"button\" ) {\r\n\t\t\treturn valueAttrSet.apply( this, arguments );\r\n\t\t}\r\n\t\tif ( nodeName !== \"input\" && nodeName !== \"option\" ) {\r\n\t\t\tmigrateWarn(\"jQuery.fn.attr('value', val) no longer sets properties\");\r\n\t\t}\r\n\t\t// Does not return so that setAttribute is also used\r\n\t\telem.value = value;\r\n\t}\r\n};\r\n\r\n\r\nvar matched, browser,\r\n\toldInit = jQuery.fn.init,\r\n\toldParseJSON = jQuery.parseJSON,\r\n\t// Note: XSS check is done below after string is trimmed\r\n\trquickExpr = /^([^<]*)(<[\\w\\W]+>)([^>]*)$/;\r\n\r\n// $(html) \"looks like html\" rule change\r\njQuery.fn.init = function( selector, context, rootjQuery ) {\r\n\tvar match;\r\n\r\n\tif ( selector && typeof selector === \"string\" && !jQuery.isPlainObject( context ) &&\r\n\t\t\t(match = rquickExpr.exec( jQuery.trim( selector ) )) && match[ 0 ] ) {\r\n\t\t// This is an HTML string according to the \"old\" rules; is it still?\r\n\t\tif ( selector.charAt( 0 ) !== \"<\" ) {\r\n\t\t\tmigrateWarn(\"$(html) HTML strings must start with '<' character\");\r\n\t\t}\r\n\t\tif ( match[ 3 ] ) {\r\n\t\t\tmigrateWarn(\"$(html) HTML text after last tag is ignored\");\r\n\t\t}\r\n\t\t// Consistently reject any HTML-like string starting with a hash (#9521)\r\n\t\t// Note that this may break jQuery 1.6.x code that otherwise would work.\r\n\t\tif ( match[ 0 ].charAt( 0 ) === \"#\" ) {\r\n\t\t\tmigrateWarn(\"HTML string cannot start with a '#' character\");\r\n\t\t\tjQuery.error(\"JQMIGRATE: Invalid selector string (XSS)\");\r\n\t\t}\r\n\t\t// Now process using loose rules; let pre-1.8 play too\r\n\t\tif ( context && context.context ) {\r\n\t\t\t// jQuery object as context; parseHTML expects a DOM object\r\n\t\t\tcontext = context.context;\r\n\t\t}\r\n\t\tif ( jQuery.parseHTML ) {\r\n\t\t\treturn oldInit.call( this, jQuery.parseHTML( match[ 2 ], context, true ),\r\n\t\t\t\t\tcontext, rootjQuery );\r\n\t\t}\r\n\t}\r\n\treturn oldInit.apply( this, arguments );\r\n};\r\njQuery.fn.init.prototype = jQuery.fn;\r\n\r\n// Let $.parseJSON(falsy_value) return null\r\njQuery.parseJSON = function( json ) {\r\n\tif ( !json && json !== null ) {\r\n\t\tmigrateWarn(\"jQuery.parseJSON requires a valid JSON string\");\r\n\t\treturn null;\r\n\t}\r\n\treturn oldParseJSON.apply( this, arguments );\r\n};\r\n\r\njQuery.uaMatch = function( ua ) {\r\n\tua = ua.toLowerCase();\r\n\r\n\tvar match = /(chrome)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t/(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec( ua ) ||\r\n\t\t/(msie) ([\\w.]+)/.exec( ua ) ||\r\n\t\tua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec( ua ) ||\r\n\t\t[];\r\n\r\n\treturn {\r\n\t\tbrowser: match[ 1 ] || \"\",\r\n\t\tversion: match[ 2 ] || \"0\"\r\n\t};\r\n};\r\n\r\n// Don't clobber any existing jQuery.browser in case it's different\r\nif ( !jQuery.browser ) {\r\n\tmatched = jQuery.uaMatch( navigator.userAgent );\r\n\tbrowser = {};\r\n\r\n\tif ( matched.browser ) {\r\n\t\tbrowser[ matched.browser ] = true;\r\n\t\tbrowser.version = matched.version;\r\n\t}\r\n\r\n\t// Chrome is Webkit, but Webkit is also Safari.\r\n\tif ( browser.chrome ) {\r\n\t\tbrowser.webkit = true;\r\n\t} else if ( browser.webkit ) {\r\n\t\tbrowser.safari = true;\r\n\t}\r\n\r\n\tjQuery.browser = browser;\r\n}\r\n\r\n// Warn if the code tries to get jQuery.browser\r\nmigrateWarnProp( jQuery, \"browser\", jQuery.browser, \"jQuery.browser is deprecated\" );\r\n\r\njQuery.sub = function() {\r\n\tfunction jQuerySub( selector, context ) {\r\n\t\treturn new jQuerySub.fn.init( selector, context );\r\n\t}\r\n\tjQuery.extend( true, jQuerySub, this );\r\n\tjQuerySub.superclass = this;\r\n\tjQuerySub.fn = jQuerySub.prototype = this();\r\n\tjQuerySub.fn.constructor = jQuerySub;\r\n\tjQuerySub.sub = this.sub;\r\n\tjQuerySub.fn.init = function init( selector, context ) {\r\n\t\tif ( context && context instanceof jQuery && !(context instanceof jQuerySub) ) {\r\n\t\t\tcontext = jQuerySub( context );\r\n\t\t}\r\n\r\n\t\treturn jQuery.fn.init.call( this, selector, context, rootjQuerySub );\r\n\t};\r\n\tjQuerySub.fn.init.prototype = jQuerySub.fn;\r\n\tvar rootjQuerySub = jQuerySub(document);\r\n\tmigrateWarn( \"jQuery.sub() is deprecated\" );\r\n\treturn jQuerySub;\r\n};\r\n\r\n\r\n// Ensure that $.ajax gets the new parseJSON defined in core.js\r\njQuery.ajaxSetup({\r\n\tconverters: {\r\n\t\t\"text json\": jQuery.parseJSON\r\n\t}\r\n});\r\n\r\n\r\nvar oldFnData = jQuery.fn.data;\r\n\r\njQuery.fn.data = function( name ) {\r\n\tvar ret, evt,\r\n\t\telem = this[0];\r\n\r\n\t// Handles 1.7 which has this behavior and 1.8 which doesn't\r\n\tif ( elem && name === \"events\" && arguments.length === 1 ) {\r\n\t\tret = jQuery.data( elem, name );\r\n\t\tevt = jQuery._data( elem, name );\r\n\t\tif ( ( ret === undefined || ret === evt ) && evt !== undefined ) {\r\n\t\t\tmigrateWarn(\"Use of jQuery.fn.data('events') is deprecated\");\r\n\t\t\treturn evt;\r\n\t\t}\r\n\t}\r\n\treturn oldFnData.apply( this, arguments );\r\n};\r\n\r\n\r\nvar rscriptType = /\\/(java|ecma)script/i,\r\n\toldSelf = jQuery.fn.andSelf || jQuery.fn.addBack;\r\n\r\njQuery.fn.andSelf = function() {\r\n\tmigrateWarn(\"jQuery.fn.andSelf() replaced by jQuery.fn.addBack()\");\r\n\treturn oldSelf.apply( this, arguments );\r\n};\r\n\r\n// Since jQuery.clean is used internally on older versions, we only shim if it's missing\r\nif ( !jQuery.clean ) {\r\n\tjQuery.clean = function( elems, context, fragment, scripts ) {\r\n\t\t// Set context per 1.8 logic\r\n\t\tcontext = context || document;\r\n\t\tcontext = !context.nodeType && context[0] || context;\r\n\t\tcontext = context.ownerDocument || context;\r\n\r\n\t\tmigrateWarn(\"jQuery.clean() is deprecated\");\r\n\r\n\t\tvar i, elem, handleScript, jsTags,\r\n\t\t\tret = [];\r\n\r\n\t\tjQuery.merge( ret, jQuery.buildFragment( elems, context ).childNodes );\r\n\r\n\t\t// Complex logic lifted directly from jQuery 1.8\r\n\t\tif ( fragment ) {\r\n\t\t\t// Special handling of each script element\r\n\t\t\thandleScript = function( elem ) {\r\n\t\t\t\t// Check if we consider it executable\r\n\t\t\t\tif ( !elem.type || rscriptType.test( elem.type ) ) {\r\n\t\t\t\t\t// Detach the script and store it in the scripts array (if provided) or the fragment\r\n\t\t\t\t\t// Return truthy to indicate that it has been handled\r\n\t\t\t\t\treturn scripts ?\r\n\t\t\t\t\t\tscripts.push( elem.parentNode ? elem.parentNode.removeChild( elem ) : elem ) :\r\n\t\t\t\t\t\tfragment.appendChild( elem );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( i = 0; (elem = ret[i]) != null; i++ ) {\r\n\t\t\t\t// Check if we're done after handling an executable script\r\n\t\t\t\tif ( !( jQuery.nodeName( elem, \"script\" ) && handleScript( elem ) ) ) {\r\n\t\t\t\t\t// Append to fragment and handle embedded scripts\r\n\t\t\t\t\tfragment.appendChild( elem );\r\n\t\t\t\t\tif ( typeof elem.getElementsByTagName !== \"undefined\" ) {\r\n\t\t\t\t\t\t// handleScript alters the DOM, so use jQuery.merge to ensure snapshot iteration\r\n\t\t\t\t\t\tjsTags = jQuery.grep( jQuery.merge( [], elem.getElementsByTagName(\"script\") ), handleScript );\r\n\r\n\t\t\t\t\t\t// Splice the scripts into ret after their former ancestor and advance our index beyond them\r\n\t\t\t\t\t\tret.splice.apply( ret, [i + 1, 0].concat( jsTags ) );\r\n\t\t\t\t\t\ti += jsTags.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn ret;\r\n\t};\r\n}\r\n\r\nvar eventAdd = jQuery.event.add,\r\n\teventRemove = jQuery.event.remove,\r\n\teventTrigger = jQuery.event.trigger,\r\n\toldToggle = jQuery.fn.toggle,\r\n\toldLive = jQuery.fn.live,\r\n\toldDie = jQuery.fn.die,\r\n\tajaxEvents = \"ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess\",\r\n\trajaxEvent = new RegExp( \"\\\\b(?:\" + ajaxEvents + \")\\\\b\" ),\r\n\trhoverHack = /(?:^|\\s)hover(\\.\\S+|)\\b/,\r\n\thoverHack = function( events ) {\r\n\t\tif ( typeof( events ) !== \"string\" || jQuery.event.special.hover ) {\r\n\t\t\treturn events;\r\n\t\t}\r\n\t\tif ( rhoverHack.test( events ) ) {\r\n\t\t\tmigrateWarn(\"'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'\");\r\n\t\t}\r\n\t\treturn events && events.replace( rhoverHack, \"mouseenter$1 mouseleave$1\" );\r\n\t};\r\n\r\n// Event props removed in 1.9, put them back if needed; no practical way to warn them\r\nif ( jQuery.event.props && jQuery.event.props[ 0 ] !== \"attrChange\" ) {\r\n\tjQuery.event.props.unshift( \"attrChange\", \"attrName\", \"relatedNode\", \"srcElement\" );\r\n}\r\n\r\n// Undocumented jQuery.event.handle was \"deprecated\" in jQuery 1.7\r\nif ( jQuery.event.dispatch ) {\r\n\tmigrateWarnProp( jQuery.event, \"handle\", jQuery.event.dispatch, \"jQuery.event.handle is undocumented and deprecated\" );\r\n}\r\n\r\n// Support for 'hover' pseudo-event and ajax event warnings\r\njQuery.event.add = function( elem, types, handler, data, selector ){\r\n\tif ( elem !== document && rajaxEvent.test( types ) ) {\r\n\t\tmigrateWarn( \"AJAX events should be attached to document: \" + types );\r\n\t}\r\n\teventAdd.call( this, elem, hoverHack( types || \"\" ), handler, data, selector );\r\n};\r\njQuery.event.remove = function( elem, types, handler, selector, mappedTypes ){\r\n\teventRemove.call( this, elem, hoverHack( types ) || \"\", handler, selector, mappedTypes );\r\n};\r\n\r\njQuery.fn.error = function() {\r\n\tvar args = Array.prototype.slice.call( arguments, 0);\r\n\tmigrateWarn(\"jQuery.fn.error() is deprecated\");\r\n\targs.splice( 0, 0, \"error\" );\r\n\tif ( arguments.length ) {\r\n\t\treturn this.bind.apply( this, args );\r\n\t}\r\n\t// error event should not bubble to window, although it does pre-1.7\r\n\tthis.triggerHandler.apply( this, args );\r\n\treturn this;\r\n};\r\n\r\njQuery.fn.toggle = function( fn, fn2 ) {\r\n\r\n\t// Don't mess with animation or css toggles\r\n\tif ( !jQuery.isFunction( fn ) || !jQuery.isFunction( fn2 ) ) {\r\n\t\treturn oldToggle.apply( this, arguments );\r\n\t}\r\n\tmigrateWarn(\"jQuery.fn.toggle(handler, handler...) is deprecated\");\r\n\r\n\t// Save reference to arguments for access in closure\r\n\tvar args = arguments,\r\n\t\tguid = fn.guid || jQuery.guid++,\r\n\t\ti = 0,\r\n\t\ttoggler = function( event ) {\r\n\t\t\t// Figure out which function to execute\r\n\t\t\tvar lastToggle = ( jQuery._data( this, \"lastToggle\" + fn.guid ) || 0 ) % i;\r\n\t\t\tjQuery._data( this, \"lastToggle\" + fn.guid, lastToggle + 1 );\r\n\r\n\t\t\t// Make sure that clicks stop\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\t// and execute the function\r\n\t\t\treturn args[ lastToggle ].apply( this, arguments ) || false;\r\n\t\t};\r\n\r\n\t// link all the functions, so any of them can unbind this click handler\r\n\ttoggler.guid = guid;\r\n\twhile ( i < args.length ) {\r\n\t\targs[ i++ ].guid = guid;\r\n\t}\r\n\r\n\treturn this.click( toggler );\r\n};\r\n\r\njQuery.fn.live = function( types, data, fn ) {\r\n\tmigrateWarn(\"jQuery.fn.live() is deprecated\");\r\n\tif ( oldLive ) {\r\n\t\treturn oldLive.apply( this, arguments );\r\n\t}\r\n\tjQuery( this.context ).on( types, this.selector, data, fn );\r\n\treturn this;\r\n};\r\n\r\njQuery.fn.die = function( types, fn ) {\r\n\tmigrateWarn(\"jQuery.fn.die() is deprecated\");\r\n\tif ( oldDie ) {\r\n\t\treturn oldDie.apply( this, arguments );\r\n\t}\r\n\tjQuery( this.context ).off( types, this.selector || \"**\", fn );\r\n\treturn this;\r\n};\r\n\r\n// Turn global events into document-triggered events\r\njQuery.event.trigger = function( event, data, elem, onlyHandlers  ){\r\n\tif ( !elem && !rajaxEvent.test( event ) ) {\r\n\t\tmigrateWarn( \"Global events are undocumented and deprecated\" );\r\n\t}\r\n\treturn eventTrigger.call( this,  event, data, elem || document, onlyHandlers  );\r\n};\r\njQuery.each( ajaxEvents.split(\"|\"),\r\n\tfunction( _, name ) {\r\n\t\tjQuery.event.special[ name ] = {\r\n\t\t\tsetup: function() {\r\n\t\t\t\tvar elem = this;\r\n\r\n\t\t\t\t// The document needs no shimming; must be !== for oldIE\r\n\t\t\t\tif ( elem !== document ) {\r\n\t\t\t\t\tjQuery.event.add( document, name + \".\" + jQuery.guid, function() {\r\n\t\t\t\t\t\tjQuery.event.trigger( name, null, elem, true );\r\n\t\t\t\t\t});\r\n\t\t\t\t\tjQuery._data( this, name, jQuery.guid++ );\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tteardown: function() {\r\n\t\t\t\tif ( this !== document ) {\r\n\t\t\t\t\tjQuery.event.remove( document, name + \".\" + jQuery._data( this, name ) );\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n);\r\n\r\n\r\n})( jQuery, window );\r\n","jquery/jquery-ui-timepicker-addon.js":"/*! jQuery Timepicker Addon - v1.4.3 - 2013-11-30\r\n* http://trentrichardson.com/examples/timepicker\r\n* Copyright (c) 2013 Trent Richardson; Licensed MIT */\r\n(function (factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define([\r\n            \"jquery\",\r\n            \"jquery/ui\"\r\n        ], factory);\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n}(function ($) {\r\n\r\n\t/*\r\n\t* Lets not redefine timepicker, Prevent \"Uncaught RangeError: Maximum call stack size exceeded\"\r\n\t*/\r\n\t$.ui.timepicker = $.ui.timepicker || {};\r\n\tif ($.ui.timepicker.version) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t/*\r\n\t* Extend jQueryUI, get it started with our version number\r\n\t*/\r\n\t$.extend($.ui, {\r\n\t\ttimepicker: {\r\n\t\t\tversion: \"1.4.3\"\r\n\t\t}\r\n\t});\r\n\r\n\t/* \r\n\t* Timepicker manager.\r\n\t* Use the singleton instance of this class, $.timepicker, to interact with the time picker.\r\n\t* Settings for (groups of) time pickers are maintained in an instance object,\r\n\t* allowing multiple different settings on the same page.\r\n\t*/\r\n\tvar Timepicker = function () {\r\n\t\tthis.regional = []; // Available regional settings, indexed by language code\r\n\t\tthis.regional[''] = { // Default regional settings\r\n\t\t\tcurrentText: 'Now',\r\n\t\t\tcloseText: 'Done',\r\n\t\t\tamNames: ['AM', 'A'],\r\n\t\t\tpmNames: ['PM', 'P'],\r\n\t\t\ttimeFormat: 'HH:mm',\r\n\t\t\ttimeSuffix: '',\r\n\t\t\ttimeOnlyTitle: 'Choose Time',\r\n\t\t\ttimeText: 'Time',\r\n\t\t\thourText: 'Hour',\r\n\t\t\tminuteText: 'Minute',\r\n\t\t\tsecondText: 'Second',\r\n\t\t\tmillisecText: 'Millisecond',\r\n\t\t\tmicrosecText: 'Microsecond',\r\n\t\t\ttimezoneText: 'Time Zone',\r\n\t\t\tisRTL: false\r\n\t\t};\r\n\t\tthis._defaults = { // Global defaults for all the datetime picker instances\r\n\t\t\tshowButtonPanel: true,\r\n\t\t\ttimeOnly: false,\r\n\t\t\tshowHour: null,\r\n\t\t\tshowMinute: null,\r\n\t\t\tshowSecond: null,\r\n\t\t\tshowMillisec: null,\r\n\t\t\tshowMicrosec: null,\r\n\t\t\tshowTimezone: null,\r\n\t\t\tshowTime: true,\r\n\t\t\tstepHour: 1,\r\n\t\t\tstepMinute: 1,\r\n\t\t\tstepSecond: 1,\r\n\t\t\tstepMillisec: 1,\r\n\t\t\tstepMicrosec: 1,\r\n\t\t\thour: 0,\r\n\t\t\tminute: 0,\r\n\t\t\tsecond: 0,\r\n\t\t\tmillisec: 0,\r\n\t\t\tmicrosec: 0,\r\n\t\t\ttimezone: null,\r\n\t\t\thourMin: 0,\r\n\t\t\tminuteMin: 0,\r\n\t\t\tsecondMin: 0,\r\n\t\t\tmillisecMin: 0,\r\n\t\t\tmicrosecMin: 0,\r\n\t\t\thourMax: 23,\r\n\t\t\tminuteMax: 59,\r\n\t\t\tsecondMax: 59,\r\n\t\t\tmillisecMax: 999,\r\n\t\t\tmicrosecMax: 999,\r\n\t\t\tminDateTime: null,\r\n\t\t\tmaxDateTime: null,\r\n\t\t\tonSelect: null,\r\n\t\t\thourGrid: 0,\r\n\t\t\tminuteGrid: 0,\r\n\t\t\tsecondGrid: 0,\r\n\t\t\tmillisecGrid: 0,\r\n\t\t\tmicrosecGrid: 0,\r\n\t\t\talwaysSetTime: true,\r\n\t\t\tseparator: ' ',\r\n\t\t\taltFieldTimeOnly: true,\r\n\t\t\taltTimeFormat: null,\r\n\t\t\taltSeparator: null,\r\n\t\t\taltTimeSuffix: null,\r\n\t\t\tpickerTimeFormat: null,\r\n\t\t\tpickerTimeSuffix: null,\r\n\t\t\tshowTimepicker: true,\r\n\t\t\ttimezoneList: null,\r\n\t\t\taddSliderAccess: false,\r\n\t\t\tsliderAccessArgs: null,\r\n\t\t\tcontrolType: 'slider',\r\n\t\t\tdefaultValue: null,\r\n\t\t\tparse: 'strict'\r\n\t\t};\r\n\t\t$.extend(this._defaults, this.regional['']);\r\n\t};\r\n\r\n\t$.extend(Timepicker.prototype, {\r\n\t\t$input: null,\r\n\t\t$altInput: null,\r\n\t\t$timeObj: null,\r\n\t\tinst: null,\r\n\t\thour_slider: null,\r\n\t\tminute_slider: null,\r\n\t\tsecond_slider: null,\r\n\t\tmillisec_slider: null,\r\n\t\tmicrosec_slider: null,\r\n\t\ttimezone_select: null,\r\n\t\thour: 0,\r\n\t\tminute: 0,\r\n\t\tsecond: 0,\r\n\t\tmillisec: 0,\r\n\t\tmicrosec: 0,\r\n\t\ttimezone: null,\r\n\t\thourMinOriginal: null,\r\n\t\tminuteMinOriginal: null,\r\n\t\tsecondMinOriginal: null,\r\n\t\tmillisecMinOriginal: null,\r\n\t\tmicrosecMinOriginal: null,\r\n\t\thourMaxOriginal: null,\r\n\t\tminuteMaxOriginal: null,\r\n\t\tsecondMaxOriginal: null,\r\n\t\tmillisecMaxOriginal: null,\r\n\t\tmicrosecMaxOriginal: null,\r\n\t\tampm: '',\r\n\t\tformattedDate: '',\r\n\t\tformattedTime: '',\r\n\t\tformattedDateTime: '',\r\n\t\ttimezoneList: null,\r\n\t\tunits: ['hour', 'minute', 'second', 'millisec', 'microsec'],\r\n\t\tsupport: {},\r\n\t\tcontrol: null,\r\n\r\n\t\t/* \r\n\t\t* Override the default settings for all instances of the time picker.\r\n\t\t* @param  {Object} settings  object - the new settings to use as defaults (anonymous object)\r\n\t\t* @return {Object} the manager object\r\n\t\t*/\r\n\t\tsetDefaults: function (settings) {\r\n\t\t\textendRemove(this._defaults, settings || {});\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* Create a new Timepicker instance\r\n\t\t*/\r\n\t\t_newInst: function ($input, opts) {\r\n\t\t\tvar tp_inst = new Timepicker(),\r\n\t\t\t\tinlineSettings = {},\r\n\t\t\t\tfns = {},\r\n\t\t\t\toverrides, i;\r\n\r\n\t\t\tfor (var attrName in this._defaults) {\r\n\t\t\t\tif (this._defaults.hasOwnProperty(attrName)) {\r\n\t\t\t\t\tvar attrValue = $input.attr('time:' + attrName);\r\n\t\t\t\t\tif (attrValue) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tinlineSettings[attrName] = eval(attrValue);\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\tinlineSettings[attrName] = attrValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\toverrides = {\r\n\t\t\t\tbeforeShow: function (input, dp_inst) {\r\n\t\t\t\t\tif ($.isFunction(tp_inst._defaults.evnts.beforeShow)) {\r\n\t\t\t\t\t\treturn tp_inst._defaults.evnts.beforeShow.call($input[0], input, dp_inst, tp_inst);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonChangeMonthYear: function (year, month, dp_inst) {\r\n\t\t\t\t\t// Update the time as well : this prevents the time from disappearing from the $input field.\r\n\t\t\t\t\ttp_inst._updateDateTime(dp_inst);\r\n\t\t\t\t\tif ($.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)) {\r\n\t\t\t\t\t\ttp_inst._defaults.evnts.onChangeMonthYear.call($input[0], year, month, dp_inst, tp_inst);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonClose: function (dateText, dp_inst) {\r\n\t\t\t\t\tif (tp_inst.timeDefined === true && $input.val() !== '') {\r\n\t\t\t\t\t\ttp_inst._updateDateTime(dp_inst);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($.isFunction(tp_inst._defaults.evnts.onClose)) {\r\n\t\t\t\t\t\ttp_inst._defaults.evnts.onClose.call($input[0], dateText, dp_inst, tp_inst);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tfor (i in overrides) {\r\n\t\t\t\tif (overrides.hasOwnProperty(i)) {\r\n\t\t\t\t\tfns[i] = opts[i] || null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\ttp_inst._defaults = $.extend({}, this._defaults, inlineSettings, opts, overrides, {\r\n\t\t\t\tevnts: fns,\r\n\t\t\t\ttimepicker: tp_inst // add timepicker as a property of datepicker: $.datepicker._get(dp_inst, 'timepicker');\r\n\t\t\t});\r\n\t\t\ttp_inst.amNames = $.map(tp_inst._defaults.amNames, function (val) {\r\n\t\t\t\treturn val.toUpperCase();\r\n\t\t\t});\r\n\t\t\ttp_inst.pmNames = $.map(tp_inst._defaults.pmNames, function (val) {\r\n\t\t\t\treturn val.toUpperCase();\r\n\t\t\t});\r\n\r\n\t\t\t// detect which units are supported\r\n\t\t\ttp_inst.support = detectSupport(\r\n\t\t\t\t\ttp_inst._defaults.timeFormat + \r\n\t\t\t\t\t(tp_inst._defaults.pickerTimeFormat ? tp_inst._defaults.pickerTimeFormat : '') +\r\n\t\t\t\t\t(tp_inst._defaults.altTimeFormat ? tp_inst._defaults.altTimeFormat : ''));\r\n\r\n\t\t\t// controlType is string - key to our this._controls\r\n\t\t\tif (typeof(tp_inst._defaults.controlType) === 'string') {\r\n\t\t\t\tif (tp_inst._defaults.controlType === 'slider' && typeof($.ui.slider) === 'undefined') {\r\n\t\t\t\t\ttp_inst._defaults.controlType = 'select';\r\n\t\t\t\t}\r\n\t\t\t\ttp_inst.control = tp_inst._controls[tp_inst._defaults.controlType];\r\n\t\t\t}\r\n\t\t\t// controlType is an object and must implement create, options, value methods\r\n\t\t\telse {\r\n\t\t\t\ttp_inst.control = tp_inst._defaults.controlType;\r\n\t\t\t}\r\n\r\n\t\t\t// prep the timezone options\r\n\t\t\tvar timezoneList = [-720, -660, -600, -570, -540, -480, -420, -360, -300, -270, -240, -210, -180, -120, -60,\r\n\t\t\t\t\t0, 60, 120, 180, 210, 240, 270, 300, 330, 345, 360, 390, 420, 480, 525, 540, 570, 600, 630, 660, 690, 720, 765, 780, 840];\r\n\t\t\tif (tp_inst._defaults.timezoneList !== null) {\r\n\t\t\t\ttimezoneList = tp_inst._defaults.timezoneList;\r\n\t\t\t}\r\n\t\t\tvar tzl = timezoneList.length, tzi = 0, tzv = null;\r\n\t\t\tif (tzl > 0 && typeof timezoneList[0] !== 'object') {\r\n\t\t\t\tfor (; tzi < tzl; tzi++) {\r\n\t\t\t\t\ttzv = timezoneList[tzi];\r\n\t\t\t\t\ttimezoneList[tzi] = { value: tzv, label: $.timepicker.timezoneOffsetString(tzv, tp_inst.support.iso8601) };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttp_inst._defaults.timezoneList = timezoneList;\r\n\r\n\t\t\t// set the default units\r\n\t\t\ttp_inst.timezone = tp_inst._defaults.timezone !== null ? $.timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone) :\r\n\t\t\t\t\t\t\t((new Date()).getTimezoneOffset() * -1);\r\n\t\t\ttp_inst.hour = tp_inst._defaults.hour < tp_inst._defaults.hourMin ? tp_inst._defaults.hourMin :\r\n\t\t\t\t\t\t\ttp_inst._defaults.hour > tp_inst._defaults.hourMax ? tp_inst._defaults.hourMax : tp_inst._defaults.hour;\r\n\t\t\ttp_inst.minute = tp_inst._defaults.minute < tp_inst._defaults.minuteMin ? tp_inst._defaults.minuteMin :\r\n\t\t\t\t\t\t\ttp_inst._defaults.minute > tp_inst._defaults.minuteMax ? tp_inst._defaults.minuteMax : tp_inst._defaults.minute;\r\n\t\t\ttp_inst.second = tp_inst._defaults.second < tp_inst._defaults.secondMin ? tp_inst._defaults.secondMin :\r\n\t\t\t\t\t\t\ttp_inst._defaults.second > tp_inst._defaults.secondMax ? tp_inst._defaults.secondMax : tp_inst._defaults.second;\r\n\t\t\ttp_inst.millisec = tp_inst._defaults.millisec < tp_inst._defaults.millisecMin ? tp_inst._defaults.millisecMin :\r\n\t\t\t\t\t\t\ttp_inst._defaults.millisec > tp_inst._defaults.millisecMax ? tp_inst._defaults.millisecMax : tp_inst._defaults.millisec;\r\n\t\t\ttp_inst.microsec = tp_inst._defaults.microsec < tp_inst._defaults.microsecMin ? tp_inst._defaults.microsecMin :\r\n\t\t\t\t\t\t\ttp_inst._defaults.microsec > tp_inst._defaults.microsecMax ? tp_inst._defaults.microsecMax : tp_inst._defaults.microsec;\r\n\t\t\ttp_inst.ampm = '';\r\n\t\t\ttp_inst.$input = $input;\r\n\r\n\t\t\tif (tp_inst._defaults.altField) {\r\n\t\t\t\ttp_inst.$altInput = $(tp_inst._defaults.altField).css({\r\n\t\t\t\t\tcursor: 'pointer'\r\n\t\t\t\t}).focus(function () {\r\n\t\t\t\t\t$input.trigger(\"focus\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (tp_inst._defaults.minDate === 0 || tp_inst._defaults.minDateTime === 0) {\r\n\t\t\t\ttp_inst._defaults.minDate = new Date();\r\n\t\t\t}\r\n\t\t\tif (tp_inst._defaults.maxDate === 0 || tp_inst._defaults.maxDateTime === 0) {\r\n\t\t\t\ttp_inst._defaults.maxDate = new Date();\r\n\t\t\t}\r\n\r\n\t\t\t// datepicker needs minDate/maxDate, timepicker needs minDateTime/maxDateTime..\r\n\t\t\tif (tp_inst._defaults.minDate !== undefined && tp_inst._defaults.minDate instanceof Date) {\r\n\t\t\t\ttp_inst._defaults.minDateTime = new Date(tp_inst._defaults.minDate.getTime());\r\n\t\t\t}\r\n\t\t\tif (tp_inst._defaults.minDateTime !== undefined && tp_inst._defaults.minDateTime instanceof Date) {\r\n\t\t\t\ttp_inst._defaults.minDate = new Date(tp_inst._defaults.minDateTime.getTime());\r\n\t\t\t}\r\n\t\t\tif (tp_inst._defaults.maxDate !== undefined && tp_inst._defaults.maxDate instanceof Date) {\r\n\t\t\t\ttp_inst._defaults.maxDateTime = new Date(tp_inst._defaults.maxDate.getTime());\r\n\t\t\t}\r\n\t\t\tif (tp_inst._defaults.maxDateTime !== undefined && tp_inst._defaults.maxDateTime instanceof Date) {\r\n\t\t\t\ttp_inst._defaults.maxDate = new Date(tp_inst._defaults.maxDateTime.getTime());\r\n\t\t\t}\r\n\t\t\ttp_inst.$input.bind('focus', function () {\r\n\t\t\t\ttp_inst._onFocus();\r\n\t\t\t});\r\n\r\n\t\t\treturn tp_inst;\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* add our sliders to the calendar\r\n\t\t*/\r\n\t\t_addTimePicker: function (dp_inst) {\r\n\t\t\tvar currDT = (this.$altInput && this._defaults.altFieldTimeOnly) ? this.$input.val() + ' ' + this.$altInput.val() : this.$input.val();\r\n\r\n\t\t\tthis.timeDefined = this._parseTime(currDT);\r\n\t\t\tthis._limitMinMaxDateTime(dp_inst, false);\r\n\t\t\tthis._injectTimePicker();\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* parse the time string from input value or _setTime\r\n\t\t*/\r\n\t\t_parseTime: function (timeString, withDate) {\r\n\t\t\tif (!this.inst) {\r\n\t\t\t\tthis.inst = $.datepicker._getInst(this.$input[0]);\r\n\t\t\t}\r\n\r\n\t\t\tif (withDate || !this._defaults.timeOnly) {\r\n\t\t\t\tvar dp_dateFormat = $.datepicker._get(this.inst, 'dateFormat');\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvar parseRes = parseDateTimeInternal(dp_dateFormat, this._defaults.timeFormat, timeString, $.datepicker._getFormatConfig(this.inst), this._defaults);\r\n\t\t\t\t\tif (!parseRes.timeObj) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$.extend(this, parseRes.timeObj);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\t$.timepicker.log(\"Error parsing the date/time string: \" + err +\r\n\t\t\t\t\t\t\t\t\t\"\\ndate/time string = \" + timeString +\r\n\t\t\t\t\t\t\t\t\t\"\\ntimeFormat = \" + this._defaults.timeFormat +\r\n\t\t\t\t\t\t\t\t\t\"\\ndateFormat = \" + dp_dateFormat);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tvar timeObj = $.datepicker.parseTime(this._defaults.timeFormat, timeString, this._defaults);\r\n\t\t\t\tif (!timeObj) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\t$.extend(this, timeObj);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* generate and inject html for timepicker into ui datepicker\r\n\t\t*/\r\n\t\t_injectTimePicker: function () {\r\n\t\t\tvar $dp = this.inst.dpDiv,\r\n\t\t\t\to = this.inst.settings,\r\n\t\t\t\ttp_inst = this,\r\n\t\t\t\tlitem = '',\r\n\t\t\t\tuitem = '',\r\n\t\t\t\tshow = null,\r\n\t\t\t\tmax = {},\r\n\t\t\t\tgridSize = {},\r\n\t\t\t\tsize = null,\r\n\t\t\t\ti = 0,\r\n\t\t\t\tl = 0;\r\n\r\n\t\t\t// Prevent displaying twice\r\n\t\t\tif ($dp.find(\"div.ui-timepicker-div\").length === 0 && o.showTimepicker) {\r\n\t\t\t\tvar noDisplay = ' style=\"display:none;\"',\r\n\t\t\t\t\thtml = '<div class=\"ui-timepicker-div' + (o.isRTL ? ' ui-timepicker-rtl' : '') + '\"><dl>' + '<dt class=\"ui_tpicker_time_label\"' + ((o.showTime) ? '' : noDisplay) + '>' + o.timeText + '</dt>' +\r\n\t\t\t\t\t\t\t\t'<dd class=\"ui_tpicker_time\"' + ((o.showTime) ? '' : noDisplay) + '></dd>';\r\n\r\n\t\t\t\t// Create the markup\r\n\t\t\t\tfor (i = 0, l = this.units.length; i < l; i++) {\r\n\t\t\t\t\tlitem = this.units[i];\r\n\t\t\t\t\tuitem = litem.substr(0, 1).toUpperCase() + litem.substr(1);\r\n\t\t\t\t\tshow = o['show' + uitem] !== null ? o['show' + uitem] : this.support[litem];\r\n\r\n\t\t\t\t\t// Added by Peter Medeiros:\r\n\t\t\t\t\t// - Figure out what the hour/minute/second max should be based on the step values.\r\n\t\t\t\t\t// - Example: if stepMinute is 15, then minMax is 45.\r\n\t\t\t\t\tmax[litem] = parseInt((o[litem + 'Max'] - ((o[litem + 'Max'] - o[litem + 'Min']) % o['step' + uitem])), 10);\r\n\t\t\t\t\tgridSize[litem] = 0;\r\n\r\n\t\t\t\t\thtml += '<dt class=\"ui_tpicker_' + litem + '_label\"' + (show ? '' : noDisplay) + '>' + o[litem + 'Text'] + '</dt>' +\r\n\t\t\t\t\t\t\t\t'<dd class=\"ui_tpicker_' + litem + '\"><div class=\"ui_tpicker_' + litem + '_slider\"' + (show ? '' : noDisplay) + '></div>';\r\n\r\n\t\t\t\t\tif (show && o[litem + 'Grid'] > 0) {\r\n\t\t\t\t\t\thtml += '<div style=\"padding-left: 1px\"><table class=\"ui-tpicker-grid-label\"><tr>';\r\n\r\n\t\t\t\t\t\tif (litem === 'hour') {\r\n\t\t\t\t\t\t\tfor (var h = o[litem + 'Min']; h <= max[litem]; h += parseInt(o[litem + 'Grid'], 10)) {\r\n\t\t\t\t\t\t\t\tgridSize[litem]++;\r\n\t\t\t\t\t\t\t\tvar tmph = $.datepicker.formatTime(this.support.ampm ? 'hht' : 'HH', {hour: h}, o);\r\n\t\t\t\t\t\t\t\thtml += '<td data-for=\"' + litem + '\">' + tmph + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tfor (var m = o[litem + 'Min']; m <= max[litem]; m += parseInt(o[litem + 'Grid'], 10)) {\r\n\t\t\t\t\t\t\t\tgridSize[litem]++;\r\n\t\t\t\t\t\t\t\thtml += '<td data-for=\"' + litem + '\">' + ((m < 10) ? '0' : '') + m + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\thtml += '</tr></table></div>';\r\n\t\t\t\t\t}\r\n\t\t\t\t\thtml += '</dd>';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Timezone\r\n\t\t\t\tvar showTz = o.showTimezone !== null ? o.showTimezone : this.support.timezone;\r\n\t\t\t\thtml += '<dt class=\"ui_tpicker_timezone_label\"' + (showTz ? '' : noDisplay) + '>' + o.timezoneText + '</dt>';\r\n\t\t\t\thtml += '<dd class=\"ui_tpicker_timezone\" ' + (showTz ? '' : noDisplay) + '></dd>';\r\n\r\n\t\t\t\t// Create the elements from string\r\n\t\t\t\thtml += '</dl></div>';\r\n\t\t\t\tvar $tp = $(html);\r\n\r\n\t\t\t\t// if we only want time picker...\r\n\t\t\t\tif (o.timeOnly === true) {\r\n\t\t\t\t\t$tp.prepend('<div class=\"ui-widget-header ui-helper-clearfix ui-corner-all\">' + '<div class=\"ui-datepicker-title\">' + o.timeOnlyTitle + '</div>' + '</div>');\r\n\t\t\t\t\t$dp.find('.ui-datepicker-header, .ui-datepicker-calendar').hide();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// add sliders, adjust grids, add events\r\n\t\t\t\tfor (i = 0, l = tp_inst.units.length; i < l; i++) {\r\n\t\t\t\t\tlitem = tp_inst.units[i];\r\n\t\t\t\t\tuitem = litem.substr(0, 1).toUpperCase() + litem.substr(1);\r\n\t\t\t\t\tshow = o['show' + uitem] !== null ? o['show' + uitem] : this.support[litem];\r\n\r\n\t\t\t\t\t// add the slider\r\n\t\t\t\t\ttp_inst[litem + '_slider'] = tp_inst.control.create(tp_inst, $tp.find('.ui_tpicker_' + litem + '_slider'), litem, tp_inst[litem], o[litem + 'Min'], max[litem], o['step' + uitem]);\r\n\r\n\t\t\t\t\t// adjust the grid and add click event\r\n\t\t\t\t\tif (show && o[litem + 'Grid'] > 0) {\r\n\t\t\t\t\t\tsize = 100 * gridSize[litem] * o[litem + 'Grid'] / (max[litem] - o[litem + 'Min']);\r\n\t\t\t\t\t\t$tp.find('.ui_tpicker_' + litem + ' table').css({\r\n\t\t\t\t\t\t\twidth: size + \"%\",\r\n\t\t\t\t\t\t\tmarginLeft: o.isRTL ? '0' : ((size / (-2 * gridSize[litem])) + \"%\"),\r\n\t\t\t\t\t\t\tmarginRight: o.isRTL ? ((size / (-2 * gridSize[litem])) + \"%\") : '0',\r\n\t\t\t\t\t\t\tborderCollapse: 'collapse'\r\n\t\t\t\t\t\t}).find(\"td\").click(function (e) {\r\n\t\t\t\t\t\t\t\tvar $t = $(this),\r\n\t\t\t\t\t\t\t\t\th = $t.html(),\r\n\t\t\t\t\t\t\t\t\tn = parseInt(h.replace(/[^0-9]/g), 10),\r\n\t\t\t\t\t\t\t\t\tap = h.replace(/[^apm]/ig),\r\n\t\t\t\t\t\t\t\t\tf = $t.data('for'); // loses scope, so we use data-for\r\n\r\n\t\t\t\t\t\t\t\tif (f === 'hour') {\r\n\t\t\t\t\t\t\t\t\tif (ap.indexOf('p') !== -1 && n < 12) {\r\n\t\t\t\t\t\t\t\t\t\tn += 12;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tif (ap.indexOf('a') !== -1 && n === 12) {\r\n\t\t\t\t\t\t\t\t\t\t\tn = 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\ttp_inst.control.value(tp_inst, tp_inst[f + '_slider'], litem, n);\r\n\r\n\t\t\t\t\t\t\t\ttp_inst._onTimeChange();\r\n\t\t\t\t\t\t\t\ttp_inst._onSelectHandler();\r\n\t\t\t\t\t\t\t}).css({\r\n\t\t\t\t\t\t\t\tcursor: 'pointer',\r\n\t\t\t\t\t\t\t\twidth: (100 / gridSize[litem]) + '%',\r\n\t\t\t\t\t\t\t\ttextAlign: 'center',\r\n\t\t\t\t\t\t\t\toverflow: 'hidden'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t} // end if grid > 0\r\n\t\t\t\t} // end for loop\r\n\r\n\t\t\t\t// Add timezone options\r\n\t\t\t\tthis.timezone_select = $tp.find('.ui_tpicker_timezone').append('<select></select>').find(\"select\");\r\n\t\t\t\t$.fn.append.apply(this.timezone_select,\r\n\t\t\t\t$.map(o.timezoneList, function (val, idx) {\r\n\t\t\t\t\treturn $(\"<option />\").val(typeof val === \"object\" ? val.value : val).text(typeof val === \"object\" ? val.label : val);\r\n\t\t\t\t}));\r\n\t\t\t\tif (typeof(this.timezone) !== \"undefined\" && this.timezone !== null && this.timezone !== \"\") {\r\n\t\t\t\t\tvar local_timezone = (new Date(this.inst.selectedYear, this.inst.selectedMonth, this.inst.selectedDay, 12)).getTimezoneOffset() * -1;\r\n\t\t\t\t\tif (local_timezone === this.timezone) {\r\n\t\t\t\t\t\tselectLocalTimezone(tp_inst);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.timezone_select.val(this.timezone);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (typeof(this.hour) !== \"undefined\" && this.hour !== null && this.hour !== \"\") {\r\n\t\t\t\t\t\tthis.timezone_select.val(o.timezone);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tselectLocalTimezone(tp_inst);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.timezone_select.change(function () {\r\n\t\t\t\t\ttp_inst._onTimeChange();\r\n\t\t\t\t\ttp_inst._onSelectHandler();\r\n\t\t\t\t});\r\n\t\t\t\t// End timezone options\r\n\t\t\t\t\r\n\t\t\t\t// inject timepicker into datepicker\r\n\t\t\t\tvar $buttonPanel = $dp.find('.ui-datepicker-buttonpane');\r\n\t\t\t\tif ($buttonPanel.length) {\r\n\t\t\t\t\t$buttonPanel.before($tp);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$dp.append($tp);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.$timeObj = $tp.find('.ui_tpicker_time');\r\n\r\n\t\t\t\tif (this.inst !== null) {\r\n\t\t\t\t\tvar timeDefined = this.timeDefined;\r\n\t\t\t\t\tthis._onTimeChange();\r\n\t\t\t\t\tthis.timeDefined = timeDefined;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// slideAccess integration: http://trentrichardson.com/2011/11/11/jquery-ui-sliders-and-touch-accessibility/\r\n\t\t\t\tif (this._defaults.addSliderAccess) {\r\n\t\t\t\t\tvar sliderAccessArgs = this._defaults.sliderAccessArgs,\r\n\t\t\t\t\t\trtl = this._defaults.isRTL;\r\n\t\t\t\t\tsliderAccessArgs.isRTL = rtl;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tsetTimeout(function () { // fix for inline mode\r\n\t\t\t\t\t\tif ($tp.find('.ui-slider-access').length === 0) {\r\n\t\t\t\t\t\t\t$tp.find('.ui-slider:visible').sliderAccess(sliderAccessArgs);\r\n\r\n\t\t\t\t\t\t\t// fix any grids since sliders are shorter\r\n\t\t\t\t\t\t\tvar sliderAccessWidth = $tp.find('.ui-slider-access:eq(0)').outerWidth(true);\r\n\t\t\t\t\t\t\tif (sliderAccessWidth) {\r\n\t\t\t\t\t\t\t\t$tp.find('table:visible').each(function () {\r\n\t\t\t\t\t\t\t\t\tvar $g = $(this),\r\n\t\t\t\t\t\t\t\t\t\toldWidth = $g.outerWidth(),\r\n\t\t\t\t\t\t\t\t\t\toldMarginLeft = $g.css(rtl ? 'marginRight' : 'marginLeft').toString().replace('%', ''),\r\n\t\t\t\t\t\t\t\t\t\tnewWidth = oldWidth - sliderAccessWidth,\r\n\t\t\t\t\t\t\t\t\t\tnewMarginLeft = ((oldMarginLeft * newWidth) / oldWidth) + '%',\r\n\t\t\t\t\t\t\t\t\t\tcss = { width: newWidth, marginRight: 0, marginLeft: 0 };\r\n\t\t\t\t\t\t\t\t\tcss[rtl ? 'marginRight' : 'marginLeft'] = newMarginLeft;\r\n\t\t\t\t\t\t\t\t\t$g.css(css);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 10);\r\n\t\t\t\t}\r\n\t\t\t\t// end slideAccess integration\r\n\r\n\t\t\t\ttp_inst._limitMinMaxDateTime(this.inst, true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* This function tries to limit the ability to go outside the\r\n\t\t* min/max date range\r\n\t\t*/\r\n\t\t_limitMinMaxDateTime: function (dp_inst, adjustSliders) {\r\n\t\t\tvar o = this._defaults,\r\n\t\t\t\tdp_date = new Date(dp_inst.selectedYear, dp_inst.selectedMonth, dp_inst.selectedDay);\r\n\r\n\t\t\tif (!this._defaults.showTimepicker) {\r\n\t\t\t\treturn;\r\n\t\t\t} // No time so nothing to check here\r\n\r\n\t\t\tif ($.datepicker._get(dp_inst, 'minDateTime') !== null && $.datepicker._get(dp_inst, 'minDateTime') !== undefined && dp_date) {\r\n\t\t\t\tvar minDateTime = $.datepicker._get(dp_inst, 'minDateTime'),\r\n\t\t\t\t\tminDateTimeDate = new Date(minDateTime.getFullYear(), minDateTime.getMonth(), minDateTime.getDate(), 0, 0, 0, 0);\r\n\r\n\t\t\t\tif (this.hourMinOriginal === null || this.minuteMinOriginal === null || this.secondMinOriginal === null || this.millisecMinOriginal === null || this.microsecMinOriginal === null) {\r\n\t\t\t\t\tthis.hourMinOriginal = o.hourMin;\r\n\t\t\t\t\tthis.minuteMinOriginal = o.minuteMin;\r\n\t\t\t\t\tthis.secondMinOriginal = o.secondMin;\r\n\t\t\t\t\tthis.millisecMinOriginal = o.millisecMin;\r\n\t\t\t\t\tthis.microsecMinOriginal = o.microsecMin;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dp_inst.settings.timeOnly || minDateTimeDate.getTime() === dp_date.getTime()) {\r\n\t\t\t\t\tthis._defaults.hourMin = minDateTime.getHours();\r\n\t\t\t\t\tif (this.hour <= this._defaults.hourMin) {\r\n\t\t\t\t\t\tthis.hour = this._defaults.hourMin;\r\n\t\t\t\t\t\tthis._defaults.minuteMin = minDateTime.getMinutes();\r\n\t\t\t\t\t\tif (this.minute <= this._defaults.minuteMin) {\r\n\t\t\t\t\t\t\tthis.minute = this._defaults.minuteMin;\r\n\t\t\t\t\t\t\tthis._defaults.secondMin = minDateTime.getSeconds();\r\n\t\t\t\t\t\t\tif (this.second <= this._defaults.secondMin) {\r\n\t\t\t\t\t\t\t\tthis.second = this._defaults.secondMin;\r\n\t\t\t\t\t\t\t\tthis._defaults.millisecMin = minDateTime.getMilliseconds();\r\n\t\t\t\t\t\t\t\tif (this.millisec <= this._defaults.millisecMin) {\r\n\t\t\t\t\t\t\t\t\tthis.millisec = this._defaults.millisecMin;\r\n\t\t\t\t\t\t\t\t\tthis._defaults.microsecMin = minDateTime.getMicroseconds();\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (this.microsec < this._defaults.microsecMin) {\r\n\t\t\t\t\t\t\t\t\t\tthis.microsec = this._defaults.microsecMin;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis._defaults.microsecMin = this.microsecMinOriginal;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis._defaults.millisecMin = this.millisecMinOriginal;\r\n\t\t\t\t\t\t\t\tthis._defaults.microsecMin = this.microsecMinOriginal;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._defaults.secondMin = this.secondMinOriginal;\r\n\t\t\t\t\t\t\tthis._defaults.millisecMin = this.millisecMinOriginal;\r\n\t\t\t\t\t\t\tthis._defaults.microsecMin = this.microsecMinOriginal;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._defaults.minuteMin = this.minuteMinOriginal;\r\n\t\t\t\t\t\tthis._defaults.secondMin = this.secondMinOriginal;\r\n\t\t\t\t\t\tthis._defaults.millisecMin = this.millisecMinOriginal;\r\n\t\t\t\t\t\tthis._defaults.microsecMin = this.microsecMinOriginal;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._defaults.hourMin = this.hourMinOriginal;\r\n\t\t\t\t\tthis._defaults.minuteMin = this.minuteMinOriginal;\r\n\t\t\t\t\tthis._defaults.secondMin = this.secondMinOriginal;\r\n\t\t\t\t\tthis._defaults.millisecMin = this.millisecMinOriginal;\r\n\t\t\t\t\tthis._defaults.microsecMin = this.microsecMinOriginal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ($.datepicker._get(dp_inst, 'maxDateTime') !== null && $.datepicker._get(dp_inst, 'maxDateTime') !== undefined && dp_date) {\r\n\t\t\t\tvar maxDateTime = $.datepicker._get(dp_inst, 'maxDateTime'),\r\n\t\t\t\t\tmaxDateTimeDate = new Date(maxDateTime.getFullYear(), maxDateTime.getMonth(), maxDateTime.getDate(), 0, 0, 0, 0);\r\n\r\n\t\t\t\tif (this.hourMaxOriginal === null || this.minuteMaxOriginal === null || this.secondMaxOriginal === null || this.millisecMaxOriginal === null) {\r\n\t\t\t\t\tthis.hourMaxOriginal = o.hourMax;\r\n\t\t\t\t\tthis.minuteMaxOriginal = o.minuteMax;\r\n\t\t\t\t\tthis.secondMaxOriginal = o.secondMax;\r\n\t\t\t\t\tthis.millisecMaxOriginal = o.millisecMax;\r\n\t\t\t\t\tthis.microsecMaxOriginal = o.microsecMax;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dp_inst.settings.timeOnly || maxDateTimeDate.getTime() === dp_date.getTime()) {\r\n\t\t\t\t\tthis._defaults.hourMax = maxDateTime.getHours();\r\n\t\t\t\t\tif (this.hour >= this._defaults.hourMax) {\r\n\t\t\t\t\t\tthis.hour = this._defaults.hourMax;\r\n\t\t\t\t\t\tthis._defaults.minuteMax = maxDateTime.getMinutes();\r\n\t\t\t\t\t\tif (this.minute >= this._defaults.minuteMax) {\r\n\t\t\t\t\t\t\tthis.minute = this._defaults.minuteMax;\r\n\t\t\t\t\t\t\tthis._defaults.secondMax = maxDateTime.getSeconds();\r\n\t\t\t\t\t\t\tif (this.second >= this._defaults.secondMax) {\r\n\t\t\t\t\t\t\t\tthis.second = this._defaults.secondMax;\r\n\t\t\t\t\t\t\t\tthis._defaults.millisecMax = maxDateTime.getMilliseconds();\r\n\t\t\t\t\t\t\t\tif (this.millisec >= this._defaults.millisecMax) {\r\n\t\t\t\t\t\t\t\t\tthis.millisec = this._defaults.millisecMax;\r\n\t\t\t\t\t\t\t\t\tthis._defaults.microsecMax = maxDateTime.getMicroseconds();\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (this.microsec > this._defaults.microsecMax) {\r\n\t\t\t\t\t\t\t\t\t\tthis.microsec = this._defaults.microsecMax;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis._defaults.microsecMax = this.microsecMaxOriginal;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis._defaults.millisecMax = this.millisecMaxOriginal;\r\n\t\t\t\t\t\t\t\tthis._defaults.microsecMax = this.microsecMaxOriginal;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._defaults.secondMax = this.secondMaxOriginal;\r\n\t\t\t\t\t\t\tthis._defaults.millisecMax = this.millisecMaxOriginal;\r\n\t\t\t\t\t\t\tthis._defaults.microsecMax = this.microsecMaxOriginal;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._defaults.minuteMax = this.minuteMaxOriginal;\r\n\t\t\t\t\t\tthis._defaults.secondMax = this.secondMaxOriginal;\r\n\t\t\t\t\t\tthis._defaults.millisecMax = this.millisecMaxOriginal;\r\n\t\t\t\t\t\tthis._defaults.microsecMax = this.microsecMaxOriginal;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._defaults.hourMax = this.hourMaxOriginal;\r\n\t\t\t\t\tthis._defaults.minuteMax = this.minuteMaxOriginal;\r\n\t\t\t\t\tthis._defaults.secondMax = this.secondMaxOriginal;\r\n\t\t\t\t\tthis._defaults.millisecMax = this.millisecMaxOriginal;\r\n\t\t\t\t\tthis._defaults.microsecMax = this.microsecMaxOriginal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (adjustSliders !== undefined && adjustSliders === true) {\r\n\t\t\t\tvar hourMax = parseInt((this._defaults.hourMax - ((this._defaults.hourMax - this._defaults.hourMin) % this._defaults.stepHour)), 10),\r\n\t\t\t\t\tminMax = parseInt((this._defaults.minuteMax - ((this._defaults.minuteMax - this._defaults.minuteMin) % this._defaults.stepMinute)), 10),\r\n\t\t\t\t\tsecMax = parseInt((this._defaults.secondMax - ((this._defaults.secondMax - this._defaults.secondMin) % this._defaults.stepSecond)), 10),\r\n\t\t\t\t\tmillisecMax = parseInt((this._defaults.millisecMax - ((this._defaults.millisecMax - this._defaults.millisecMin) % this._defaults.stepMillisec)), 10),\r\n\t\t\t\t\tmicrosecMax = parseInt((this._defaults.microsecMax - ((this._defaults.microsecMax - this._defaults.microsecMin) % this._defaults.stepMicrosec)), 10);\r\n\r\n\t\t\t\tif (this.hour_slider) {\r\n\t\t\t\t\tthis.control.options(this, this.hour_slider, 'hour', { min: this._defaults.hourMin, max: hourMax });\r\n\t\t\t\t\tthis.control.value(this, this.hour_slider, 'hour', this.hour - (this.hour % this._defaults.stepHour));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.minute_slider) {\r\n\t\t\t\t\tthis.control.options(this, this.minute_slider, 'minute', { min: this._defaults.minuteMin, max: minMax });\r\n\t\t\t\t\tthis.control.value(this, this.minute_slider, 'minute', this.minute - (this.minute % this._defaults.stepMinute));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.second_slider) {\r\n\t\t\t\t\tthis.control.options(this, this.second_slider, 'second', { min: this._defaults.secondMin, max: secMax });\r\n\t\t\t\t\tthis.control.value(this, this.second_slider, 'second', this.second - (this.second % this._defaults.stepSecond));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.millisec_slider) {\r\n\t\t\t\t\tthis.control.options(this, this.millisec_slider, 'millisec', { min: this._defaults.millisecMin, max: millisecMax });\r\n\t\t\t\t\tthis.control.value(this, this.millisec_slider, 'millisec', this.millisec - (this.millisec % this._defaults.stepMillisec));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.microsec_slider) {\r\n\t\t\t\t\tthis.control.options(this, this.microsec_slider, 'microsec', { min: this._defaults.microsecMin, max: microsecMax });\r\n\t\t\t\t\tthis.control.value(this, this.microsec_slider, 'microsec', this.microsec - (this.microsec % this._defaults.stepMicrosec));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* when a slider moves, set the internal time...\r\n\t\t* on time change is also called when the time is updated in the text field\r\n\t\t*/\r\n\t\t_onTimeChange: function () {\r\n\t\t\tif (!this._defaults.showTimepicker) {\r\n                                return;\r\n\t\t\t}\r\n\t\t\tvar hour = (this.hour_slider) ? this.control.value(this, this.hour_slider, 'hour') : false,\r\n\t\t\t\tminute = (this.minute_slider) ? this.control.value(this, this.minute_slider, 'minute') : false,\r\n\t\t\t\tsecond = (this.second_slider) ? this.control.value(this, this.second_slider, 'second') : false,\r\n\t\t\t\tmillisec = (this.millisec_slider) ? this.control.value(this, this.millisec_slider, 'millisec') : false,\r\n\t\t\t\tmicrosec = (this.microsec_slider) ? this.control.value(this, this.microsec_slider, 'microsec') : false,\r\n\t\t\t\ttimezone = (this.timezone_select) ? this.timezone_select.val() : false,\r\n\t\t\t\to = this._defaults,\r\n\t\t\t\tpickerTimeFormat = o.pickerTimeFormat || o.timeFormat,\r\n\t\t\t\tpickerTimeSuffix = o.pickerTimeSuffix || o.timeSuffix;\r\n\r\n\t\t\tif (typeof(hour) === 'object') {\r\n\t\t\t\thour = false;\r\n\t\t\t}\r\n\t\t\tif (typeof(minute) === 'object') {\r\n\t\t\t\tminute = false;\r\n\t\t\t}\r\n\t\t\tif (typeof(second) === 'object') {\r\n\t\t\t\tsecond = false;\r\n\t\t\t}\r\n\t\t\tif (typeof(millisec) === 'object') {\r\n\t\t\t\tmillisec = false;\r\n\t\t\t}\r\n\t\t\tif (typeof(microsec) === 'object') {\r\n\t\t\t\tmicrosec = false;\r\n\t\t\t}\r\n\t\t\tif (typeof(timezone) === 'object') {\r\n\t\t\t\ttimezone = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (hour !== false) {\r\n\t\t\t\thour = parseInt(hour, 10);\r\n\t\t\t}\r\n\t\t\tif (minute !== false) {\r\n\t\t\t\tminute = parseInt(minute, 10);\r\n\t\t\t}\r\n\t\t\tif (second !== false) {\r\n\t\t\t\tsecond = parseInt(second, 10);\r\n\t\t\t}\r\n\t\t\tif (millisec !== false) {\r\n\t\t\t\tmillisec = parseInt(millisec, 10);\r\n\t\t\t}\r\n\t\t\tif (microsec !== false) {\r\n\t\t\t\tmicrosec = parseInt(microsec, 10);\r\n\t\t\t}\r\n\t\t\tif (timezone !== false) {\r\n\t\t\t\ttimezone = timezone.toString();\r\n\t\t\t}\r\n\r\n\t\t\tvar ampm = o[hour < 12 ? 'amNames' : 'pmNames'][0];\r\n\r\n\t\t\t// If the update was done in the input field, the input field should not be updated.\r\n\t\t\t// If the update was done using the sliders, update the input field.\r\n\t\t\tvar hasChanged = (\r\n\t\t\t\t\t\thour !== parseInt(this.hour,10) || // sliders should all be numeric\r\n\t\t\t\t\t\tminute !== parseInt(this.minute,10) || \r\n\t\t\t\t\t\tsecond !== parseInt(this.second,10) || \r\n\t\t\t\t\t\tmillisec !== parseInt(this.millisec,10) || \r\n\t\t\t\t\t\tmicrosec !== parseInt(this.microsec,10) || \r\n\t\t\t\t\t\t(this.ampm.length > 0 && (hour < 12) !== ($.inArray(this.ampm.toUpperCase(), this.amNames) !== -1)) || \r\n\t\t\t\t\t\t(this.timezone !== null && timezone !== this.timezone.toString()) // could be numeric or \"EST\" format, so use toString()\r\n\t\t\t\t\t);\r\n\r\n\t\t\tif (hasChanged) {\r\n\r\n\t\t\t\tif (hour !== false) {\r\n\t\t\t\t\tthis.hour = hour;\r\n\t\t\t\t}\r\n\t\t\t\tif (minute !== false) {\r\n\t\t\t\t\tthis.minute = minute;\r\n\t\t\t\t}\r\n\t\t\t\tif (second !== false) {\r\n\t\t\t\t\tthis.second = second;\r\n\t\t\t\t}\r\n\t\t\t\tif (millisec !== false) {\r\n\t\t\t\t\tthis.millisec = millisec;\r\n\t\t\t\t}\r\n\t\t\t\tif (microsec !== false) {\r\n\t\t\t\t\tthis.microsec = microsec;\r\n\t\t\t\t}\r\n\t\t\t\tif (timezone !== false) {\r\n\t\t\t\t\tthis.timezone = timezone;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this.inst) {\r\n\t\t\t\t\tthis.inst = $.datepicker._getInst(this.$input[0]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._limitMinMaxDateTime(this.inst, true);\r\n\t\t\t}\r\n\t\t\tif (this.support.ampm) {\r\n\t\t\t\tthis.ampm = ampm;\r\n\t\t\t}\r\n\r\n\t\t\t// Updates the time within the timepicker\r\n\t\t\tthis.formattedTime = $.datepicker.formatTime(o.timeFormat, this, o);\r\n\t\t\tif (this.$timeObj) {\r\n\t\t\t\tif (pickerTimeFormat === o.timeFormat) {\r\n\t\t\t\t\tthis.$timeObj.text(this.formattedTime + pickerTimeSuffix);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.$timeObj.text($.datepicker.formatTime(pickerTimeFormat, this, o) + pickerTimeSuffix);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.timeDefined = true;\r\n\t\t\tif (hasChanged) {\r\n\t\t\t\tthis._updateDateTime();\r\n\t\t\t\tthis.$input.focus();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* call custom onSelect.\r\n\t\t* bind to sliders slidestop, and grid click.\r\n\t\t*/\r\n\t\t_onSelectHandler: function () {\r\n\t\t\tvar onSelect = this._defaults.onSelect || this.inst.settings.onSelect;\r\n\t\t\tvar inputEl = this.$input ? this.$input[0] : null;\r\n\t\t\tif (onSelect && inputEl) {\r\n\t\t\t\tonSelect.apply(inputEl, [this.formattedDateTime, this]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* update our input with the new date time..\r\n\t\t*/\r\n\t\t_updateDateTime: function (dp_inst) {\r\n\t\t\tdp_inst = this.inst || dp_inst;\r\n\t\t\tvar dtTmp = (dp_inst.currentYear > 0? \r\n\t\t\t\t\t\t\tnew Date(dp_inst.currentYear, dp_inst.currentMonth, dp_inst.currentDay) : \r\n\t\t\t\t\t\t\tnew Date(dp_inst.selectedYear, dp_inst.selectedMonth, dp_inst.selectedDay)),\r\n\t\t\t\tdt = $.datepicker._daylightSavingAdjust(dtTmp),\r\n\t\t\t\t//dt = $.datepicker._daylightSavingAdjust(new Date(dp_inst.selectedYear, dp_inst.selectedMonth, dp_inst.selectedDay)),\r\n\t\t\t\t//dt = $.datepicker._daylightSavingAdjust(new Date(dp_inst.currentYear, dp_inst.currentMonth, dp_inst.currentDay)),\r\n\t\t\t\tdateFmt = $.datepicker._get(dp_inst, 'dateFormat'),\r\n\t\t\t\tformatCfg = $.datepicker._getFormatConfig(dp_inst),\r\n\t\t\t\ttimeAvailable = dt !== null && this.timeDefined;\r\n\t\t\tthis.formattedDate = $.datepicker.formatDate(dateFmt, (dt === null ? new Date() : dt), formatCfg);\r\n\t\t\tvar formattedDateTime = this.formattedDate;\r\n\t\t\t\r\n\t\t\t// if a slider was changed but datepicker doesn't have a value yet, set it\r\n\t\t\tif (dp_inst.lastVal === \"\") {\r\n                dp_inst.currentYear = dp_inst.selectedYear;\r\n                dp_inst.currentMonth = dp_inst.selectedMonth;\r\n                dp_inst.currentDay = dp_inst.selectedDay;\r\n            }\r\n\r\n\t\t\t/*\r\n\t\t\t* remove following lines to force every changes in date picker to change the input value\r\n\t\t\t* Bug descriptions: when an input field has a default value, and click on the field to pop up the date picker. \r\n\t\t\t* If the user manually empty the value in the input field, the date picker will never change selected value.\r\n\t\t\t*/\r\n\t\t\t//if (dp_inst.lastVal !== undefined && (dp_inst.lastVal.length > 0 && this.$input.val().length === 0)) {\r\n\t\t\t//\treturn;\r\n\t\t\t//}\r\n\r\n\t\t\tif (this._defaults.timeOnly === true) {\r\n\t\t\t\tformattedDateTime = this.formattedTime;\r\n\t\t\t} else if (this._defaults.timeOnly !== true && (this._defaults.alwaysSetTime || timeAvailable)) {\r\n\t\t\t\tformattedDateTime += this._defaults.separator + this.formattedTime + this._defaults.timeSuffix;\r\n\t\t\t}\r\n\r\n\t\t\tthis.formattedDateTime = formattedDateTime;\r\n\r\n\t\t\tif (!this._defaults.showTimepicker) {\r\n\t\t\t\tthis.$input.val(this.formattedDate);\r\n\t\t\t} else if (this.$altInput && this._defaults.timeOnly === false && this._defaults.altFieldTimeOnly === true) {\r\n\t\t\t\tthis.$altInput.val(this.formattedTime);\r\n\t\t\t\tthis.$input.val(this.formattedDate);\r\n\t\t\t} else if (this.$altInput) {\r\n\t\t\t\tthis.$input.val(formattedDateTime);\r\n\t\t\t\tvar altFormattedDateTime = '',\r\n\t\t\t\t\taltSeparator = this._defaults.altSeparator ? this._defaults.altSeparator : this._defaults.separator,\r\n\t\t\t\t\taltTimeSuffix = this._defaults.altTimeSuffix ? this._defaults.altTimeSuffix : this._defaults.timeSuffix;\r\n\t\t\t\t\r\n\t\t\t\tif (!this._defaults.timeOnly) {\r\n\t\t\t\t\tif (this._defaults.altFormat) {\r\n\t\t\t\t\t\taltFormattedDateTime = $.datepicker.formatDate(this._defaults.altFormat, (dt === null ? new Date() : dt), formatCfg);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\taltFormattedDateTime = this.formattedDate;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (altFormattedDateTime) {\r\n\t\t\t\t\t\taltFormattedDateTime += altSeparator;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this._defaults.altTimeFormat) {\r\n\t\t\t\t\taltFormattedDateTime += $.datepicker.formatTime(this._defaults.altTimeFormat, this, this._defaults) + altTimeSuffix;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\taltFormattedDateTime += this.formattedTime + altTimeSuffix;\r\n\t\t\t\t}\r\n\t\t\t\tthis.$altInput.val(altFormattedDateTime);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$input.val(formattedDateTime);\r\n\t\t\t}\r\n\r\n\t\t\tthis.$input.trigger(\"change\");\r\n\t\t},\r\n\r\n\t\t_onFocus: function () {\r\n\t\t\tif (!this.$input.val() && this._defaults.defaultValue) {\r\n\t\t\t\tthis.$input.val(this._defaults.defaultValue);\r\n\t\t\t\tvar inst = $.datepicker._getInst(this.$input.get(0)),\r\n\t\t\t\t\ttp_inst = $.datepicker._get(inst, 'timepicker');\r\n\t\t\t\tif (tp_inst) {\r\n\t\t\t\t\tif (tp_inst._defaults.timeOnly && (inst.input.val() !== inst.lastVal)) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t$.datepicker._updateDatepicker(inst);\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\t$.timepicker.log(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* Small abstraction to control types\r\n\t\t* We can add more, just be sure to follow the pattern: create, options, value\r\n\t\t*/\r\n\t\t_controls: {\r\n\t\t\t// slider methods\r\n\t\t\tslider: {\r\n\t\t\t\tcreate: function (tp_inst, obj, unit, val, min, max, step) {\r\n\t\t\t\t\tvar rtl = tp_inst._defaults.isRTL; // if rtl go -60->0 instead of 0->60\r\n\t\t\t\t\treturn obj.prop('slide', null).slider({\r\n\t\t\t\t\t\torientation: \"horizontal\",\r\n\t\t\t\t\t\tvalue: rtl ? val * -1 : val,\r\n\t\t\t\t\t\tmin: rtl ? max * -1 : min,\r\n\t\t\t\t\t\tmax: rtl ? min * -1 : max,\r\n\t\t\t\t\t\tstep: step,\r\n\t\t\t\t\t\tslide: function (event, ui) {\r\n\t\t\t\t\t\t\ttp_inst.control.value(tp_inst, $(this), unit, rtl ? ui.value * -1 : ui.value);\r\n\t\t\t\t\t\t\ttp_inst._onTimeChange();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tstop: function (event, ui) {\r\n\t\t\t\t\t\t\ttp_inst._onSelectHandler();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\t\r\n\t\t\t\t},\r\n\t\t\t\toptions: function (tp_inst, obj, unit, opts, val) {\r\n\t\t\t\t\tif (tp_inst._defaults.isRTL) {\r\n\t\t\t\t\t\tif (typeof(opts) === 'string') {\r\n\t\t\t\t\t\t\tif (opts === 'min' || opts === 'max') {\r\n\t\t\t\t\t\t\t\tif (val !== undefined) {\r\n\t\t\t\t\t\t\t\t\treturn obj.slider(opts, val * -1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn Math.abs(obj.slider(opts));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn obj.slider(opts);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar min = opts.min, \r\n\t\t\t\t\t\t\tmax = opts.max;\r\n\t\t\t\t\t\topts.min = opts.max = null;\r\n\t\t\t\t\t\tif (min !== undefined) {\r\n\t\t\t\t\t\t\topts.max = min * -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (max !== undefined) {\r\n\t\t\t\t\t\t\topts.min = max * -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn obj.slider(opts);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (typeof(opts) === 'string' && val !== undefined) {\r\n\t\t\t\t\t\treturn obj.slider(opts, val);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn obj.slider(opts);\r\n\t\t\t\t},\r\n\t\t\t\tvalue: function (tp_inst, obj, unit, val) {\r\n\t\t\t\t\tif (tp_inst._defaults.isRTL) {\r\n\t\t\t\t\t\tif (val !== undefined) {\r\n\t\t\t\t\t\t\treturn obj.slider('value', val * -1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn Math.abs(obj.slider('value'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (val !== undefined) {\r\n\t\t\t\t\t\treturn obj.slider('value', val);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn obj.slider('value');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// select methods\r\n\t\t\tselect: {\r\n\t\t\t\tcreate: function (tp_inst, obj, unit, val, min, max, step) {\r\n\t\t\t\t\tvar sel = '<select class=\"ui-timepicker-select\" data-unit=\"' + unit + '\" data-min=\"' + min + '\" data-max=\"' + max + '\" data-step=\"' + step + '\">',\r\n\t\t\t\t\t\tformat = tp_inst._defaults.pickerTimeFormat || tp_inst._defaults.timeFormat;\r\n\r\n\t\t\t\t\tfor (var i = min; i <= max; i += step) {\r\n\t\t\t\t\t\tsel += '<option value=\"' + i + '\"' + (i === val ? ' selected' : '') + '>';\r\n\t\t\t\t\t\tif (unit === 'hour') {\r\n\t\t\t\t\t\t\tsel += $.datepicker.formatTime($.trim(format.replace(/[^ht ]/ig, '')), {hour: i}, tp_inst._defaults);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (unit === 'millisec' || unit === 'microsec' || i >= 10) { sel += i; }\r\n\t\t\t\t\t\telse {sel += '0' + i.toString(); }\r\n\t\t\t\t\t\tsel += '</option>';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsel += '</select>';\r\n\r\n\t\t\t\t\tobj.children('select').remove();\r\n\r\n\t\t\t\t\t$(sel).appendTo(obj).change(function (e) {\r\n\t\t\t\t\t\ttp_inst._onTimeChange();\r\n\t\t\t\t\t\ttp_inst._onSelectHandler();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t},\r\n\t\t\t\toptions: function (tp_inst, obj, unit, opts, val) {\r\n\t\t\t\t\tvar o = {},\r\n\t\t\t\t\t\t$t = obj.children('select');\r\n\t\t\t\t\tif (typeof(opts) === 'string') {\r\n\t\t\t\t\t\tif (val === undefined) {\r\n\t\t\t\t\t\t\treturn $t.data(opts);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\to[opts] = val;\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse { o = opts; }\r\n\t\t\t\t\treturn tp_inst.control.create(tp_inst, obj, $t.data('unit'), $t.val(), o.min || $t.data('min'), o.max || $t.data('max'), o.step || $t.data('step'));\r\n\t\t\t\t},\r\n\t\t\t\tvalue: function (tp_inst, obj, unit, val) {\r\n\t\t\t\t\tvar $t = obj.children('select');\r\n\t\t\t\t\tif (val !== undefined) {\r\n\t\t\t\t\t\treturn $t.val(val);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn $t.val();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} // end _controls\r\n\r\n\t});\r\n\r\n\t$.fn.extend({\r\n\t\t/*\r\n\t\t* shorthand just to use timepicker.\r\n\t\t*/\r\n\t\ttimepicker: function (o) {\r\n\t\t\to = o || {};\r\n\t\t\tvar tmp_args = Array.prototype.slice.call(arguments);\r\n\r\n\t\t\tif (typeof o === 'object') {\r\n\t\t\t\ttmp_args[0] = $.extend(o, {\r\n\t\t\t\t\ttimeOnly: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn $(this).each(function () {\r\n\t\t\t\t$.fn.datetimepicker.apply($(this), tmp_args);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* extend timepicker to datepicker\r\n\t\t*/\r\n\t\tdatetimepicker: function (o) {\r\n\t\t\to = o || {};\r\n\t\t\tvar tmp_args = arguments;\r\n\r\n\t\t\tif (typeof(o) === 'string') {\r\n\t\t\t\tif (o === 'getDate') {\r\n\t\t\t\t\treturn $.fn.datepicker.apply($(this[0]), tmp_args);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.each(function () {\r\n\t\t\t\t\t\tvar $t = $(this);\r\n\t\t\t\t\t\t$t.datepicker.apply($t, tmp_args);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn this.each(function () {\r\n\t\t\t\t\tvar $t = $(this);\r\n\t\t\t\t\t$t.datepicker($.timepicker._newInst($t, o)._defaults);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t/*\r\n\t* Public Utility to parse date and time\r\n\t*/\r\n\t$.datepicker.parseDateTime = function (dateFormat, timeFormat, dateTimeString, dateSettings, timeSettings) {\r\n\t\tvar parseRes = parseDateTimeInternal(dateFormat, timeFormat, dateTimeString, dateSettings, timeSettings);\r\n\t\tif (parseRes.timeObj) {\r\n\t\t\tvar t = parseRes.timeObj;\r\n\t\t\tparseRes.date.setHours(t.hour, t.minute, t.second, t.millisec);\r\n\t\t\tparseRes.date.setMicroseconds(t.microsec);\r\n\t\t}\r\n\r\n\t\treturn parseRes.date;\r\n\t};\r\n\r\n\t/*\r\n\t* Public utility to parse time\r\n\t*/\r\n\t$.datepicker.parseTime = function (timeFormat, timeString, options) {\r\n\t\tvar o = extendRemove(extendRemove({}, $.timepicker._defaults), options || {}),\r\n\t\t\tiso8601 = (timeFormat.replace(/\\'.*?\\'/g, '').indexOf('Z') !== -1);\r\n\r\n\t\t// Strict parse requires the timeString to match the timeFormat exactly\r\n\t\tvar strictParse = function (f, s, o) {\r\n\r\n\t\t\t// pattern for standard and localized AM/PM markers\r\n\t\t\tvar getPatternAmpm = function (amNames, pmNames) {\r\n\t\t\t\tvar markers = [];\r\n\t\t\t\tif (amNames) {\r\n\t\t\t\t\t$.merge(markers, amNames);\r\n\t\t\t\t}\r\n\t\t\t\tif (pmNames) {\r\n\t\t\t\t\t$.merge(markers, pmNames);\r\n\t\t\t\t}\r\n\t\t\t\tmarkers = $.map(markers, function (val) {\r\n\t\t\t\t\treturn val.replace(/[.*+?|()\\[\\]{}\\\\]/g, '\\\\$&');\r\n\t\t\t\t});\r\n\t\t\t\treturn '(' + markers.join('|') + ')?';\r\n\t\t\t};\r\n\r\n\t\t\t// figure out position of time elements.. cause js cant do named captures\r\n\t\t\tvar getFormatPositions = function (timeFormat) {\r\n\t\t\t\tvar finds = timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),\r\n\t\t\t\t\torders = {\r\n\t\t\t\t\t\th: -1,\r\n\t\t\t\t\t\tm: -1,\r\n\t\t\t\t\t\ts: -1,\r\n\t\t\t\t\t\tl: -1,\r\n\t\t\t\t\t\tc: -1,\r\n\t\t\t\t\t\tt: -1,\r\n\t\t\t\t\t\tz: -1\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tif (finds) {\r\n\t\t\t\t\tfor (var i = 0; i < finds.length; i++) {\r\n\t\t\t\t\t\tif (orders[finds[i].toString().charAt(0)] === -1) {\r\n\t\t\t\t\t\t\torders[finds[i].toString().charAt(0)] = i + 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn orders;\r\n\t\t\t};\r\n\r\n\t\t\tvar regstr = '^' + f.toString()\r\n\t\t\t\t\t.replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g, function (match) {\r\n\t\t\t\t\t\t\tvar ml = match.length;\r\n\t\t\t\t\t\t\tswitch (match.charAt(0).toLowerCase()) {\r\n\t\t\t\t\t\t\tcase 'h':\r\n\t\t\t\t\t\t\t\treturn ml === 1 ? '(\\\\d?\\\\d)' : '(\\\\d{' + ml + '})';\r\n\t\t\t\t\t\t\tcase 'm':\r\n\t\t\t\t\t\t\t\treturn ml === 1 ? '(\\\\d?\\\\d)' : '(\\\\d{' + ml + '})';\r\n\t\t\t\t\t\t\tcase 's':\r\n\t\t\t\t\t\t\t\treturn ml === 1 ? '(\\\\d?\\\\d)' : '(\\\\d{' + ml + '})';\r\n\t\t\t\t\t\t\tcase 'l':\r\n\t\t\t\t\t\t\t\treturn '(\\\\d?\\\\d?\\\\d)';\r\n\t\t\t\t\t\t\tcase 'c':\r\n\t\t\t\t\t\t\t\treturn '(\\\\d?\\\\d?\\\\d)';\r\n\t\t\t\t\t\t\tcase 'z':\r\n\t\t\t\t\t\t\t\treturn '(z|[-+]\\\\d\\\\d:?\\\\d\\\\d|\\\\S+)?';\r\n\t\t\t\t\t\t\tcase 't':\r\n\t\t\t\t\t\t\t\treturn getPatternAmpm(o.amNames, o.pmNames);\r\n\t\t\t\t\t\t\tdefault:    // literal escaped in quotes\r\n\t\t\t\t\t\t\t\treturn '(' + match.replace(/\\'/g, \"\").replace(/(\\.|\\$|\\^|\\\\|\\/|\\(|\\)|\\[|\\]|\\?|\\+|\\*)/g, function (m) { return \"\\\\\" + m; }) + ')?';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t.replace(/\\s/g, '\\\\s?') +\r\n\t\t\t\t\to.timeSuffix + '$',\r\n\t\t\t\torder = getFormatPositions(f),\r\n\t\t\t\tampm = '',\r\n\t\t\t\ttreg;\r\n\r\n\t\t\ttreg = s.match(new RegExp(regstr, 'i'));\r\n\r\n\t\t\tvar resTime = {\r\n\t\t\t\thour: 0,\r\n\t\t\t\tminute: 0,\r\n\t\t\t\tsecond: 0,\r\n\t\t\t\tmillisec: 0,\r\n\t\t\t\tmicrosec: 0\r\n\t\t\t};\r\n\r\n\t\t\tif (treg) {\r\n\t\t\t\tif (order.t !== -1) {\r\n\t\t\t\t\tif (treg[order.t] === undefined || treg[order.t].length === 0) {\r\n\t\t\t\t\t\tampm = '';\r\n\t\t\t\t\t\tresTime.ampm = '';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tampm = $.inArray(treg[order.t].toUpperCase(), o.amNames) !== -1 ? 'AM' : 'PM';\r\n\t\t\t\t\t\tresTime.ampm = o[ampm === 'AM' ? 'amNames' : 'pmNames'][0];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (order.h !== -1) {\r\n\t\t\t\t\tif (ampm === 'AM' && treg[order.h] === '12') {\r\n\t\t\t\t\t\tresTime.hour = 0; // 12am = 0 hour\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (ampm === 'PM' && treg[order.h] !== '12') {\r\n\t\t\t\t\t\t\tresTime.hour = parseInt(treg[order.h], 10) + 12; // 12pm = 12 hour, any other pm = hour + 12\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresTime.hour = Number(treg[order.h]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (order.m !== -1) {\r\n\t\t\t\t\tresTime.minute = Number(treg[order.m]);\r\n\t\t\t\t}\r\n\t\t\t\tif (order.s !== -1) {\r\n\t\t\t\t\tresTime.second = Number(treg[order.s]);\r\n\t\t\t\t}\r\n\t\t\t\tif (order.l !== -1) {\r\n\t\t\t\t\tresTime.millisec = Number(treg[order.l]);\r\n\t\t\t\t}\r\n\t\t\t\tif (order.c !== -1) {\r\n\t\t\t\t\tresTime.microsec = Number(treg[order.c]);\r\n\t\t\t\t}\r\n\t\t\t\tif (order.z !== -1 && treg[order.z] !== undefined) {\r\n\t\t\t\t\tresTime.timezone = $.timepicker.timezoneOffsetNumber(treg[order.z]);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\treturn resTime;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};// end strictParse\r\n\r\n\t\t// First try JS Date, if that fails, use strictParse\r\n\t\tvar looseParse = function (f, s, o) {\r\n\t\t\ttry {\r\n\t\t\t\tvar d = new Date('2012-01-01 ' + s);\r\n\t\t\t\tif (isNaN(d.getTime())) {\r\n\t\t\t\t\td = new Date('2012-01-01T' + s);\r\n\t\t\t\t\tif (isNaN(d.getTime())) {\r\n\t\t\t\t\t\td = new Date('01/01/2012 ' + s);\r\n\t\t\t\t\t\tif (isNaN(d.getTime())) {\r\n\t\t\t\t\t\t\tthrow \"Unable to parse time with native Date: \" + s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\thour: d.getHours(),\r\n\t\t\t\t\tminute: d.getMinutes(),\r\n\t\t\t\t\tsecond: d.getSeconds(),\r\n\t\t\t\t\tmillisec: d.getMilliseconds(),\r\n\t\t\t\t\tmicrosec: d.getMicroseconds(),\r\n\t\t\t\t\ttimezone: d.getTimezoneOffset() * -1\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tcatch (err) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn strictParse(f, s, o);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (err2) {\r\n\t\t\t\t\t$.timepicker.log(\"Unable to parse \\ntimeString: \" + s + \"\\ntimeFormat: \" + f);\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}; // end looseParse\r\n\t\t\r\n\t\tif (typeof o.parse === \"function\") {\r\n\t\t\treturn o.parse(timeFormat, timeString, o);\r\n\t\t}\r\n\t\tif (o.parse === 'loose') {\r\n\t\t\treturn looseParse(timeFormat, timeString, o);\r\n\t\t}\r\n\t\treturn strictParse(timeFormat, timeString, o);\r\n\t};\r\n\r\n\t/**\r\n\t * Public utility to format the time\r\n\t * @param {string} format format of the time\r\n\t * @param {Object} time Object not a Date for timezones\r\n\t * @param {Object} [options] essentially the regional[].. amNames, pmNames, ampm\r\n\t * @returns {string} the formatted time\r\n\t */\r\n\t$.datepicker.formatTime = function (format, time, options) {\r\n\t\toptions = options || {};\r\n\t\toptions = $.extend({}, $.timepicker._defaults, options);\r\n\t\ttime = $.extend({\r\n\t\t\thour: 0,\r\n\t\t\tminute: 0,\r\n\t\t\tsecond: 0,\r\n\t\t\tmillisec: 0,\r\n\t\t\tmicrosec: 0,\r\n\t\t\ttimezone: null\r\n\t\t}, time);\r\n\r\n\t\tvar tmptime = format,\r\n\t\t\tampmName = options.amNames[0],\r\n\t\t\thour = parseInt(time.hour, 10);\r\n\r\n\t\tif (hour > 11) {\r\n\t\t\tampmName = options.pmNames[0];\r\n\t\t}\r\n\r\n\t\ttmptime = tmptime.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g, function (match) {\r\n\t\t\tswitch (match) {\r\n\t\t\tcase 'HH':\r\n\t\t\t\treturn ('0' + hour).slice(-2);\r\n\t\t\tcase 'H':\r\n\t\t\t\treturn hour;\r\n\t\t\tcase 'hh':\r\n\t\t\t\treturn ('0' + convert24to12(hour)).slice(-2);\r\n\t\t\tcase 'h':\r\n\t\t\t\treturn convert24to12(hour);\r\n\t\t\tcase 'mm':\r\n\t\t\t\treturn ('0' + time.minute).slice(-2);\r\n\t\t\tcase 'm':\r\n\t\t\t\treturn time.minute;\r\n\t\t\tcase 'ss':\r\n\t\t\t\treturn ('0' + time.second).slice(-2);\r\n\t\t\tcase 's':\r\n\t\t\t\treturn time.second;\r\n\t\t\tcase 'l':\r\n\t\t\t\treturn ('00' + time.millisec).slice(-3);\r\n\t\t\tcase 'c':\r\n\t\t\t\treturn ('00' + time.microsec).slice(-3);\r\n\t\t\tcase 'z':\r\n\t\t\t\treturn $.timepicker.timezoneOffsetString(time.timezone === null ? options.timezone : time.timezone, false);\r\n\t\t\tcase 'Z':\r\n\t\t\t\treturn $.timepicker.timezoneOffsetString(time.timezone === null ? options.timezone : time.timezone, true);\r\n\t\t\tcase 'T':\r\n\t\t\t\treturn ampmName.charAt(0).toUpperCase();\r\n\t\t\tcase 'TT':\r\n\t\t\t\treturn ampmName.toUpperCase();\r\n\t\t\tcase 't':\r\n\t\t\t\treturn ampmName.charAt(0).toLowerCase();\r\n\t\t\tcase 'tt':\r\n\t\t\t\treturn ampmName.toLowerCase();\r\n\t\t\tdefault:\r\n\t\t\t\treturn match.replace(/'/g, \"\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn tmptime;\r\n\t};\r\n\r\n\t/*\r\n\t* the bad hack :/ override datepicker so it doesn't close on select\r\n\t// inspired: http://stackoverflow.com/questions/1252512/jquery-datepicker-prevent-closing-picker-when-clicking-a-date/1762378#1762378\r\n\t*/\r\n\t$.datepicker._base_selectDate = $.datepicker._selectDate;\r\n\t$.datepicker._selectDate = function (id, dateStr) {\r\n\t\tvar inst = this._getInst($(id)[0]),\r\n\t\t\ttp_inst = this._get(inst, 'timepicker');\r\n\r\n\t\tif (tp_inst) {\r\n\t\t\ttp_inst._limitMinMaxDateTime(inst, true);\r\n\t\t\tinst.inline = inst.stay_open = true;\r\n\t\t\t//This way the onSelect handler called from calendarpicker get the full dateTime\r\n\t\t\tthis._base_selectDate(id, dateStr);\r\n\t\t\tinst.inline = inst.stay_open = false;\r\n\t\t\tthis._notifyChange(inst);\r\n\t\t\tthis._updateDatepicker(inst);\r\n\t\t} else {\r\n\t\t\tthis._base_selectDate(id, dateStr);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t* second bad hack :/ override datepicker so it triggers an event when changing the input field\r\n\t* and does not redraw the datepicker on every selectDate event\r\n\t*/\r\n\t$.datepicker._base_updateDatepicker = $.datepicker._updateDatepicker;\r\n\t$.datepicker._updateDatepicker = function (inst) {\r\n\r\n\t\t// don't popup the datepicker if there is another instance already opened\r\n\t\tvar input = inst.input[0];\r\n\t\tif ($.datepicker._curInst && $.datepicker._curInst !== inst && $.datepicker._datepickerShowing && $.datepicker._lastInput !== input) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (typeof(inst.stay_open) !== 'boolean' || inst.stay_open === false) {\r\n\r\n\t\t\tthis._base_updateDatepicker(inst);\r\n\r\n\t\t\t// Reload the time control when changing something in the input text field.\r\n\t\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\t\tif (tp_inst) {\r\n\t\t\t\ttp_inst._addTimePicker(inst);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t* third bad hack :/ override datepicker so it allows spaces and colon in the input field\r\n\t*/\r\n\t$.datepicker._base_doKeyPress = $.datepicker._doKeyPress;\r\n\t$.datepicker._doKeyPress = function (event) {\r\n\t\tvar inst = $.datepicker._getInst(event.target),\r\n\t\t\ttp_inst = $.datepicker._get(inst, 'timepicker');\r\n\r\n\t\tif (tp_inst) {\r\n\t\t\tif ($.datepicker._get(inst, 'constrainInput')) {\r\n\t\t\t\tvar ampm = tp_inst.support.ampm,\r\n\t\t\t\t\ttz = tp_inst._defaults.showTimezone !== null ? tp_inst._defaults.showTimezone : tp_inst.support.timezone,\r\n\t\t\t\t\tdateChars = $.datepicker._possibleChars($.datepicker._get(inst, 'dateFormat')),\r\n\t\t\t\t\tdatetimeChars = tp_inst._defaults.timeFormat.toString()\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/[hms]/g, '')\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/TT/g, ampm ? 'APM' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/Tt/g, ampm ? 'AaPpMm' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/tT/g, ampm ? 'AaPpMm' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/T/g, ampm ? 'AP' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/tt/g, ampm ? 'apm' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t.replace(/t/g, ampm ? 'ap' : '') + \r\n\t\t\t\t\t\t\t\t\t\t\t\" \" + tp_inst._defaults.separator + \r\n\t\t\t\t\t\t\t\t\t\t\ttp_inst._defaults.timeSuffix + \r\n\t\t\t\t\t\t\t\t\t\t\t(tz ? tp_inst._defaults.timezoneList.join('') : '') + \r\n\t\t\t\t\t\t\t\t\t\t\t(tp_inst._defaults.amNames.join('')) + (tp_inst._defaults.pmNames.join('')) + \r\n\t\t\t\t\t\t\t\t\t\t\tdateChars,\r\n\t\t\t\t\tchr = String.fromCharCode(event.charCode === undefined ? event.keyCode : event.charCode);\r\n\t\t\t\treturn event.ctrlKey || (chr < ' ' || !dateChars || datetimeChars.indexOf(chr) > -1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn $.datepicker._base_doKeyPress(event);\r\n\t};\r\n\r\n\t/*\r\n\t* Fourth bad hack :/ override _updateAlternate function used in inline mode to init altField\r\n\t* Update any alternate field to synchronise with the main field.\r\n\t*/\r\n\t$.datepicker._base_updateAlternate = $.datepicker._updateAlternate;\r\n\t$.datepicker._updateAlternate = function (inst) {\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\tif (tp_inst) {\r\n\t\t\tvar altField = tp_inst._defaults.altField;\r\n\t\t\tif (altField) { // update alternate field too\r\n\t\t\t\tvar altFormat = tp_inst._defaults.altFormat || tp_inst._defaults.dateFormat,\r\n\t\t\t\t\tdate = this._getDate(inst),\r\n\t\t\t\t\tformatCfg = $.datepicker._getFormatConfig(inst),\r\n\t\t\t\t\taltFormattedDateTime = '', \r\n\t\t\t\t\taltSeparator = tp_inst._defaults.altSeparator ? tp_inst._defaults.altSeparator : tp_inst._defaults.separator, \r\n\t\t\t\t\taltTimeSuffix = tp_inst._defaults.altTimeSuffix ? tp_inst._defaults.altTimeSuffix : tp_inst._defaults.timeSuffix,\r\n\t\t\t\t\taltTimeFormat = tp_inst._defaults.altTimeFormat !== null ? tp_inst._defaults.altTimeFormat : tp_inst._defaults.timeFormat;\r\n\t\t\t\t\r\n\t\t\t\taltFormattedDateTime += $.datepicker.formatTime(altTimeFormat, tp_inst, tp_inst._defaults) + altTimeSuffix;\r\n\t\t\t\tif (!tp_inst._defaults.timeOnly && !tp_inst._defaults.altFieldTimeOnly && date !== null) {\r\n\t\t\t\t\tif (tp_inst._defaults.altFormat) {\r\n\t\t\t\t\t\taltFormattedDateTime = $.datepicker.formatDate(tp_inst._defaults.altFormat, date, formatCfg) + altSeparator + altFormattedDateTime;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\taltFormattedDateTime = tp_inst.formattedDate + altSeparator + altFormattedDateTime;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t$(altField).val(altFormattedDateTime);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$.datepicker._base_updateAlternate(inst);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t* Override key up event to sync manual input changes.\r\n\t*/\r\n\t$.datepicker._base_doKeyUp = $.datepicker._doKeyUp;\r\n\t$.datepicker._doKeyUp = function (event) {\r\n\t\tvar inst = $.datepicker._getInst(event.target),\r\n\t\t\ttp_inst = $.datepicker._get(inst, 'timepicker');\r\n\r\n\t\tif (tp_inst) {\r\n\t\t\tif (tp_inst._defaults.timeOnly && (inst.input.val() !== inst.lastVal)) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t$.datepicker._updateDatepicker(inst);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\t$.timepicker.log(err);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn $.datepicker._base_doKeyUp(event);\r\n\t};\r\n\r\n\t/*\r\n\t* override \"Today\" button to also grab the time.\r\n\t*/\r\n\t$.datepicker._base_gotoToday = $.datepicker._gotoToday;\r\n\t$.datepicker._gotoToday = function (id) {\r\n\t\tvar inst = this._getInst($(id)[0]),\r\n\t\t\t$dp = inst.dpDiv;\r\n\t\tthis._base_gotoToday(id);\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\tselectLocalTimezone(tp_inst);\r\n\t\tvar now = new Date();\r\n\t\tthis._setTime(inst, now);\r\n\t\t$('.ui-datepicker-today', $dp).click();\r\n\t};\r\n\r\n\t/*\r\n\t* Disable & enable the Time in the datetimepicker\r\n\t*/\r\n\t$.datepicker._disableTimepickerDatepicker = function (target) {\r\n\t\tvar inst = this._getInst(target);\r\n\t\tif (!inst) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\t$(target).datepicker('getDate'); // Init selected[Year|Month|Day]\r\n\t\tif (tp_inst) {\r\n\t\t\tinst.settings.showTimepicker = false;\r\n\t\t\ttp_inst._defaults.showTimepicker = false;\r\n\t\t\ttp_inst._updateDateTime(inst);\r\n\t\t}\r\n\t};\r\n\r\n\t$.datepicker._enableTimepickerDatepicker = function (target) {\r\n\t\tvar inst = this._getInst(target);\r\n\t\tif (!inst) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\t$(target).datepicker('getDate'); // Init selected[Year|Month|Day]\r\n\t\tif (tp_inst) {\r\n\t\t\tinst.settings.showTimepicker = true;\r\n\t\t\ttp_inst._defaults.showTimepicker = true;\r\n\t\t\ttp_inst._addTimePicker(inst); // Could be disabled on page load\r\n\t\t\ttp_inst._updateDateTime(inst);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t* Create our own set time function\r\n\t*/\r\n\t$.datepicker._setTime = function (inst, date) {\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\tif (tp_inst) {\r\n\t\t\tvar defaults = tp_inst._defaults;\r\n\r\n\t\t\t// calling _setTime with no date sets time to defaults\r\n\t\t\ttp_inst.hour = date ? date.getHours() : defaults.hour;\r\n\t\t\ttp_inst.minute = date ? date.getMinutes() : defaults.minute;\r\n\t\t\ttp_inst.second = date ? date.getSeconds() : defaults.second;\r\n\t\t\ttp_inst.millisec = date ? date.getMilliseconds() : defaults.millisec;\r\n\t\t\ttp_inst.microsec = date ? date.getMicroseconds() : defaults.microsec;\r\n\r\n\t\t\t//check if within min/max times.. \r\n\t\t\ttp_inst._limitMinMaxDateTime(inst, true);\r\n\r\n\t\t\ttp_inst._onTimeChange();\r\n\t\t\ttp_inst._updateDateTime(inst);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t* Create new public method to set only time, callable as $().datepicker('setTime', date)\r\n\t*/\r\n\t$.datepicker._setTimeDatepicker = function (target, date, withDate) {\r\n\t\tvar inst = this._getInst(target);\r\n\t\tif (!inst) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\r\n\t\tif (tp_inst) {\r\n\t\t\tthis._setDateFromField(inst);\r\n\t\t\tvar tp_date;\r\n\t\t\tif (date) {\r\n\t\t\t\tif (typeof date === \"string\") {\r\n\t\t\t\t\ttp_inst._parseTime(date, withDate);\r\n\t\t\t\t\ttp_date = new Date();\r\n\t\t\t\t\ttp_date.setHours(tp_inst.hour, tp_inst.minute, tp_inst.second, tp_inst.millisec);\r\n\t\t\t\t\ttp_date.setMicroseconds(tp_inst.microsec);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttp_date = new Date(date.getTime());\r\n\t\t\t\t\ttp_date.setMicroseconds(date.getMicroseconds());\r\n\t\t\t\t}\r\n\t\t\t\tif (tp_date.toString() === 'Invalid Date') {\r\n\t\t\t\t\ttp_date = undefined;\r\n\t\t\t\t}\r\n\t\t\t\tthis._setTime(inst, tp_date);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/*\r\n\t* override setDate() to allow setting time too within Date object\r\n\t*/\r\n\t$.datepicker._base_setDateDatepicker = $.datepicker._setDateDatepicker;\r\n\t$.datepicker._setDateDatepicker = function (target, date) {\r\n\t\tvar inst = this._getInst(target);\r\n\t\tif (!inst) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (typeof(date) === 'string') {\r\n\t\t\tdate = new Date(date);\r\n\t\t\tif (!date.getTime()) {\r\n\t\t\t\t$.timepicker.log(\"Error creating Date object from string.\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\tvar tp_date;\r\n\t\tif (date instanceof Date) {\r\n\t\t\ttp_date = new Date(date.getTime());\r\n\t\t\ttp_date.setMicroseconds(date.getMicroseconds());\r\n\t\t} else {\r\n\t\t\ttp_date = date;\r\n\t\t}\r\n\t\t\r\n\t\t// This is important if you are using the timezone option, javascript's Date \r\n\t\t// object will only return the timezone offset for the current locale, so we \r\n\t\t// adjust it accordingly.  If not using timezone option this won't matter..\r\n\t\t// If a timezone is different in tp, keep the timezone as is\r\n\t\tif (tp_inst && tp_date) {\r\n\t\t\t// look out for DST if tz wasn't specified\r\n\t\t\tif (!tp_inst.support.timezone && tp_inst._defaults.timezone === null) {\r\n\t\t\t\ttp_inst.timezone = tp_date.getTimezoneOffset() * -1;\r\n\t\t\t}\r\n\t\t\tdate = $.timepicker.timezoneAdjust(date, tp_inst.timezone);\r\n\t\t\ttp_date = $.timepicker.timezoneAdjust(tp_date, tp_inst.timezone);\r\n\t\t}\r\n\r\n\t\tthis._updateDatepicker(inst);\r\n\t\tthis._base_setDateDatepicker.apply(this, arguments);\r\n\t\tthis._setTimeDatepicker(target, tp_date, true);\r\n\t};\r\n\r\n\t/*\r\n\t* override getDate() to allow getting time too within Date object\r\n\t*/\r\n\t$.datepicker._base_getDateDatepicker = $.datepicker._getDateDatepicker;\r\n\t$.datepicker._getDateDatepicker = function (target, noDefault) {\r\n\t\tvar inst = this._getInst(target);\r\n\t\tif (!inst) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\r\n\t\tif (tp_inst) {\r\n\t\t\t// if it hasn't yet been defined, grab from field\r\n\t\t\tif (inst.lastVal === undefined) {\r\n\t\t\t\tthis._setDateFromField(inst, noDefault);\r\n\t\t\t}\r\n\r\n\t\t\tvar date = this._getDate(inst);\r\n\t\t\tif (date && tp_inst._parseTime($(target).val(), tp_inst.timeOnly)) {\r\n\t\t\t\tdate.setHours(tp_inst.hour, tp_inst.minute, tp_inst.second, tp_inst.millisec);\r\n\t\t\t\tdate.setMicroseconds(tp_inst.microsec);\r\n\r\n\t\t\t\t// This is important if you are using the timezone option, javascript's Date \r\n\t\t\t\t// object will only return the timezone offset for the current locale, so we \r\n\t\t\t\t// adjust it accordingly.  If not using timezone option this won't matter..\r\n\t\t\t\tif (tp_inst.timezone != null) {\r\n\t\t\t\t\t// look out for DST if tz wasn't specified\r\n\t\t\t\t\tif (!tp_inst.support.timezone && tp_inst._defaults.timezone === null) {\r\n\t\t\t\t\t\ttp_inst.timezone = date.getTimezoneOffset() * -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdate = $.timepicker.timezoneAdjust(date, tp_inst.timezone);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn date;\r\n\t\t}\r\n\t\treturn this._base_getDateDatepicker(target, noDefault);\r\n\t};\r\n\r\n\t/*\r\n\t* override parseDate() because UI 1.8.14 throws an error about \"Extra characters\"\r\n\t* An option in datapicker to ignore extra format characters would be nicer.\r\n\t*/\r\n\t$.datepicker._base_parseDate = $.datepicker.parseDate;\r\n\t$.datepicker.parseDate = function (format, value, settings) {\r\n\t\tvar date;\r\n\t\ttry {\r\n\t\t\tdate = this._base_parseDate(format, value, settings);\r\n\t\t} catch (err) {\r\n\t\t\t// Hack!  The error message ends with a colon, a space, and\r\n\t\t\t// the \"extra\" characters.  We rely on that instead of\r\n\t\t\t// attempting to perfectly reproduce the parsing algorithm.\r\n\t\t\tif (err.indexOf(\":\") >= 0) {\r\n\t\t\t\tdate = this._base_parseDate(format, value.substring(0, value.length - (err.length - err.indexOf(':') - 2)), settings);\r\n\t\t\t\t$.timepicker.log(\"Error parsing the date string: \" + err + \"\\ndate string = \" + value + \"\\ndate format = \" + format);\r\n\t\t\t} else {\r\n\t\t\t\tthrow err;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn date;\r\n\t};\r\n\r\n\t/*\r\n\t* override formatDate to set date with time to the input\r\n\t*/\r\n\t$.datepicker._base_formatDate = $.datepicker._formatDate;\r\n\t$.datepicker._formatDate = function (inst, day, month, year) {\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\tif (tp_inst) {\r\n\t\t\ttp_inst._updateDateTime(inst);\r\n\t\t\treturn tp_inst.$input.val();\r\n\t\t}\r\n\t\treturn this._base_formatDate(inst);\r\n\t};\r\n\r\n\t/*\r\n\t* override options setter to add time to maxDate(Time) and minDate(Time). MaxDate\r\n\t*/\r\n\t$.datepicker._base_optionDatepicker = $.datepicker._optionDatepicker;\r\n\t$.datepicker._optionDatepicker = function (target, name, value) {\r\n\t\tvar inst = this._getInst(target),\r\n\t\t\tname_clone;\r\n\t\tif (!inst) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tvar tp_inst = this._get(inst, 'timepicker');\r\n\t\tif (tp_inst) {\r\n\t\t\tvar min = null,\r\n\t\t\t\tmax = null,\r\n\t\t\t\tonselect = null,\r\n\t\t\t\toverrides = tp_inst._defaults.evnts,\r\n\t\t\t\tfns = {},\r\n\t\t\t\tprop;\r\n\t\t\tif (typeof name === 'string') { // if min/max was set with the string\r\n\t\t\t\tif (name === 'minDate' || name === 'minDateTime') {\r\n\t\t\t\t\tmin = value;\r\n\t\t\t\t} else if (name === 'maxDate' || name === 'maxDateTime') {\r\n\t\t\t\t\tmax = value;\r\n\t\t\t\t} else if (name === 'onSelect') {\r\n\t\t\t\t\tonselect = value;\r\n\t\t\t\t} else if (overrides.hasOwnProperty(name)) {\r\n\t\t\t\t\tif (typeof (value) === 'undefined') {\r\n\t\t\t\t\t\treturn overrides[name];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfns[name] = value;\r\n\t\t\t\t\tname_clone = {}; //empty results in exiting function after overrides updated\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof name === 'object') { //if min/max was set with the JSON\r\n\t\t\t\tif (name.minDate) {\r\n\t\t\t\t\tmin = name.minDate;\r\n\t\t\t\t} else if (name.minDateTime) {\r\n\t\t\t\t\tmin = name.minDateTime;\r\n\t\t\t\t} else if (name.maxDate) {\r\n\t\t\t\t\tmax = name.maxDate;\r\n\t\t\t\t} else if (name.maxDateTime) {\r\n\t\t\t\t\tmax = name.maxDateTime;\r\n\t\t\t\t}\r\n\t\t\t\tfor (prop in overrides) {\r\n\t\t\t\t\tif (overrides.hasOwnProperty(prop) && name[prop]) {\r\n\t\t\t\t\t\tfns[prop] = name[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (prop in fns) {\r\n\t\t\t\tif (fns.hasOwnProperty(prop)) {\r\n\t\t\t\t\toverrides[prop] = fns[prop];\r\n\t\t\t\t\tif (!name_clone) { name_clone = $.extend({}, name); }\r\n\t\t\t\t\tdelete name_clone[prop];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (name_clone && isEmptyObject(name_clone)) { return; }\r\n\t\t\tif (min) { //if min was set\r\n\t\t\t\tif (min === 0) {\r\n\t\t\t\t\tmin = new Date();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmin = new Date(min);\r\n\t\t\t\t}\r\n\t\t\t\ttp_inst._defaults.minDate = min;\r\n\t\t\t\ttp_inst._defaults.minDateTime = min;\r\n\t\t\t} else if (max) { //if max was set\r\n\t\t\t\tif (max === 0) {\r\n\t\t\t\t\tmax = new Date();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmax = new Date(max);\r\n\t\t\t\t}\r\n\t\t\t\ttp_inst._defaults.maxDate = max;\r\n\t\t\t\ttp_inst._defaults.maxDateTime = max;\r\n\t\t\t} else if (onselect) {\r\n\t\t\t\ttp_inst._defaults.onSelect = onselect;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (value === undefined) {\r\n\t\t\treturn this._base_optionDatepicker.call($.datepicker, target, name);\r\n\t\t}\r\n\t\treturn this._base_optionDatepicker.call($.datepicker, target, name_clone || name, value);\r\n\t};\r\n\t\r\n\t/*\r\n\t* jQuery isEmptyObject does not check hasOwnProperty - if someone has added to the object prototype,\r\n\t* it will return false for all objects\r\n\t*/\r\n\tvar isEmptyObject = function (obj) {\r\n\t\tvar prop;\r\n\t\tfor (prop in obj) {\r\n\t\t\tif (obj.hasOwnProperty(prop)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\r\n\t/*\r\n\t* jQuery extend now ignores nulls!\r\n\t*/\r\n\tvar extendRemove = function (target, props) {\r\n\t\t$.extend(target, props);\r\n\t\tfor (var name in props) {\r\n\t\t\tif (props[name] === null || props[name] === undefined) {\r\n\t\t\t\ttarget[name] = props[name];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn target;\r\n\t};\r\n\r\n\t/*\r\n\t* Determine by the time format which units are supported\r\n\t* Returns an object of booleans for each unit\r\n\t*/\r\n\tvar detectSupport = function (timeFormat) {\r\n\t\tvar tf = timeFormat.replace(/'.*?'/g, '').toLowerCase(), // removes literals\r\n\t\t\tisIn = function (f, t) { // does the format contain the token?\r\n\t\t\t\t\treturn f.indexOf(t) !== -1 ? true : false;\r\n\t\t\t\t};\r\n\t\treturn {\r\n\t\t\t\thour: isIn(tf, 'h'),\r\n\t\t\t\tminute: isIn(tf, 'm'),\r\n\t\t\t\tsecond: isIn(tf, 's'),\r\n\t\t\t\tmillisec: isIn(tf, 'l'),\r\n\t\t\t\tmicrosec: isIn(tf, 'c'),\r\n\t\t\t\ttimezone: isIn(tf, 'z'),\r\n\t\t\t\tampm: isIn(tf, 't') && isIn(timeFormat, 'h'),\r\n\t\t\t\tiso8601: isIn(timeFormat, 'Z')\r\n\t\t\t};\r\n\t};\r\n\r\n\t/*\r\n\t* Converts 24 hour format into 12 hour\r\n\t* Returns 12 hour without leading 0\r\n\t*/\r\n\tvar convert24to12 = function (hour) {\r\n\t\thour %= 12;\r\n\r\n\t\tif (hour === 0) {\r\n\t\t\thour = 12;\r\n\t\t}\r\n\r\n\t\treturn String(hour);\r\n\t};\r\n\r\n\tvar computeEffectiveSetting = function (settings, property) {\r\n\t\treturn settings && settings[property] ? settings[property] : $.timepicker._defaults[property];\r\n\t};\r\n\r\n\t/*\r\n\t* Splits datetime string into date and time substrings.\r\n\t* Throws exception when date can't be parsed\r\n\t* Returns {dateString: dateString, timeString: timeString}\r\n\t*/\r\n\tvar splitDateTime = function (dateTimeString, timeSettings) {\r\n\t\t// The idea is to get the number separator occurrences in datetime and the time format requested (since time has\r\n\t\t// fewer unknowns, mostly numbers and am/pm). We will use the time pattern to split.\r\n\t\tvar separator = computeEffectiveSetting(timeSettings, 'separator'),\r\n\t\t\tformat = computeEffectiveSetting(timeSettings, 'timeFormat'),\r\n\t\t\ttimeParts = format.split(separator), // how many occurrences of separator may be in our format?\r\n\t\t\ttimePartsLen = timeParts.length,\r\n\t\t\tallParts = dateTimeString.split(separator),\r\n\t\t\tallPartsLen = allParts.length;\r\n\r\n\t\tif (allPartsLen > 1) {\r\n\t\t\treturn {\r\n\t\t\t\tdateString: allParts.splice(0, allPartsLen - timePartsLen).join(separator),\r\n\t\t\t\ttimeString: allParts.splice(0, timePartsLen).join(separator)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tdateString: dateTimeString,\r\n\t\t\ttimeString: ''\r\n\t\t};\r\n\t};\r\n\r\n\t/*\r\n\t* Internal function to parse datetime interval\r\n\t* Returns: {date: Date, timeObj: Object}, where\r\n\t*   date - parsed date without time (type Date)\r\n\t*   timeObj = {hour: , minute: , second: , millisec: , microsec: } - parsed time. Optional\r\n\t*/\r\n\tvar parseDateTimeInternal = function (dateFormat, timeFormat, dateTimeString, dateSettings, timeSettings) {\r\n\t\tvar date,\r\n\t\t\tparts,\r\n\t\t\tparsedTime;\r\n\r\n\t\tparts = splitDateTime(dateTimeString, timeSettings);\r\n\t\tdate = $.datepicker._base_parseDate(dateFormat, parts.dateString, dateSettings);\r\n\r\n\t\tif (parts.timeString === '') {\r\n\t\t\treturn {\r\n\t\t\t\tdate: date\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tparsedTime = $.datepicker.parseTime(timeFormat, parts.timeString, timeSettings);\r\n\r\n\t\tif (!parsedTime) {\r\n\t\t\tthrow 'Wrong time format';\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tdate: date,\r\n\t\t\ttimeObj: parsedTime\r\n\t\t};\r\n\t};\r\n\r\n\t/*\r\n\t* Internal function to set timezone_select to the local timezone\r\n\t*/\r\n\tvar selectLocalTimezone = function (tp_inst, date) {\r\n\t\tif (tp_inst && tp_inst.timezone_select) {\r\n\t\t\tvar now = date || new Date();\r\n\t\t\ttp_inst.timezone_select.val(-now.getTimezoneOffset());\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t* Create a Singleton Instance\r\n\t*/\r\n\t$.timepicker = new Timepicker();\r\n\r\n\t/**\r\n\t * Get the timezone offset as string from a date object (eg '+0530' for UTC+5.5)\r\n\t * @param {number} tzMinutes if not a number, less than -720 (-1200), or greater than 840 (+1400) this value is returned\r\n\t * @param {boolean} iso8601 if true formats in accordance to iso8601 \"+12:45\"\r\n\t * @return {string}\r\n\t */\r\n\t$.timepicker.timezoneOffsetString = function (tzMinutes, iso8601) {\r\n\t\tif (isNaN(tzMinutes) || tzMinutes > 840 || tzMinutes < -720) {\r\n\t\t\treturn tzMinutes;\r\n\t\t}\r\n\r\n\t\tvar off = tzMinutes,\r\n\t\t\tminutes = off % 60,\r\n\t\t\thours = (off - minutes) / 60,\r\n\t\t\tiso = iso8601 ? ':' : '',\r\n\t\t\ttz = (off >= 0 ? '+' : '-') + ('0' + Math.abs(hours)).slice(-2) + iso + ('0' + Math.abs(minutes)).slice(-2);\r\n\t\t\r\n\t\tif (tz === '+00:00') {\r\n\t\t\treturn 'Z';\r\n\t\t}\r\n\t\treturn tz;\r\n\t};\r\n\r\n\t/**\r\n\t * Get the number in minutes that represents a timezone string\r\n\t * @param  {string} tzString formatted like \"+0500\", \"-1245\", \"Z\"\r\n\t * @return {number} the offset minutes or the original string if it doesn't match expectations\r\n\t */\r\n\t$.timepicker.timezoneOffsetNumber = function (tzString) {\r\n\t\tvar normalized = tzString.toString().replace(':', ''); // excuse any iso8601, end up with \"+1245\"\r\n\r\n\t\tif (normalized.toUpperCase() === 'Z') { // if iso8601 with Z, its 0 minute offset\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tif (!/^(\\-|\\+)\\d{4}$/.test(normalized)) { // possibly a user defined tz, so just give it back\r\n\t\t\treturn tzString;\r\n\t\t}\r\n\r\n\t\treturn ((normalized.substr(0, 1) === '-' ? -1 : 1) * // plus or minus\r\n\t\t\t\t\t((parseInt(normalized.substr(1, 2), 10) * 60) + // hours (converted to minutes)\r\n\t\t\t\t\tparseInt(normalized.substr(3, 2), 10))); // minutes\r\n\t};\r\n\r\n\t/**\r\n\t * No way to set timezone in js Date, so we must adjust the minutes to compensate. (think setDate, getDate)\r\n\t * @param  {Date} date\r\n\t * @param  {string} toTimezone formatted like \"+0500\", \"-1245\"\r\n\t * @return {Date}\r\n\t */\r\n\t$.timepicker.timezoneAdjust = function (date, toTimezone) {\r\n\t\tvar toTz = $.timepicker.timezoneOffsetNumber(toTimezone);\r\n\t\tif (!isNaN(toTz)) {\r\n\t\t\tdate.setMinutes(date.getMinutes() + -date.getTimezoneOffset() - toTz);\r\n\t\t}\r\n\t\treturn date;\r\n\t};\r\n\r\n\t/**\r\n\t * Calls `timepicker()` on the `startTime` and `endTime` elements, and configures them to\r\n\t * enforce date range limits.\r\n\t * n.b. The input value must be correctly formatted (reformatting is not supported)\r\n\t * @param  {Element} startTime\r\n\t * @param  {Element} endTime\r\n\t * @param  {Object} options Options for the timepicker() call\r\n\t * @return {jQuery}\r\n\t */\r\n\t$.timepicker.timeRange = function (startTime, endTime, options) {\r\n\t\treturn $.timepicker.handleRange('timepicker', startTime, endTime, options);\r\n\t};\r\n\r\n\t/**\r\n\t * Calls `datetimepicker` on the `startTime` and `endTime` elements, and configures them to\r\n\t * enforce date range limits.\r\n\t * @param  {Element} startTime\r\n\t * @param  {Element} endTime\r\n\t * @param  {Object} options Options for the `timepicker()` call. Also supports `reformat`,\r\n\t *   a boolean value that can be used to reformat the input values to the `dateFormat`.\r\n\t * @param  {string} method Can be used to specify the type of picker to be added\r\n\t * @return {jQuery}\r\n\t */\r\n\t$.timepicker.datetimeRange = function (startTime, endTime, options) {\r\n\t\t$.timepicker.handleRange('datetimepicker', startTime, endTime, options);\r\n\t};\r\n\r\n\t/**\r\n\t * Calls `datepicker` on the `startTime` and `endTime` elements, and configures them to\r\n\t * enforce date range limits.\r\n\t * @param  {Element} startTime\r\n\t * @param  {Element} endTime\r\n\t * @param  {Object} options Options for the `timepicker()` call. Also supports `reformat`,\r\n\t *   a boolean value that can be used to reformat the input values to the `dateFormat`.\r\n\t * @return {jQuery}\r\n\t */\r\n\t$.timepicker.dateRange = function (startTime, endTime, options) {\r\n\t\t$.timepicker.handleRange('datepicker', startTime, endTime, options);\r\n\t};\r\n\r\n\t/**\r\n\t * Calls `method` on the `startTime` and `endTime` elements, and configures them to\r\n\t * enforce date range limits.\r\n\t * @param  {string} method Can be used to specify the type of picker to be added\r\n\t * @param  {Element} startTime\r\n\t * @param  {Element} endTime\r\n\t * @param  {Object} options Options for the `timepicker()` call. Also supports `reformat`,\r\n\t *   a boolean value that can be used to reformat the input values to the `dateFormat`.\r\n\t * @return {jQuery}\r\n\t */\r\n\t$.timepicker.handleRange = function (method, startTime, endTime, options) {\r\n\t\toptions = $.extend({}, {\r\n\t\t\tminInterval: 0, // min allowed interval in milliseconds\r\n\t\t\tmaxInterval: 0, // max allowed interval in milliseconds\r\n\t\t\tstart: {},      // options for start picker\r\n\t\t\tend: {}         // options for end picker\r\n\t\t}, options);\r\n\r\n\t\tfunction checkDates(changed, other) {\r\n\t\t\tvar startdt = startTime[method]('getDate'),\r\n\t\t\t\tenddt = endTime[method]('getDate'),\r\n\t\t\t\tchangeddt = changed[method]('getDate');\r\n\r\n\t\t\tif (startdt !== null) {\r\n\t\t\t\tvar minDate = new Date(startdt.getTime()),\r\n\t\t\t\t\tmaxDate = new Date(startdt.getTime());\r\n\r\n\t\t\t\tminDate.setMilliseconds(minDate.getMilliseconds() + options.minInterval);\r\n\t\t\t\tmaxDate.setMilliseconds(maxDate.getMilliseconds() + options.maxInterval);\r\n\r\n\t\t\t\tif (options.minInterval > 0 && minDate > enddt) { // minInterval check\r\n\t\t\t\t\tendTime[method]('setDate', minDate);\r\n\t\t\t\t}\r\n\t\t\t\telse if (options.maxInterval > 0 && maxDate < enddt) { // max interval check\r\n\t\t\t\t\tendTime[method]('setDate', maxDate);\r\n\t\t\t\t}\r\n\t\t\t\telse if (startdt > enddt) {\r\n\t\t\t\t\tother[method]('setDate', changeddt);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction selected(changed, other, option) {\r\n\t\t\tif (!changed.val()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar date = changed[method].call(changed, 'getDate');\r\n\t\t\tif (date !== null && options.minInterval > 0) {\r\n\t\t\t\tif (option === 'minDate') {\r\n\t\t\t\t\tdate.setMilliseconds(date.getMilliseconds() + options.minInterval);\r\n\t\t\t\t}\r\n\t\t\t\tif (option === 'maxDate') {\r\n\t\t\t\t\tdate.setMilliseconds(date.getMilliseconds() - options.minInterval);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (date.getTime) {\r\n\t\t\t\tother[method].call(other, 'option', option, date);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$.fn[method].call(startTime, $.extend({\r\n\t\t\tonClose: function (dateText, inst) {\r\n\t\t\t\tcheckDates($(this), endTime);\r\n\t\t\t},\r\n\t\t\tonSelect: function (selectedDateTime) {\r\n\t\t\t\tselected($(this), endTime, 'minDate');\r\n\t\t\t}\r\n\t\t}, options, options.start));\r\n\t\t$.fn[method].call(endTime, $.extend({\r\n\t\t\tonClose: function (dateText, inst) {\r\n\t\t\t\tcheckDates($(this), startTime);\r\n\t\t\t},\r\n\t\t\tonSelect: function (selectedDateTime) {\r\n\t\t\t\tselected($(this), startTime, 'maxDate');\r\n\t\t\t}\r\n\t\t}, options, options.end));\r\n\r\n\t\tcheckDates(startTime, endTime);\r\n\t\tselected(startTime, endTime, 'minDate');\r\n\t\tselected(endTime, startTime, 'maxDate');\r\n\t\treturn $([startTime.get(0), endTime.get(0)]);\r\n\t};\r\n\r\n\t/**\r\n\t * Log error or data to the console during error or debugging\r\n\t * @param  {Object} err pass any type object to log to the console during error or debugging\r\n\t * @return {void}\r\n\t */\r\n\t$.timepicker.log = function (err) {\r\n\t\tif (window.console) {\r\n\t\t\twindow.console.log(err);\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t * Add util object to allow access to private methods for testability.\r\n\t */\r\n\t$.timepicker._util = {\r\n\t\t_extendRemove: extendRemove,\r\n\t\t_isEmptyObject: isEmptyObject,\r\n\t\t_convert24to12: convert24to12,\r\n\t\t_detectSupport: detectSupport,\r\n\t\t_selectLocalTimezone: selectLocalTimezone,\r\n\t\t_computeEffectiveSetting: computeEffectiveSetting,\r\n\t\t_splitDateTime: splitDateTime,\r\n\t\t_parseDateTimeInternal: parseDateTimeInternal\r\n\t};\r\n\r\n\t/*\r\n\t* Microsecond support\r\n\t*/\r\n\tif (!Date.prototype.getMicroseconds) {\r\n\t\tDate.prototype.microseconds = 0;\r\n\t\tDate.prototype.getMicroseconds = function () { return this.microseconds; };\r\n\t\tDate.prototype.setMicroseconds = function (m) {\r\n\t\t\tthis.setMilliseconds(this.getMilliseconds() + Math.floor(m / 1000));\r\n\t\t\tthis.microseconds = m % 1000;\r\n\t\t\treturn this;\r\n\t\t};\r\n\t}\r\n\r\n\t/*\r\n\t* Keep up with the version\r\n\t*/\r\n\t$.timepicker.version = \"1.4.3\";\r\n\r\n}));","jquery/jquery.hoverIntent.js":"/**\r\n * hoverIntent is similar to jQuery's built-in \"hover\" function except that\r\n * instead of firing the onMouseOver event immediately, hoverIntent checks\r\n * to see if the user's mouse has slowed down (beneath the sensitivity\r\n * threshold) before firing the onMouseOver event.\r\n *\r\n * hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+\r\n * <http://cherne.net/brian/resources/jquery.hoverIntent.html>\r\n *\r\n * hoverIntent is currently available for use in all personal or commercial\r\n * projects under both MIT and GPL licenses. This means that you can choose\r\n * the license that best suits your project, and use it accordingly.\r\n *\r\n * // basic usage (just like .hover) receives onMouseOver and onMouseOut functions\r\n * $(\"ul li\").hoverIntent( showNav , hideNav );\r\n *\r\n * // advanced usage receives configuration object only\r\n * $(\"ul li\").hoverIntent({\r\n*\tsensitivity: 7, // number = sensitivity threshold (must be 1 or higher)\r\n*\tinterval: 100,   // number = milliseconds of polling interval\r\n*\tover: showNav,  // function = onMouseOver callback (required)\r\n*\ttimeout: 0,   // number = milliseconds delay before onMouseOut function call\r\n*\tout: hideNav    // function = onMouseOut callback (required)\r\n* });\r\n *\r\n * @param  f  onMouseOver function || An object with configuration options\r\n * @param  g  onMouseOut function  || Nothing (use configuration options object)\r\n * @author    Brian Cherne brian(at)cherne(dot)net\r\n */\r\n(function ($) {\r\n    $.fn.hoverIntent = function (f, g) {\r\n        // default configuration options\r\n        var cfg = {\r\n            sensitivity:7,\r\n            interval:100,\r\n            timeout:0\r\n        };\r\n        // override configuration options with user supplied object\r\n        cfg = $.extend(cfg, g ? { over:f, out:g } : f);\r\n\r\n        // instantiate variables\r\n        // cX, cY = current X and Y position of mouse, updated by mousemove event\r\n        // pX, pY = previous X and Y position of mouse, set by mouseover and polling interval\r\n        var cX, cY, pX, pY;\r\n\r\n        // A private function for getting mouse position\r\n        var track = function (ev) {\r\n            cX = ev.pageX;\r\n            cY = ev.pageY;\r\n        };\r\n\r\n        // A private function for comparing current and previous mouse position\r\n        var compare = function (ev, ob) {\r\n            ob.hoverIntent_t = clearTimeout(ob.hoverIntent_t);\r\n            // compare mouse positions to see if they've crossed the threshold\r\n            if (( Math.abs(pX - cX) + Math.abs(pY - cY) ) < cfg.sensitivity) {\r\n                $(ob).unbind(\"mousemove\", track);\r\n                // set hoverIntent state to true (so mouseOut can be called)\r\n                ob.hoverIntent_s = 1;\r\n                return cfg.over.apply(ob, [ev]);\r\n            } else {\r\n                // set previous coordinates for next time\r\n                pX = cX;\r\n                pY = cY;\r\n                // use self-calling timeout, guarantees intervals are spaced out properly (avoids JavaScript timer bugs)\r\n                ob.hoverIntent_t = setTimeout(function () {\r\n                    compare(ev, ob);\r\n                }, cfg.interval);\r\n            }\r\n        };\r\n\r\n        // A private function for delaying the mouseOut function\r\n        var delay = function (ev, ob) {\r\n            ob.hoverIntent_t = clearTimeout(ob.hoverIntent_t);\r\n            ob.hoverIntent_s = 0;\r\n            return cfg.out.apply(ob, [ev]);\r\n        };\r\n\r\n        // A private function for handling mouse 'hovering'\r\n        var handleHover = function (e) {\r\n            // copy objects to be passed into t (required for event object to be passed in IE)\r\n            var ev = jQuery.extend({}, e);\r\n            var ob = this;\r\n\r\n            // cancel hoverIntent timer if it exists\r\n            if (ob.hoverIntent_t) {\r\n                ob.hoverIntent_t = clearTimeout(ob.hoverIntent_t);\r\n            }\r\n\r\n            // if e.type == \"mouseenter\"\r\n            if (e.type == \"mouseenter\") {\r\n                // set \"previous\" X and Y position based on initial entry point\r\n                pX = ev.pageX;\r\n                pY = ev.pageY;\r\n                // update \"current\" X and Y position based on mousemove\r\n                $(ob).bind(\"mousemove\", track);\r\n                // start polling interval (self-calling timeout) to compare mouse coordinates over time\r\n                if (ob.hoverIntent_s != 1) {\r\n                    ob.hoverIntent_t = setTimeout(function () {\r\n                        compare(ev, ob);\r\n                    }, cfg.interval);\r\n                }\r\n\r\n                // else e.type == \"mouseleave\"\r\n            } else {\r\n                // unbind expensive mousemove event\r\n                $(ob).unbind(\"mousemove\", track);\r\n                // if hoverIntent state is true, then call the mouseOut function after the specified delay\r\n                if (ob.hoverIntent_s == 1) {\r\n                    ob.hoverIntent_t = setTimeout(function () {\r\n                        delay(ev, ob);\r\n                    }, cfg.timeout);\r\n                }\r\n            }\r\n        };\r\n\r\n        // bind the function to the two event listeners\r\n        return this.bind('mouseenter', handleHover).bind('mouseleave', handleHover);\r\n    };\r\n})(jQuery);","jquery/jquery.metadata.js":"/*\r\n * Metadata - jQuery plugin for parsing metadata from elements\r\n *\r\n * Copyright (c) 2006 John Resig, Yehuda Katz, J\u00c3\u00af\u00c2\u00bf\u00c2\u00bd\u00c3\u0083\u00c2\u00b6rn Zaefferer, Paul McLanahan\r\n *\r\n * Dual licensed under the MIT and GPL licenses:\r\n *   http://www.opensource.org/licenses/mit-license.php\r\n *   http://www.gnu.org/licenses/gpl.html\r\n *\r\n * Revision: $Id: jquery.metadata.js 3640 2007-10-11 18:34:38Z pmclanahan $\r\n *\r\n */\r\n\r\n/**\r\n * Sets the type of metadata to use. Metadata is encoded in JSON, and each property\r\n * in the JSON will become a property of the element itself.\r\n *\r\n * There are four supported types of metadata storage:\r\n *\r\n *   attr:  Inside an attribute. The name parameter indicates *which* attribute.\r\n *\r\n *   class: Inside the class attribute, wrapped in curly braces: { }\r\n *\r\n *   elem:  Inside a child element (e.g. a script tag). The\r\n *          name parameter indicates *which* element.\r\n *   html5: Values are stored in data-* attributes.\r\n *\r\n * The metadata for an element is loaded the first time the element is accessed via jQuery.\r\n *\r\n * As a result, you can define the metadata type, use $(expr) to load the metadata into the elements\r\n * matched by expr, then redefine the metadata type and run another $(expr) for other elements.\r\n *\r\n * @name $.metadata.setType\r\n *\r\n * @example <p id=\"one\" class=\"some_class {item_id: 1, item_label: 'Label'}\">This is a p</p>\r\n * @before $.metadata.setType(\"class\")\r\n * @after $(\"#one\").metadata().item_id == 1; $(\"#one\").metadata().item_label == \"Label\"\r\n * @desc Reads metadata from the class attribute\r\n *\r\n * @example <p id=\"one\" class=\"some_class\" data=\"{item_id: 1, item_label: 'Label'}\">This is a p</p>\r\n * @before $.metadata.setType(\"attr\", \"data\")\r\n * @after $(\"#one\").metadata().item_id == 1; $(\"#one\").metadata().item_label == \"Label\"\r\n * @desc Reads metadata from a \"data\" attribute\r\n *\r\n * @example <p id=\"one\" class=\"some_class\"><script>{item_id: 1, item_label: 'Label'}</script>This is a p</p>\r\n * @before $.metadata.setType(\"elem\", \"script\")\r\n * @after $(\"#one\").metadata().item_id == 1; $(\"#one\").metadata().item_label == \"Label\"\r\n * @desc Reads metadata from a nested script element\r\n *\r\n * @example <p id=\"one\" class=\"some_class\" data-item_id=\"1\" data-item_label=\"Label\">This is a p</p>\r\n * @before $.metadata.setType(\"html5\")\r\n * @after $(\"#one\").metadata().item_id == 1; $(\"#one\").metadata().item_label == \"Label\"\r\n * @desc Reads metadata from a series of data-* attributes\r\n *\r\n * @param String type The encoding type\r\n * @param String name The name of the attribute to be used to get metadata (optional)\r\n * @cat Plugins/Metadata\r\n * @descr Sets the type of encoding to be used when loading metadata for the first time\r\n * @type undefined\r\n * @see metadata()\r\n */\r\n(function (factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define([\"jquery\"], factory);\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n}(function ($) {\r\n\r\n\r\n    $.extend({\r\n        metadata : {\r\n            defaults : {\r\n                type: 'class',\r\n                name: 'metadata',\r\n                cre: /({.*})/,\r\n                single: 'metadata',\r\n                meta:'validate'\r\n            },\r\n            setType: function( type, name ){\r\n                this.defaults.type = type;\r\n                this.defaults.name = name;\r\n            },\r\n            get: function( elem, opts ){\r\n                var settings = $.extend({},this.defaults,opts);\r\n                // check for empty string in single property\r\n                if (!settings.single.length) {\r\n                    settings.single = 'metadata';\r\n                }\r\n                if (!settings.meta.length) {\r\n                    settings.meta = 'validate';\r\n                }\r\n\r\n                var data = $.data(elem, settings.single);\r\n                // returned cached data if it already exists\r\n                if ( data ) return data;\r\n\r\n                data = \"{}\";\r\n\r\n                var getData = function(data) {\r\n                    if(typeof data != \"string\") return data;\r\n\r\n                    if( data.indexOf('{') < 0 ) {\r\n                        data = eval(\"(\" + data + \")\");\r\n                    }\r\n                }\r\n\r\n                var getObject = function(data) {\r\n                    if(typeof data != \"string\") return data;\r\n\r\n                    data = eval(\"(\" + data + \")\");\r\n                    return data;\r\n                }\r\n\r\n                if ( settings.type == \"html5\" ) {\r\n                    var object = {};\r\n                    $( elem.attributes ).each(function() {\r\n                        var name = this.nodeName;\r\n                        if (name.indexOf('data-' + settings.meta) === 0) {\r\n                            name = name.replace(/^data-/, '');\r\n                        }\r\n                        else {\r\n                            return true;\r\n                        }\r\n                        object[name] = getObject(this.value);\r\n                    });\r\n                } else {\r\n                    if ( settings.type == \"class\" ) {\r\n                        var m = settings.cre.exec( elem.className );\r\n                        if ( m )\r\n                            data = m[1];\r\n                    } else if ( settings.type == \"elem\" ) {\r\n                        if( !elem.getElementsByTagName ) return;\r\n                        var e = elem.getElementsByTagName(settings.name);\r\n                        if ( e.length )\r\n                            data = $.trim(e[0].innerHTML);\r\n                    } else if ( elem.getAttribute != undefined ) {\r\n                        var attr = elem.getAttribute( settings.name );\r\n                        if ( attr )\r\n                            data = attr;\r\n                    }\r\n                    object = getObject(data.indexOf(\"{\") < 0 ? \"{\" + data + \"}\" : data);\r\n                }\r\n\r\n                $.data( elem, settings.single, object );\r\n                return object;\r\n            }\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Returns the metadata object for the first member of the jQuery object.\r\n     *\r\n     * @name metadata\r\n     * @descr Returns element's metadata object\r\n     * @param Object opts An object contianing settings to override the defaults\r\n     * @type jQuery\r\n     * @cat Plugins/Metadata\r\n     */\r\n    $.fn.metadata = function( opts ){\r\n        return $.metadata.get( this[0], opts );\r\n    };\r\n\r\n}));","jquery/jquery.storageapi.min.js":"/* jQuery Storage API Plugin 1.7.3 https://github.com/julien-maurel/jQuery-Storage-API */\r\n!function(e){\"function\"==typeof define&&define.amd?define([\"jquery\"],e):e(\"object\"==typeof exports?require(\"jquery\"):jQuery)}(function(e){function t(t){var r,i,n,o=arguments.length,s=window[t],a=arguments,u=a[1];if(2>o)throw Error(\"Minimum 2 arguments must be given\");if(e.isArray(u)){i={};for(var f in u){r=u[f];try{i[r]=JSON.parse(s.getItem(r))}catch(c){i[r]=s.getItem(r)}}return i}if(2!=o){try{i=JSON.parse(s.getItem(u))}catch(c){throw new ReferenceError(u+\" is not defined in this storage\")}for(var f=2;o-1>f;f++)if(i=i[a[f]],void 0===i)throw new ReferenceError([].slice.call(a,1,f+1).join(\".\")+\" is not defined in this storage\");if(e.isArray(a[f])){n=i,i={};for(var m in a[f])i[a[f][m]]=n[a[f][m]];return i}return i[a[f]]}try{return JSON.parse(s.getItem(u))}catch(c){return s.getItem(u)}}function r(t){var r,i,n=arguments.length,o=window[t],s=arguments,a=s[1],u=s[2],f={};if(2>n||!e.isPlainObject(a)&&3>n)throw Error(\"Minimum 3 arguments must be given or second parameter must be an object\");if(e.isPlainObject(a)){for(var c in a)r=a[c],e.isPlainObject(r)?o.setItem(c,JSON.stringify(r)):o.setItem(c,r);return a}if(3==n)return\"object\"==typeof u?o.setItem(a,JSON.stringify(u)):o.setItem(a,u),u;try{i=o.getItem(a),null!=i&&(f=JSON.parse(i))}catch(m){}i=f;for(var c=2;n-2>c;c++)r=s[c],i[r]&&e.isPlainObject(i[r])||(i[r]={}),i=i[r];return i[s[c]]=s[c+1],o.setItem(a,JSON.stringify(f)),f}function i(t){var r,i,n=arguments.length,o=window[t],s=arguments,a=s[1];if(2>n)throw Error(\"Minimum 2 arguments must be given\");if(e.isArray(a)){for(var u in a)o.removeItem(a[u]);return!0}if(2==n)return o.removeItem(a),!0;try{r=i=JSON.parse(o.getItem(a))}catch(f){throw new ReferenceError(a+\" is not defined in this storage\")}for(var u=2;n-1>u;u++)if(i=i[s[u]],void 0===i)throw new ReferenceError([].slice.call(s,1,u).join(\".\")+\" is not defined in this storage\");if(e.isArray(s[u]))for(var c in s[u])delete i[s[u][c]];else delete i[s[u]];return o.setItem(a,JSON.stringify(r)),!0}function n(t,r){var n=a(t);for(var o in n)i(t,n[o]);if(r)for(var o in e.namespaceStorages)u(o)}function o(r){var i=arguments.length,n=arguments,s=(window[r],n[1]);if(1==i)return 0==a(r).length;if(e.isArray(s)){for(var u=0;u<s.length;u++)if(!o(r,s[u]))return!1;return!0}try{var f=t.apply(this,arguments);e.isArray(n[i-1])||(f={totest:f});for(var u in f)if(!(e.isPlainObject(f[u])&&e.isEmptyObject(f[u])||e.isArray(f[u])&&!f[u].length)&&f[u])return!1;return!0}catch(c){return!0}}function s(r){var i=arguments.length,n=arguments,o=(window[r],n[1]);if(2>i)throw Error(\"Minimum 2 arguments must be given\");if(e.isArray(o)){for(var a=0;a<o.length;a++)if(!s(r,o[a]))return!1;return!0}try{var u=t.apply(this,arguments);e.isArray(n[i-1])||(u={totest:u});for(var a in u)if(void 0===u[a]||null===u[a])return!1;return!0}catch(f){return!1}}function a(r){var i=arguments.length,n=window[r],o=arguments,s=(o[1],[]),a={};if(a=i>1?t.apply(this,o):n,a._cookie)for(var u in e.cookie())\"\"!=u&&s.push(u.replace(a._prefix,\"\"));else for(var f in a)s.push(f);return s}function u(t){if(!t||\"string\"!=typeof t)throw Error(\"First parameter must be a string\");g?(window.localStorage.getItem(t)||window.localStorage.setItem(t,\"{}\"),window.sessionStorage.getItem(t)||window.sessionStorage.setItem(t,\"{}\")):(window.localCookieStorage.getItem(t)||window.localCookieStorage.setItem(t,\"{}\"),window.sessionCookieStorage.getItem(t)||window.sessionCookieStorage.setItem(t,\"{}\"));var r={localStorage:e.extend({},e.localStorage,{_ns:t}),sessionStorage:e.extend({},e.sessionStorage,{_ns:t})};return e.cookie&&(window.cookieStorage.getItem(t)||window.cookieStorage.setItem(t,\"{}\"),r.cookieStorage=e.extend({},e.cookieStorage,{_ns:t})),e.namespaceStorages[t]=r,r}function f(e){if(!window[e])return!1;var t=\"jsapi\";try{return window[e].setItem(t,t),window[e].removeItem(t),!0}catch(r){return!1}}var c=\"ls_\",m=\"ss_\",g=f(\"localStorage\"),h={_type:\"\",_ns:\"\",_callMethod:function(e,t){var r=[this._type],t=Array.prototype.slice.call(t),i=t[0];return this._ns&&r.push(this._ns),\"string\"==typeof i&&-1!==i.indexOf(\".\")&&(t.shift(),[].unshift.apply(t,i.split(\".\"))),[].push.apply(r,t),e.apply(this,r)},get:function(){return this._callMethod(t,arguments)},set:function(){var t=arguments.length,i=arguments,n=i[0];if(1>t||!e.isPlainObject(n)&&2>t)throw Error(\"Minimum 2 arguments must be given or first parameter must be an object\");if(e.isPlainObject(n)&&this._ns){for(var o in n)r(this._type,this._ns,o,n[o]);return n}var s=this._callMethod(r,i);return this._ns?s[n.split(\".\")[0]]:s},remove:function(){if(arguments.length<1)throw Error(\"Minimum 1 argument must be given\");return this._callMethod(i,arguments)},removeAll:function(e){return this._ns?(r(this._type,this._ns,{}),!0):n(this._type,e)},isEmpty:function(){return this._callMethod(o,arguments)},isSet:function(){if(arguments.length<1)throw Error(\"Minimum 1 argument must be given\");return this._callMethod(s,arguments)},keys:function(){return this._callMethod(a,arguments)}};if(e.cookie){window.name||(window.name=Math.floor(1e8*Math.random()));var l={_cookie:!0,_prefix:\"\",_expires:null,_path:null,_domain:null,setItem:function(t,r){e.cookie(this._prefix+t,r,{expires:this._expires,path:this._path,domain:this._domain})},getItem:function(t){return e.cookie(this._prefix+t)},removeItem:function(t){return e.removeCookie(this._prefix+t)},clear:function(){for(var t in e.cookie())\"\"!=t&&(!this._prefix&&-1===t.indexOf(c)&&-1===t.indexOf(m)||this._prefix&&0===t.indexOf(this._prefix))&&e.removeCookie(t)},setExpires:function(e){return this._expires=e,this},setPath:function(e){return this._path=e,this},setDomain:function(e){return this._domain=e,this},setConf:function(e){return e.path&&(this._path=e.path),e.domain&&(this._domain=e.domain),e.expires&&(this._expires=e.expires),this},setDefaultConf:function(){this._path=this._domain=this._expires=null}};g||(window.localCookieStorage=e.extend({},l,{_prefix:c,_expires:3650}),window.sessionCookieStorage=e.extend({},l,{_prefix:m+window.name+\"_\"})),window.cookieStorage=e.extend({},l),e.cookieStorage=e.extend({},h,{_type:\"cookieStorage\",setExpires:function(e){return window.cookieStorage.setExpires(e),this},setPath:function(e){return window.cookieStorage.setPath(e),this},setDomain:function(e){return window.cookieStorage.setDomain(e),this},setConf:function(e){return window.cookieStorage.setConf(e),this},setDefaultConf:function(){return window.cookieStorage.setDefaultConf(),this}})}e.initNamespaceStorage=function(e){return u(e)},g?(e.localStorage=e.extend({},h,{_type:\"localStorage\"}),e.sessionStorage=e.extend({},h,{_type:\"sessionStorage\"})):(e.localStorage=e.extend({},h,{_type:\"localCookieStorage\"}),e.sessionStorage=e.extend({},h,{_type:\"sessionCookieStorage\"})),e.namespaceStorages={},e.removeAllStorages=function(t){e.localStorage.removeAll(t),e.sessionStorage.removeAll(t),e.cookieStorage&&e.cookieStorage.removeAll(t),t||(e.namespaceStorages={})}});","jquery/jquery.tabs.js":"/* ========================================================\r\n * bootstrap-tab.js v2.0.4\r\n * http://twitter.github.com/bootstrap/javascript.html#tabs\r\n * ========================================================\r\n * Copyright 2012 Twitter, Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * ======================================================== */\r\n\r\ndefine([\r\n  \"jquery\"\r\n], function(jQuery){\r\n\r\n\r\n!function ($) {\r\n\r\n  \"use strict\"; // jshint ;_;\r\n\r\n\r\n /* TAB CLASS DEFINITION\r\n  * ==================== */\r\n\r\n  var Tab = function ( element ) {\r\n    this.element = $(element)\r\n  };\r\n\r\n  Tab.prototype = {\r\n\r\n    constructor: Tab\r\n\r\n  , show: function () {\r\n      var $this = this.element\r\n        , $ul = $this.closest('ul:not(.dropdown-menu)')\r\n        , selector = $this.attr('data-target')\r\n        , previous\r\n        , $target\r\n        , e;\r\n\r\n      if (!selector) {\r\n        selector = $this.attr('href');\r\n        selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, ''); //strip for ie7\r\n      }\r\n\r\n      if ( $this.parent('li').hasClass('active') ) return;\r\n\r\n      previous = $ul.find('.active a').last()[0];\r\n\r\n      e = $.Event('show', {\r\n        relatedTarget: previous\r\n      });\r\n\r\n      $this.trigger(e);\r\n\r\n      if (e.isDefaultPrevented()) return;\r\n\r\n      $target = $(selector);\r\n\r\n      this.activate($this.parent('li'), $ul);\r\n      this.activate($target, $target.parent(), function () {\r\n        $this.trigger({\r\n          type: 'shown'\r\n        , relatedTarget: previous\r\n        })\r\n      })\r\n    }\r\n\r\n  , activate: function ( element, container, callback) {\r\n      var $active = container.find('> .active')\r\n        , transition = callback\r\n            && $.support.transition\r\n            && $active.hasClass('fade');\r\n\r\n      function next() {\r\n        $active\r\n          .removeClass('active')\r\n          .find('> .dropdown-menu > .active')\r\n          .removeClass('active');\r\n\r\n        element.addClass('active');\r\n\r\n        if (transition) {\r\n          element[0].offsetWidth; // reflow for transition\r\n          element.addClass('in');\r\n        } else {\r\n          element.removeClass('fade')\r\n        }\r\n\r\n        if ( element.parent('.dropdown-menu') ) {\r\n          element.closest('li.dropdown').addClass('active')\r\n        }\r\n\r\n        callback && callback()\r\n      }\r\n\r\n      transition ?\r\n        $active.one($.support.transition.end, next) :\r\n        next();\r\n\r\n      $active.removeClass('in')\r\n    }\r\n  };\r\n\r\n\r\n /* TAB PLUGIN DEFINITION\r\n  * ===================== */\r\n\r\n  $.fn.tab = function ( option ) {\r\n    return this.each(function () {\r\n      var $this = $(this)\r\n        , data = $this.data('tab');\r\n      if (!data) $this.data('tab', (data = new Tab(this)));\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  };\r\n\r\n  $.fn.tab.Constructor = Tab;\r\n\r\n\r\n /* TAB DATA-API\r\n  * ============ */\r\n\r\n  $(function () {\r\n    $('body').on('click.tab.data-api', '[data-toggle=\"tab\"], [data-toggle=\"pill\"]', function (e) {\r\n      e.preventDefault();\r\n      $(this).tab('show')\r\n    })\r\n  })\r\n\r\n}(jQuery);\r\n\r\n/* =============================================================\r\n * bootstrap-collapse.js v2.0.4\r\n * http://twitter.github.com/bootstrap/javascript.html#collapse\r\n * =============================================================\r\n * Copyright 2012 Twitter, Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * ============================================================ */\r\n\r\n\r\n!function ($) {\r\n\r\n  \"use strict\"; // jshint ;_;\r\n\r\n\r\n /* COLLAPSE PUBLIC CLASS DEFINITION\r\n  * ================================ */\r\n\r\n  var Collapse = function (element, options) {\r\n    this.$element = $(element);\r\n    this.options = $.extend({}, $.fn.collapse.defaults, options);\r\n\r\n    if (this.options.parent) {\r\n      this.$parent = $(this.options.parent)\r\n    }\r\n\r\n    this.options.toggle && this.toggle()\r\n  };\r\n\r\n  Collapse.prototype = {\r\n\r\n    constructor: Collapse\r\n\r\n  , dimension: function () {\r\n      var hasWidth = this.$element.hasClass('width');\r\n      return hasWidth ? 'width' : 'height'\r\n    }\r\n\r\n  , show: function () {\r\n      var dimension\r\n        , scroll\r\n        , actives\r\n        , hasData;\r\n\r\n      if (this.transitioning) return;\r\n\r\n      dimension = this.dimension();\r\n      scroll = $.camelCase(['scroll', dimension].join('-'));\r\n      actives = this.$parent && this.$parent.find('> .accordion-group > .in');\r\n\r\n      if (actives && actives.length) {\r\n        hasData = actives.data('collapse');\r\n        if (hasData && hasData.transitioning) return;\r\n        actives.collapse('hide');\r\n        hasData || actives.data('collapse', null)\r\n      }\r\n\r\n      this.$element[dimension](0);\r\n      this.transition('addClass', $.Event('show'), 'shown');\r\n      this.$element[dimension](this.$element[0][scroll]);\r\n    }\r\n\r\n  , hide: function () {\r\n      var dimension;\r\n      if (this.transitioning) return;\r\n      dimension = this.dimension();\r\n      this.reset(this.$element[dimension]());\r\n      this.transition('removeClass', $.Event('hide'), 'hidden');\r\n      this.$element[dimension](0)\r\n    }\r\n\r\n  , reset: function (size) {\r\n      var dimension = this.dimension();\r\n\r\n      this.$element\r\n        .removeClass('collapse')\r\n        [dimension](size || 'auto')\r\n        [0].offsetWidth;\r\n\r\n      this.$element[size !== null ? 'addClass' : 'removeClass']('collapse');\r\n\r\n      return this\r\n    }\r\n\r\n  , transition: function (method, startEvent, completeEvent) {\r\n      var that = this\r\n        , complete = function () {\r\n            if (startEvent.type == 'show') that.reset();\r\n            that.transitioning = 0;\r\n            that.$element.trigger(completeEvent)\r\n          };\r\n\r\n      this.$element.trigger(startEvent);\r\n\r\n      if (startEvent.isDefaultPrevented()) return;\r\n\r\n      this.transitioning = 1;\r\n\r\n      this.$element[method]('in');\r\n\r\n      $.support.transition && this.$element.hasClass('collapse') ?\r\n        this.$element.one($.support.transition.end, complete) :\r\n        complete()\r\n    }\r\n\r\n  , toggle: function () {\r\n      this[this.$element.hasClass('in') ? 'hide' : 'show']();\r\n    }\r\n\r\n  };\r\n\r\n\r\n /* COLLAPSIBLE PLUGIN DEFINITION\r\n  * ============================== */\r\n\r\n  $.fn.collapse = function (option) {\r\n    return this.each(function () {\r\n      var $this = $(this)\r\n        , data = $this.data('collapse')\r\n        , options = typeof option == 'object' && option;\r\n      if (!data) $this.data('collapse', (data = new Collapse(this, options)));\r\n      if (typeof option == 'string') data[option]()\r\n    })\r\n  };\r\n\r\n  $.fn.collapse.defaults = {\r\n    toggle: true\r\n  };\r\n\r\n  $.fn.collapse.Constructor = Collapse;\r\n\r\n\r\n /* COLLAPSIBLE DATA-API\r\n  * ==================== */\r\n\r\n  $(function () {\r\n    $('body').on('click.collapse.data-api', '[data-toggle=collapse]', function ( e ) {\r\n      var $this = $(this), href\r\n        , target = $this.attr('data-target')\r\n          || e.preventDefault()\r\n          || (href = $this.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '') //strip for ie7\r\n        , option = $(target).data('collapse') ? 'toggle' : $this.data();\r\n      $(target).collapse(option);\r\n        $(this).toggleClass('active');\r\n    })\r\n  })\r\n\r\n}(jQuery);\r\n\r\n});","jquery/jquery.validate.js":"/**\r\n * jQuery Validation Plugin @VERSION\r\n *\r\n * http://bassistance.de/jquery-plugins/jquery-plugin-validation/\r\n * http://docs.jquery.com/Plugins/Validation\r\n *\r\n * Copyright (c) 2012 J\u00c3\u00b6rn Zaefferer\r\n *\r\n * Dual licensed under the MIT and GPL licenses:\r\n *   http://www.opensource.org/licenses/mit-license.php\r\n *   http://www.gnu.org/licenses/gpl.html\r\n */\r\n(function (factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define([\r\n            \"jquery\",\r\n            \"jquery/jquery.metadata\"\r\n        ], factory);\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n}(function (jQuery) {\r\n\r\n(function ($) {\r\n\r\n    $.extend($.fn, {\r\n        // http://docs.jquery.com/Plugins/Validation/validate\r\n        validate: function (options) {\r\n\r\n            // if nothing is selected, return nothing; can't chain anyway\r\n            if (!this.length) {\r\n                if (options && options.debug && window.console) {\r\n                    console.warn(\"nothing selected, can't validate, returning nothing\");\r\n                }\r\n                return;\r\n            }\r\n\r\n            // check if a validator for this form was already created\r\n            var validator = $.data(this[0], 'validator');\r\n            if (validator) {\r\n                return validator;\r\n            }\r\n\r\n            // Add novalidate tag if HTML5.\r\n            this.attr('novalidate', 'novalidate');\r\n\r\n            validator = new $.validator(options, this[0]);\r\n            $.data(this[0], 'validator', validator);\r\n\r\n            if (validator.settings.onsubmit) {\r\n\r\n                this.validateDelegate(\":submit\", \"click\", function (ev) {\r\n                    if (validator.settings.submitHandler) {\r\n                        validator.submitButton = ev.target;\r\n                    }\r\n                    // allow suppressing validation by adding a cancel class to the submit button\r\n                    if ($(ev.target).hasClass('cancel')) {\r\n                        validator.cancelSubmit = true;\r\n                    }\r\n                });\r\n\r\n                // validate the form on submit\r\n                this.submit(function (event) {\r\n                    if (validator.settings.debug) {\r\n                        // prevent form submit to be able to see console output\r\n                        event.preventDefault();\r\n                    }\r\n                    function handle() {\r\n                        var hidden;\r\n                        if (validator.settings.submitHandler) {\r\n                            if (validator.submitButton) {\r\n                                // insert a hidden input as a replacement for the missing submit button\r\n                                hidden = $(\"<input type='hidden'/>\").attr(\"name\", validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);\r\n                            }\r\n                            validator.settings.submitHandler.call(validator, validator.currentForm, event);\r\n                            if (validator.submitButton) {\r\n                                // and clean up afterwards; thanks to no-block-scope, hidden can be referenced\r\n                                hidden.remove();\r\n                            }\r\n                            return false;\r\n                        }\r\n                        return true;\r\n                    }\r\n\r\n                    // prevent submit for invalid forms or custom submit handlers\r\n                    if (validator.cancelSubmit) {\r\n                        validator.cancelSubmit = false;\r\n                        return handle();\r\n                    }\r\n                    if (validator.form()) {\r\n                        if (validator.pendingRequest) {\r\n                            validator.formSubmitted = true;\r\n                            return false;\r\n                        }\r\n                        return handle();\r\n                    } else {\r\n                        validator.focusInvalid();\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            return validator;\r\n        },\r\n        // http://docs.jquery.com/Plugins/Validation/valid\r\n        valid: function () {\r\n            if ($(this[0]).is('form')) {\r\n                return this.validate().form();\r\n            } else {\r\n                var valid = true;\r\n                var validator = $(this[0].form).validate();\r\n                this.each(function () {\r\n                    valid &= validator.element(this);\r\n                });\r\n                return valid;\r\n            }\r\n        },\r\n        // attributes: space seperated list of attributes to retrieve and remove\r\n        removeAttrs: function (attributes) {\r\n            var result = {},\r\n                $element = this;\r\n            $.each(attributes.split(/\\s/), function (index, value) {\r\n                result[value] = $element.attr(value);\r\n                $element.removeAttr(value);\r\n            });\r\n            return result;\r\n        },\r\n        // http://docs.jquery.com/Plugins/Validation/rules\r\n        rules: function (command, argument) {\r\n            var element = this[0];\r\n\r\n            if (command) {\r\n                var settings = $.data(element.form, 'validator').settings;\r\n                var staticRules = settings.rules;\r\n                var existingRules = $.validator.staticRules(element);\r\n                switch (command) {\r\n                    case \"add\":\r\n                        $.extend(existingRules, $.validator.normalizeRule(argument));\r\n                        staticRules[element.name] = existingRules;\r\n                        if (argument.messages) {\r\n                            settings.messages[element.name] = $.extend(settings.messages[element.name], argument.messages);\r\n                        }\r\n                        break;\r\n                    case \"remove\":\r\n                        if (!argument) {\r\n                            delete staticRules[element.name];\r\n                            return existingRules;\r\n                        }\r\n                        var filtered = {};\r\n                        $.each(argument.split(/\\s/), function (index, method) {\r\n                            filtered[method] = existingRules[method];\r\n                            delete existingRules[method];\r\n                        });\r\n                        return filtered;\r\n                }\r\n            }\r\n\r\n            var data = $.validator.normalizeRules(\r\n                $.extend(\r\n                    {},\r\n                    $.validator.metadataRules(element),\r\n                    $.validator.classRules(element),\r\n                    $.validator.attributeRules(element),\r\n                    $.validator.staticRules(element)\r\n                ), element);\r\n\r\n            // make sure required is at front\r\n            if (data.required) {\r\n                var param = data.required;\r\n                delete data.required;\r\n                data = $.extend({required: param}, data);\r\n            }\r\n\r\n            return data;\r\n        }\r\n    });\r\n\r\n// Custom selectors\r\n    $.extend($.expr[\":\"], {\r\n        // http://docs.jquery.com/Plugins/Validation/blank\r\n        blank: function (a) {\r\n            return !$.trim(\"\" + a.value);\r\n        },\r\n        // http://docs.jquery.com/Plugins/Validation/filled\r\n        filled: function (a) {\r\n            return !!$.trim(\"\" + a.value);\r\n        },\r\n        // http://docs.jquery.com/Plugins/Validation/unchecked\r\n        unchecked: function (a) {\r\n            return !a.checked;\r\n        }\r\n    });\r\n\r\n// constructor for validator\r\n    $.validator = function (options, form) {\r\n        this.settings = $.extend(true, {}, $.validator.defaults, options);\r\n        this.currentForm = form;\r\n        this.init();\r\n    };\r\n\r\n    $.validator.format = function (source, params) {\r\n        if (arguments.length === 1) {\r\n            return function () {\r\n                var args = $.makeArray(arguments);\r\n                args.unshift(source);\r\n                return $.validator.format.apply(this, args);\r\n            };\r\n        }\r\n        if (arguments.length > 2 && params.constructor !== Array) {\r\n            params = $.makeArray(arguments).slice(1);\r\n        }\r\n        if (params.constructor !== Array) {\r\n            params = [ params ];\r\n        }\r\n        $.each(params, function (i, n) {\r\n            source = source.replace(new RegExp(\"\\\\{\" + i + \"\\\\}\", \"g\"), n);\r\n        });\r\n        return source;\r\n    };\r\n\r\n    $.extend($.validator, {\r\n\r\n        defaults: {\r\n            messages: {},\r\n            groups: {},\r\n            rules: {},\r\n            errorClass: \"error\",\r\n            validClass: \"valid\",\r\n            errorElement: \"label\",\r\n            focusInvalid: true,\r\n            errorContainer: $([]),\r\n            errorLabelContainer: $([]),\r\n            onsubmit: true,\r\n            ignore: \":hidden\",\r\n            ignoreTitle: false,\r\n            onfocusin: function (element, event) {\r\n                this.lastActive = element;\r\n\r\n                // hide error label and remove error class on focus if enabled\r\n                if (this.settings.focusCleanup && !this.blockFocusCleanup) {\r\n                    if (this.settings.unhighlight) {\r\n                        this.settings.unhighlight.call(this, element, this.settings.errorClass, this.settings.validClass);\r\n                    }\r\n                    this.addWrapper(this.errorsFor(element)).hide();\r\n                }\r\n            },\r\n            onfocusout: function (element, event) {\r\n                if (!this.checkable(element) && (element.name in this.submitted || !this.optional(element))) {\r\n                    this.element(element);\r\n                }\r\n            },\r\n            onkeyup: function (element, event) {\r\n                if (event.which == 9 && this.elementValue(element) === '') {\r\n                    return;\r\n                } else if (element.name in this.submitted || element === this.lastActive) {\r\n                    this.element(element);\r\n                }\r\n            },\r\n            onclick: function (element, event) {\r\n                // click on selects, radiobuttons and checkboxes\r\n                if (element.name in this.submitted) {\r\n                    this.element(element);\r\n                }\r\n                // or option elements, check parent select in that case\r\n                else if (element.parentNode.name in this.submitted) {\r\n                    this.element(element.parentNode);\r\n                }\r\n            },\r\n            highlight: function (element, errorClass, validClass) {\r\n                if (element.type === 'radio') {\r\n                    this.findByName(element.name).addClass(errorClass).removeClass(validClass);\r\n                } else {\r\n                    $(element).addClass(errorClass).removeClass(validClass);\r\n                }\r\n            },\r\n            unhighlight: function (element, errorClass, validClass) {\r\n                if (element.type === 'radio') {\r\n                    this.findByName(element.name).removeClass(errorClass).addClass(validClass);\r\n                } else {\r\n                    $(element).removeClass(errorClass).addClass(validClass);\r\n                }\r\n            }\r\n        },\r\n\r\n        // http://docs.jquery.com/Plugins/Validation/Validator/setDefaults\r\n        setDefaults: function (settings) {\r\n            $.extend($.validator.defaults, settings);\r\n        },\r\n\r\n        messages: {\r\n            required: \"This field is required.\",\r\n            remote: \"Please fix this field.\",\r\n            email: \"Please enter a valid email address.\",\r\n            url: \"Please enter a valid URL.\",\r\n            date: \"Please enter a valid date.\",\r\n            dateISO: \"Please enter a valid date (ISO).\",\r\n            number: \"Please enter a valid number.\",\r\n            digits: \"Please enter only digits.\",\r\n            creditcard: \"Please enter a valid credit card number.\",\r\n            equalTo: \"Please enter the same value again.\",\r\n            maxlength: $.validator.format(\"Please enter no more than {0} characters.\"),\r\n            minlength: $.validator.format(\"Please enter at least {0} characters.\"),\r\n            rangelength: $.validator.format(\"Please enter a value between {0} and {1} characters long.\"),\r\n            range: $.validator.format(\"Please enter a value between {0} and {1}.\"),\r\n            max: $.validator.format(\"Please enter a value less than or equal to {0}.\"),\r\n            min: $.validator.format(\"Please enter a value greater than or equal to {0}.\")\r\n        },\r\n\r\n        autoCreateRanges: false,\r\n\r\n        prototype: {\r\n\r\n            init: function () {\r\n                this.labelContainer = $(this.settings.errorLabelContainer);\r\n                this.errorContext = this.labelContainer.length && this.labelContainer || $(this.currentForm);\r\n                this.containers = $(this.settings.errorContainer).add(this.settings.errorLabelContainer);\r\n                this.submitted = {};\r\n                this.valueCache = {};\r\n                this.pendingRequest = 0;\r\n                this.pending = {};\r\n                this.invalid = {};\r\n                this.reset();\r\n\r\n                var groups = (this.groups = {});\r\n                $.each(this.settings.groups, function (key, value) {\r\n                    $.each(value.split(/\\s/), function (index, name) {\r\n                        groups[name] = key;\r\n                    });\r\n                });\r\n                var rules = this.settings.rules;\r\n                $.each(rules, function (key, value) {\r\n                    rules[key] = $.validator.normalizeRule(value);\r\n                });\r\n\r\n                function delegate(event) {\r\n                    var validator = $.data(this[0].form, \"validator\"),\r\n                        eventType = \"on\" + event.type.replace(/^validate/, \"\");\r\n                    if (validator.settings[eventType]) {\r\n                        validator.settings[eventType].call(validator, this[0], event);\r\n                    }\r\n                }\r\n\r\n                $(this.currentForm)\r\n                    .validateDelegate(\":text, [type='password'], [type='file'], select, textarea, \" +\r\n                    \"[type='number'], [type='search'], input.search, [type='tel'], [type='url'], \" +\r\n                    \"[type='email'], [type='datetime'], [type='date'], [type='month'], \" +\r\n                    \"[type='week'], [type='time'], [type='datetime-local'], \" +\r\n                    \"[type='range'], [type='color'] \",\r\n                    \"focusin focusout keyup\", delegate)\r\n                    .validateDelegate(\"[type='radio'], [type='checkbox'], select, option\", \"click\", delegate);\r\n\r\n                if (this.settings.invalidHandler) {\r\n                    $(this.currentForm).bind(\"invalid-form.validate\", this.settings.invalidHandler);\r\n                }\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Validator/form\r\n            form: function () {\r\n                this.checkForm();\r\n                $.extend(this.submitted, this.errorMap);\r\n                this.invalid = $.extend({}, this.errorMap);\r\n                if (!this.valid()) {\r\n                    $(this.currentForm).triggerHandler(\"invalid-form\", [this]);\r\n                }\r\n                this.showErrors();\r\n                return this.valid();\r\n            },\r\n\r\n            checkForm: function () {\r\n                this.prepareForm();\r\n                for (var i = 0, elements = (this.currentElements = this.elements()); elements[i]; i++) {\r\n                    this.check(elements[i]);\r\n                }\r\n                return this.valid();\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Validator/element\r\n            element: function (element) {\r\n                element = this.validationTargetFor(this.clean(element));\r\n                this.lastElement = element;\r\n                this.prepareElement(element);\r\n                this.currentElements = $(element);\r\n                var result = this.check(element) !== false;\r\n                if (result) {\r\n                    delete this.invalid[element.name];\r\n                } else {\r\n                    this.invalid[element.name] = true;\r\n                }\r\n                if (!this.numberOfInvalids()) {\r\n                    // Hide error containers on last error\r\n                    this.toHide = this.toHide.add(this.containers);\r\n                }\r\n                this.showErrors();\r\n                return result;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Validator/showErrors\r\n            showErrors: function (errors) {\r\n                if (errors) {\r\n                    // add items to error list and map\r\n                    $.extend(this.errorMap, errors);\r\n                    this.errorList = [];\r\n                    for (var name in errors) {\r\n                        this.errorList.push({\r\n                            message: errors[name],\r\n                            element: this.findByName(name)[0]\r\n                        });\r\n                    }\r\n                    // remove items from success list\r\n                    this.successList = $.grep(this.successList, function (element) {\r\n                        return !(element.name in errors);\r\n                    });\r\n                }\r\n                if (this.settings.showErrors) {\r\n                    this.settings.showErrors.call(this, this.errorMap, this.errorList);\r\n                } else {\r\n                    this.defaultShowErrors();\r\n                }\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Validator/resetForm\r\n            resetForm: function () {\r\n                if ($.fn.resetForm) {\r\n                    $(this.currentForm).resetForm();\r\n                }\r\n                this.submitted = {};\r\n                this.lastElement = null;\r\n                this.prepareForm();\r\n                this.hideErrors();\r\n                this.elements().removeClass(this.settings.errorClass).removeData(\"previousValue\");\r\n            },\r\n\r\n            numberOfInvalids: function () {\r\n                return this.objectLength(this.invalid);\r\n            },\r\n\r\n            objectLength: function (obj) {\r\n                var count = 0;\r\n                for (var i in obj) {\r\n                    count++;\r\n                }\r\n                return count;\r\n            },\r\n\r\n            hideErrors: function () {\r\n                this.addWrapper(this.toHide).hide();\r\n            },\r\n\r\n            valid: function () {\r\n                return this.size() === 0;\r\n            },\r\n\r\n            size: function () {\r\n                return this.errorList.length;\r\n            },\r\n\r\n            focusInvalid: function () {\r\n                if (this.settings.focusInvalid) {\r\n                    try {\r\n                        $(this.findLastActive() || this.errorList.length && this.errorList[0].element || [])\r\n                            .filter(\":visible\")\r\n                            .focus()\r\n                            // manually trigger focusin event; without it, focusin handler isn't called, findLastActive won't have anything to find\r\n                            .trigger(\"focusin\");\r\n                    } catch (e) {\r\n                        // ignore IE throwing errors when focusing hidden elements\r\n                    }\r\n                }\r\n            },\r\n\r\n            findLastActive: function () {\r\n                var lastActive = this.lastActive;\r\n                return lastActive && $.grep(this.errorList,function (n) {\r\n                    return n.element.name === lastActive.name;\r\n                }).length === 1 && lastActive;\r\n            },\r\n\r\n            elements: function () {\r\n                var validator = this,\r\n                    rulesCache = {};\r\n\r\n                // select all valid inputs inside the form (no submit or reset buttons)\r\n                return $(this.currentForm)\r\n                    .find(\"input, select, textarea\")\r\n                    .not(\":submit, :reset, :image, [disabled]\")\r\n                    .not(this.settings.ignore)\r\n                    .filter(function () {\r\n                        if (!this.name && validator.settings.debug && window.console) {\r\n                            console.error(\"%o has no name assigned\", this);\r\n                        }\r\n\r\n                        // select only the first element for each name, and only those with rules specified\r\n                        if (this.name in rulesCache || !validator.objectLength($(this).rules())) {\r\n                            return false;\r\n                        }\r\n\r\n                        rulesCache[this.name] = true;\r\n                        return true;\r\n                    });\r\n            },\r\n\r\n            clean: function (selector) {\r\n                return $(selector)[0];\r\n            },\r\n\r\n            errors: function () {\r\n                var errorClass = this.settings.errorClass.replace(' ', '.');\r\n                return $(this.settings.errorElement + \".\" + errorClass, this.errorContext);\r\n            },\r\n\r\n            reset: function () {\r\n                this.successList = [];\r\n                this.errorList = [];\r\n                this.errorMap = {};\r\n                this.toShow = $([]);\r\n                this.toHide = $([]);\r\n                this.currentElements = $([]);\r\n            },\r\n\r\n            prepareForm: function () {\r\n                this.reset();\r\n                this.toHide = this.errors().add(this.containers);\r\n            },\r\n\r\n            prepareElement: function (element) {\r\n                this.reset();\r\n                this.toHide = this.errorsFor(element);\r\n            },\r\n\r\n            elementValue: function (element) {\r\n                var type = $(element).attr('type'),\r\n                    val = $(element).val();\r\n\r\n                if (type === 'radio' || type === 'checkbox') {\r\n                    return $('input[name=\"' + $(element).attr('name') + '\"]:checked').val();\r\n                }\r\n\r\n                if (typeof val === 'string') {\r\n                    return val.replace(/\\r/g, \"\");\r\n                }\r\n                return val;\r\n            },\r\n\r\n            check: function (element) {\r\n                element = this.validationTargetFor(this.clean(element));\r\n\r\n                var rules = $(element).rules();\r\n                var dependencyMismatch = false;\r\n                var val = this.elementValue(element);\r\n                var result;\r\n\r\n                for (var method in rules) {\r\n                    var rule = { method: method, parameters: rules[method] };\r\n                    try {\r\n\r\n                        result = $.validator.methods[method].call(this, val, element, rule.parameters);\r\n\r\n                        // if a method indicates that the field is optional and therefore valid,\r\n                        // don't mark it as valid when there are no other rules\r\n                        if (result === \"dependency-mismatch\") {\r\n                            dependencyMismatch = true;\r\n                            continue;\r\n                        }\r\n                        dependencyMismatch = false;\r\n\r\n                        if (result === \"pending\") {\r\n                            this.toHide = this.toHide.not(this.errorsFor(element));\r\n                            return;\r\n                        }\r\n\r\n                        if (!result) {\r\n                            this.formatAndAdd(element, rule);\r\n                            return false;\r\n                        }\r\n                    } catch (e) {\r\n                        if (this.settings.debug && window.console) {\r\n                            console.log(\"exception occurred when checking element \" + element.id + \", check the '\" + rule.method + \"' method\", e);\r\n                        }\r\n                        throw e;\r\n                    }\r\n                }\r\n                if (dependencyMismatch) {\r\n                    return;\r\n                }\r\n                if (this.objectLength(rules)) {\r\n                    this.successList.push(element);\r\n                }\r\n                return true;\r\n            },\r\n\r\n            // return the custom message for the given element and validation method\r\n            // specified in the element's \"messages\" metadata\r\n            customMetaMessage: function (element, method) {\r\n                if (!$.metadata) {\r\n                    return;\r\n                }\r\n                var meta = this.settings.meta ? $(element).metadata()[this.settings.meta] : $(element).metadata();\r\n                return meta && meta.messages && meta.messages[method];\r\n            },\r\n\r\n            // return the custom message for the given element and validation method\r\n            // specified in the element's HTML5 data attribute\r\n            customDataMessage: function (element, method) {\r\n                return $(element).data('msg-' + method.toLowerCase()) || (element.attributes && $(element).attr('data-msg-' + method.toLowerCase()));\r\n            },\r\n\r\n            // return the custom message for the given element name and validation method\r\n            customMessage: function (name, method) {\r\n                var m = this.settings.messages[name];\r\n                return m && (m.constructor === String ? m : m[method]);\r\n            },\r\n\r\n            // return the first defined argument, allowing empty strings\r\n            findDefined: function () {\r\n                for (var i = 0; i < arguments.length; i++) {\r\n                    if (arguments[i] !== undefined) {\r\n                        return arguments[i];\r\n                    }\r\n                }\r\n                return undefined;\r\n            },\r\n\r\n            defaultMessage: function (element, method) {\r\n                var noMessage = $.mage.__(\"Warning: No message defined for %s\");\r\n                return this.findDefined(\r\n                    this.customMessage(element.name, method),\r\n                    this.customDataMessage(element, method),\r\n                    this.customMetaMessage(element, method),\r\n                    // title is never undefined, so handle empty string as undefined\r\n                    !this.settings.ignoreTitle && element.title || undefined,\r\n                    $.validator.messages[method],\r\n                    \"<strong>\" + noMessage.replace('%s', element.name) + \"</strong>\"\r\n                );\r\n            },\r\n\r\n            formatAndAdd: function (element, rule) {\r\n                var message = this.defaultMessage(element, rule.method),\r\n                    theregex = /\\$?\\{(\\d+)\\}/g;\r\n                if (typeof message === \"function\") {\r\n                    message = message.call(this, rule.parameters, element);\r\n                } else if (theregex.test(message)) {\r\n                    message = $.validator.format(message.replace(theregex, '{$1}'), rule.parameters);\r\n                }\r\n                this.errorList.push({\r\n                    message: message,\r\n                    element: element\r\n                });\r\n\r\n                this.errorMap[element.name] = message;\r\n                this.submitted[element.name] = message;\r\n            },\r\n\r\n            addWrapper: function (toToggle) {\r\n                if (this.settings.wrapper) {\r\n                    toToggle = toToggle.add(toToggle.parent(this.settings.wrapper));\r\n                }\r\n                return toToggle;\r\n            },\r\n\r\n            defaultShowErrors: function () {\r\n                var i, elements;\r\n                for (i = 0; this.errorList[i]; i++) {\r\n                    var error = this.errorList[i];\r\n                    if (this.settings.highlight) {\r\n                        this.settings.highlight.call(this, error.element, this.settings.errorClass, this.settings.validClass);\r\n                    }\r\n                    this.showLabel(error.element, error.message);\r\n                }\r\n                if (this.errorList.length) {\r\n                    this.toShow = this.toShow.add(this.containers);\r\n                }\r\n                if (this.settings.success) {\r\n                    for (i = 0; this.successList[i]; i++) {\r\n                        this.showLabel(this.successList[i]);\r\n                    }\r\n                }\r\n                if (this.settings.unhighlight) {\r\n                    for (i = 0, elements = this.validElements(); elements[i]; i++) {\r\n                        this.settings.unhighlight.call(this, elements[i], this.settings.errorClass, this.settings.validClass);\r\n                    }\r\n                }\r\n                this.toHide = this.toHide.not(this.toShow);\r\n                this.hideErrors();\r\n                this.addWrapper(this.toShow).show();\r\n            },\r\n\r\n            validElements: function () {\r\n                return this.currentElements.not(this.invalidElements());\r\n            },\r\n\r\n            invalidElements: function () {\r\n                return $(this.errorList).map(function () {\r\n                    return this.element;\r\n                });\r\n            },\r\n\r\n            showLabel: function (element, message) {\r\n                var label = this.errorsFor(element);\r\n                if (label.length) {\r\n                    // refresh error/success class\r\n                    label.removeClass(this.settings.validClass).addClass(this.settings.errorClass);\r\n\r\n                    // check if we have a generated label, replace the message then\r\n                    if (label.attr(\"generated\")) {\r\n                        label.hide().html(message);\r\n                    }\r\n                } else {\r\n                    // create label\r\n                    label = $(\"<\" + this.settings.errorElement + \"/>\")\r\n                        .attr({\"for\": this.idOrName(element), generated: true})\r\n                        .addClass(this.settings.errorClass)\r\n                        .html(message || \"\");\r\n                    if (this.settings.wrapper) {\r\n                        // make sure the element is visible, even in IE\r\n                        // actually showing the wrapped element is handled elsewhere\r\n                        label = label.hide().show().wrap(\"<\" + this.settings.wrapper + \"/>\").parent();\r\n                    }\r\n                    if (!this.labelContainer.append(label).length) {\r\n                        if (this.settings.errorPlacement) {\r\n                            this.settings.errorPlacement(label, $(element));\r\n                        } else {\r\n                            label.insertAfter(element);\r\n                        }\r\n                    }\r\n                }\r\n                if (!message && this.settings.success) {\r\n                    label.text(\"\");\r\n                    if (typeof this.settings.success === \"string\") {\r\n                        label.addClass(this.settings.success);\r\n                    } else {\r\n                        this.settings.success(label, element);\r\n                    }\r\n                }\r\n                this.toShow = this.toShow.add(label);\r\n            },\r\n\r\n            errorsFor: function (element) {\r\n                var name = this.idOrName(element);\r\n                return this.errors().filter(function () {\r\n                    return $(this).attr('for') === name;\r\n                });\r\n            },\r\n\r\n            idOrName: function (element) {\r\n                return this.groups[element.name] || (this.checkable(element) ? element.name : element.id || element.name);\r\n            },\r\n\r\n            validationTargetFor: function (element) {\r\n                // if radio/checkbox, validate first element in group instead\r\n                if (this.checkable(element)) {\r\n                    element = this.findByName(element.name).not(this.settings.ignore)[0];\r\n                }\r\n                return element;\r\n            },\r\n\r\n            checkable: function (element) {\r\n                return (/radio|checkbox/i).test(element.type);\r\n            },\r\n\r\n            findByName: function (name) {\r\n                return $(this.currentForm).find('[name=\"' + name + '\"]');\r\n            },\r\n\r\n            getLength: function (value, element) {\r\n                switch (element.nodeName.toLowerCase()) {\r\n                    case 'select':\r\n                        return $(\"option:selected\", element).length;\r\n                    case 'input':\r\n                        if (this.checkable(element)) {\r\n                            return this.findByName(element.name).filter(':checked').length;\r\n                        }\r\n                }\r\n                return value.length;\r\n            },\r\n\r\n            depend: function (param, element) {\r\n                return this.dependTypes[typeof param] ? this.dependTypes[typeof param](param, element) : true;\r\n            },\r\n\r\n            dependTypes: {\r\n                \"boolean\": function (param, element) {\r\n                    return param;\r\n                },\r\n                \"string\": function (param, element) {\r\n                    return !!$(param, element.form).length;\r\n                },\r\n                \"function\": function (param, element) {\r\n                    return param(element);\r\n                }\r\n            },\r\n\r\n            optional: function (element) {\r\n                var val = this.elementValue(element);\r\n                return !$.validator.methods.required.call(this, val, element) && \"dependency-mismatch\";\r\n            },\r\n\r\n            startRequest: function (element) {\r\n                if (!this.pending[element.name]) {\r\n                    this.pendingRequest++;\r\n                    this.pending[element.name] = true;\r\n                }\r\n            },\r\n\r\n            stopRequest: function (element, valid) {\r\n                this.pendingRequest--;\r\n                // sometimes synchronization fails, make sure pendingRequest is never < 0\r\n                if (this.pendingRequest < 0) {\r\n                    this.pendingRequest = 0;\r\n                }\r\n                delete this.pending[element.name];\r\n                if (valid && this.pendingRequest === 0 && this.formSubmitted && this.form()) {\r\n                    $(this.currentForm).submit();\r\n                    this.formSubmitted = false;\r\n                } else if (!valid && this.pendingRequest === 0 && this.formSubmitted) {\r\n                    $(this.currentForm).triggerHandler(\"invalid-form\", [this]);\r\n                    this.formSubmitted = false;\r\n                }\r\n            },\r\n\r\n            previousValue: function (element) {\r\n                return $.data(element, \"previousValue\") || $.data(element, \"previousValue\", {\r\n                    old: null,\r\n                    valid: true,\r\n                    message: this.defaultMessage(element, \"remote\")\r\n                });\r\n            }\r\n\r\n        },\r\n\r\n        classRuleSettings: {\r\n            required: {required: true},\r\n            email: {email: true},\r\n            url: {url: true},\r\n            date: {date: true},\r\n            dateISO: {dateISO: true},\r\n            number: {number: true},\r\n            digits: {digits: true},\r\n            creditcard: {creditcard: true}\r\n        },\r\n\r\n        addClassRules: function (className, rules) {\r\n            if (className.constructor === String) {\r\n                this.classRuleSettings[className] = rules;\r\n            } else {\r\n                $.extend(this.classRuleSettings, className);\r\n            }\r\n        },\r\n\r\n        classRules: function (element) {\r\n            var rules = {};\r\n            var classes = $(element).attr('class');\r\n            if (classes) {\r\n                $.each(classes.split(' '), function () {\r\n                    if (this in $.validator.classRuleSettings) {\r\n                        $.extend(rules, $.validator.classRuleSettings[this]);\r\n                    }\r\n                });\r\n            }\r\n            return rules;\r\n        },\r\n\r\n        attributeRules: function (element) {\r\n            var rules = {};\r\n            var $element = $(element);\r\n\r\n            for (var method in $.validator.methods) {\r\n                var value;\r\n\r\n                // support for <input required> in both html5 and older browsers\r\n                if (method === 'required') {\r\n                    value = $element.get(0).getAttribute(method);\r\n                    // Some browsers return an empty string for the required attribute\r\n                    // and non-HTML5 browsers might have required=\"\" markup\r\n                    if (value === \"\") {\r\n                        value = true;\r\n                    }\r\n                    // force non-HTML5 browsers to return bool\r\n                    value = !!value;\r\n                } else {\r\n                    value = $element.attr(method);\r\n                }\r\n\r\n                if (value) {\r\n                    rules[method] = value;\r\n                } else if ($element[0].getAttribute(\"type\") === method) {\r\n                    rules[method] = true;\r\n                }\r\n            }\r\n\r\n            // maxlength may be returned as -1, 2147483647 (IE) and 524288 (safari) for text inputs\r\n            if (rules.maxlength && /-1|2147483647|524288/.test(rules.maxlength)) {\r\n                delete rules.maxlength;\r\n            }\r\n\r\n            return rules;\r\n        },\r\n\r\n        metadataRules: function (element) {\r\n            if (!$.metadata) {\r\n                return {};\r\n            }\r\n\r\n            var meta = $.data(element.form, 'validator').settings.meta;\r\n            return meta ?\r\n                $(element).metadata()[meta] :\r\n                $(element).metadata();\r\n        },\r\n\r\n        staticRules: function (element) {\r\n            var rules = {};\r\n            var validator = $.data(element.form, 'validator');\r\n            if (validator.settings.rules) {\r\n                rules = $.validator.normalizeRule(validator.settings.rules[element.name]) || {};\r\n            }\r\n            return rules;\r\n        },\r\n\r\n        normalizeRules: function (rules, element) {\r\n            // handle dependency check\r\n            $.each(rules, function (prop, val) {\r\n                // ignore rule when param is explicitly false, eg. required:false\r\n                if (val === false) {\r\n                    delete rules[prop];\r\n                    return;\r\n                }\r\n                if (val.param || val.depends) {\r\n                    var keepRule = true;\r\n                    switch (typeof val.depends) {\r\n                        case \"string\":\r\n                            keepRule = !!$(val.depends, element.form).length;\r\n                            break;\r\n                        case \"function\":\r\n                            keepRule = val.depends.call(element, element);\r\n                            break;\r\n                    }\r\n                    if (keepRule) {\r\n                        rules[prop] = val.param !== undefined ? val.param : true;\r\n                    } else {\r\n                        delete rules[prop];\r\n                    }\r\n                }\r\n            });\r\n\r\n            // evaluate parameters\r\n            $.each(rules, function (rule, parameter) {\r\n                rules[rule] = $.isFunction(parameter) ? parameter(element) : parameter;\r\n            });\r\n\r\n            // clean number parameters\r\n            $.each(['minlength', 'maxlength', 'min', 'max'], function () {\r\n                if (rules[this]) {\r\n                    rules[this] = Number(rules[this]);\r\n                }\r\n            });\r\n            $.each(['rangelength', 'range'], function () {\r\n                if (rules[this]) {\r\n                    rules[this] = [Number(rules[this][0]), Number(rules[this][1])];\r\n                }\r\n            });\r\n\r\n            if ($.validator.autoCreateRanges) {\r\n                // auto-create ranges\r\n                if (rules.min && rules.max) {\r\n                    rules.range = [rules.min, rules.max];\r\n                    delete rules.min;\r\n                    delete rules.max;\r\n                }\r\n                if (rules.minlength && rules.maxlength) {\r\n                    rules.rangelength = [rules.minlength, rules.maxlength];\r\n                    delete rules.minlength;\r\n                    delete rules.maxlength;\r\n                }\r\n            }\r\n\r\n            // To support custom messages in metadata ignore rule methods titled \"messages\"\r\n            if (rules.messages) {\r\n                delete rules.messages;\r\n            }\r\n\r\n            return rules;\r\n        },\r\n\r\n        // Converts a simple string to a {string: true} rule, e.g., \"required\" to {required:true}\r\n        normalizeRule: function (data) {\r\n            if (typeof data === \"string\") {\r\n                var transformed = {};\r\n                $.each(data.split(/\\s/), function () {\r\n                    transformed[this] = true;\r\n                });\r\n                data = transformed;\r\n            }\r\n            return data;\r\n        },\r\n\r\n        // http://docs.jquery.com/Plugins/Validation/Validator/addMethod\r\n        addMethod: function (name, method, message) {\r\n            $.validator.methods[name] = method;\r\n            $.validator.messages[name] = message !== undefined ? message : $.validator.messages[name];\r\n            if (method.length < 3) {\r\n                $.validator.addClassRules(name, $.validator.normalizeRule(name));\r\n            }\r\n        },\r\n\r\n        methods: {\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/required\r\n            required: function (value, element, param) {\r\n                // check if dependency is met\r\n                if (!this.depend(param, element)) {\r\n                    return \"dependency-mismatch\";\r\n                }\r\n                if (element.nodeName.toLowerCase() === \"select\") {\r\n                    // could be an array for select-multiple or a string, both are fine this way\r\n                    var val = $(element).val();\r\n                    return val && val.length > 0;\r\n                }\r\n                if (this.checkable(element)) {\r\n                    return this.getLength(value, element) > 0;\r\n                }\r\n                return $.trim(value).length > 0;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/remote\r\n            remote: function (value, element, param) {\r\n                if (this.optional(element)) {\r\n                    return \"dependency-mismatch\";\r\n                }\r\n\r\n                var previous = this.previousValue(element);\r\n                if (!this.settings.messages[element.name]) {\r\n                    this.settings.messages[element.name] = {};\r\n                }\r\n                previous.originalMessage = this.settings.messages[element.name].remote;\r\n                this.settings.messages[element.name].remote = previous.message;\r\n\r\n                param = typeof param === \"string\" && {url: param} || param;\r\n\r\n                if (this.pending[element.name]) {\r\n                    return \"pending\";\r\n                }\r\n                if (previous.old === value) {\r\n                    return previous.valid;\r\n                }\r\n\r\n                previous.old = value;\r\n                var validator = this;\r\n                this.startRequest(element);\r\n                var data = {};\r\n                data[element.name] = value;\r\n                $.ajax($.extend(true, {\r\n                    url: param,\r\n                    mode: \"abort\",\r\n                    port: \"validate\" + element.name,\r\n                    dataType: \"json\",\r\n                    data: data,\r\n                    success: function (response) {\r\n                        validator.settings.messages[element.name].remote = previous.originalMessage;\r\n                        var valid = response === true || response === \"true\";\r\n                        if (valid) {\r\n                            var submitted = validator.formSubmitted;\r\n                            validator.prepareElement(element);\r\n                            validator.formSubmitted = submitted;\r\n                            validator.successList.push(element);\r\n                            delete validator.invalid[element.name];\r\n                            validator.showErrors();\r\n                        } else {\r\n                            var errors = {};\r\n                            var message = response || validator.defaultMessage(element, \"remote\");\r\n                            errors[element.name] = previous.message = $.isFunction(message) ? message(value) : message;\r\n                            validator.invalid[element.name] = true;\r\n                            validator.showErrors(errors);\r\n                        }\r\n                        previous.valid = valid;\r\n                        validator.stopRequest(element, valid);\r\n                    }\r\n                }, param));\r\n                return \"pending\";\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/minlength\r\n            minlength: function (value, element, param) {\r\n                var length = $.isArray(value) ? value.length : this.getLength($.trim(value), element);\r\n                return this.optional(element) || length >= param;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/maxlength\r\n            maxlength: function (value, element, param) {\r\n                var length = $.isArray(value) ? value.length : this.getLength($.trim(value), element);\r\n                return this.optional(element) || length <= param;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/rangelength\r\n            rangelength: function (value, element, param) {\r\n                var length = $.isArray(value) ? value.length : this.getLength($.trim(value), element);\r\n                return this.optional(element) || ( length >= param[0] && length <= param[1] );\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/min\r\n            min: function (value, element, param) {\r\n                return this.optional(element) || value >= param;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/max\r\n            max: function (value, element, param) {\r\n                return this.optional(element) || value <= param;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/range\r\n            range: function (value, element, param) {\r\n                return this.optional(element) || ( value >= param[0] && value <= param[1] );\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/email\r\n            email: function (value, element) {\r\n                // contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/\r\n                return this.optional(element) || /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i.test(value);\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/url\r\n            url: function (value, element) {\r\n                // contributed by Scott Gonzalez: http://projects.scottsplayground.com/iri/\r\n                return this.optional(element) || /^(https?|ftp):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(\\#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i.test(value);\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/date\r\n            date: function (value, element) {\r\n                return this.optional(element) || !/Invalid|NaN/.test(new Date(value));\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/dateISO\r\n            dateISO: function (value, element) {\r\n                return this.optional(element) || /^\\d{4}[\\/\\-]\\d{1,2}[\\/\\-]\\d{1,2}$/.test(value);\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/number\r\n            number: function (value, element) {\r\n                return this.optional(element) || /^-?(?:\\d+|\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$/.test(value);\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/digits\r\n            digits: function (value, element) {\r\n                return this.optional(element) || /^\\d+$/.test(value);\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/creditcard\r\n            // based on http://en.wikipedia.org/wiki/Luhn\r\n            creditcard: function (value, element) {\r\n                if (this.optional(element)) {\r\n                    return \"dependency-mismatch\";\r\n                }\r\n                // accept only spaces, digits and dashes\r\n                if (/[^0-9 \\-]+/.test(value)) {\r\n                    return false;\r\n                }\r\n                var nCheck = 0,\r\n                    nDigit = 0,\r\n                    bEven = false;\r\n\r\n                value = value.replace(/\\D/g, \"\");\r\n\r\n                for (var n = value.length - 1; n >= 0; n--) {\r\n                    var cDigit = value.charAt(n);\r\n                    nDigit = parseInt(cDigit, 10);\r\n                    if (bEven) {\r\n                        if ((nDigit *= 2) > 9) {\r\n                            nDigit -= 9;\r\n                        }\r\n                    }\r\n                    nCheck += nDigit;\r\n                    bEven = !bEven;\r\n                }\r\n\r\n                return (nCheck % 10) === 0;\r\n            },\r\n\r\n            // http://docs.jquery.com/Plugins/Validation/Methods/equalTo\r\n            equalTo: function (value, element, param) {\r\n                // bind to the blur event of the target in order to revalidate whenever the target field is updated\r\n                // TODO find a way to bind the event just once, avoiding the unbind-rebind overhead\r\n                var target = $(param);\r\n                if (this.settings.onfocusout) {\r\n                    target.unbind(\".validate-equalTo\").bind(\"blur.validate-equalTo\", function () {\r\n                        $(element).valid();\r\n                    });\r\n                }\r\n                return value === target.val();\r\n            }\r\n\r\n        }\r\n\r\n    });\r\n\r\n// deprecated, use $.validator.format instead\r\n    $.format = $.validator.format;\r\n\r\n}(jQuery));\r\n\r\n// ajax mode: abort\r\n// usage: $.ajax({ mode: \"abort\"[, port: \"uniqueport\"]});\r\n// if mode:\"abort\" is used, the previous request on that port (port can be undefined) is aborted via XMLHttpRequest.abort()\r\n(function ($) {\r\n    var pendingRequests = {};\r\n    // Use a prefilter if available (1.5+)\r\n    if ($.ajaxPrefilter) {\r\n        $.ajaxPrefilter(function (settings, _, xhr) {\r\n            var port = settings.port;\r\n            if (settings.mode === \"abort\") {\r\n                if (pendingRequests[port]) {\r\n                    pendingRequests[port].abort();\r\n                }\r\n                pendingRequests[port] = xhr;\r\n            }\r\n        });\r\n    } else {\r\n        // Proxy ajax\r\n        var ajax = $.ajax;\r\n        $.ajax = function (settings) {\r\n            var mode = ( \"mode\" in settings ? settings : $.ajaxSettings ).mode,\r\n                port = ( \"port\" in settings ? settings : $.ajaxSettings ).port;\r\n            if (mode === \"abort\") {\r\n                if (pendingRequests[port]) {\r\n                    pendingRequests[port].abort();\r\n                }\r\n                return (pendingRequests[port] = ajax.apply(this, arguments));\r\n            }\r\n            return ajax.apply(this, arguments);\r\n        };\r\n    }\r\n}(jQuery));\r\n\r\n// provides cross-browser focusin and focusout events\r\n// IE has native support, in other browsers, use event caputuring (neither bubbles)\r\n\r\n// provides delegate(type: String, delegate: Selector, handler: Callback) plugin for easier event delegation\r\n// handler is only called when $(event.target).is(delegate), in the scope of the jquery-object for event.target\r\n(function ($) {\r\n    // only implement if not provided by jQuery core (since 1.4)\r\n    // TODO verify if jQuery 1.4's implementation is compatible with older jQuery special-event APIs\r\n    if (!jQuery.event.special.focusin && !jQuery.event.special.focusout && document.addEventListener) {\r\n        $.each({\r\n            focus: 'focusin',\r\n            blur: 'focusout'\r\n        }, function (original, fix) {\r\n            $.event.special[fix] = {\r\n                setup: function () {\r\n                    this.addEventListener(original, handler, true);\r\n                },\r\n                teardown: function () {\r\n                    this.removeEventListener(original, handler, true);\r\n                },\r\n                handler: function (e) {\r\n                    var args = arguments;\r\n                    args[0] = $.event.fix(e);\r\n                    args[0].type = fix;\r\n                    return $.event.handle.apply(this, args);\r\n                }\r\n            };\r\n            function handler(e) {\r\n                e = $.event.fix(e);\r\n                e.type = fix;\r\n                return $.event.handle.call(this, e);\r\n            }\r\n        });\r\n    }\r\n    $.extend($.fn, {\r\n        validateDelegate: function (delegate, type, handler) {\r\n            return this.bind(type, function (event) {\r\n                var target = $(event.target);\r\n                if (target.is(delegate)) {\r\n                    return handler.apply(target, arguments);\r\n                }\r\n            });\r\n        }\r\n    });\r\n}(jQuery));\r\n\r\n}));","jquery/colorpicker/js/colorpicker.js":"/**\r\n *\r\n * Color picker\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n * Dual licensed under the MIT and GPL licenses\r\n * \r\n */\r\n\r\nrequire([\r\n\t\"jquery\",\r\n], function ($) {\r\n\tvar ColorPicker = function () {\r\n\t\tvar\r\n\t\t\tids = {},\r\n\t\t\tinAction,\r\n\t\t\tcharMin = 65,\r\n\t\t\tvisible,\r\n\t\t\ttpl = '<div class=\"colorpicker\"><div class=\"colorpicker_color\"><div><div></div></div></div><div class=\"colorpicker_hue\"><div></div></div><div class=\"colorpicker_new_color\"></div><div class=\"colorpicker_current_color\"></div><div class=\"colorpicker_hex\"><input type=\"text\" maxlength=\"6\" size=\"6\" /></div><div class=\"colorpicker_rgb_r colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_g colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_h colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_s colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_submit\"></div></div>',\r\n\t\t\tdefaults = {\r\n\t\t\t\teventName: 'click',\r\n\t\t\t\tonShow: function () {},\r\n\t\t\t\tonBeforeShow: function(){},\r\n\t\t\t\tonHide: function () {},\r\n\t\t\t\tonChange: function () {},\r\n\t\t\t\tonSubmit: function () {},\r\n\t\t\t\tcolor: 'ff0000',\r\n\t\t\t\tlivePreview: true,\r\n\t\t\t\tflat: false\r\n\t\t\t},\r\n\t\t\tfillRGBFields = function  (hsb, cal) {\r\n\t\t\t\tvar rgb = HSBToRGB(hsb);\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(1).val(rgb.r).end()\r\n\t\t\t\t\t.eq(2).val(rgb.g).end()\r\n\t\t\t\t\t.eq(3).val(rgb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHSBFields = function  (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(4).val(hsb.h).end()\r\n\t\t\t\t\t.eq(5).val(hsb.s).end()\r\n\t\t\t\t\t.eq(6).val(hsb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHexFields = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(0).val(HSBToHex(hsb)).end();\r\n\t\t\t},\r\n\t\t\tsetSelector = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').selector.css('backgroundColor', '#' + HSBToHex({h: hsb.h, s: 100, b: 100}));\r\n\t\t\t\t$(cal).data('colorpicker').selectorIndic.css({\r\n\t\t\t\t\tleft: parseInt(150 * hsb.s/100, 10),\r\n\t\t\t\t\ttop: parseInt(150 * (100-hsb.b)/100, 10)\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetHue = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').hue.css('top', parseInt(150 - 150 * hsb.h/360, 10));\r\n\t\t\t},\r\n\t\t\tsetCurrentColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').currentColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tsetNewColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').newColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tkeyDown = function (ev) {\r\n\t\t\t\tvar pressedKey = ev.charCode || ev.keyCode || -1;\r\n\t\t\t\tif ((pressedKey > charMin && pressedKey <= 90) || pressedKey == 32) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tif (cal.data('colorpicker').livePreview === true) {\r\n\t\t\t\t\tchange.apply(this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent(), col;\r\n\t\t\t\tif (this.parentNode.className.indexOf('_hex') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = HexToHSB(fixHex(this.value));\r\n\t\t\t\t} else if (this.parentNode.className.indexOf('_hsb') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = fixHSB({\r\n\t\t\t\t\t\th: parseInt(cal.data('colorpicker').fields.eq(4).val(), 10),\r\n\t\t\t\t\t\ts: parseInt(cal.data('colorpicker').fields.eq(5).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(6).val(), 10)\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = RGBToHSB(fixRGB({\r\n\t\t\t\t\t\tr: parseInt(cal.data('colorpicker').fields.eq(1).val(), 10),\r\n\t\t\t\t\t\tg: parseInt(cal.data('colorpicker').fields.eq(2).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(3).val(), 10)\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t\tif (ev) {\r\n\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t}\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onChange.apply(cal, [col, HSBToHex(col), HSBToRGB(col)]);\r\n\t\t\t},\r\n\t\t\tblur = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tcal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tfocus = function () {\r\n\t\t\t\tcharMin = this.parentNode.className.indexOf('_hex') > 0 ? 70 : 65;\r\n\t\t\t\t$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t\t$(this).parent().addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tdownIncrement = function (ev) {\r\n\t\t\t\tvar field = $(this).parent().find('input').focus();\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tel: $(this).parent().addClass('colorpicker_slider'),\r\n\t\t\t\t\tmax: this.parentNode.className.indexOf('_hsb_h') > 0 ? 360 : (this.parentNode.className.indexOf('_hsb') > 0 ? 100 : 255),\r\n\t\t\t\t\ty: ev.pageY,\r\n\t\t\t\t\tfield: field,\r\n\t\t\t\t\tval: parseInt(field.val(), 10),\r\n\t\t\t\t\tpreview: $(this).parent().parent().data('colorpicker').livePreview\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t$(document).bind('mouseup', current, upIncrement);\r\n\t\t\t\t$(document).bind('mousemove', current, moveIncrement);\r\n\t\t\t},\r\n\t\t\tmoveIncrement = function (ev) {\r\n\t\t\t\tev.data.field.val(Math.max(0, Math.min(ev.data.max, parseInt(ev.data.val + ev.pageY - ev.data.y, 10))));\r\n\t\t\t\tif (ev.data.preview) {\r\n\t\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupIncrement = function (ev) {\r\n\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\tev.data.el.removeClass('colorpicker_slider').find('input').focus();\r\n\t\t\t\t$(document).unbind('mouseup', upIncrement);\r\n\t\t\t\t$(document).unbind('mousemove', moveIncrement);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownHue = function (ev) {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\ty: $(this).offset().top\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upHue);\r\n\t\t\t\t$(document).bind('mousemove', current, moveHue);\r\n\t\t\t},\r\n\t\t\tmoveHue = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(4)\r\n\t\t\t\t\t\t.val(parseInt(360*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.y))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupHue = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upHue);\r\n\t\t\t\t$(document).unbind('mousemove', moveHue);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownSelector = function (ev) {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\tpos: $(this).offset()\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upSelector);\r\n\t\t\t\t$(document).bind('mousemove', current, moveSelector);\r\n\t\t\t},\r\n\t\t\tmoveSelector = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(6)\r\n\t\t\t\t\t\t.val(parseInt(100*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.pos.top))))/150, 10))\r\n\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t.eq(5)\r\n\t\t\t\t\t\t.val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX - ev.data.pos.left))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupSelector = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upSelector);\r\n\t\t\t\t$(document).unbind('mousemove', moveSelector);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tenterSubmit = function (ev) {\r\n\t\t\t\t$(this).addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tleaveSubmit = function (ev) {\r\n\t\t\t\t$(this).removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tclickSubmit = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').color;\r\n\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onSubmit(col, HSBToHex(col), HSBToRGB(col), cal.data('colorpicker').el);\r\n\t\t\t},\r\n\t\t\tshow = function (ev) {\r\n\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\tcal.data('colorpicker').onBeforeShow.apply(this, [cal.get(0)]);\r\n\t\t\t\tvar pos = $(this).offset();\r\n\t\t\t\tvar viewPort = getViewport();\r\n\t\t\t\tvar top = pos.top + this.offsetHeight;\r\n\t\t\t\tvar left = pos.left;\r\n\t\t\t\tif (top + 176 > viewPort.t + viewPort.h) {\r\n\t\t\t\t\ttop -= this.offsetHeight + 176;\r\n\t\t\t\t}\r\n\t\t\t\tif (left + 356 > viewPort.l + viewPort.w) {\r\n\t\t\t\t\tleft -= 356;\r\n\t\t\t\t}\r\n\t\t\t\tcal.css({left: left + 'px', top: top + 'px'});\r\n\t\t\t\tif (cal.data('colorpicker').onShow.apply(this, [cal.get(0)]) != false) {\r\n\t\t\t\t\tcal.show();\r\n\t\t\t\t}\r\n\t\t\t\t$(document).bind('mousedown', {cal: cal}, hide);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\thide = function (ev) {\r\n\t\t\t\tif (!isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\r\n\t\t\t\t\tif (ev.data.cal.data('colorpicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\r\n\t\t\t\t\t\tev.data.cal.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).unbind('mousedown', hide);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisChildOf = function(parentEl, el, container) {\r\n\t\t\t\tif (parentEl == el) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (parentEl.contains) {\r\n\t\t\t\t\treturn parentEl.contains(el);\r\n\t\t\t\t}\r\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t\t\t}\r\n\t\t\t\tvar prEl = el.parentNode;\r\n\t\t\t\twhile(prEl && prEl != container) {\r\n\t\t\t\t\tif (prEl == parentEl)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tprEl = prEl.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tgetViewport = function () {\r\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\r\n\t\t\t\treturn {\r\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\r\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\r\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\r\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHSB = function (hsb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\th: Math.min(360, Math.max(0, hsb.h)),\r\n\t\t\t\t\ts: Math.min(100, Math.max(0, hsb.s)),\r\n\t\t\t\t\tb: Math.min(100, Math.max(0, hsb.b))\r\n\t\t\t\t};\r\n\t\t\t}, \r\n\t\t\tfixRGB = function (rgb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tr: Math.min(255, Math.max(0, rgb.r)),\r\n\t\t\t\t\tg: Math.min(255, Math.max(0, rgb.g)),\r\n\t\t\t\t\tb: Math.min(255, Math.max(0, rgb.b))\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHex = function (hex) {\r\n\t\t\t\tvar len = 6 - hex.length;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tvar o = [];\r\n\t\t\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\t\t\to.push('0');\r\n\t\t\t\t\t}\r\n\t\t\t\t\to.push(hex);\r\n\t\t\t\t\thex = o.join('');\r\n\t\t\t\t}\r\n\t\t\t\treturn hex;\r\n\t\t\t}, \r\n\t\t\tHexToRGB = function (hex) {\r\n\t\t\t\tvar hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n\t\t\t\treturn {r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF)};\r\n\t\t\t},\r\n\t\t\tHexToHSB = function (hex) {\r\n\t\t\t\treturn RGBToHSB(HexToRGB(hex));\r\n\t\t\t},\r\n\t\t\tRGBToHSB = function (rgb) {\r\n\t\t\t\tvar hsb = {\r\n\t\t\t\t\th: 0,\r\n\t\t\t\t\ts: 0,\r\n\t\t\t\t\tb: 0\r\n\t\t\t\t};\r\n\t\t\t\tvar min = Math.min(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar max = Math.max(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar delta = max - min;\r\n\t\t\t\thsb.b = max;\r\n\t\t\t\tif (max != 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\thsb.s = max != 0 ? 255 * delta / max : 0;\r\n\t\t\t\tif (hsb.s != 0) {\r\n\t\t\t\t\tif (rgb.r == max) {\r\n\t\t\t\t\t\thsb.h = (rgb.g - rgb.b) / delta;\r\n\t\t\t\t\t} else if (rgb.g == max) {\r\n\t\t\t\t\t\thsb.h = 2 + (rgb.b - rgb.r) / delta;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thsb.h = 4 + (rgb.r - rgb.g) / delta;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thsb.h = -1;\r\n\t\t\t\t}\r\n\t\t\t\thsb.h *= 60;\r\n\t\t\t\tif (hsb.h < 0) {\r\n\t\t\t\t\thsb.h += 360;\r\n\t\t\t\t}\r\n\t\t\t\thsb.s *= 100/255;\r\n\t\t\t\thsb.b *= 100/255;\r\n\t\t\t\treturn hsb;\r\n\t\t\t},\r\n\t\t\tHSBToRGB = function (hsb) {\r\n\t\t\t\tvar rgb = {};\r\n\t\t\t\tvar h = Math.round(hsb.h);\r\n\t\t\t\tvar s = Math.round(hsb.s*255/100);\r\n\t\t\t\tvar v = Math.round(hsb.b*255/100);\r\n\t\t\t\tif(s == 0) {\r\n\t\t\t\t\trgb.r = rgb.g = rgb.b = v;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar t1 = v;\r\n\t\t\t\t\tvar t2 = (255-s)*v/255;\r\n\t\t\t\t\tvar t3 = (t1-t2)*(h%60)/60;\r\n\t\t\t\t\tif(h==360) h = 0;\r\n\t\t\t\t\tif(h<60) {rgb.r=t1;\trgb.b=t2; rgb.g=t2+t3}\r\n\t\t\t\t\telse if(h<120) {rgb.g=t1; rgb.b=t2;\trgb.r=t1-t3}\r\n\t\t\t\t\telse if(h<180) {rgb.g=t1; rgb.r=t2;\trgb.b=t2+t3}\r\n\t\t\t\t\telse if(h<240) {rgb.b=t1; rgb.r=t2;\trgb.g=t1-t3}\r\n\t\t\t\t\telse if(h<300) {rgb.b=t1; rgb.g=t2;\trgb.r=t2+t3}\r\n\t\t\t\t\telse if(h<360) {rgb.r=t1; rgb.g=t2;\trgb.b=t1-t3}\r\n\t\t\t\t\telse {rgb.r=0; rgb.g=0;\trgb.b=0}\r\n\t\t\t\t}\r\n\t\t\t\treturn {r:Math.round(rgb.r), g:Math.round(rgb.g), b:Math.round(rgb.b)};\r\n\t\t\t},\r\n\t\t\tRGBToHex = function (rgb) {\r\n\t\t\t\tvar hex = [\r\n\t\t\t\t\trgb.r.toString(16),\r\n\t\t\t\t\trgb.g.toString(16),\r\n\t\t\t\t\trgb.b.toString(16)\r\n\t\t\t\t];\r\n\t\t\t\t$.each(hex, function (nr, val) {\r\n\t\t\t\t\tif (val.length == 1) {\r\n\t\t\t\t\t\thex[nr] = '0' + val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn hex.join('');\r\n\t\t\t},\r\n\t\t\tHSBToHex = function (hsb) {\r\n\t\t\t\treturn RGBToHex(HSBToRGB(hsb));\r\n\t\t\t},\r\n\t\t\trestoreOriginal = function () {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').origColor;\r\n\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function (opt) {\r\n\t\t\t\topt = $.extend({}, defaults, opt||{});\r\n\t\t\t\tif (typeof opt.color == 'string') {\r\n\t\t\t\t\topt.color = HexToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.r != undefined && opt.color.g != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = RGBToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.h != undefined && opt.color.s != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = fixHSB(opt.color);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function () {\r\n\t\t\t\t\tif (!$(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar options = $.extend({}, opt);\r\n\t\t\t\t\t\toptions.origColor = opt.color;\r\n\t\t\t\t\t\tvar id = 'collorpicker_' + parseInt(Math.random() * 1000);\r\n\t\t\t\t\t\t$(this).data('colorpickerId', id);\r\n\t\t\t\t\t\tvar cal = $(tpl).attr('id', id);\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.appendTo(this).show();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcal.appendTo(document.body);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.fields = cal\r\n\t\t\t\t\t\t\t\t\t\t\t.find('input')\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('keyup', keyDown)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('change', change)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('blur', blur)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('focus', focus);\r\n\t\t\t\t\t\tcal\r\n\t\t\t\t\t\t\t.find('span').bind('mousedown', downIncrement).end()\r\n\t\t\t\t\t\t\t.find('>div.colorpicker_current_color').bind('click', restoreOriginal);\r\n\t\t\t\t\t\toptions.selector = cal.find('div.colorpicker_color').bind('mousedown', downSelector);\r\n\t\t\t\t\t\toptions.selectorIndic = options.selector.find('div div');\r\n\t\t\t\t\t\toptions.el = this;\r\n\t\t\t\t\t\toptions.hue = cal.find('div.colorpicker_hue div');\r\n\t\t\t\t\t\tcal.find('div.colorpicker_hue').bind('mousedown', downHue);\r\n\t\t\t\t\t\toptions.newColor = cal.find('div.colorpicker_new_color');\r\n\t\t\t\t\t\toptions.currentColor = cal.find('div.colorpicker_current_color');\r\n\t\t\t\t\t\tcal.data('colorpicker', options);\r\n\t\t\t\t\t\tcal.find('div.colorpicker_submit')\r\n\t\t\t\t\t\t\t.bind('mouseenter', enterSubmit)\r\n\t\t\t\t\t\t\t.bind('mouseleave', leaveSubmit)\r\n\t\t\t\t\t\t\t.bind('click', clickSubmit);\r\n\t\t\t\t\t\tfillRGBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetHue(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\t\t\t\tdisplay: 'block'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowPicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tshow.apply(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thidePicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\t$('#' + $(this).data('colorpickerId')).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetColor: function(col) {\r\n\t\t\t\tif (typeof col == 'string') {\r\n\t\t\t\t\tcol = HexToHSB(col);\r\n\t\t\t\t} else if (col.r != undefined && col.g != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = RGBToHSB(col);\r\n\t\t\t\t} else if (col.h != undefined && col.s != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = fixHSB(col);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$.fn.extend({\r\n\t\tColorPicker: ColorPicker.init,\r\n\t\tColorPickerHide: ColorPicker.hidePicker,\r\n\t\tColorPickerShow: ColorPicker.showPicker,\r\n\t\tColorPickerSetColor: ColorPicker.setColor\r\n\t});\r\n});","jquery/editableMultiselect/js/jquery.editable.js":"/*\r\n * Jeditable - jQuery in place edit plugin\r\n *\r\n * Copyright (c) 2006-2009 Mika Tuupola, Dylan Verheul\r\n *\r\n * Licensed under the MIT license:\r\n *   http://www.opensource.org/licenses/mit-license.php\r\n *\r\n * Project home:\r\n *   http://www.appelsiini.net/projects/jeditable\r\n *\r\n * Based on editable by Dylan Verheul <dylan_at_dyve.net>:\r\n *    http://www.dyve.net/jquery/?editable\r\n *\r\n */\r\n\r\n/**\r\n * Version 1.7.1\r\n *\r\n * ** means there is basic unit tests for this parameter.\r\n *\r\n * @name  Jeditable\r\n * @type  jQuery\r\n * @param String  target             (POST) URL or function to send edited content to **\r\n * @param Hash    options            additional options\r\n * @param String  options[method]    method to use to send edited content (POST or PUT) **\r\n * @param Function options[callback] Function to run after submitting edited content **\r\n * @param String  options[name]      POST parameter name of edited content\r\n * @param String  options[id]        POST parameter name of edited div id\r\n * @param Hash    options[submitdata] Extra parameters to send when submitting edited content.\r\n * @param String  options[type]      text, textarea or select (or any 3rd party input type) **\r\n * @param Integer options[rows]      number of rows if using textarea **\r\n * @param Integer options[cols]      number of columns if using textarea **\r\n * @param Mixed   options[height]    'auto', 'none' or height in pixels **\r\n * @param Mixed   options[width]     'auto', 'none' or width in pixels **\r\n * @param String  options[loadurl]   URL to fetch input content before editing **\r\n * @param String  options[loadtype]  Request type for load url. Should be GET or POST.\r\n * @param String  options[loadtext]  Text to display while loading external content.\r\n * @param Mixed   options[loaddata]  Extra parameters to pass when fetching content before editing.\r\n * @param Mixed   options[data]      Or content given as paramameter. String or function.**\r\n * @param String  options[indicator] indicator html to show when saving\r\n * @param String  options[tooltip]   optional tooltip text via title attribute **\r\n * @param String  options[event]     jQuery event such as 'click' of 'dblclick' **\r\n * @param String  options[submit]    submit button value, empty means no button **\r\n * @param String  options[cancel]    cancel button value, empty means no button **\r\n * @param String  options[cssclass]  CSS class to apply to input form. 'inherit' to copy from parent. **\r\n * @param String  options[style]     Style to apply to input form 'inherit' to copy from parent. **\r\n * @param String  options[select]    true or false, when true text is highlighted ??\r\n * @param String  options[placeholder] Placeholder text or html to insert when element is empty. **\r\n * @param String  options[onblur]    'cancel', 'submit', 'ignore' or function ??\r\n *\r\n * @param Function options[onsubmit] function(settings, original) { ... } called before submit\r\n * @param Function options[onreset]  function(settings, original) { ... } called before reset\r\n * @param Function options[onerror]  function(settings, original, xhr) { ... } called on error\r\n *\r\n * @param Hash    options[ajaxoptions]  jQuery Ajax options. See docs.jquery.com.\r\n *\r\n */\r\n\r\n(function($) {\r\n\r\n    $.fn.editable = function(target, options) {\r\n\r\n        if ('disable' == target) {\r\n            $(this).data('disabled.editable', true);\r\n            return;\r\n        }\r\n        if ('enable' == target) {\r\n            $(this).data('disabled.editable', false);\r\n            return;\r\n        }\r\n        if ('destroy' == target) {\r\n            $(this)\r\n                .unbind($(this).data('event.editable'))\r\n                .removeData('disabled.editable')\r\n                .removeData('event.editable');\r\n            return;\r\n        }\r\n\r\n        var settings = $.extend({}, $.fn.editable.defaults, {target:target}, options);\r\n\r\n        /* setup some functions */\r\n        var plugin   = $.editable.types[settings.type].plugin || function() { };\r\n        var submit   = $.editable.types[settings.type].submit || function() { };\r\n        var buttons  = $.editable.types[settings.type].buttons\r\n            || $.editable.types['defaults'].buttons;\r\n        var content  = $.editable.types[settings.type].content\r\n            || $.editable.types['defaults'].content;\r\n        var element  = $.editable.types[settings.type].element\r\n            || $.editable.types['defaults'].element;\r\n        var reset    = $.editable.types[settings.type].reset\r\n            || $.editable.types['defaults'].reset;\r\n        var callback = settings.callback || function() { };\r\n        var onedit   = settings.onedit   || function() { };\r\n        var onsubmit = settings.onsubmit || function() { };\r\n        var onreset  = settings.onreset  || function() { };\r\n        var onerror  = settings.onerror  || reset;\r\n\r\n        /* show tooltip */\r\n        if (settings.tooltip) {\r\n            $(this).attr('title', settings.tooltip);\r\n        }\r\n\r\n        settings.autowidth  = 'auto' == settings.width;\r\n        settings.autoheight = 'auto' == settings.height;\r\n\r\n        return this.each(function() {\r\n\r\n            /* save this to self because this changes when scope changes */\r\n            var self = this;\r\n\r\n            /* inlined block elements lose their width and height after first edit */\r\n            /* save them for later use as workaround */\r\n            var savedwidth  = $(self).width();\r\n            var savedheight = $(self).height();\r\n\r\n            /* save so it can be later used by $.editable('destroy') */\r\n            $(this).data('event.editable', settings.event);\r\n\r\n            /* if element is empty add something clickable (if requested) */\r\n            if (!$.trim($(this).html())) {\r\n                $(this).html(settings.placeholder);\r\n            }\r\n\r\n            $(this).bind(settings.event, function(e) {\r\n\r\n                /* abort if disabled for this element */\r\n                if (true === $(this).data('disabled.editable')) {\r\n                    return;\r\n                }\r\n\r\n                /* prevent throwing an exeption if edit field is clicked again */\r\n                if (self.editing) {\r\n                    return;\r\n                }\r\n\r\n                /* abort if onedit hook returns false */\r\n                if (false === onedit.apply(this, [settings, self])) {\r\n                    return;\r\n                }\r\n\r\n                /* prevent default action and bubbling */\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n\r\n                /* remove tooltip */\r\n                if (settings.tooltip) {\r\n                    $(self).removeAttr('title');\r\n                }\r\n\r\n                /* figure out how wide and tall we are, saved width and height */\r\n                /* are workaround for http://dev.jquery.com/ticket/2190 */\r\n                if (0 == $(self).width()) {\r\n                    //$(self).css('visibility', 'hidden');\r\n                    settings.width  = savedwidth;\r\n                    settings.height = savedheight;\r\n                } else {\r\n                    if (settings.width != 'none') {\r\n                        settings.width =\r\n                            settings.autowidth ? $(self).width()  : settings.width;\r\n                    }\r\n                    if (settings.height != 'none') {\r\n                        settings.height =\r\n                            settings.autoheight ? $(self).height() : settings.height;\r\n                    }\r\n                }\r\n                //$(this).css('visibility', '');\r\n\r\n                /* remove placeholder text, replace is here because of IE */\r\n                if ($(this).html().toLowerCase().replace(/(;|\")/g, '') ==\r\n                    settings.placeholder.toLowerCase().replace(/(;|\")/g, '')) {\r\n                    $(this).html('');\r\n                }\r\n\r\n                self.editing    = true;\r\n                self.revert     = $(self).html();\r\n                $(self).html('');\r\n\r\n                /* create the form object */\r\n                var form = $('<form />');\r\n\r\n                /* apply css or style or both */\r\n                if (settings.cssclass) {\r\n                    if ('inherit' == settings.cssclass) {\r\n                        form.attr('class', $(self).attr('class'));\r\n                    } else {\r\n                        form.attr('class', settings.cssclass);\r\n                    }\r\n                }\r\n\r\n                if (settings.style) {\r\n                    if ('inherit' == settings.style) {\r\n                        form.attr('style', $(self).attr('style'));\r\n                        /* IE needs the second line or display wont be inherited */\r\n                        form.css('display', $(self).css('display'));\r\n                    } else {\r\n                        form.attr('style', settings.style);\r\n                    }\r\n                }\r\n\r\n                /* add main input element to form and store it in input */\r\n                var input = element.apply(form, [settings, self]);\r\n\r\n                /* set input content via POST, GET, given data or existing value */\r\n                var input_content;\r\n\r\n                if (settings.loadurl) {\r\n                    var t = setTimeout(function() {\r\n                        input.disabled = true;\r\n                        content.apply(form, [settings.loadtext, settings, self]);\r\n                    }, 100);\r\n\r\n                    var loaddata = {};\r\n                    loaddata[settings.id] = self.id;\r\n                    if ($.isFunction(settings.loaddata)) {\r\n                        $.extend(loaddata, settings.loaddata.apply(self, [self.revert, settings]));\r\n                    } else {\r\n                        $.extend(loaddata, settings.loaddata);\r\n                    }\r\n                    $.ajax({\r\n                        type : settings.loadtype,\r\n                        url  : settings.loadurl,\r\n                        data : loaddata,\r\n                        async : false,\r\n                        success: function(result) {\r\n                            window.clearTimeout(t);\r\n                            input_content = result;\r\n                            input.disabled = false;\r\n                        }\r\n                    });\r\n                } else if (settings.data) {\r\n                    input_content = settings.data;\r\n                    if ($.isFunction(settings.data)) {\r\n                        input_content = settings.data.apply(self, [self.revert, settings]);\r\n                    }\r\n                } else {\r\n                    input_content = self.revert;\r\n                }\r\n                content.apply(form, [input_content, settings, self]);\r\n\r\n                input.attr('name', settings.name);\r\n\r\n                /* add buttons to the form */\r\n                buttons.apply(form, [settings, self]);\r\n\r\n                /* add created form to self */\r\n                $(self).append(form);\r\n\r\n                /* attach 3rd party plugin if requested */\r\n                plugin.apply(form, [settings, self]);\r\n\r\n                /* focus to first visible form element */\r\n                $(':input:visible:enabled:first', form).focus();\r\n\r\n                /* highlight input contents when requested */\r\n                if (settings.select) {\r\n                    input.select();\r\n                }\r\n\r\n                /* discard changes if pressing esc */\r\n                input.keydown(function(e) {\r\n                    if (e.keyCode == 27) {\r\n                        e.preventDefault();\r\n                        //self.reset();\r\n                        reset.apply(form, [settings, self]);\r\n                    }\r\n                });\r\n\r\n                /* discard, submit or nothing with changes when clicking outside */\r\n                /* do nothing is usable when navigating with tab */\r\n                var t;\r\n                if ('cancel' == settings.onblur) {\r\n                    input.blur(function(e) {\r\n                        /* prevent canceling if submit was clicked */\r\n                        t = setTimeout(function() {\r\n                            reset.apply(form, [settings, self]);\r\n                        }, 500);\r\n                    });\r\n                } else if ('submit' == settings.onblur) {\r\n                    input.blur(function(e) {\r\n                        /* prevent double submit if submit was clicked */\r\n                        t = setTimeout(function() {\r\n                            form.submit();\r\n                        }, 200);\r\n                    });\r\n                } else if ($.isFunction(settings.onblur)) {\r\n                    input.blur(function(e) {\r\n                        settings.onblur.apply(self, [input.val(), settings]);\r\n                    });\r\n                } else {\r\n                    input.blur(function(e) {\r\n                        /* TODO: maybe something here */\r\n                    });\r\n                }\r\n\r\n                form.submit(function(e) {\r\n\r\n                    if (t) {\r\n                        clearTimeout(t);\r\n                    }\r\n\r\n                    /* do no submit */\r\n                    e.preventDefault();\r\n\r\n                    /* call before submit hook. */\r\n                    /* if it returns false abort submitting */\r\n                    if (false !== onsubmit.apply(form, [settings, self])) {\r\n                        /* custom inputs call before submit hook. */\r\n                        /* if it returns false abort submitting */\r\n                        if (false !== submit.apply(form, [settings, self])) {\r\n\r\n                            /* check if given target is function */\r\n                            if ($.isFunction(settings.target)) {\r\n                                var str = settings.target.apply(self, [input.val(), settings]);\r\n                                $(self).html(str);\r\n                                self.editing = false;\r\n                                callback.apply(self, [self.innerHTML, settings]);\r\n                                /* TODO: this is not dry */\r\n                                if (!$.trim($(self).html())) {\r\n                                    $(self).html(settings.placeholder);\r\n                                }\r\n                            } else {\r\n                                /* add edited content and id of edited element to POST */\r\n                                var submitdata = {};\r\n                                submitdata[settings.name] = input.val();\r\n                                submitdata[settings.id] = self.id;\r\n                                /* add extra data to be POST:ed */\r\n                                if ($.isFunction(settings.submitdata)) {\r\n                                    $.extend(submitdata, settings.submitdata.apply(self, [self.revert, settings]));\r\n                                } else {\r\n                                    $.extend(submitdata, settings.submitdata);\r\n                                }\r\n\r\n                                /* quick and dirty PUT support */\r\n                                if ('PUT' == settings.method) {\r\n                                    submitdata['_method'] = 'put';\r\n                                }\r\n\r\n                                /* show the saving indicator */\r\n                                $(self).html(settings.indicator);\r\n\r\n                                /* defaults for ajaxoptions */\r\n                                var ajaxoptions = {\r\n                                    type    : 'POST',\r\n                                    data    : submitdata,\r\n                                    dataType: 'html',\r\n                                    url     : settings.target,\r\n                                    success : function(result, status) {\r\n                                        if (ajaxoptions.dataType == 'html') {\r\n                                            $(self).html(result);\r\n                                        }\r\n                                        self.editing = false;\r\n                                        callback.apply(self, [result, settings]);\r\n                                        if (!$.trim($(self).html())) {\r\n                                            $(self).html(settings.placeholder);\r\n                                        }\r\n                                    },\r\n                                    error   : function(xhr, status, error) {\r\n                                        onerror.apply(form, [settings, self, xhr]);\r\n                                    }\r\n                                };\r\n\r\n                                /* override with what is given in settings.ajaxoptions */\r\n                                $.extend(ajaxoptions, settings.ajaxoptions);\r\n                                $.ajax(ajaxoptions);\r\n\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    /* show tooltip again */\r\n                    $(self).attr('title', settings.tooltip);\r\n\r\n                    return false;\r\n                });\r\n            });\r\n\r\n            /* privileged methods */\r\n            this.reset = function(form) {\r\n                /* prevent calling reset twice when blurring */\r\n                if (this.editing) {\r\n                    /* before reset hook, if it returns false abort reseting */\r\n                    if (false !== onreset.apply(form, [settings, self])) {\r\n                        $(self).html(self.revert);\r\n                        self.editing   = false;\r\n                        if (!$.trim($(self).html())) {\r\n                            $(self).html(settings.placeholder);\r\n                        }\r\n                        /* show tooltip again */\r\n                        if (settings.tooltip) {\r\n                            $(self).attr('title', settings.tooltip);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n        });\r\n\r\n    };\r\n\r\n\r\n    $.editable = {\r\n        types: {\r\n            defaults: {\r\n                element : function(settings, original) {\r\n                    var input = $('<input type=\"hidden\"></input>');\r\n                    $(this).append(input);\r\n                    return(input);\r\n                },\r\n                content : function(string, settings, original) {\r\n                    $(':input:first', this).val(string);\r\n                },\r\n                reset : function(settings, original) {\r\n                    settings.data.apply(original, [original, settings]);\r\n                    original.reset(this);\r\n                },\r\n                buttons : function(settings, original) {\r\n                    var form = this;\r\n                    if (settings.submit) {\r\n                        /* if given html string use that */\r\n                        if (settings.submit.match(/>$/)) {\r\n                            var submit = $(settings.submit).click(function() {\r\n                                if (submit.attr(\"type\") != \"submit\") {\r\n                                    form.submit();\r\n                                }\r\n                            });\r\n                            /* otherwise use button with given string as text */\r\n                        } else {\r\n                            var submit = $('<button type=\"submit\" />');\r\n                            submit.html(settings.submit);\r\n                        }\r\n                        $(this).append(submit);\r\n                    }\r\n                    if (settings.cancel) {\r\n                        /* if given html string use that */\r\n                        if (settings.cancel.match(/>$/)) {\r\n                            var cancel = $(settings.cancel);\r\n                            /* otherwise use button with given string as text */\r\n                        } else {\r\n                            var cancel = $('<button type=\"cancel\" />');\r\n                            cancel.html(settings.cancel);\r\n                        }\r\n                        $(this).append(cancel);\r\n\r\n                        $(cancel).click(function(event) {\r\n                            original.reset(this);\r\n                            return false;\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            text: {\r\n                element : function(settings, original) {\r\n                    var input = $('<input type=\"text\"/>');\r\n//                    if (settings.width  != 'none') { input.width(settings.width);  }\r\n//                    if (settings.height != 'none') { input.height(settings.height); }\r\n                    /* https://bugzilla.mozilla.org/show_bug.cgi?id=236791 */\r\n                    //input[0].setAttribute('autocomplete','off');\r\n                    input.attr('autocomplete','off');\r\n                    $(this).append(input);\r\n                    return(input);\r\n                }\r\n            },\r\n            textarea: {\r\n                element : function(settings, original) {\r\n                    var textarea = $('<textarea />');\r\n                    if (settings.rows) {\r\n                        textarea.attr('rows', settings.rows);\r\n                    } else if (settings.height != \"none\") {\r\n                        textarea.height(settings.height);\r\n                    }\r\n                    if (settings.cols) {\r\n                        textarea.attr('cols', settings.cols);\r\n                    } else if (settings.width != \"none\") {\r\n                        textarea.width(settings.width);\r\n                    }\r\n                    $(this).append(textarea);\r\n                    return(textarea);\r\n                }\r\n            },\r\n            select: {\r\n                element : function(settings, original) {\r\n                    var select = $('<select />');\r\n                    $(this).append(select);\r\n                    return(select);\r\n                },\r\n                content : function(data, settings, original) {\r\n                    /* If it is string assume it is json. */\r\n                    if (String == data.constructor) {\r\n                        eval ('var json = ' + data);\r\n                    } else {\r\n                        /* Otherwise assume it is a hash already. */\r\n                        var json = data;\r\n                    }\r\n                    for (var key in json) {\r\n                        if (!json.hasOwnProperty(key)) {\r\n                            continue;\r\n                        }\r\n                        if ('selected' == key) {\r\n                            continue;\r\n                        }\r\n                        var option = $('<option />').val(key).append(json[key]);\r\n                        $('select', this).append(option);\r\n                    }\r\n                    /* Loop option again to set selected. IE needed this... */\r\n                    $('select', this).children().each(function() {\r\n                        if ($(this).val() == json['selected'] ||\r\n                            $(this).text() == $.trim(original.revert)) {\r\n                            $(this).attr('selected', 'selected');\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        },\r\n\r\n        /* Add new input type */\r\n        addInputType: function(name, input) {\r\n            $.editable.types[name] = input;\r\n        }\r\n    };\r\n\r\n    // publicly accessible defaults\r\n    $.fn.editable.defaults = {\r\n        name       : 'value',\r\n        id         : 'id',\r\n        type       : 'text',\r\n        width      : 'auto',\r\n        height     : 'auto',\r\n        event      : 'click.editable',\r\n        onblur     : 'cancel',\r\n        loadtype   : 'GET',\r\n        loadtext   : 'Loading...',\r\n        placeholder: 'Click to edit',\r\n        loaddata   : {},\r\n        submitdata : {},\r\n        ajaxoptions: {}\r\n    };\r\n\r\n})(jQuery);\r\n","jquery/editableMultiselect/js/jquery.multiselect.js":"define([\r\n    \"jquery\"\r\n], function($){\r\n\r\n    /*\r\n     * jQuery.multiselect plugin\r\n     *\r\n     * Form control: allow select several values from list and add new value(s) to list\r\n     *\r\n     * Licensed under the BSD License:\r\n     *   http://www.opensource.org/licenses/bsd-license\r\n     *\r\n     * Version: 0.9.0\r\n     *\r\n     * @author Dmitry (dio) Levashov, dio@std42.ru\r\n     * @example\r\n     *  html: <select name=\"my-select\" multiple=\"on\"><option .... </select>\r\n     * js   : $('select[name=\"my-select\"]').multiselect()\r\n     *  or\r\n     * var opts = { ... };\r\n     * $('select[name=\"my-select\"]').multiselect(opts);\r\n     */\r\n    $.fn.multiselect = function(opts) {\r\n        var o = $.extend({\r\n            mselectHiddenClass: 'mselect-hidden',\r\n            mselectItemNotEditableClass: 'mselect-list-item-not-editable',\r\n            mselectItemNotRemovableClass: 'mselect-list-item-not-removable',\r\n            mselectListClass: 'mselect-list',\r\n            mselectItemsWrapperClass: 'mselect-items-wrapper',\r\n            mselectButtonAddClass: 'mselect-button-add',\r\n            mselectInputContainerClass: 'mselect-input-container',\r\n            mselectInputClass: 'mselect-input',\r\n            mselectButtonCancelClass: 'mselect-cancel',\r\n            mselectButtonSaveClass: 'mselect-save',\r\n            mselectListItemClass: 'mselect-list-item',\r\n            mselectItemsWrapperOverflowClass: 'mselect-fixed',\r\n            mselectDisabledClass: 'mselect-disabled',\r\n            mselectCheckedClass: 'mselect-checked',\r\n            layout: '<section class=\"block %mselectListClass%\">'\r\n                +'<div class=\"block-content\"><div class=\"%mselectItemsWrapperClass%\">'\r\n                +'%items%'\r\n                +'</div></div>'\r\n                +'<footer class=\"block-footer\">'\r\n                +'<span class=\"action-add %mselectButtonAddClass%\">%addText%</span>'\r\n                +'</footer>'\r\n                +'<div class=\"%mselectInputContainerClass%\">'\r\n                +'<input type=\"text\" class=\"%mselectInputClass%\" title=\"%inputTitle%\"/>'\r\n                +'<span class=\"%mselectButtonCancelClass%\" title=\"%cancelText%\"></span>'\r\n                +'<span class=\"%mselectButtonSaveClass%\" title=\"Add\"></span>'\r\n                +'</div>'\r\n                +'</section>',\r\n            item : '<div  class=\"%mselectListItemClass% %mselectDisabledClass% %iseditable% %isremovable%\"><label><input type=\"checkbox\" class=\"%mselectCheckedClass%\" value=\"%value%\" %checked% %disabled% /><span>%label%</span></label>' +\r\n                '<span class=\"mselect-edit\" title=\"Edit\">Edit</span>' +\r\n                '<span class=\"mselect-delete\" title=\"Delete\">Delete</span> ' +\r\n                '</div>',\r\n            addText: 'Add new value',\r\n            cancelText: 'Cancel',\r\n            inputTitle: 'Enter new option',\r\n            size: 5,\r\n            keyCodes: {\r\n                Enter: 13,\r\n                Esc: 27\r\n            },\r\n            toggleAddButton: true,\r\n            // New option for callback\r\n            mselectInputSubmitCallback: null,\r\n            parse : function(v) { return v.split(/\\s*,\\s*/); }\r\n        }, opts||{});\r\n\r\n        return this.filter('select[multiple]:not(.' + o.mselectHiddenClass + ')').each(function() {\r\n            var select = $(this).addClass(o.mselectHiddenClass).hide(),\r\n                size = select.attr('size') > 0 ? select.attr('size') : o.size,\r\n                items = (function() {\r\n                    var str = '';\r\n\r\n                    select.children('option').each(function(i, option) {\r\n                        option = $(option);\r\n\r\n                        str += o.item\r\n                            .replace(/%value%/gi,  option.val())\r\n                            .replace(/%checked%/gi, option.attr('selected') ? 'checked' : '')\r\n                            .replace(/%mselectCheckedClass%/gi, option.attr('selected') ? ''+o.mselectCheckedClass+'' : '')\r\n                            .replace(/%disabled%/gi, option.attr('disabled') ? 'disabled' : '')\r\n                            .replace(/%mselectDisabledClass%/gi, option.attr('disabled') ? ''+o.mselectDisabledClass+'' : '')\r\n                            .replace(/%mselectListItemClass%/gi, o.mselectListItemClass)\r\n                            .replace(/%iseditable%/gi, option.attr('data-is-editable') ? ''+o.mselectItemNotEditableClass+'' : '')\r\n                            .replace(/%isremovable%/i, option.attr('data-is-removable') ? ''+o.mselectItemNotRemovableClass+'' : '')\r\n                            .replace(/%label%/gi,  option.html());\r\n                    });\r\n\r\n                    return str;\r\n                })(),\r\n                html = o.layout\r\n                    .replace(/%items%/gi, items)\r\n                    .replace(/%mselectListClass%/gi, o.mselectListClass)\r\n                    .replace(/%mselectButtonAddClass%/gi, o.mselectButtonAddClass)\r\n                    .replace(/%mselectButtonSaveClass%/gi, o.mselectButtonSaveClass)\r\n                    .replace(/%mselectButtonCancelClass%/gi, o.mselectButtonCancelClass)\r\n                    .replace(/%mselectItemsWrapperClass%/gi, o.mselectItemsWrapperClass)\r\n                    .replace(/%mselectInputContainerClass%/gi, o.mselectInputContainerClass)\r\n                    .replace(/%mselectInputClass%/gi, o.mselectInputClass)\r\n                    .replace(/%addText%/gi, o.addText)\r\n                    .replace(/%cancelText%/gi, o.cancelText)\r\n                    .replace(/%inputTitle%/gi, o.inputTitle),\r\n                widget = $(html)\r\n                    .insertAfter(this)\r\n                    .on('change.mselectCheck', '[type=checkbox]', function() {\r\n                        var checkbox = $(this),\r\n                            index = checkbox.closest('.' + o.mselectListItemClass + '').index();\r\n\r\n                        select.find('option').eq(index).attr('selected', !!checkbox.attr('checked'));\r\n                    }),\r\n                list = widget.find('.' + o.mselectItemsWrapperClass + ''),\r\n                buttonAdd = widget.find('.' + o.mselectButtonAddClass + '')\r\n                    .on('click.mselectAdd', function(e) {\r\n                        e.preventDefault();\r\n                        o.toggleAddButton && buttonAdd.hide();\r\n                        container.show();\r\n                        input.focus();\r\n                        if (input.parents(o.mselectListClass).length) {\r\n                            list.scrollTop(list.height());\r\n                        }\r\n                    }),\r\n                container = widget.find('.' + o.mselectInputContainerClass + ''),\r\n                input = container.find('[type=text].' + o.mselectInputClass + '')\r\n                    .on('blur.mselectReset', function() {\r\n                        reset();\r\n                    })\r\n                    .on('keydown.mselectAddNewOption', function(e) {\r\n                        var c = e.keyCode;\r\n\r\n                        if (c == o.keyCodes.Enter || c == o.keyCodes.Esc) {\r\n                            e.preventDefault();\r\n                            c == o.keyCodes.Enter ? append(input.val())  : reset();\r\n                        }\r\n                    }),\r\n                buttonSave = container.find('.' + o.mselectButtonSaveClass + '')\r\n                    .on('mousedown.mselectSave', function(e) {\r\n                        append(input.val());\r\n                    }),\r\n                buttonCancel = container.find('.' + o.mselectButtonCancelClass + '')\r\n                    .on('mousedown.mdelectCancel', function(e) {\r\n                        input.val('');\r\n                    }),\r\n                append = function(v) {\r\n                    // Add ability to define custom handler for adding new values\r\n                    if ($.isFunction(o.mselectInputSubmitCallback)) {\r\n                        o.mselectInputSubmitCallback(v, o);\r\n                        return;\r\n                    }\r\n                    // end of callback implementation\r\n                    $.each(typeof(o.parse) == 'function' ? o.parse(v) : [$.trim(v)], function(i, v) {\r\n                        var item;\r\n\r\n                        if (v && !select.children('[value=\"' + v + '\"]').length) {\r\n                            item = $(o.item.replace(/%value%|%label%/gi, v)\r\n                                .replace(/%mselectDisabledClass%|%iseditable%|%isremovable%/gi,'')\r\n                                .replace(/%mselectListItemClass%/gi,o.mselectListItemClass))\r\n                                .find('[type=checkbox]')\r\n                                .attr('checked', true)\r\n                                .addClass(o.mselectCheckedClass)\r\n                                .end();\r\n\r\n                            list.children('.' + o.mselectListItemClass + '').length\r\n                                ? list.children('.' + o.mselectListItemClass + ':last').after(item)\r\n                                : list.prepend(item);\r\n\r\n                            select.append('<option value=\"' + v + '\" selected=\"selected\">' + v + '</option>');\r\n                        }\r\n                    });\r\n\r\n                    reset();\r\n                    list.scrollTop(list.height());\r\n                },\r\n                reset = function() {\r\n                    var ch = select.children();\r\n\r\n                    input.val('');\r\n                    container.hide();\r\n                    buttonAdd.show();\r\n                    list[list.children().length ? 'show' : 'hide']();\r\n\r\n                    if (ch.length >= size && !list.hasClass(o.mselectItemsWrapperOverflowClass)) {\r\n                        list.height(list.children('.' + o.mselectListItemClass + ':first')\r\n                            .outerHeight(true) * size)\r\n                            .addClass(o.mselectItemsWrapperOverflowClass);\r\n                    }\r\n                };\r\n            reset();\r\n        }).end();\r\n    };\r\n});","jquery/fileUploader/jquery.fileupload-fp.js":"/*\r\n * jQuery File Upload File Processing Plugin 1.0\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2012, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*jslint nomen: true, unparam: true, regexp: true */\r\n/*global define, window, document */\r\n\r\n(function (factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        // Register as an anonymous AMD module:\r\n        define([\r\n            'jquery',\r\n            'jquery/fileUploader/load-image',\r\n            'jquery/fileUploader/canvas-to-blob',\r\n            'jquery/fileUploader/jquery.fileupload'\r\n        ], factory);\r\n    } else {\r\n        // Browser globals:\r\n        factory(\r\n            window.jQuery,\r\n            window.loadImage\r\n        );\r\n    }\r\n}(function ($, loadImage) {\r\n    'use strict';\r\n\r\n    // The File Upload IP version extends the basic fileupload widget\r\n    // with file processing functionality:\r\n    $.widget('blueimpFP.fileupload', $.blueimp.fileupload, {\r\n\r\n        options: {\r\n            // The list of file processing actions:\r\n            process: [\r\n            /*\r\n                {\r\n                    action: 'load',\r\n                    fileTypes: /^image\\/(gif|jpeg|png)$/,\r\n                    maxFileSize: 20000000 // 20MB\r\n                },\r\n                {\r\n                    action: 'resize',\r\n                    maxWidth: 1920,\r\n                    maxHeight: 1200,\r\n                    minWidth: 800,\r\n                    minHeight: 600\r\n                },\r\n                {\r\n                    action: 'save'\r\n                }\r\n            */\r\n            ],\r\n\r\n            // The add callback is invoked as soon as files are added to the\r\n            // fileupload widget (via file input selection, drag & drop or add\r\n            // API call). See the basic file upload widget for more information:\r\n            add: function (e, data) {\r\n                $(this).fileupload('process', data).done(function () {\r\n                    data.submit();\r\n                });\r\n            }\r\n        },\r\n\r\n        processActions: {\r\n            // Loads the image given via data.files and data.index\r\n            // as canvas element.\r\n            // Accepts the options fileTypes (regular expression)\r\n            // and maxFileSize (integer) to limit the files to load:\r\n            load: function (data, options) {\r\n                var that = this,\r\n                    file = data.files[data.index],\r\n                    dfd = $.Deferred();\r\n                if (window.HTMLCanvasElement &&\r\n                        window.HTMLCanvasElement.prototype.toBlob &&\r\n                        ($.type(options.maxFileSize) !== 'number' ||\r\n                            file.size < options.maxFileSize) &&\r\n                        (!options.fileTypes ||\r\n                            options.fileTypes.test(file.type))) {\r\n                    loadImage(\r\n                        file,\r\n                        function (canvas) {\r\n                            data.canvas = canvas;\r\n                            dfd.resolveWith(that, [data]);\r\n                        },\r\n                        {canvas: true}\r\n                    );\r\n                } else {\r\n                    dfd.rejectWith(that, [data]);\r\n                }\r\n                return dfd.promise();\r\n            },\r\n            // Resizes the image given as data.canvas and updates\r\n            // data.canvas with the resized image.\r\n            // Accepts the options maxWidth, maxHeight, minWidth and\r\n            // minHeight to scale the given image:\r\n            resize: function (data, options) {\r\n                if (data.canvas) {\r\n                    var canvas = loadImage.scale(data.canvas, options);\r\n                    if (canvas.width !== data.canvas.width ||\r\n                            canvas.height !== data.canvas.height) {\r\n                        data.canvas = canvas;\r\n                        data.processed = true;\r\n                    }\r\n                }\r\n                return data;\r\n            },\r\n            // Saves the processed image given as data.canvas\r\n            // inplace at data.index of data.files:\r\n            save: function (data, options) {\r\n                // Do nothing if no processing has happened:\r\n                if (!data.canvas || !data.processed) {\r\n                    return data;\r\n                }\r\n                var that = this,\r\n                    file = data.files[data.index],\r\n                    name = file.name,\r\n                    dfd = $.Deferred(),\r\n                    callback = function (blob) {\r\n                        if (!blob.name) {\r\n                            if (file.type === blob.type) {\r\n                                blob.name = file.name;\r\n                            } else if (file.name) {\r\n                                blob.name = file.name.replace(\r\n                                    /\\..+$/,\r\n                                    '.' + blob.type.substr(6)\r\n                                );\r\n                            }\r\n                        }\r\n                        // Store the created blob at the position\r\n                        // of the original file in the files list:\r\n                        data.files[data.index] = blob;\r\n                        dfd.resolveWith(that, [data]);\r\n                    };\r\n                // Use canvas.mozGetAsFile directly, to retain the filename, as\r\n                // Gecko doesn't support the filename option for FormData.append:\r\n                if (data.canvas.mozGetAsFile) {\r\n                    callback(data.canvas.mozGetAsFile(\r\n                        (/^image\\/(jpeg|png)$/.test(file.type) && name) ||\r\n                            ((name && name.replace(/\\..+$/, '')) ||\r\n                                'blob') + '.png',\r\n                        file.type\r\n                    ));\r\n                } else {\r\n                    data.canvas.toBlob(callback, file.type);\r\n                }\r\n                return dfd.promise();\r\n            }\r\n        },\r\n\r\n        // Resizes the file at the given index and stores the created blob at\r\n        // the original position of the files list, returns a Promise object:\r\n        _processFile: function (files, index, options) {\r\n            var that = this,\r\n                dfd = $.Deferred().resolveWith(that, [{\r\n                    files: files,\r\n                    index: index\r\n                }]),\r\n                chain = dfd.promise();\r\n            that._processing += 1;\r\n            $.each(options.process, function (i, settings) {\r\n                chain = chain.pipe(function (data) {\r\n                    return that.processActions[settings.action]\r\n                        .call(this, data, settings);\r\n                });\r\n            });\r\n            chain.always(function () {\r\n                that._processing -= 1;\r\n                if (that._processing === 0) {\r\n                    that.element\r\n                        .removeClass('fileupload-processing');\r\n                }\r\n            });\r\n            if (that._processing === 1) {\r\n                that.element.addClass('fileupload-processing');\r\n            }\r\n            return chain;\r\n        },\r\n\r\n        // Processes the files given as files property of the data parameter,\r\n        // returns a Promise object that allows to bind a done handler, which\r\n        // will be invoked after processing all files (inplace) is done:\r\n        process: function (data) {\r\n            var that = this,\r\n                options = $.extend({}, this.options, data);\r\n            if (options.process && options.process.length &&\r\n                    this._isXHRUpload(options)) {\r\n                $.each(data.files, function (index, file) {\r\n                    that._processingQueue = that._processingQueue.pipe(\r\n                        function () {\r\n                            var dfd = $.Deferred();\r\n                            that._processFile(data.files, index, options)\r\n                                .always(function () {\r\n                                    dfd.resolveWith(that);\r\n                                });\r\n                            return dfd.promise();\r\n                        }\r\n                    );\r\n                });\r\n            }\r\n            return this._processingQueue;\r\n        },\r\n\r\n        _create: function () {\r\n            $.blueimp.fileupload.prototype._create.call(this);\r\n            this._processing = 0;\r\n            this._processingQueue = $.Deferred().resolveWith(this)\r\n                .promise();\r\n        }\r\n\r\n    });\r\n\r\n}));\r\n","jquery/fileUploader/jquery.fileupload-ui.js":"/*\r\n * jQuery File Upload User Interface Plugin 6.9.5\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2010, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*jslint nomen: true, unparam: true, regexp: true */\r\n/*global define, window, document, URL, webkitURL, FileReader */\r\n\r\n(function (factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        // Register as an anonymous AMD module:\r\n        define([\r\n            'jquery',\r\n            'mage/template',\r\n            'jquery/fileUploader/load-image',\r\n            'jquery/fileUploader/jquery.fileupload-fp',\r\n            'jquery/fileUploader/jquery.iframe-transport'\r\n        ], factory);\r\n    } else {\r\n        // Browser globals:\r\n        factory(\r\n            window.jQuery,\r\n            window.mageTemplate,\r\n            window.loadImage\r\n        );\r\n    }\r\n}(function ($, tmpl, loadImage) {\r\n    'use strict';\r\n\r\n    // The UI version extends the FP (file processing) version or the basic\r\n    // file upload widget and adds complete user interface interaction:\r\n    var parentWidget = ($.blueimpFP || $.blueimp).fileupload;\r\n    $.widget('blueimpUI.fileupload', parentWidget, {\r\n\r\n        options: {\r\n            // By default, files added to the widget are uploaded as soon\r\n            // as the user clicks on the start buttons. To enable automatic\r\n            // uploads, set the following option to true:\r\n            autoUpload: false,\r\n            // The following option limits the number of files that are\r\n            // allowed to be uploaded using this widget:\r\n            maxNumberOfFiles: undefined,\r\n            // The maximum allowed file size:\r\n            maxFileSize: undefined,\r\n            // The minimum allowed file size:\r\n            minFileSize: undefined,\r\n            // The regular expression for allowed file types, matches\r\n            // against either file type or file name:\r\n            acceptFileTypes:  /.+$/i,\r\n            // The regular expression to define for which files a preview\r\n            // image is shown, matched against the file type:\r\n            previewSourceFileTypes: /^image\\/(gif|jpeg|png)$/,\r\n            // The maximum file size of images that are to be displayed as preview:\r\n            previewSourceMaxFileSize: 5000000, // 5MB\r\n            // The maximum width of the preview images:\r\n            previewMaxWidth: 80,\r\n            // The maximum height of the preview images:\r\n            previewMaxHeight: 80,\r\n            // By default, preview images are displayed as canvas elements\r\n            // if supported by the browser. Set the following option to false\r\n            // to always display preview images as img elements:\r\n            previewAsCanvas: true,\r\n            // The ID of the upload template:\r\n            uploadTemplateId: 'template-upload',\r\n            // The ID of the download template:\r\n            downloadTemplateId: 'template-download',\r\n            // The container for the list of files. If undefined, it is set to\r\n            // an element with class \"files\" inside of the widget element:\r\n            filesContainer: undefined,\r\n            // By default, files are appended to the files container.\r\n            // Set the following option to true, to prepend files instead:\r\n            prependFiles: false,\r\n            // The expected data type of the upload response, sets the dataType\r\n            // option of the $.ajax upload requests:\r\n            dataType: 'json',\r\n\r\n            // The add callback is invoked as soon as files are added to the fileupload\r\n            // widget (via file input selection, drag & drop or add API call).\r\n            // See the basic file upload widget for more information:\r\n            add: function (e, data) {\r\n                var that = $(this).data('fileupload'),\r\n                    options = that.options,\r\n                    files = data.files;\r\n                $(this).fileupload('process', data).done(function () {\r\n                    that._adjustMaxNumberOfFiles(-files.length);\r\n                    data.maxNumberOfFilesAdjusted = true;\r\n                    data.files.valid = data.isValidated = that._validate(files);\r\n                    data.context = that._renderUpload(files).data('data', data);\r\n                    options.filesContainer[\r\n                        options.prependFiles ? 'prepend' : 'append'\r\n                    ](data.context);\r\n                    that._renderPreviews(files, data.context);\r\n                    that._forceReflow(data.context);\r\n                    that._transition(data.context).done(\r\n                        function () {\r\n                            if ((that._trigger('added', e, data) !== false) &&\r\n                                    (options.autoUpload || data.autoUpload) &&\r\n                                    data.autoUpload !== false && data.isValidated) {\r\n                                data.submit();\r\n                            }\r\n                        }\r\n                    );\r\n                });\r\n            },\r\n            // Callback for the start of each file upload request:\r\n            send: function (e, data) {\r\n                var that = $(this).data('fileupload');\r\n                if (!data.isValidated) {\r\n                    if (!data.maxNumberOfFilesAdjusted) {\r\n                        that._adjustMaxNumberOfFiles(-data.files.length);\r\n                        data.maxNumberOfFilesAdjusted = true;\r\n                    }\r\n                    if (!that._validate(data.files)) {\r\n                        return false;\r\n                    }\r\n                }\r\n                if (data.context && data.dataType &&\r\n                        data.dataType.substr(0, 6) === 'iframe') {\r\n                    // Iframe Transport does not support progress events.\r\n                    // In lack of an indeterminate progress bar, we set\r\n                    // the progress to 100%, showing the full animated bar:\r\n                    data.context\r\n                        .find('.progress').addClass(\r\n                            !$.support.transition && 'progress-animated'\r\n                        )\r\n                        .attr('aria-valuenow', 100)\r\n                        .find('.bar').css(\r\n                            'width',\r\n                            '100%'\r\n                        );\r\n                }\r\n                return that._trigger('sent', e, data);\r\n            },\r\n            // Callback for successful uploads:\r\n            done: function (e, data) {\r\n                var that = $(this).data('fileupload'),\r\n                    template;\r\n                if (data.context) {\r\n                    data.context.each(function (index) {\r\n                        var file = ($.isArray(data.result) &&\r\n                                data.result[index]) || {error: 'emptyResult'};\r\n                        if (file.error) {\r\n                            that._adjustMaxNumberOfFiles(1);\r\n                        }\r\n                        that._transition($(this)).done(\r\n                            function () {\r\n                                var node = $(this);\r\n                                template = that._renderDownload([file])\r\n                                    .replaceAll(node);\r\n                                that._forceReflow(template);\r\n                                that._transition(template).done(\r\n                                    function () {\r\n                                        data.context = $(this);\r\n                                        that._trigger('completed', e, data);\r\n                                    }\r\n                                );\r\n                            }\r\n                        );\r\n                    });\r\n                } else {\r\n                    if ($.isArray(data.result)) {\r\n                        $.each(data.result, function (index, file) {\r\n                            if (data.maxNumberOfFilesAdjusted && file.error) {\r\n                                that._adjustMaxNumberOfFiles(1);\r\n                            } else if (!data.maxNumberOfFilesAdjusted &&\r\n                                    !file.error) {\r\n                                that._adjustMaxNumberOfFiles(-1);\r\n                            }\r\n                        });\r\n                        data.maxNumberOfFilesAdjusted = true;\r\n                    }\r\n                    template = that._renderDownload(data.result)\r\n                        .appendTo(that.options.filesContainer);\r\n                    that._forceReflow(template);\r\n                    that._transition(template).done(\r\n                        function () {\r\n                            data.context = $(this);\r\n                            that._trigger('completed', e, data);\r\n                        }\r\n                    );\r\n                }\r\n            },\r\n            // Callback for failed (abort or error) uploads:\r\n            fail: function (e, data) {\r\n                var that = $(this).data('fileupload'),\r\n                    template;\r\n                if (data.maxNumberOfFilesAdjusted) {\r\n                    that._adjustMaxNumberOfFiles(data.files.length);\r\n                }\r\n                if (data.context) {\r\n                    data.context.each(function (index) {\r\n                        if (data.errorThrown !== 'abort') {\r\n                            var file = data.files[index];\r\n                            file.error = file.error || data.errorThrown ||\r\n                                true;\r\n                            that._transition($(this)).done(\r\n                                function () {\r\n                                    var node = $(this);\r\n                                    template = that._renderDownload([file])\r\n                                        .replaceAll(node);\r\n                                    that._forceReflow(template);\r\n                                    that._transition(template).done(\r\n                                        function () {\r\n                                            data.context = $(this);\r\n                                            that._trigger('failed', e, data);\r\n                                        }\r\n                                    );\r\n                                }\r\n                            );\r\n                        } else {\r\n                            that._transition($(this)).done(\r\n                                function () {\r\n                                    $(this).remove();\r\n                                    that._trigger('failed', e, data);\r\n                                }\r\n                            );\r\n                        }\r\n                    });\r\n                } else if (data.errorThrown !== 'abort') {\r\n                    data.context = that._renderUpload(data.files)\r\n                        .appendTo(that.options.filesContainer)\r\n                        .data('data', data);\r\n                    that._forceReflow(data.context);\r\n                    that._transition(data.context).done(\r\n                        function () {\r\n                            data.context = $(this);\r\n                            that._trigger('failed', e, data);\r\n                        }\r\n                    );\r\n                } else {\r\n                    that._trigger('failed', e, data);\r\n                }\r\n            },\r\n            // Callback for upload progress events:\r\n            progress: function (e, data) {\r\n                if (data.context) {\r\n                    var progress = parseInt(data.loaded / data.total * 100, 10);\r\n                    data.context.find('.progress')\r\n                        .attr('aria-valuenow', progress)\r\n                        .find('.bar').css(\r\n                            'width',\r\n                            progress + '%'\r\n                        );\r\n                }\r\n            },\r\n            // Callback for global upload progress events:\r\n            progressall: function (e, data) {\r\n                var $this = $(this),\r\n                    progress = parseInt(data.loaded / data.total * 100, 10),\r\n                    globalProgressNode = $this.find('.fileupload-progress'),\r\n                    extendedProgressNode = globalProgressNode\r\n                        .find('.progress-extended');\r\n                if (extendedProgressNode.length) {\r\n                    extendedProgressNode.html(\r\n                        $this.data('fileupload')._renderExtendedProgress(data)\r\n                    );\r\n                }\r\n                globalProgressNode\r\n                    .find('.progress')\r\n                    .attr('aria-valuenow', progress)\r\n                    .find('.bar').css(\r\n                        'width',\r\n                        progress + '%'\r\n                    );\r\n            },\r\n            // Callback for uploads start, equivalent to the global ajaxStart event:\r\n            start: function (e) {\r\n                var that = $(this).data('fileupload');\r\n                that._transition($(this).find('.fileupload-progress')).done(\r\n                    function () {\r\n                        that._trigger('started', e);\r\n                    }\r\n                );\r\n            },\r\n            // Callback for uploads stop, equivalent to the global ajaxStop event:\r\n            stop: function (e) {\r\n                var that = $(this).data('fileupload');\r\n                that._transition($(this).find('.fileupload-progress')).done(\r\n                    function () {\r\n                        $(this).find('.progress')\r\n                            .attr('aria-valuenow', '0')\r\n                            .find('.bar').css('width', '0%');\r\n                        $(this).find('.progress-extended').html('&nbsp;');\r\n                        that._trigger('stopped', e);\r\n                    }\r\n                );\r\n            },\r\n            // Callback for file deletion:\r\n            destroy: function (e, data) {\r\n                var that = $(this).data('fileupload');\r\n                if (data.url) {\r\n                    $.ajax(data);\r\n                    that._adjustMaxNumberOfFiles(1);\r\n                }\r\n                that._transition(data.context).done(\r\n                    function () {\r\n                        $(this).remove();\r\n                        that._trigger('destroyed', e, data);\r\n                    }\r\n                );\r\n            }\r\n        },\r\n\r\n        // Link handler, that allows to download files\r\n        // by drag & drop of the links to the desktop:\r\n        _enableDragToDesktop: function () {\r\n            var link = $(this),\r\n                url = link.prop('href'),\r\n                name = link.prop('download'),\r\n                type = 'application/octet-stream';\r\n            link.bind('dragstart', function (e) {\r\n                try {\r\n                    e.originalEvent.dataTransfer.setData(\r\n                        'DownloadURL',\r\n                        [type, name, url].join(':')\r\n                    );\r\n                } catch (err) {}\r\n            });\r\n        },\r\n\r\n        _adjustMaxNumberOfFiles: function (operand) {\r\n            if (typeof this.options.maxNumberOfFiles === 'number') {\r\n                this.options.maxNumberOfFiles += operand;\r\n                if (this.options.maxNumberOfFiles < 1) {\r\n                    this._disableFileInputButton();\r\n                } else {\r\n                    this._enableFileInputButton();\r\n                }\r\n            }\r\n        },\r\n\r\n        _formatFileSize: function (bytes) {\r\n            if (typeof bytes !== 'number') {\r\n                return '';\r\n            }\r\n            if (bytes >= 1000000000) {\r\n                return (bytes / 1000000000).toFixed(2) + ' GB';\r\n            }\r\n            if (bytes >= 1000000) {\r\n                return (bytes / 1000000).toFixed(2) + ' MB';\r\n            }\r\n            return (bytes / 1000).toFixed(2) + ' KB';\r\n        },\r\n\r\n        _formatBitrate: function (bits) {\r\n            if (typeof bits !== 'number') {\r\n                return '';\r\n            }\r\n            if (bits >= 1000000000) {\r\n                return (bits / 1000000000).toFixed(2) + ' Gbit/s';\r\n            }\r\n            if (bits >= 1000000) {\r\n                return (bits / 1000000).toFixed(2) + ' Mbit/s';\r\n            }\r\n            if (bits >= 1000) {\r\n                return (bits / 1000).toFixed(2) + ' kbit/s';\r\n            }\r\n            return bits + ' bit/s';\r\n        },\r\n\r\n        _formatTime: function (seconds) {\r\n            var date = new Date(seconds * 1000),\r\n                days = parseInt(seconds / 86400, 10);\r\n            days = days ? days + 'd ' : '';\r\n            return days +\r\n                ('0' + date.getUTCHours()).slice(-2) + ':' +\r\n                ('0' + date.getUTCMinutes()).slice(-2) + ':' +\r\n                ('0' + date.getUTCSeconds()).slice(-2);\r\n        },\r\n\r\n        _formatPercentage: function (floatValue) {\r\n            return (floatValue * 100).toFixed(2) + ' %';\r\n        },\r\n\r\n        _renderExtendedProgress: function (data) {\r\n            return this._formatBitrate(data.bitrate) + ' | ' +\r\n                this._formatTime(\r\n                    (data.total - data.loaded) * 8 / data.bitrate\r\n                ) + ' | ' +\r\n                this._formatPercentage(\r\n                    data.loaded / data.total\r\n                ) + ' | ' +\r\n                this._formatFileSize(data.loaded) + ' / ' +\r\n                this._formatFileSize(data.total);\r\n        },\r\n\r\n        _hasError: function (file) {\r\n            if (file.error) {\r\n                return file.error;\r\n            }\r\n            // The number of added files is subtracted from\r\n            // maxNumberOfFiles before validation, so we check if\r\n            // maxNumberOfFiles is below 0 (instead of below 1):\r\n            if (this.options.maxNumberOfFiles < 0) {\r\n                return 'maxNumberOfFiles';\r\n            }\r\n            // Files are accepted if either the file type or the file name\r\n            // matches against the acceptFileTypes regular expression, as\r\n            // only browsers with support for the File API report the type:\r\n            if (!(this.options.acceptFileTypes.test(file.type) ||\r\n                    this.options.acceptFileTypes.test(file.name))) {\r\n                return 'acceptFileTypes';\r\n            }\r\n            if (this.options.maxFileSize &&\r\n                    file.size > this.options.maxFileSize) {\r\n                return 'maxFileSize';\r\n            }\r\n            if (typeof file.size === 'number' &&\r\n                    file.size < this.options.minFileSize) {\r\n                return 'minFileSize';\r\n            }\r\n            return null;\r\n        },\r\n\r\n        _validate: function (files) {\r\n            var that = this,\r\n                valid = !!files.length;\r\n            $.each(files, function (index, file) {\r\n                file.error = that._hasError(file);\r\n                if (file.error) {\r\n                    valid = false;\r\n                }\r\n            });\r\n            return valid;\r\n        },\r\n\r\n        _renderTemplate: function (func, files) {\r\n            if (!func) {\r\n                return $();\r\n            }\r\n            var result = func({\r\n                files: files,\r\n                formatFileSize: this._formatFileSize,\r\n                options: this.options\r\n            });\r\n            if (result instanceof $) {\r\n                return result;\r\n            }\r\n            return $(this.options.templatesContainer).html(result).children();\r\n        },\r\n\r\n        _renderPreview: function (file, node) {\r\n            var that = this,\r\n                options = this.options,\r\n                dfd = $.Deferred();\r\n            return ((loadImage && loadImage(\r\n                file,\r\n                function (img) {\r\n                    node.append(img);\r\n                    that._forceReflow(node);\r\n                    that._transition(node).done(function () {\r\n                        dfd.resolveWith(node);\r\n                    });\r\n                    if (!$.contains(document.body, node[0])) {\r\n                        // If the element is not part of the DOM,\r\n                        // transition events are not triggered,\r\n                        // so we have to resolve manually:\r\n                        dfd.resolveWith(node);\r\n                    }\r\n                },\r\n                {\r\n                    maxWidth: options.previewMaxWidth,\r\n                    maxHeight: options.previewMaxHeight,\r\n                    canvas: options.previewAsCanvas\r\n                }\r\n            )) || dfd.resolveWith(node)) && dfd;\r\n        },\r\n\r\n        _renderPreviews: function (files, nodes) {\r\n            var that = this,\r\n                options = this.options;\r\n            nodes.find('.preview span').each(function (index, element) {\r\n                var file = files[index];\r\n                if (options.previewSourceFileTypes.test(file.type) &&\r\n                        ($.type(options.previewSourceMaxFileSize) !== 'number' ||\r\n                        file.size < options.previewSourceMaxFileSize)) {\r\n                    that._processingQueue = that._processingQueue.pipe(function () {\r\n                        var dfd = $.Deferred();\r\n                        that._renderPreview(file, $(element)).done(\r\n                            function () {\r\n                                dfd.resolveWith(that);\r\n                            }\r\n                        );\r\n                        return dfd.promise();\r\n                    });\r\n                }\r\n            });\r\n            return this._processingQueue;\r\n        },\r\n\r\n        _renderUpload: function (files) {\r\n            return this._renderTemplate(\r\n                this.options.uploadTemplate,\r\n                files\r\n            );\r\n        },\r\n\r\n        _renderDownload: function (files) {\r\n            return this._renderTemplate(\r\n                this.options.downloadTemplate,\r\n                files\r\n            ).find('a[download]').each(this._enableDragToDesktop).end();\r\n        },\r\n\r\n        _startHandler: function (e) {\r\n            e.preventDefault();\r\n            var button = $(this),\r\n                template = button.closest('.template-upload'),\r\n                data = template.data('data');\r\n            if (data && data.submit && !data.jqXHR && data.submit()) {\r\n                button.prop('disabled', true);\r\n            }\r\n        },\r\n\r\n        _cancelHandler: function (e) {\r\n            e.preventDefault();\r\n            var template = $(this).closest('.template-upload'),\r\n                data = template.data('data') || {};\r\n            if (!data.jqXHR) {\r\n                data.errorThrown = 'abort';\r\n                e.data.fileupload._trigger('fail', e, data);\r\n            } else {\r\n                data.jqXHR.abort();\r\n            }\r\n        },\r\n\r\n        _deleteHandler: function (e) {\r\n            e.preventDefault();\r\n            var button = $(this);\r\n            e.data.fileupload._trigger('destroy', e, {\r\n                context: button.closest('.template-download'),\r\n                url: button.attr('data-url'),\r\n                type: button.attr('data-type') || 'DELETE',\r\n                dataType: e.data.fileupload.options.dataType\r\n            });\r\n        },\r\n\r\n        _forceReflow: function (node) {\r\n            return $.support.transition && node.length &&\r\n                node[0].offsetWidth;\r\n        },\r\n\r\n        _transition: function (node) {\r\n            var dfd = $.Deferred();\r\n            if ($.support.transition && node.hasClass('fade')) {\r\n                node.bind(\r\n                    $.support.transition.end,\r\n                    function (e) {\r\n                        // Make sure we don't respond to other transitions events\r\n                        // in the container element, e.g. from button elements:\r\n                        if (e.target === node[0]) {\r\n                            node.unbind($.support.transition.end);\r\n                            dfd.resolveWith(node);\r\n                        }\r\n                    }\r\n                ).toggleClass('in');\r\n            } else {\r\n                node.toggleClass('in');\r\n                dfd.resolveWith(node);\r\n            }\r\n            return dfd;\r\n        },\r\n\r\n        _initButtonBarEventHandlers: function () {\r\n            var fileUploadButtonBar = this.element.find('.fileupload-buttonbar'),\r\n                filesList = this.options.filesContainer,\r\n                ns = this.options.namespace;\r\n            fileUploadButtonBar.find('.start')\r\n                .bind('click.' + ns, function (e) {\r\n                    e.preventDefault();\r\n                    filesList.find('.start button').click();\r\n                });\r\n            fileUploadButtonBar.find('.cancel')\r\n                .bind('click.' + ns, function (e) {\r\n                    e.preventDefault();\r\n                    filesList.find('.cancel button').click();\r\n                });\r\n            fileUploadButtonBar.find('.delete')\r\n                .bind('click.' + ns, function (e) {\r\n                    e.preventDefault();\r\n                    filesList.find('.delete input:checked')\r\n                        .siblings('button').click();\r\n                    fileUploadButtonBar.find('.toggle')\r\n                        .prop('checked', false);\r\n                });\r\n            fileUploadButtonBar.find('.toggle')\r\n                .bind('change.' + ns, function (e) {\r\n                    filesList.find('.delete input').prop(\r\n                        'checked',\r\n                        $(this).is(':checked')\r\n                    );\r\n                });\r\n        },\r\n\r\n        _destroyButtonBarEventHandlers: function () {\r\n            this.element.find('.fileupload-buttonbar button')\r\n                .unbind('click.' + this.options.namespace);\r\n            this.element.find('.fileupload-buttonbar .toggle')\r\n                .unbind('change.' + this.options.namespace);\r\n        },\r\n\r\n        _initEventHandlers: function () {\r\n            parentWidget.prototype._initEventHandlers.call(this);\r\n            var eventData = {fileupload: this};\r\n            this.options.filesContainer\r\n                .delegate(\r\n                    '.start button',\r\n                    'click.' + this.options.namespace,\r\n                    eventData,\r\n                    this._startHandler\r\n                )\r\n                .delegate(\r\n                    '.cancel button',\r\n                    'click.' + this.options.namespace,\r\n                    eventData,\r\n                    this._cancelHandler\r\n                )\r\n                .delegate(\r\n                    '.delete button',\r\n                    'click.' + this.options.namespace,\r\n                    eventData,\r\n                    this._deleteHandler\r\n                );\r\n            this._initButtonBarEventHandlers();\r\n        },\r\n\r\n        _destroyEventHandlers: function () {\r\n            var options = this.options;\r\n            this._destroyButtonBarEventHandlers();\r\n            options.filesContainer\r\n                .undelegate('.start button', 'click.' + options.namespace)\r\n                .undelegate('.cancel button', 'click.' + options.namespace)\r\n                .undelegate('.delete button', 'click.' + options.namespace);\r\n            parentWidget.prototype._destroyEventHandlers.call(this);\r\n        },\r\n\r\n        _enableFileInputButton: function () {\r\n            this.element.find('.fileinput-button input')\r\n                .prop('disabled', false)\r\n                .parent().removeClass('disabled');\r\n        },\r\n\r\n        _disableFileInputButton: function () {\r\n            this.element.find('.fileinput-button input')\r\n                .prop('disabled', true)\r\n                .parent().addClass('disabled');\r\n        },\r\n\r\n        _initTemplates: function () {\r\n            var options = this.options;\r\n            options.templatesContainer = document.createElement(\r\n                options.filesContainer.prop('nodeName')\r\n            );\r\n            if (tmpl) {\r\n                if (options.uploadTemplateId) {\r\n                    options.uploadTemplate = tmpl(options.uploadTemplateId);\r\n                }\r\n                if (options.downloadTemplateId) {\r\n                    options.downloadTemplate = tmpl(options.downloadTemplateId);\r\n                }\r\n            }\r\n        },\r\n\r\n        _initFilesContainer: function () {\r\n            var options = this.options;\r\n            if (options.filesContainer === undefined) {\r\n                options.filesContainer = this.element.find('.files');\r\n            } else if (!(options.filesContainer instanceof $)) {\r\n                options.filesContainer = $(options.filesContainer);\r\n            }\r\n        },\r\n\r\n        _stringToRegExp: function (str) {\r\n            var parts = str.split('/'),\r\n                modifiers = parts.pop();\r\n            parts.shift();\r\n            return new RegExp(parts.join('/'), modifiers);\r\n        },\r\n\r\n        _initRegExpOptions: function () {\r\n            var options = this.options;\r\n            if ($.type(options.acceptFileTypes) === 'string') {\r\n                options.acceptFileTypes = this._stringToRegExp(\r\n                    options.acceptFileTypes\r\n                );\r\n            }\r\n            if ($.type(options.previewSourceFileTypes) === 'string') {\r\n                options.previewSourceFileTypes = this._stringToRegExp(\r\n                    options.previewSourceFileTypes\r\n                );\r\n            }\r\n        },\r\n\r\n        _initSpecialOptions: function () {\r\n            parentWidget.prototype._initSpecialOptions.call(this);\r\n            this._initFilesContainer();\r\n            this._initTemplates();\r\n            this._initRegExpOptions();\r\n        },\r\n\r\n        _create: function () {\r\n            parentWidget.prototype._create.call(this);\r\n            this._refreshOptionsList.push(\r\n                'filesContainer',\r\n                'uploadTemplateId',\r\n                'downloadTemplateId'\r\n            );\r\n            if (!$.blueimpFP) {\r\n                this._processingQueue = $.Deferred().resolveWith(this).promise();\r\n                this.process = function () {\r\n                    return this._processingQueue;\r\n                };\r\n            }\r\n        },\r\n\r\n        enable: function () {\r\n            var wasDisabled = false;\r\n            if (this.options.disabled) {\r\n                wasDisabled = true;\r\n            }\r\n            parentWidget.prototype.enable.call(this);\r\n            if (wasDisabled) {\r\n                this.element.find('input, button').prop('disabled', false);\r\n                this._enableFileInputButton();\r\n            }\r\n        },\r\n\r\n        disable: function () {\r\n            if (!this.options.disabled) {\r\n                this.element.find('input, button').prop('disabled', true);\r\n                this._disableFileInputButton();\r\n            }\r\n            parentWidget.prototype.disable.call(this);\r\n        }\r\n\r\n    });\r\n\r\n}));\r\n","jquery/fileUploader/jquery.fileupload.js":"/*\r\n * jQuery File Upload Plugin 5.16.4\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2010, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*jslint nomen: true, unparam: true, regexp: true */\r\n/*global define, window, document, Blob, FormData, location */\r\n\r\n(function (factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        // Register as an anonymous AMD module:\r\n        define([\r\n            'jquery',\r\n            'jquery/ui',\r\n            'jquery/fileUploader/jquery.iframe-transport'\r\n        ], factory);\r\n    } else {\r\n        // Browser globals:\r\n        factory(window.jQuery);\r\n    }\r\n}(function ($) {\r\n    'use strict';\r\n\r\n    // The FileReader API is not actually used, but works as feature detection,\r\n    // as e.g. Safari supports XHR file uploads via the FormData API,\r\n    // but not non-multipart XHR file uploads:\r\n    $.support.xhrFileUpload = !!(window.XMLHttpRequestUpload && window.FileReader);\r\n    $.support.xhrFormDataFileUpload = !!window.FormData;\r\n\r\n    // The fileupload widget listens for change events on file input fields defined\r\n    // via fileInput setting and paste or drop events of the given dropZone.\r\n    // In addition to the default jQuery Widget methods, the fileupload widget\r\n    // exposes the \"add\" and \"send\" methods, to add or directly send files using\r\n    // the fileupload API.\r\n    // By default, files added via file input selection, paste, drag & drop or\r\n    // \"add\" method are uploaded immediately, but it is possible to override\r\n    // the \"add\" callback option to queue file uploads.\r\n    $.widget('blueimp.fileupload', {\r\n\r\n        options: {\r\n            // The namespace used for event handler binding on the dropZone and\r\n            // fileInput collections.\r\n            // If not set, the name of the widget (\"fileupload\") is used.\r\n            namespace: undefined,\r\n            // The drop target collection, by the default the complete document.\r\n            // Set to null or an empty collection to disable drag & drop support:\r\n            dropZone: $(document),\r\n            // The file input field collection, that is listened for change events.\r\n            // If undefined, it is set to the file input fields inside\r\n            // of the widget element on plugin initialization.\r\n            // Set to null or an empty collection to disable the change listener.\r\n            fileInput: undefined,\r\n            // By default, the file input field is replaced with a clone after\r\n            // each input field change event. This is required for iframe transport\r\n            // queues and allows change events to be fired for the same file\r\n            // selection, but can be disabled by setting the following option to false:\r\n            replaceFileInput: true,\r\n            // The parameter name for the file form data (the request argument name).\r\n            // If undefined or empty, the name property of the file input field is\r\n            // used, or \"files[]\" if the file input name property is also empty,\r\n            // can be a string or an array of strings:\r\n            paramName: undefined,\r\n            // By default, each file of a selection is uploaded using an individual\r\n            // request for XHR type uploads. Set to false to upload file\r\n            // selections in one request each:\r\n            singleFileUploads: true,\r\n            // To limit the number of files uploaded with one XHR request,\r\n            // set the following option to an integer greater than 0:\r\n            limitMultiFileUploads: undefined,\r\n            // Set the following option to true to issue all file upload requests\r\n            // in a sequential order:\r\n            sequentialUploads: false,\r\n            // To limit the number of concurrent uploads,\r\n            // set the following option to an integer greater than 0:\r\n            limitConcurrentUploads: undefined,\r\n            // Set the following option to true to force iframe transport uploads:\r\n            forceIframeTransport: false,\r\n            // Set the following option to the location of a redirect url on the\r\n            // origin server, for cross-domain iframe transport uploads:\r\n            redirect: undefined,\r\n            // The parameter name for the redirect url, sent as part of the form\r\n            // data and set to 'redirect' if this option is empty:\r\n            redirectParamName: undefined,\r\n            // Set the following option to the location of a postMessage window,\r\n            // to enable postMessage transport uploads:\r\n            postMessage: undefined,\r\n            // By default, XHR file uploads are sent as multipart/form-data.\r\n            // The iframe transport is always using multipart/form-data.\r\n            // Set to false to enable non-multipart XHR uploads:\r\n            multipart: true,\r\n            // To upload large files in smaller chunks, set the following option\r\n            // to a preferred maximum chunk size. If set to 0, null or undefined,\r\n            // or the browser does not support the required Blob API, files will\r\n            // be uploaded as a whole.\r\n            maxChunkSize: undefined,\r\n            // When a non-multipart upload or a chunked multipart upload has been\r\n            // aborted, this option can be used to resume the upload by setting\r\n            // it to the size of the already uploaded bytes. This option is most\r\n            // useful when modifying the options object inside of the \"add\" or\r\n            // \"send\" callbacks, as the options are cloned for each file upload.\r\n            uploadedBytes: undefined,\r\n            // By default, failed (abort or error) file uploads are removed from the\r\n            // global progress calculation. Set the following option to false to\r\n            // prevent recalculating the global progress data:\r\n            recalculateProgress: true,\r\n            // Interval in milliseconds to calculate and trigger progress events:\r\n            progressInterval: 100,\r\n            // Interval in milliseconds to calculate progress bitrate:\r\n            bitrateInterval: 500,\r\n\r\n            // Additional form data to be sent along with the file uploads can be set\r\n            // using this option, which accepts an array of objects with name and\r\n            // value properties, a function returning such an array, a FormData\r\n            // object (for XHR file uploads), or a simple object.\r\n            // The form of the first fileInput is given as parameter to the function:\r\n            formData: function (form) {\r\n                return form.serializeArray();\r\n            },\r\n\r\n            // The add callback is invoked as soon as files are added to the fileupload\r\n            // widget (via file input selection, drag & drop, paste or add API call).\r\n            // If the singleFileUploads option is enabled, this callback will be\r\n            // called once for each file in the selection for XHR file uplaods, else\r\n            // once for each file selection.\r\n            // The upload starts when the submit method is invoked on the data parameter.\r\n            // The data object contains a files property holding the added files\r\n            // and allows to override plugin options as well as define ajax settings.\r\n            // Listeners for this callback can also be bound the following way:\r\n            // .bind('fileuploadadd', func);\r\n            // data.submit() returns a Promise object and allows to attach additional\r\n            // handlers using jQuery's Deferred callbacks:\r\n            // data.submit().done(func).fail(func).always(func);\r\n            add: function (e, data) {\r\n                data.submit();\r\n            },\r\n\r\n            // Other callbacks:\r\n            // Callback for the submit event of each file upload:\r\n            // submit: function (e, data) {}, // .bind('fileuploadsubmit', func);\r\n            // Callback for the start of each file upload request:\r\n            // send: function (e, data) {}, // .bind('fileuploadsend', func);\r\n            // Callback for successful uploads:\r\n            // done: function (e, data) {}, // .bind('fileuploaddone', func);\r\n            // Callback for failed (abort or error) uploads:\r\n            // fail: function (e, data) {}, // .bind('fileuploadfail', func);\r\n            // Callback for completed (success, abort or error) requests:\r\n            // always: function (e, data) {}, // .bind('fileuploadalways', func);\r\n            // Callback for upload progress events:\r\n            // progress: function (e, data) {}, // .bind('fileuploadprogress', func);\r\n            // Callback for global upload progress events:\r\n            // progressall: function (e, data) {}, // .bind('fileuploadprogressall', func);\r\n            // Callback for uploads start, equivalent to the global ajaxStart event:\r\n            // start: function (e) {}, // .bind('fileuploadstart', func);\r\n            // Callback for uploads stop, equivalent to the global ajaxStop event:\r\n            // stop: function (e) {}, // .bind('fileuploadstop', func);\r\n            // Callback for change events of the fileInput collection:\r\n            // change: function (e, data) {}, // .bind('fileuploadchange', func);\r\n            // Callback for paste events to the dropZone collection:\r\n            // paste: function (e, data) {}, // .bind('fileuploadpaste', func);\r\n            // Callback for drop events of the dropZone collection:\r\n            // drop: function (e, data) {}, // .bind('fileuploaddrop', func);\r\n            // Callback for dragover events of the dropZone collection:\r\n            // dragover: function (e) {}, // .bind('fileuploaddragover', func);\r\n\r\n            // The plugin options are used as settings object for the ajax calls.\r\n            // The following are jQuery ajax settings required for the file uploads:\r\n            processData: false,\r\n            contentType: false,\r\n            cache: false\r\n        },\r\n\r\n        // A list of options that require a refresh after assigning a new value:\r\n        _refreshOptionsList: [\r\n            'namespace',\r\n            'dropZone',\r\n            'fileInput',\r\n            'multipart',\r\n            'forceIframeTransport'\r\n        ],\r\n\r\n        _BitrateTimer: function () {\r\n            this.timestamp = +(new Date());\r\n            this.loaded = 0;\r\n            this.bitrate = 0;\r\n            this.getBitrate = function (now, loaded, interval) {\r\n                var timeDiff = now - this.timestamp;\r\n                if (!this.bitrate || !interval || timeDiff > interval) {\r\n                    this.bitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;\r\n                    this.loaded = loaded;\r\n                    this.timestamp = now;\r\n                }\r\n                return this.bitrate;\r\n            };\r\n        },\r\n\r\n        _isXHRUpload: function (options) {\r\n            return !options.forceIframeTransport &&\r\n                ((!options.multipart && $.support.xhrFileUpload) ||\r\n                $.support.xhrFormDataFileUpload);\r\n        },\r\n\r\n        _getFormData: function (options) {\r\n            var formData;\r\n            if (typeof options.formData === 'function') {\r\n                return options.formData(options.form);\r\n            }\r\n\t\t\tif ($.isArray(options.formData)) {\r\n                return options.formData;\r\n            }\r\n\t\t\tif (options.formData) {\r\n                formData = [];\r\n                $.each(options.formData, function (name, value) {\r\n                    formData.push({name: name, value: value});\r\n                });\r\n                return formData;\r\n            }\r\n            return [];\r\n        },\r\n\r\n        _getTotal: function (files) {\r\n            var total = 0;\r\n            $.each(files, function (index, file) {\r\n                total += file.size || 1;\r\n            });\r\n            return total;\r\n        },\r\n\r\n        _onProgress: function (e, data) {\r\n            if (e.lengthComputable) {\r\n                var now = +(new Date()),\r\n                    total,\r\n                    loaded;\r\n                if (data._time && data.progressInterval &&\r\n                        (now - data._time < data.progressInterval) &&\r\n                        e.loaded !== e.total) {\r\n                    return;\r\n                }\r\n                data._time = now;\r\n                total = data.total || this._getTotal(data.files);\r\n                loaded = parseInt(\r\n                    e.loaded / e.total * (data.chunkSize || total),\r\n                    10\r\n                ) + (data.uploadedBytes || 0);\r\n                this._loaded += loaded - (data.loaded || data.uploadedBytes || 0);\r\n                data.lengthComputable = true;\r\n                data.loaded = loaded;\r\n                data.total = total;\r\n                data.bitrate = data._bitrateTimer.getBitrate(\r\n                    now,\r\n                    loaded,\r\n                    data.bitrateInterval\r\n                );\r\n                // Trigger a custom progress event with a total data property set\r\n                // to the file size(s) of the current upload and a loaded data\r\n                // property calculated accordingly:\r\n                this._trigger('progress', e, data);\r\n                // Trigger a global progress event for all current file uploads,\r\n                // including ajax calls queued for sequential file uploads:\r\n                this._trigger('progressall', e, {\r\n                    lengthComputable: true,\r\n                    loaded: this._loaded,\r\n                    total: this._total,\r\n                    bitrate: this._bitrateTimer.getBitrate(\r\n                        now,\r\n                        this._loaded,\r\n                        data.bitrateInterval\r\n                    )\r\n                });\r\n            }\r\n        },\r\n\r\n        _initProgressListener: function (options) {\r\n            var that = this,\r\n                xhr = options.xhr ? options.xhr() : $.ajaxSettings.xhr();\r\n            // Accesss to the native XHR object is required to add event listeners\r\n            // for the upload progress event:\r\n            if (xhr.upload) {\r\n                $(xhr.upload).bind('progress', function (e) {\r\n                    var oe = e.originalEvent;\r\n                    // Make sure the progress event properties get copied over:\r\n                    e.lengthComputable = oe.lengthComputable;\r\n                    e.loaded = oe.loaded;\r\n                    e.total = oe.total;\r\n                    that._onProgress(e, options);\r\n                });\r\n                options.xhr = function () {\r\n                    return xhr;\r\n                };\r\n            }\r\n        },\r\n\r\n        _initXHRData: function (options) {\r\n            var formData,\r\n                file = options.files[0],\r\n                // Ignore non-multipart setting if not supported:\r\n                multipart = options.multipart || !$.support.xhrFileUpload,\r\n                paramName = options.paramName[0];\r\n            if (!multipart || options.blob) {\r\n                // For non-multipart uploads and chunked uploads,\r\n                // file meta data is not part of the request body,\r\n                // so we transmit this data as part of the HTTP headers.\r\n                // For cross domain requests, these headers must be allowed\r\n                // via Access-Control-Allow-Headers or removed using\r\n                // the beforeSend callback:\r\n                options.headers = $.extend(options.headers, {\r\n                    'X-File-Name': file.name,\r\n                    'X-File-Type': file.type,\r\n                    'X-File-Size': file.size\r\n                });\r\n                if (!options.blob) {\r\n                    // Non-chunked non-multipart upload:\r\n                    options.contentType = file.type;\r\n                    options.data = file;\r\n                } else if (!multipart) {\r\n                    // Chunked non-multipart upload:\r\n                    options.contentType = 'application/octet-stream';\r\n                    options.data = options.blob;\r\n                }\r\n            }\r\n            if (multipart && $.support.xhrFormDataFileUpload) {\r\n                if (options.postMessage) {\r\n                    // window.postMessage does not allow sending FormData\r\n                    // objects, so we just add the File/Blob objects to\r\n                    // the formData array and let the postMessage window\r\n                    // create the FormData object out of this array:\r\n                    formData = this._getFormData(options);\r\n                    if (options.blob) {\r\n                        formData.push({\r\n                            name: paramName,\r\n                            value: options.blob\r\n                        });\r\n                    } else {\r\n                        $.each(options.files, function (index, file) {\r\n                            formData.push({\r\n                                name: options.paramName[index] || paramName,\r\n                                value: file\r\n                            });\r\n                        });\r\n                    }\r\n                } else {\r\n                    if (options.formData instanceof FormData) {\r\n                        formData = options.formData;\r\n                    } else {\r\n                        formData = new FormData();\r\n                        $.each(this._getFormData(options), function (index, field) {\r\n                            formData.append(field.name, field.value);\r\n                        });\r\n                    }\r\n                    if (options.blob) {\r\n                        formData.append(paramName, options.blob, file.name);\r\n                    } else {\r\n                        $.each(options.files, function (index, file) {\r\n                            // File objects are also Blob instances.\r\n                            // This check allows the tests to run with\r\n                            // dummy objects:\r\n                            if (file instanceof Blob) {\r\n                                formData.append(\r\n                                    options.paramName[index] || paramName,\r\n                                    file,\r\n                                    file.name\r\n                                );\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                options.data = formData;\r\n            }\r\n            // Blob reference is not needed anymore, free memory:\r\n            options.blob = null;\r\n        },\r\n\r\n        _initIframeSettings: function (options) {\r\n            // Setting the dataType to iframe enables the iframe transport:\r\n            options.dataType = 'iframe ' + (options.dataType || '');\r\n            // The iframe transport accepts a serialized array as form data:\r\n            options.formData = this._getFormData(options);\r\n            // Add redirect url to form data on cross-domain uploads:\r\n            if (options.redirect && $('<a></a>').prop('href', options.url)\r\n                    .prop('host') !== location.host) {\r\n                options.formData.push({\r\n                    name: options.redirectParamName || 'redirect',\r\n                    value: options.redirect\r\n                });\r\n            }\r\n        },\r\n\r\n        _initDataSettings: function (options) {\r\n            if (this._isXHRUpload(options)) {\r\n                if (!this._chunkedUpload(options, true)) {\r\n                    if (!options.data) {\r\n                        this._initXHRData(options);\r\n                    }\r\n                    this._initProgressListener(options);\r\n                }\r\n                if (options.postMessage) {\r\n                    // Setting the dataType to postmessage enables the\r\n                    // postMessage transport:\r\n                    options.dataType = 'postmessage ' + (options.dataType || '');\r\n                }\r\n            } else {\r\n                this._initIframeSettings(options, 'iframe');\r\n            }\r\n        },\r\n\r\n        _getParamName: function (options) {\r\n            var fileInput = $(options.fileInput),\r\n                paramName = options.paramName;\r\n            if (!paramName) {\r\n                paramName = [];\r\n                fileInput.each(function () {\r\n                    var input = $(this),\r\n                        name = input.prop('name') || 'files[]',\r\n                        i = (input.prop('files') || [1]).length;\r\n                    while (i) {\r\n                        paramName.push(name);\r\n                        i -= 1;\r\n                    }\r\n                });\r\n                if (!paramName.length) {\r\n                    paramName = [fileInput.prop('name') || 'files[]'];\r\n                }\r\n            } else if (!$.isArray(paramName)) {\r\n                paramName = [paramName];\r\n            }\r\n            return paramName;\r\n        },\r\n\r\n        _initFormSettings: function (options) {\r\n            // Retrieve missing options from the input field and the\r\n            // associated form, if available:\r\n            if (!options.form || !options.form.length) {\r\n                options.form = $(options.fileInput.prop('form'));\r\n            }\r\n            options.paramName = this._getParamName(options);\r\n            if (!options.url) {\r\n                options.url = options.form.prop('action') || location.href;\r\n            }\r\n            // The HTTP request method must be \"POST\" or \"PUT\":\r\n            options.type = (options.type || options.form.prop('method') || '')\r\n                .toUpperCase();\r\n            if (options.type !== 'POST' && options.type !== 'PUT') {\r\n                options.type = 'POST';\r\n            }\r\n            if (!options.formAcceptCharset) {\r\n                options.formAcceptCharset = options.form.attr('accept-charset');\r\n            }\r\n        },\r\n\r\n        _getAJAXSettings: function (data) {\r\n            var options = $.extend({}, this.options, data);\r\n            this._initFormSettings(options);\r\n            this._initDataSettings(options);\r\n            return options;\r\n        },\r\n\r\n        // Maps jqXHR callbacks to the equivalent\r\n        // methods of the given Promise object:\r\n        _enhancePromise: function (promise) {\r\n            promise.success = promise.done;\r\n            promise.error = promise.fail;\r\n            promise.complete = promise.always;\r\n            return promise;\r\n        },\r\n\r\n        // Creates and returns a Promise object enhanced with\r\n        // the jqXHR methods abort, success, error and complete:\r\n        _getXHRPromise: function (resolveOrReject, context, args) {\r\n            var dfd = $.Deferred(),\r\n                promise = dfd.promise();\r\n            context = context || this.options.context || promise;\r\n            if (resolveOrReject === true) {\r\n                dfd.resolveWith(context, args);\r\n            } else if (resolveOrReject === false) {\r\n                dfd.rejectWith(context, args);\r\n            }\r\n            promise.abort = dfd.promise;\r\n            return this._enhancePromise(promise);\r\n        },\r\n\r\n        // Uploads a file in multiple, sequential requests\r\n        // by splitting the file up in multiple blob chunks.\r\n        // If the second parameter is true, only tests if the file\r\n        // should be uploaded in chunks, but does not invoke any\r\n        // upload requests:\r\n        _chunkedUpload: function (options, testOnly) {\r\n            var that = this,\r\n                file = options.files[0],\r\n                fs = file.size,\r\n                ub = options.uploadedBytes = options.uploadedBytes || 0,\r\n                mcs = options.maxChunkSize || fs,\r\n                // Use the Blob methods with the slice implementation\r\n                // according to the W3C Blob API specification:\r\n                slice = file.webkitSlice || file.mozSlice || file.slice,\r\n                upload,\r\n                n,\r\n                jqXHR,\r\n                pipe;\r\n            if (!(this._isXHRUpload(options) && slice && (ub || mcs < fs)) ||\r\n                    options.data) {\r\n                return false;\r\n            }\r\n            if (testOnly) {\r\n                return true;\r\n            }\r\n            if (ub >= fs) {\r\n                file.error = 'uploadedBytes';\r\n                return this._getXHRPromise(\r\n                    false,\r\n                    options.context,\r\n                    [null, 'error', file.error]\r\n                );\r\n            }\r\n            // n is the number of blobs to upload,\r\n            // calculated via filesize, uploaded bytes and max chunk size:\r\n            n = Math.ceil((fs - ub) / mcs);\r\n            // The chunk upload method accepting the chunk number as parameter:\r\n            upload = function (i) {\r\n                if (!i) {\r\n                    return that._getXHRPromise(true, options.context);\r\n                }\r\n                // Upload the blobs in sequential order:\r\n                return upload(i -= 1).pipe(function () {\r\n                    // Clone the options object for each chunk upload:\r\n                    var o = $.extend({}, options);\r\n                    o.blob = slice.call(\r\n                        file,\r\n                        ub + i * mcs,\r\n                        ub + (i + 1) * mcs\r\n                    );\r\n                    // Expose the chunk index:\r\n                    o.chunkIndex = i;\r\n                    // Expose the number of chunks:\r\n                    o.chunksNumber = n;\r\n                    // Store the current chunk size, as the blob itself\r\n                    // will be dereferenced after data processing:\r\n                    o.chunkSize = o.blob.size;\r\n                    // Process the upload data (the blob and potential form data):\r\n                    that._initXHRData(o);\r\n                    // Add progress listeners for this chunk upload:\r\n                    that._initProgressListener(o);\r\n                    jqXHR = ($.ajax(o) || that._getXHRPromise(false, o.context))\r\n                        .done(function () {\r\n                            // Create a progress event if upload is done and\r\n                            // no progress event has been invoked for this chunk:\r\n                            if (!o.loaded) {\r\n                                that._onProgress($.Event('progress', {\r\n                                    lengthComputable: true,\r\n                                    loaded: o.chunkSize,\r\n                                    total: o.chunkSize\r\n                                }), o);\r\n                            }\r\n                            options.uploadedBytes = o.uploadedBytes +=\r\n                                o.chunkSize;\r\n                        });\r\n                    return jqXHR;\r\n                });\r\n            };\r\n            // Return the piped Promise object, enhanced with an abort method,\r\n            // which is delegated to the jqXHR object of the current upload,\r\n            // and jqXHR callbacks mapped to the equivalent Promise methods:\r\n            pipe = upload(n);\r\n            pipe.abort = function () {\r\n                return jqXHR.abort();\r\n            };\r\n            return this._enhancePromise(pipe);\r\n        },\r\n\r\n        _beforeSend: function (e, data) {\r\n            if (this._active === 0) {\r\n                // the start callback is triggered when an upload starts\r\n                // and no other uploads are currently running,\r\n                // equivalent to the global ajaxStart event:\r\n                this._trigger('start');\r\n                // Set timer for global bitrate progress calculation:\r\n                this._bitrateTimer = new this._BitrateTimer();\r\n            }\r\n            this._active += 1;\r\n            // Initialize the global progress values:\r\n            this._loaded += data.uploadedBytes || 0;\r\n            this._total += this._getTotal(data.files);\r\n        },\r\n\r\n        _onDone: function (result, textStatus, jqXHR, options) {\r\n            if (!this._isXHRUpload(options)) {\r\n                // Create a progress event for each iframe load:\r\n                this._onProgress($.Event('progress', {\r\n                    lengthComputable: true,\r\n                    loaded: 1,\r\n                    total: 1\r\n                }), options);\r\n            }\r\n            options.result = result;\r\n            options.textStatus = textStatus;\r\n            options.jqXHR = jqXHR;\r\n            this._trigger('done', null, options);\r\n        },\r\n\r\n        _onFail: function (jqXHR, textStatus, errorThrown, options) {\r\n            options.jqXHR = jqXHR;\r\n            options.textStatus = textStatus;\r\n            options.errorThrown = errorThrown;\r\n            this._trigger('fail', null, options);\r\n            if (options.recalculateProgress) {\r\n                // Remove the failed (error or abort) file upload from\r\n                // the global progress calculation:\r\n                this._loaded -= options.loaded || options.uploadedBytes || 0;\r\n                this._total -= options.total || this._getTotal(options.files);\r\n            }\r\n        },\r\n\r\n        _onAlways: function (jqXHRorResult, textStatus, jqXHRorError, options) {\r\n            this._active -= 1;\r\n            options.textStatus = textStatus;\r\n            if (jqXHRorError && jqXHRorError.always) {\r\n                options.jqXHR = jqXHRorError;\r\n                options.result = jqXHRorResult;\r\n            } else {\r\n                options.jqXHR = jqXHRorResult;\r\n                options.errorThrown = jqXHRorError;\r\n            }\r\n            this._trigger('always', null, options);\r\n            if (this._active === 0) {\r\n                // The stop callback is triggered when all uploads have\r\n                // been completed, equivalent to the global ajaxStop event:\r\n                this._trigger('stop');\r\n                // Reset the global progress values:\r\n                this._loaded = this._total = 0;\r\n                this._bitrateTimer = null;\r\n            }\r\n        },\r\n\r\n        _onSend: function (e, data) {\r\n            var that = this,\r\n                jqXHR,\r\n                slot,\r\n                pipe,\r\n                options = that._getAJAXSettings(data),\r\n                send = function (resolve, args) {\r\n                    that._sending += 1;\r\n                    // Set timer for bitrate progress calculation:\r\n                    options._bitrateTimer = new that._BitrateTimer();\r\n                    jqXHR = jqXHR || (\r\n                        (resolve !== false &&\r\n                        that._trigger('send', e, options) !== false &&\r\n                        (that._chunkedUpload(options) || $.ajax(options))) ||\r\n                        that._getXHRPromise(false, options.context, args)\r\n                    ).done(function (result, textStatus, jqXHR) {\r\n                        that._onDone(result, textStatus, jqXHR, options);\r\n                    }).fail(function (jqXHR, textStatus, errorThrown) {\r\n                        that._onFail(jqXHR, textStatus, errorThrown, options);\r\n                    }).always(function (jqXHRorResult, textStatus, jqXHRorError) {\r\n                        that._sending -= 1;\r\n                        that._onAlways(\r\n                            jqXHRorResult,\r\n                            textStatus,\r\n                            jqXHRorError,\r\n                            options\r\n                        );\r\n                        if (options.limitConcurrentUploads &&\r\n                                options.limitConcurrentUploads > that._sending) {\r\n                            // Start the next queued upload,\r\n                            // that has not been aborted:\r\n                            var nextSlot = that._slots.shift(),\r\n                                isPending;\r\n                            while (nextSlot) {\r\n                                // jQuery 1.6 doesn't provide .state(),\r\n                                // while jQuery 1.8+ removed .isRejected():\r\n                                isPending = nextSlot.state ?\r\n                                        nextSlot.state() === 'pending' :\r\n                                        !nextSlot.isRejected();\r\n                                if (isPending) {\r\n                                    nextSlot.resolve();\r\n                                    break;\r\n                                }\r\n                                nextSlot = that._slots.shift();\r\n                            }\r\n                        }\r\n                    });\r\n                    return jqXHR;\r\n                };\r\n            this._beforeSend(e, options);\r\n            if (this.options.sequentialUploads ||\r\n                    (this.options.limitConcurrentUploads &&\r\n                    this.options.limitConcurrentUploads <= this._sending)) {\r\n                if (this.options.limitConcurrentUploads > 1) {\r\n                    slot = $.Deferred();\r\n                    this._slots.push(slot);\r\n                    pipe = slot.pipe(send);\r\n                } else {\r\n                    pipe = (this._sequence = this._sequence.pipe(send, send));\r\n                }\r\n                // Return the piped Promise object, enhanced with an abort method,\r\n                // which is delegated to the jqXHR object of the current upload,\r\n                // and jqXHR callbacks mapped to the equivalent Promise methods:\r\n                pipe.abort = function () {\r\n                    var args = [undefined, 'abort', 'abort'];\r\n                    if (!jqXHR) {\r\n                        if (slot) {\r\n                            slot.rejectWith(pipe, args);\r\n                        }\r\n                        return send(false, args);\r\n                    }\r\n                    return jqXHR.abort();\r\n                };\r\n                return this._enhancePromise(pipe);\r\n            }\r\n            return send();\r\n        },\r\n\r\n        _onAdd: function (e, data) {\r\n            var that = this,\r\n                result = true,\r\n                options = $.extend({}, this.options, data),\r\n                limit = options.limitMultiFileUploads,\r\n                paramName = this._getParamName(options),\r\n                paramNameSet,\r\n                paramNameSlice,\r\n                fileSet,\r\n                i;\r\n            if (!(options.singleFileUploads || limit) ||\r\n                    !this._isXHRUpload(options)) {\r\n                fileSet = [data.files];\r\n                paramNameSet = [paramName];\r\n            } else if (!options.singleFileUploads && limit) {\r\n                fileSet = [];\r\n                paramNameSet = [];\r\n                for (i = 0; i < data.files.length; i += limit) {\r\n                    fileSet.push(data.files.slice(i, i + limit));\r\n                    paramNameSlice = paramName.slice(i, i + limit);\r\n                    if (!paramNameSlice.length) {\r\n                        paramNameSlice = paramName;\r\n                    }\r\n                    paramNameSet.push(paramNameSlice);\r\n                }\r\n            } else {\r\n                paramNameSet = paramName;\r\n            }\r\n            data.originalFiles = data.files;\r\n            $.each(fileSet || data.files, function (index, element) {\r\n                var newData = $.extend({}, data);\r\n                newData.files = fileSet ? element : [element];\r\n                newData.paramName = paramNameSet[index];\r\n                newData.submit = function () {\r\n                    newData.jqXHR = this.jqXHR =\r\n                        (that._trigger('submit', e, this) !== false) &&\r\n                        that._onSend(e, this);\r\n                    return this.jqXHR;\r\n                };\r\n                return (result = that._trigger('add', e, newData));\r\n            });\r\n            return result;\r\n        },\r\n\r\n        _replaceFileInput: function (input) {\r\n            var inputClone = input.clone(true);\r\n            $('<form></form>').append(inputClone)[0].reset();\r\n            // Detaching allows to insert the fileInput on another form\r\n            // without loosing the file input value:\r\n            input.after(inputClone).detach();\r\n            // Avoid memory leaks with the detached file input:\r\n            $.cleanData(input.unbind('remove'));\r\n            // Replace the original file input element in the fileInput\r\n            // collection with the clone, which has been copied including\r\n            // event handlers:\r\n            this.options.fileInput = this.options.fileInput.map(function (i, el) {\r\n                if (el === input[0]) {\r\n                    return inputClone[0];\r\n                }\r\n                return el;\r\n            });\r\n            // If the widget has been initialized on the file input itself,\r\n            // override this.element with the file input clone:\r\n            if (input[0] === this.element[0]) {\r\n                this.element = inputClone;\r\n            }\r\n        },\r\n\r\n        _handleFileTreeEntry: function (entry, path) {\r\n            var that = this,\r\n                dfd = $.Deferred(),\r\n                errorHandler = function () {\r\n                    dfd.reject();\r\n                },\r\n                dirReader;\r\n            path = path || '';\r\n            if (entry.isFile) {\r\n                entry.file(function (file) {\r\n                    file.relativePath = path;\r\n                    dfd.resolve(file);\r\n                }, errorHandler);\r\n            } else if (entry.isDirectory) {\r\n                dirReader = entry.createReader();\r\n                dirReader.readEntries(function (entries) {\r\n                    that._handleFileTreeEntries(\r\n                        entries,\r\n                        path + entry.name + '/'\r\n                    ).done(function (files) {\r\n                        dfd.resolve(files);\r\n                    }).fail(errorHandler);\r\n                }, errorHandler);\r\n            } else {\r\n                errorHandler();\r\n            }\r\n            return dfd.promise();\r\n        },\r\n\r\n        _handleFileTreeEntries: function (entries, path) {\r\n            var that = this;\r\n            return $.when.apply(\r\n                $,\r\n                $.map(entries, function (entry) {\r\n                    return that._handleFileTreeEntry(entry, path);\r\n                })\r\n            ).pipe(function () {\r\n                return Array.prototype.concat.apply(\r\n                    [],\r\n                    arguments\r\n                );\r\n            });\r\n        },\r\n\r\n        _getDroppedFiles: function (dataTransfer) {\r\n            dataTransfer = dataTransfer || {};\r\n            var items = dataTransfer.items;\r\n            if (items && items.length && (items[0].webkitGetAsEntry ||\r\n                    items[0].getAsEntry)) {\r\n                return this._handleFileTreeEntries(\r\n                    $.map(items, function (item) {\r\n                        if (item.webkitGetAsEntry) {\r\n                            return item.webkitGetAsEntry();\r\n                        }\r\n                        return item.getAsEntry();\r\n                    })\r\n                );\r\n            }\r\n            return $.Deferred().resolve(\r\n                $.makeArray(dataTransfer.files)\r\n            ).promise();\r\n        },\r\n\r\n        _getFileInputFiles: function (fileInput) {\r\n            fileInput = $(fileInput);\r\n            var entries = fileInput.prop('webkitEntries') ||\r\n                    fileInput.prop('entries'),\r\n                files,\r\n                value;\r\n            if (entries && entries.length) {\r\n                return this._handleFileTreeEntries(entries);\r\n            }\r\n            files = $.makeArray(fileInput.prop('files'));\r\n            if (!files.length) {\r\n                value = fileInput.prop('value');\r\n                if (!value) {\r\n                    return $.Deferred().reject([]).promise();\r\n                }\r\n                // If the files property is not available, the browser does not\r\n                // support the File API and we add a pseudo File object with\r\n                // the input value as name with path information removed:\r\n                files = [{name: value.replace(/^.*\\\\/, '')}];\r\n            }\r\n            return $.Deferred().resolve(files).promise();\r\n        },\r\n\r\n        _onChange: function (e) {\r\n            var that = e.data.fileupload,\r\n                data = {\r\n                    fileInput: $(e.target),\r\n                    form: $(e.target.form)\r\n                };\r\n            that._getFileInputFiles(data.fileInput).always(function (files) {\r\n                data.files = files;\r\n                if (that.options.replaceFileInput) {\r\n                    that._replaceFileInput(data.fileInput);\r\n                }\r\n                if (that._trigger('change', e, data) !== false) {\r\n                    that._onAdd(e, data);\r\n                }\r\n            });\r\n        },\r\n\r\n        _onPaste: function (e) {\r\n            var that = e.data.fileupload,\r\n                cbd = e.originalEvent.clipboardData,\r\n                items = (cbd && cbd.items) || [],\r\n                data = {files: []};\r\n            $.each(items, function (index, item) {\r\n                var file = item.getAsFile && item.getAsFile();\r\n                if (file) {\r\n                    data.files.push(file);\r\n                }\r\n            });\r\n            if (that._trigger('paste', e, data) === false ||\r\n                    that._onAdd(e, data) === false) {\r\n                return false;\r\n            }\r\n        },\r\n\r\n        _onDrop: function (e) {\r\n            e.preventDefault();\r\n            var that = e.data.fileupload,\r\n                dataTransfer = e.dataTransfer = e.originalEvent.dataTransfer,\r\n                data = {};\r\n            that._getDroppedFiles(dataTransfer).always(function (files) {\r\n                data.files = files;\r\n                if (that._trigger('drop', e, data) !== false) {\r\n                    that._onAdd(e, data);\r\n                }\r\n            });\r\n        },\r\n\r\n        _onDragOver: function (e) {\r\n            var that = e.data.fileupload,\r\n                dataTransfer = e.dataTransfer = e.originalEvent.dataTransfer;\r\n            if (that._trigger('dragover', e) === false) {\r\n                return false;\r\n            }\r\n            if (dataTransfer) {\r\n                dataTransfer.dropEffect = 'copy';\r\n            }\r\n            e.preventDefault();\r\n        },\r\n\r\n        _initEventHandlers: function () {\r\n            var ns = this.options.namespace;\r\n            if (this._isXHRUpload(this.options)) {\r\n                this.options.dropZone\r\n                    .bind('dragover.' + ns, {fileupload: this}, this._onDragOver)\r\n                    .bind('drop.' + ns, {fileupload: this}, this._onDrop)\r\n                    .bind('paste.' + ns, {fileupload: this}, this._onPaste);\r\n            }\r\n            this.options.fileInput\r\n                .bind('change.' + ns, {fileupload: this}, this._onChange);\r\n        },\r\n\r\n        _destroyEventHandlers: function () {\r\n            var ns = this.options.namespace;\r\n            this.options.dropZone\r\n                .unbind('dragover.' + ns, this._onDragOver)\r\n                .unbind('drop.' + ns, this._onDrop)\r\n                .unbind('paste.' + ns, this._onPaste);\r\n            this.options.fileInput\r\n                .unbind('change.' + ns, this._onChange);\r\n        },\r\n\r\n        _setOption: function (key, value) {\r\n            var refresh = $.inArray(key, this._refreshOptionsList) !== -1;\r\n            if (refresh) {\r\n                this._destroyEventHandlers();\r\n            }\r\n            $.Widget.prototype._setOption.call(this, key, value);\r\n            if (refresh) {\r\n                this._initSpecialOptions();\r\n                this._initEventHandlers();\r\n            }\r\n        },\r\n\r\n        _initSpecialOptions: function () {\r\n            var options = this.options;\r\n            if (options.fileInput === undefined) {\r\n                options.fileInput = this.element.is('input[type=\"file\"]') ?\r\n                        this.element : this.element.find('input[type=\"file\"]');\r\n            } else if (!(options.fileInput instanceof $)) {\r\n                options.fileInput = $(options.fileInput);\r\n            }\r\n            if (!(options.dropZone instanceof $)) {\r\n                options.dropZone = $(options.dropZone);\r\n            }\r\n        },\r\n\r\n        _create: function () {\r\n            var options = this.options;\r\n            // Initialize options set via HTML5 data-attributes:\r\n            $.extend(options, $(this.element[0].cloneNode(false)).data());\r\n            options.namespace = options.namespace || this.widgetName;\r\n            this._initSpecialOptions();\r\n            this._slots = [];\r\n            this._sequence = this._getXHRPromise(true);\r\n            this._sending = this._active = this._loaded = this._total = 0;\r\n            this._initEventHandlers();\r\n        },\r\n\r\n        destroy: function () {\r\n            this._destroyEventHandlers();\r\n            $.Widget.prototype.destroy.call(this);\r\n        },\r\n\r\n        enable: function () {\r\n            var wasDisabled = false;\r\n            if (this.options.disabled) {\r\n                wasDisabled = true;\r\n            }\r\n            $.Widget.prototype.enable.call(this);\r\n            if (wasDisabled) {\r\n                this._initEventHandlers();\r\n            }\r\n        },\r\n\r\n        disable: function () {\r\n            if (!this.options.disabled) {\r\n                this._destroyEventHandlers();\r\n            }\r\n            $.Widget.prototype.disable.call(this);\r\n        },\r\n\r\n        // This method is exposed to the widget API and allows adding files\r\n        // using the fileupload API. The data parameter accepts an object which\r\n        // must have a files property and can contain additional options:\r\n        // .fileupload('add', {files: filesList});\r\n        add: function (data) {\r\n            var that = this;\r\n            if (!data || this.options.disabled) {\r\n                return;\r\n            }\r\n            if (data.fileInput && !data.files) {\r\n                this._getFileInputFiles(data.fileInput).always(function (files) {\r\n                    data.files = files;\r\n                    that._onAdd(null, data);\r\n                });\r\n            } else {\r\n                data.files = $.makeArray(data.files);\r\n                this._onAdd(null, data);\r\n            }\r\n        },\r\n\r\n        // This method is exposed to the widget API and allows sending files\r\n        // using the fileupload API. The data parameter accepts an object which\r\n        // must have a files or fileInput property and can contain additional options:\r\n        // .fileupload('send', {files: filesList});\r\n        // The method returns a Promise object for the file upload call.\r\n        send: function (data) {\r\n            if (data && !this.options.disabled) {\r\n                if (data.fileInput && !data.files) {\r\n                    var that = this,\r\n                        dfd = $.Deferred(),\r\n                        promise = dfd.promise(),\r\n                        jqXHR,\r\n                        aborted;\r\n                    promise.abort = function () {\r\n                        aborted = true;\r\n                        if (jqXHR) {\r\n                            return jqXHR.abort();\r\n                        }\r\n                        dfd.reject(null, 'abort', 'abort');\r\n                        return promise;\r\n                    };\r\n                    this._getFileInputFiles(data.fileInput).always(\r\n                        function (files) {\r\n                            if (aborted) {\r\n                                return;\r\n                            }\r\n                            data.files = files;\r\n                            jqXHR = that._onSend(null, data).then(\r\n                                function (result, textStatus, jqXHR) {\r\n                                    dfd.resolve(result, textStatus, jqXHR);\r\n                                },\r\n                                function (jqXHR, textStatus, errorThrown) {\r\n                                    dfd.reject(jqXHR, textStatus, errorThrown);\r\n                                }\r\n                            );\r\n                        }\r\n                    );\r\n                    return this._enhancePromise(promise);\r\n                }\r\n                data.files = $.makeArray(data.files);\r\n                if (data.files.length) {\r\n                    return this._onSend(null, data);\r\n                }\r\n            }\r\n            return this._getXHRPromise(false, data && data.context);\r\n        }\r\n\r\n    });\r\n\r\n}));\r\n","jquery/fileUploader/jquery.iframe-transport.js":"/*\r\n * jQuery Iframe Transport Plugin 1.5\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*jslint unparam: true, nomen: true */\r\n/*global define, window, document */\r\n\r\n(function (factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        // Register as an anonymous AMD module:\r\n        define(['jquery'], factory);\r\n    } else {\r\n        // Browser globals:\r\n        factory(window.jQuery);\r\n    }\r\n}(function ($) {\r\n    'use strict';\r\n\r\n    // Helper variable to create unique names for the transport iframes:\r\n    var counter = 0;\r\n\r\n    // The iframe transport accepts three additional options:\r\n    // options.fileInput: a jQuery collection of file input fields\r\n    // options.paramName: the parameter name for the file form data,\r\n    //  overrides the name property of the file input field(s),\r\n    //  can be a string or an array of strings.\r\n    // options.formData: an array of objects with name and value properties,\r\n    //  equivalent to the return data of .serializeArray(), e.g.:\r\n    //  [{name: 'a', value: 1}, {name: 'b', value: 2}]\r\n    $.ajaxTransport('iframe', function (options) {\r\n        if (options.async && (options.type === 'POST' || options.type === 'GET')) {\r\n            var form,\r\n                iframe;\r\n            return {\r\n                send: function (_, completeCallback) {\r\n                    form = $('<form style=\"display:none;\"></form>');\r\n                    form.attr('accept-charset', options.formAcceptCharset);\r\n                    // javascript:false as initial iframe src\r\n                    // prevents warning popups on HTTPS in IE6.\r\n                    // IE versions below IE8 cannot set the name property of\r\n                    // elements that have already been added to the DOM,\r\n                    // so we set the name along with the iframe HTML markup:\r\n                    iframe = $(\r\n                        '<iframe src=\"javascript:false;\" name=\"iframe-transport-' +\r\n                            (counter += 1) + '\"></iframe>'\r\n                    ).bind('load', function () {\r\n                        var fileInputClones,\r\n                            paramNames = $.isArray(options.paramName) ?\r\n                                    options.paramName : [options.paramName];\r\n                        iframe\r\n                            .unbind('load')\r\n                            .bind('load', function () {\r\n                                var response;\r\n                                // Wrap in a try/catch block to catch exceptions thrown\r\n                                // when trying to access cross-domain iframe contents:\r\n                                try {\r\n                                    response = iframe.contents();\r\n                                    // Google Chrome and Firefox do not throw an\r\n                                    // exception when calling iframe.contents() on\r\n                                    // cross-domain requests, so we unify the response:\r\n                                    if (!response.length || !response[0].firstChild) {\r\n                                        throw new Error();\r\n                                    }\r\n                                } catch (e) {\r\n                                    response = undefined;\r\n                                }\r\n                                // The complete callback returns the\r\n                                // iframe content document as response object:\r\n                                completeCallback(\r\n                                    200,\r\n                                    'success',\r\n                                    {'iframe': response}\r\n                                );\r\n                                // Fix for IE endless progress bar activity bug\r\n                                // (happens on form submits to iframe targets):\r\n                                $('<iframe src=\"javascript:false;\"></iframe>')\r\n                                    .appendTo(form);\r\n                                form.remove();\r\n                            });\r\n                        form\r\n                            .prop('target', iframe.prop('name'))\r\n                            .prop('action', options.url)\r\n                            .prop('method', options.type);\r\n                        if (options.formData) {\r\n                            $.each(options.formData, function (index, field) {\r\n                                $('<input type=\"hidden\"/>')\r\n                                    .prop('name', field.name)\r\n                                    .val(field.value)\r\n                                    .appendTo(form);\r\n                            });\r\n                        }\r\n                        if (options.fileInput && options.fileInput.length &&\r\n                                options.type === 'POST') {\r\n                            fileInputClones = options.fileInput.clone();\r\n                            // Insert a clone for each file input field:\r\n                            options.fileInput.after(function (index) {\r\n                                return fileInputClones[index];\r\n                            });\r\n                            if (options.paramName) {\r\n                                options.fileInput.each(function (index) {\r\n                                    $(this).prop(\r\n                                        'name',\r\n                                        paramNames[index] || options.paramName\r\n                                    );\r\n                                });\r\n                            }\r\n                            // Appending the file input fields to the hidden form\r\n                            // removes them from their original location:\r\n                            form\r\n                                .append(options.fileInput)\r\n                                .prop('enctype', 'multipart/form-data')\r\n                                // enctype must be set as encoding for IE:\r\n                                .prop('encoding', 'multipart/form-data');\r\n                        }\r\n                        form.submit();\r\n                        // Insert the file input fields at their original location\r\n                        // by replacing the clones with the originals:\r\n                        if (fileInputClones && fileInputClones.length) {\r\n                            options.fileInput.each(function (index, input) {\r\n                                var clone = $(fileInputClones[index]);\r\n                                $(input).prop('name', clone.prop('name'));\r\n                                clone.replaceWith(input);\r\n                            });\r\n                        }\r\n                    });\r\n                    form.append(iframe).appendTo(document.body);\r\n                },\r\n                abort: function () {\r\n                    if (iframe) {\r\n                        // javascript:false as iframe src aborts the request\r\n                        // and prevents warning popups on HTTPS in IE6.\r\n                        // concat is used to avoid the \"Script URL\" JSLint error:\r\n                        iframe\r\n                            .unbind('load')\r\n                            .prop('src', 'javascript'.concat(':false;'));\r\n                    }\r\n                    if (form) {\r\n                        form.remove();\r\n                    }\r\n                }\r\n            };\r\n        }\r\n    });\r\n\r\n    // The iframe transport returns the iframe content document as response.\r\n    // The following adds converters from iframe to text, json, html, and script:\r\n    $.ajaxSetup({\r\n        converters: {\r\n            'iframe text': function (iframe) {\r\n                return $(iframe[0].body).text();\r\n            },\r\n            'iframe json': function (iframe) {\r\n                return $.parseJSON($(iframe[0].body).text());\r\n            },\r\n            'iframe html': function (iframe) {\r\n                return $(iframe[0].body).html();\r\n            },\r\n            'iframe script': function (iframe) {\r\n                return $.globalEval($(iframe[0].body).text());\r\n            }\r\n        }\r\n    });\r\n\r\n}));\r\n","jquery/fileUploader/load-image.js":"(function(a){\"use strict\";var b=function(a,c,d){var e=document.createElement(\"img\"),f,g;return e.onerror=c,e.onload=function(){g&&(!d||!d.noRevoke)&&b.revokeObjectURL(g),c(b.scale(e,d))},window.Blob&&a instanceof Blob||window.File&&a instanceof File?f=g=b.createObjectURL(a):f=a,f?(e.src=f,e):b.readFile(a,function(a){e.src=a})},c=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.scale=function(a,b){b=b||{};var c=document.createElement(\"canvas\"),d=a.width,e=a.height,f=Math.max((b.minWidth||d)/d,(b.minHeight||e)/e);return f>1&&(d=parseInt(d*f,10),e=parseInt(e*f,10)),f=Math.min((b.maxWidth||d)/d,(b.maxHeight||e)/e),f<1&&(d=parseInt(d*f,10),e=parseInt(e*f,10)),a.getContext||b.canvas&&c.getContext?(c.width=d,c.height=e,c.getContext(\"2d\").drawImage(a,0,0,d,e),c):(a.width=d,a.height=e,a)},b.createObjectURL=function(a){return c?c.createObjectURL(a):!1},b.revokeObjectURL=function(a){return c?c.revokeObjectURL(a):!1},b.readFile=function(a,b){if(window.FileReader&&FileReader.prototype.readAsDataURL){var c=new FileReader;return c.onload=function(a){b(a.target.result)},c.readAsDataURL(a),c}return!1},typeof define==\"function\"&&define.amd?define(function(){return b}):a.loadImage=b})(this);","jquery/fileUploader/locale.js":"/*\r\n * jQuery File Upload Plugin Localization Example 6.5.1\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2012, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*global window */\r\n\r\nwindow.locale = {\r\n    \"fileupload\": {\r\n        \"errors\": {\r\n            \"maxFileSize\": \"File is too big\",\r\n            \"minFileSize\": \"File is too small\",\r\n            \"acceptFileTypes\": \"Filetype not allowed\",\r\n            \"maxNumberOfFiles\": \"Max number of files exceeded\",\r\n            \"uploadedBytes\": \"Uploaded bytes exceed file size\",\r\n            \"emptyResult\": \"Empty file upload result\"\r\n        },\r\n        \"error\": \"Error\",\r\n        \"start\": \"Start\",\r\n        \"cancel\": \"Cancel\",\r\n        \"destroy\": \"Delete\"\r\n    }\r\n};\r\n","jquery/fileUploader/main.js":"/*\r\n * jQuery File Upload Plugin JS Example 6.7\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2010, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*jslint nomen: true, unparam: true, regexp: true */\r\n/*global $, window, document */\r\n\r\n$(function () {\r\n    'use strict';\r\n\r\n    // Initialize the jQuery File Upload widget:\r\n    $('#fileupload').fileupload();\r\n\r\n    // Enable iframe cross-domain access via redirect option:\r\n    $('#fileupload').fileupload(\r\n        'option',\r\n        'redirect',\r\n        window.location.href.replace(\r\n            /\\/[^\\/]*$/,\r\n            '/cors/result.html?%s'\r\n        )\r\n    );\r\n\r\n    if (window.location.hostname === 'blueimp.github.com') {\r\n        // Demo settings:\r\n        $('#fileupload').fileupload('option', {\r\n            url: '//jquery-file-upload.appspot.com/',\r\n            maxFileSize: 5000000,\r\n            acceptFileTypes: /(\\.|\\/)(gif|jpe?g|png)$/i,\r\n            process: [\r\n                {\r\n                    action: 'load',\r\n                    fileTypes: /^image\\/(gif|jpeg|png)$/,\r\n                    maxFileSize: 20000000 // 20MB\r\n                },\r\n                {\r\n                    action: 'resize',\r\n                    maxWidth: 1440,\r\n                    maxHeight: 900\r\n                },\r\n                {\r\n                    action: 'save'\r\n                }\r\n            ]\r\n        });\r\n        // Upload server status check for browsers with CORS support:\r\n        if ($.support.cors) {\r\n            $.ajax({\r\n                url: '//jquery-file-upload.appspot.com/',\r\n                type: 'HEAD'\r\n            }).fail(function () {\r\n                $('<span class=\"alert alert-error\"/>')\r\n                    .text($.mage.__('Upload server currently unavailable - ') +\r\n                            new Date())\r\n                    .appendTo('#fileupload');\r\n            });\r\n        }\r\n    } else {\r\n        // Load existing files:\r\n        $('#fileupload').each(function () {\r\n            var that = this;\r\n            $.getJSON(this.action, function (result) {\r\n                if (result && result.length) {\r\n                    $(that).fileupload('option', 'done')\r\n                        .call(that, null, {result: result});\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n});\r\n","jquery/fileUploader/cors/jquery.postmessage-transport.js":"/*\r\n * jQuery postMessage Transport Plugin 1.1\r\n * https://github.com/blueimp/jQuery-File-Upload\r\n *\r\n * Copyright 2011, Sebastian Tschan\r\n * https://blueimp.net\r\n *\r\n * Licensed under the MIT license:\r\n * http://www.opensource.org/licenses/MIT\r\n */\r\n\r\n/*jslint unparam: true, nomen: true */\r\n/*global define, window, document */\r\n\r\n(function (factory) {\r\n    'use strict';\r\n    if (typeof define === 'function' && define.amd) {\r\n        // Register as an anonymous AMD module:\r\n        define(['jquery'], factory);\r\n    } else {\r\n        // Browser globals:\r\n        factory(window.jQuery);\r\n    }\r\n}(function ($) {\r\n    'use strict';\r\n\r\n    var counter = 0,\r\n        names = [\r\n            'accepts',\r\n            'cache',\r\n            'contents',\r\n            'contentType',\r\n            'crossDomain',\r\n            'data',\r\n            'dataType',\r\n            'headers',\r\n            'ifModified',\r\n            'mimeType',\r\n            'password',\r\n            'processData',\r\n            'timeout',\r\n            'traditional',\r\n            'type',\r\n            'url',\r\n            'username'\r\n        ],\r\n        convert = function (p) {\r\n            return p;\r\n        };\r\n\r\n    $.ajaxSetup({\r\n        converters: {\r\n            'postmessage text': convert,\r\n            'postmessage json': convert,\r\n            'postmessage html': convert\r\n        }\r\n    });\r\n\r\n    $.ajaxTransport('postmessage', function (options) {\r\n        if (options.postMessage && window.postMessage) {\r\n            var iframe,\r\n                loc = $('<a>').prop('href', options.postMessage)[0],\r\n                target = loc.protocol + '//' + loc.host,\r\n                xhrUpload = options.xhr().upload;\r\n            return {\r\n                send: function (_, completeCallback) {\r\n                    var message = {\r\n                            id: 'postmessage-transport-' + (counter += 1)\r\n                        },\r\n                        eventName = 'message.' + message.id;\r\n                    iframe = $(\r\n                        '<iframe style=\"display:none;\" src=\"' +\r\n                            options.postMessage + '\" name=\"' +\r\n                            message.id + '\"></iframe>'\r\n                    ).bind('load', function () {\r\n                        $.each(names, function (i, name) {\r\n                            message[name] = options[name];\r\n                        });\r\n                        message.dataType = message.dataType.replace('postmessage ', '');\r\n                        $(window).bind(eventName, function (e) {\r\n                            e = e.originalEvent;\r\n                            var data = e.data,\r\n                                ev;\r\n                            if (e.origin === target && data.id === message.id) {\r\n                                if (data.type === 'progress') {\r\n                                    ev = document.createEvent('Event');\r\n                                    ev.initEvent(data.type, false, true);\r\n                                    $.extend(ev, data);\r\n                                    xhrUpload.dispatchEvent(ev);\r\n                                } else {\r\n                                    completeCallback(\r\n                                        data.status,\r\n                                        data.statusText,\r\n                                        {postmessage: data.result},\r\n                                        data.headers\r\n                                    );\r\n                                    iframe.remove();\r\n                                    $(window).unbind(eventName);\r\n                                }\r\n                            }\r\n                        });\r\n                        iframe[0].contentWindow.postMessage(\r\n                            message,\r\n                            target\r\n                        );\r\n                    }).appendTo(document.body);\r\n                },\r\n                abort: function () {\r\n                    if (iframe) {\r\n                        iframe.remove();\r\n                    }\r\n                }\r\n            };\r\n        }\r\n    });\r\n\r\n}));\r\n","mage/bootstrap.js":"/**\r\n * Copyright \u00c2\u00a9 2016 Magento. All rights reserved.\r\n * See COPYING.txt for license details.\r\n */\r\ndefine([\r\n    'jquery',\r\n    'mage/apply/main',\r\n    'Magento_Ui/js/lib/knockout/bootstrap'\r\n], function ($, mage) {\r\n    'use strict';\r\n\r\n    $.ajaxSetup({\r\n        cache: false\r\n    });\r\n\r\n    /**\r\n     * Init all components defined via data-mage-init attribute.\r\n     */\r\n    $(mage.apply);\r\n});\r\n","mage/captcha.js":"/**\r\n * Copyright \u00c2\u00a9 2016 Magento. All rights reserved.\r\n * See COPYING.txt for license details.\r\n */\r\nvar Captcha = Class.create();\r\nCaptcha.prototype = {\r\n    initialize: function(url, formId){\r\n        this.url = url;\r\n        this.formId = formId;\r\n    },\r\n    refresh: function(elem) {\r\n        formId = this.formId;\r\n        if (elem) Element.addClassName(elem, 'refreshing');\r\n        new Ajax.Request(this.url, {\r\n            onSuccess: function (response) {\r\n                if (response.responseText.isJSON()) {\r\n                    var json = response.responseText.evalJSON();\r\n                    if (!json.error && json.imgSrc) {\r\n                        $(formId).writeAttribute('src', json.imgSrc);\r\n                        if (elem) Element.removeClassName(elem, 'refreshing');\r\n                    } else {\r\n                        if (elem) Element.removeClassName(elem, 'refreshing');\r\n                    }\r\n                }\r\n            },\r\n            method: 'post',\r\n            parameters: {\r\n                'formId'   : this.formId\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n\r\n","mage/layout.js":"/**\r\n * Copyright \u00c2\u00a9 2016 Magento. All rights reserved.\r\n * See COPYING.txt for license details.\r\n */\r\n/*jshint browser:true jquery:true */\r\n/*global console:true*/\r\ndefine(['underscore'], function($) {\r\n    return {\r\n        build: function(config) {\r\n            var types = _.map(_.flatten(config), function(item) {\r\n                return item.type;\r\n            });\r\n            require(types, function () {\r\n                \r\n            });\r\n        }\r\n    };\r\n});\r\n"}
    }
});
